
/**
    
    ######## BEFORE UPDATING DATA-HANDLING CODE OR USING THE COALESCE OPERATOR: ######## ~michael
    don't use the pipe-pipe "||" coalesce operator when handling data because if a zero comes to the coalesce (and it is a number 0 and not a string "0") it will be evaluated as false and thus coalesce to the next operand. Whenever you use this operator: be careful of what will be evaluated.
    
    To see this in action run this in your console:
    
    console.log( true      || 'test' );  // logs:  true  (expected)
    console.log( false     || 'test' );  // logs: 'test' (expected)

    console.log( null      || 'test' );  // logs: 'test' (expected)
    console.log( undefined || 'test' );  // logs: 'test' (expected)

    console.log( '1'       || 'test' );  // logs: '1'    (expected)
    console.log(  1        || 'test' );  // logs:  1     (expected)
    console.log( '0'       || 'test' );  // logs: '0'    (expected)
    console.log(  0        || 'test' );  // logs: 'test' (OH NO!!)
    
    here is another demonstration:
    
    console.log( Boolean(true)      );
    console.log( Boolean(false)     );
    console.log( Boolean(null)      );
    console.log( Boolean(undefined) );
    console.log( Boolean('1')       );
    console.log( Boolean( 1)        );
    console.log( Boolean('0')       );
    console.log( Boolean( 0)        ); // zero evaluates to false
    
    
    ######## BEFORE UPDATING FASTCLICK: ######## ~michael
    fastclick (around line 254) has some code added (by michael) to add a feature to fastclick, bring this code to any new version
    
    it also has (around line 123) some code added to an if statement added by joseph:
        if (deviceIsAndroid || deviceIsIOS) {
    as opposed to:
        if (deviceIsAndroid) {
    
    
    ######## BEFORE UPDATING X-TAGS: ######## ~michael and nunzio
    nunzio: the below warning now seems to be outdated
    nunzio: you have to delete '"function"==typeof define&&define.amd?define(X):"undefined"!=typeof module&&module.exports?module.exports=X:' from xtags for electron
    make sure you include the polyfills and make sure that there isn't still a duplicated block of code in the source, if there is remove it, here is how to find out:
    
    do a find in textedit for: "scope.upgradeDocumentTree = nop;" (excluding the quotes of course)
    AND var IMPORT_LINK_TYPE = scope.IMPORT_LINK_TYPE
    
    remove the whole block of code surrounding the second match (it might be the first match but I think it is the second match)
    
    
    ######## ELEMENT REGISTRATION: ######## ~michael
    When registering a custom element:
        1) register it after the "DOMContentLoaded" event has fired. Doing this prevents an issue that we ran into where in some cases (I believe when greyspots.js is cached and you are on yosemite is one case) some elements would be cut off and would disappear.
        2) Use the "methods" for public functions only, private functions should be kept in the "DOMContentLoaded" function. By keeping the functions in there it makes it so that the code for that element is the only code that can run those functions and it prevents these functions for cluttering public namespaces.
        3) Use "'use strict';" from the beginning. If you don't start out with it you might introduce strict mode errors that you don't even know about. Then one day you might decide to put "'use strict';" in there and errors you didn't know about will appear. Some errors might appear when you first move it over and some errors might be disvovered by your users because you didn't test every little feature of the element.
    
    An example:
    
    document.addEventListener('DOMContentLoaded', function () {
        'use strict';
        
        // ### private functions go here ###
        function foobar() {
            // do stuff to "element" here (gs-new-element is the only element that can run this function)
        }
        
        xtag.register('gs-new-element', {
            lifecycle: {
                'created': function () {
                    
                }
            },
            events: {},
            accessors: {},
            methods: {
                // ### public functions go here ###
            }
        });
    });
    
    ######## PSEUDO ELEMENT WARNING: ######## ~michael
    In firefox I ran into an issue where the undo history of controls in a gs-form (with the attribute "save-while-typing") was being erased. Turns out the issue was caused by a CSS pseudo-element. I was using a pseudo-element for a little box attached to the form to tell the user if the form was waiting to save or saving. By changing the pseudo-element to a real element that I add and remove with Javascript the issue was fixed.
    
    If you want to use a pseudo-element: make sure it doesn't affect the undo history of elements that are children of the element that the pseudo-element is attached to. This issue could have been fixed by now.
    
    
    
    ######## TEMPLATE SHIM: ######## ~michael
    The template polyfill has been changed, DO NOT UPDATE. It is for old browsers, and old browsers don't change so there is should be no need for the polyfill to change.
    
*/ /**
 * @license
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */
if(typeof HTMLTemplateElement==='undefined'){(function(){var TEMPLATE_TAG='template';var contentDoc=document.implementation.createHTMLDocument('template');/**
      Provides a minimal shim for the <template> element.
    */
HTMLTemplateElement=function(){};HTMLTemplateElement.prototype=Object.create(HTMLElement.prototype);/**
      The `decorate` method moves element children to the template's `content`.
      NOTE: there is no support for dynamically adding elements to templates.
    */
HTMLTemplateElement.decorate=function(template){if(!template.content){template.content=template.ownerDocument.createDocumentFragment();}
var child;while(child=template.firstChild){template.content.appendChild(child);}
if(!template.content.children){Object.defineProperty(template.content,'children',{get:function(){'use strict';var arrChildren=[],i,len,childNodes=this.childNodes;for(i=0,len=childNodes.length;i<len;i+=1){if(childNodes[i].nodeType!==3){arrChildren.push(childNodes[i]);}}
return arrChildren;},configurable:true});}
Object.defineProperty(template,'innerHTML',{get:function(){var o='',fragment=this.content.cloneNode(true);for(var e=fragment.firstChild;e;e=e.nextSibling){o+=e.outerHTML||escapeData(e.data);}
return o;},set:function(text){contentDoc.body.innerHTML=text;while(this.content.firstChild){this.content.removeChild(this.content.firstChild);}
while(contentDoc.body.firstChild){this.content.appendChild(contentDoc.body.firstChild);}},configurable:true});Object.defineProperty(template,'outerHTML',{get:function(){var openTagText,arrAttr,i,len,innerHTML=this.innerHTML;arrAttr=this.attributes;for(i=0,len=arrAttr.length,openTagText='<template';i<len;i+=1){openTagText+=' '+arrAttr[i].nodeName+'="'+encodeHTML(arrAttr[i].value)+'"';}
return openTagText+'>'+innerHTML+'</template>';},configurable:true});};/**
      The `bootstrap` method is called automatically and "fixes" all
      <template> elements in the document referenced by the `doc` argument.
    */
HTMLTemplateElement.bootstrap=function(doc){var templates=doc.querySelectorAll(TEMPLATE_TAG),i,l,t;for(i=0,l=templates.length,t;(i<l)&&(t=templates[i]);i+=1){if(!GS.findParentTag(t,'template')&&GS.findParentTag(t,'html')){HTMLTemplateElement.decorate(t);}}};window.addEventListener('DOMContentLoaded',function(){HTMLTemplateElement.bootstrap(document);});var createElement=document.createElement;document.createElement=function(){'use strict';var el=createElement.apply(document,arguments);if(el.localName=='template'){HTMLTemplateElement.decorate(el);}
return el;};var escapeDataRegExp=/[&\u00A0<>]/g;function escapeReplace(c){switch(c){case'&':return'&amp;';case'<':return'&lt;';case'>':return'&gt;';case'\u00A0':return'&nbsp;';}}
function escapeData(s){return s.replace(escapeDataRegExp,escapeReplace);}})();}(function(){function e(e){if(this._element=e,e.className!=this._classCache){if(this._classCache=e.className,!this._classCache)return;var t,n=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(t=0;n.length>t;t++)a.call(this,n[t])}}function t(e,t){e.className=t.join(" ")}function n(e,t,n){Object.defineProperty?Object.defineProperty(e,t,{get:n}):e.__defineGetter__(t,n)}if(!(window.Element===void 0||"classList"in document.documentElement)){var r=Array.prototype,o=r.indexOf,i=r.slice,a=r.push,s=r.splice,c=r.join;e.prototype={add:function(e){this.contains(e)||(a.call(this,e),t(this._element,i.call(this,0)))},contains:function(e){return-1!==o.call(this,e)},item:function(e){return this[e]||null},remove:function(e){var n=o.call(this,e);-1!==n&&(s.call(this,n,1),t(this._element,i.call(this,0)))},toString:function(){return c.call(this," ")},toggle:function(e){-1===o.call(this,e)?this.add(e):this.remove(e)}},window.DOMTokenList=e,n(Element.prototype,"classList",function(){return new e(this)})}})(),function(){window.WebComponents=window.WebComponents||{flags:{}};var e="webcomponents-lite.js",t=document.querySelector('script[src*="'+e+'"]'),n={};if(!n.noOpts){if(location.search.slice(1).split("&").forEach(function(e){var t,r=e.split("=");r[0]&&(t=r[0].match(/wc-(.+)/))&&(n[t[1]]=r[1]||!0)}),t)for(var r,o=0;r=t.attributes[o];o++)"src"!==r.name&&(n[r.name]=r.value||!0);if(n.log&&n.log.split){var i=n.log.split(",");n.log={},i.forEach(function(e){n.log[e]=!0})}else n.log={}}n.register&&(window.CustomElements=window.CustomElements||{flags:{}},window.CustomElements.flags.register=n.register),WebComponents.flags=n}(),function(e){"use strict";function t(e){return void 0!==h[e]}function n(){s.call(this),this._isInvalid=!0}function r(e){return""==e&&n.call(this),e.toLowerCase()}function o(e){var t=e.charCodeAt(0);return t>32&&127>t&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function i(e){var t=e.charCodeAt(0);return t>32&&127>t&&-1==[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}function a(e,a,s){function c(e){y.push(e)}var u=a||"scheme start",l=0,d="",b=!1,g=!1,y=[];e:for(;(e[l-1]!=f||0==l)&&!this._isInvalid;){var w=e[l];switch(u){case"scheme start":if(!w||!m.test(w)){if(a){c("Invalid scheme.");break e}d="",u="no scheme";continue}d+=w.toLowerCase(),u="scheme";break;case"scheme":if(w&&v.test(w))d+=w.toLowerCase();else{if(":"!=w){if(a){if(f==w)break e;c("Code point not allowed in scheme: "+w);break e}d="",l=0,u="no scheme";continue}if(this._scheme=d,d="",a)break e;t(this._scheme)&&(this._isRelative=!0),u="file"==this._scheme?"relative":this._isRelative&&s&&s._scheme==this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"==w?(this._query="?",u="query"):"#"==w?(this._fragment="#",u="fragment"):f!=w&&" "!=w&&"\n"!=w&&"\r"!=w&&(this._schemeData+=o(w));break;case"no scheme":if(s&&t(s._scheme)){u="relative";continue}c("Missing scheme."),n.call(this);break;case"relative or authority":if("/"!=w||"/"!=e[l+1]){c("Expected /, got: "+w),u="relative";continue}u="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!=this._scheme&&(this._scheme=s._scheme),f==w){this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._username=s._username,this._password=s._password;break e}if("/"==w||"\\"==w)"\\"==w&&c("\\ is an invalid code point."),u="relative slash";else if("?"==w)this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query="?",this._username=s._username,this._password=s._password,u="query";else{if("#"!=w){var _=e[l+1],E=e[l+2];("file"!=this._scheme||!m.test(w)||":"!=_&&"|"!=_||f!=E&&"/"!=E&&"\\"!=E&&"?"!=E&&"#"!=E)&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password,this._path=s._path.slice(),this._path.pop()),u="relative path";continue}this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._fragment="#",this._username=s._username,this._password=s._password,u="fragment"}break;case"relative slash":if("/"!=w&&"\\"!=w){"file"!=this._scheme&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password),u="relative path";continue}"\\"==w&&c("\\ is an invalid code point."),u="file"==this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=w){c("Expected '/', got: "+w),u="authority ignore slashes";continue}u="authority second slash";break;case"authority second slash":if(u="authority ignore slashes","/"!=w){c("Expected '/', got: "+w);continue}break;case"authority ignore slashes":if("/"!=w&&"\\"!=w){u="authority";continue}c("Expected authority, got: "+w);break;case"authority":if("@"==w){b&&(c("@ already seen."),d+="%40"),b=!0;for(var T=0;d.length>T;T++){var C=d[T];if(" "!=C&&"\n"!=C&&"\r"!=C)if(":"!=C||null!==this._password){var M=o(C);null!==this._password?this._password+=M:this._username+=M}else this._password="";else c("Invalid whitespace in authority.")}d=""}else{if(f==w||"/"==w||"\\"==w||"?"==w||"#"==w){l-=d.length,d="",u="host";continue}d+=w}break;case"file host":if(f==w||"/"==w||"\\"==w||"?"==w||"#"==w){2!=d.length||!m.test(d[0])||":"!=d[1]&&"|"!=d[1]?0==d.length?u="relative path start":(this._host=r.call(this,d),d="",u="relative path start"):u="relative path";continue}" "==w||"\n"==w||"\r"==w?c("Invalid whitespace in file host."):d+=w;break;case"host":case"hostname":if(":"!=w||g){if(f==w||"/"==w||"\\"==w||"?"==w||"#"==w){if(this._host=r.call(this,d),d="",u="relative path start",a)break e;continue}" "!=w&&"\n"!=w&&"\r"!=w?("["==w?g=!0:"]"==w&&(g=!1),d+=w):c("Invalid code point in host/hostname: "+w)}else if(this._host=r.call(this,d),d="",u="port","hostname"==a)break e;break;case"port":if(/[0-9]/.test(w))d+=w;else{if(f==w||"/"==w||"\\"==w||"?"==w||"#"==w||a){if(""!=d){var L=parseInt(d,10);L!=h[this._scheme]&&(this._port=L+""),d=""}if(a)break e;u="relative path start";continue}" "==w||"\n"==w||"\r"==w?c("Invalid code point in port: "+w):n.call(this)}break;case"relative path start":if("\\"==w&&c("'\\' not allowed in path."),u="relative path","/"!=w&&"\\"!=w)continue;break;case"relative path":if(f!=w&&"/"!=w&&"\\"!=w&&(a||"?"!=w&&"#"!=w))" "!=w&&"\n"!=w&&"\r"!=w&&(d+=o(w));else{"\\"==w&&c("\\ not allowed in relative path.");var O;(O=p[d.toLowerCase()])&&(d=O),".."==d?(this._path.pop(),"/"!=w&&"\\"!=w&&this._path.push("")):"."==d&&"/"!=w&&"\\"!=w?this._path.push(""):"."!=d&&("file"==this._scheme&&0==this._path.length&&2==d.length&&m.test(d[0])&&"|"==d[1]&&(d=d[0]+":"),this._path.push(d)),d="","?"==w?(this._query="?",u="query"):"#"==w&&(this._fragment="#",u="fragment")}break;case"query":a||"#"!=w?f!=w&&" "!=w&&"\n"!=w&&"\r"!=w&&(this._query+=i(w)):(this._fragment="#",u="fragment");break;case"fragment":f!=w&&" "!=w&&"\n"!=w&&"\r"!=w&&(this._fragment+=w)}l++}}function s(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function c(e,t){void 0===t||t instanceof c||(t=new c(t+"")),this._url=e,s.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");a.call(this,n,null,t)}var u=!1;if(!e.forceJURL)try{var l=new URL("b","http://a");l.pathname="c%20d",u="http://a/c%20d"===l.href}catch(d){}if(!u){var h=Object.create(null);h.ftp=21,h.file=0,h.gopher=70,h.http=80,h.https=443,h.ws=80,h.wss=443;var p=Object.create(null);p["%2e"]=".",p[".%2e"]="..",p["%2e."]="..",p["%2e%2e"]="..";var f=void 0,m=/[a-zA-Z]/,v=/[a-zA-Z0-9\+\-\.]/;c.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return(""!=this._username||null!=this._password)&&(e=this._username+(null!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){s.call(this),a.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||a.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],a.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&(this._query="?","?"==e[0]&&(e=e.slice(1)),a.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set hash(e){this._isInvalid||(this._fragment="#","#"==e[0]&&(e=e.slice(1)),a.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return e=this.host,e?this._scheme+"://"+e:""}};var b=e.URL;b&&(c.createObjectURL=function(){return b.createObjectURL.apply(b,arguments)},c.revokeObjectURL=function(e){b.revokeObjectURL(e)}),e.URL=c}}(self),"undefined"==typeof WeakMap&&function(){var e=Object.defineProperty,t=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+(t++ +"__")};n.prototype={set:function(t,n){var r=t[this.name];return r&&r[0]===t?r[1]=n:e(t,this.name,{value:[t,n],writable:!0}),this},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){var t=e[this.name];return t&&t[0]===e?(t[0]=t[1]=void 0,!0):!1},has:function(e){var t=e[this.name];return t?t[0]===e:!1}},window.WeakMap=n}(),function(e){function t(e){w.push(e),y||(y=!0,m(r))}function n(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}function r(){y=!1;var e=w;w=[],e.sort(function(e,t){return e.uid_-t.uid_});var t=!1;e.forEach(function(e){var n=e.takeRecords();o(e),n.length&&(e.callback_(n,e),t=!0)}),t&&r()}function o(e){e.nodes_.forEach(function(t){var n=v.get(t);n&&n.forEach(function(t){t.observer===e&&t.removeTransientObservers()})})}function i(e,t){for(var n=e;n;n=n.parentNode){var r=v.get(n);if(r)for(var o=0;r.length>o;o++){var i=r[o],a=i.options;if(n===e||a.subtree){var s=t(a);s&&i.enqueue(s)}}}}function a(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++_}function s(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function c(e){var t=new s(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}function u(e,t){return E=new s(e,t)}function l(e){return T?T:(T=c(E),T.oldValue=e,T)}function d(){E=T=void 0}function h(e){return e===T||e===E}function p(e,t){return e===t?e:T&&h(e)?T:null}function f(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}if(!e.JsMutationObserver){var m,v=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))m=setTimeout;else if(window.setImmediate)m=window.setImmediate;else{var b=[],g=Math.random()+"";window.addEventListener("message",function(e){if(e.data===g){var t=b;b=[],t.forEach(function(e){e()})}}),m=function(e){b.push(e),window.postMessage(g,"*")}}var y=!1,w=[],_=0;a.prototype={observe:function(e,t){if(e=n(e),!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=v.get(e);r||v.set(e,r=[]);for(var o,i=0;r.length>i;i++)if(r[i].observer===this){o=r[i],o.removeListeners(),o.options=t;break}o||(o=new f(this,e,t),r.push(o),this.nodes_.push(e)),o.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=v.get(e),n=0;t.length>n;n++){var r=t[n];if(r.observer===this){r.removeListeners(),t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}};var E,T;f.prototype={enqueue:function(e){var n=this.observer.records_,r=n.length;if(n.length>0){var o=n[r-1],i=p(o,e);if(i)return n[r-1]=i,void 0}else t(this.observer);n[r]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=v.get(e);t||v.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=v.get(e),n=0;t.length>n;n++)if(t[n]===this){t.splice(n,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,n=e.relatedNode.namespaceURI,r=e.target,o=new u("attributes",r);o.attributeName=t,o.attributeNamespace=n;var a=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;i(r,function(e){return!e.attributes||e.attributeFilter&&e.attributeFilter.length&&-1===e.attributeFilter.indexOf(t)&&-1===e.attributeFilter.indexOf(n)?void 0:e.attributeOldValue?l(a):o});break;case"DOMCharacterDataModified":var r=e.target,o=u("characterData",r),a=e.prevValue;i(r,function(e){return e.characterData?e.characterDataOldValue?l(a):o:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var s,c,h=e.target;"DOMNodeInserted"===e.type?(s=[h],c=[]):(s=[],c=[h]);var p=h.previousSibling,f=h.nextSibling,o=u("childList",e.target.parentNode);o.addedNodes=s,o.removedNodes=c,o.previousSibling=p,o.nextSibling=f,i(e.relatedNode,function(e){return e.childList?o:void 0})}d()}},e.JsMutationObserver=a,e.MutationObserver||(e.MutationObserver=a,a._isPolyfilled=!0)}}(self),"undefined"==typeof HTMLTemplateElement&&function(){function e(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case"Â ":return"&nbsp;"}}function t(t){return t.replace(a,e)}var n="template",r=document.implementation.createHTMLDocument("template"),o=!0;HTMLTemplateElement=function(){},HTMLTemplateElement.prototype=Object.create(HTMLElement.prototype),HTMLTemplateElement.decorate=function(e){if(!e.content){e.content=r.createDocumentFragment();for(var n;n=e.firstChild;)e.content.appendChild(n);if(o)try{Object.defineProperty(e,"innerHTML",{get:function(){for(var e="",n=this.content.firstChild;n;n=n.nextSibling)e+=n.outerHTML||t(n.data);return e},set:function(e){for(r.body.innerHTML=e,HTMLTemplateElement.bootstrap(r);this.content.firstChild;)this.content.removeChild(this.content.firstChild);for(;r.body.firstChild;)this.content.appendChild(r.body.firstChild)},configurable:!0})}catch(i){o=!1}HTMLTemplateElement.bootstrap(e.content)}},HTMLTemplateElement.bootstrap=function(e){for(var t,r=e.querySelectorAll(n),o=0,i=r.length;i>o&&(t=r[o]);o++)HTMLTemplateElement.decorate(t)},document.addEventListener("DOMContentLoaded",function(){HTMLTemplateElement.bootstrap(document)});var i=document.createElement;document.createElement=function(){"use strict";var e=i.apply(document,arguments);return"template"==e.localName&&HTMLTemplateElement.decorate(e),e};var a=/[&\u00A0<>]/g}(),function(){"use strict";if(!window.performance){var e=Date.now();window.performance={now:function(){return Date.now()-e}}}window.requestAnimationFrame||(window.requestAnimationFrame=function(){var e=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return e?function(t){return e(function(){t(performance.now())})}:function(e){return window.setTimeout(e,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)}}());var t=function(){var e=document.createEvent("Event");return e.initEvent("foo",!0,!0),e.preventDefault(),e.defaultPrevented}();if(!t){var n=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(n.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var r=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||r&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,Boolean(t.bubbles),Boolean(t.cancelable),t.detail),n},window.CustomEvent.prototype=window.Event.prototype),!window.Event||r&&"function"!=typeof window.Event){var o=window.Event;window.Event=function(e,t){t=t||{};var n=document.createEvent("Event");return n.initEvent(e,Boolean(t.bubbles),Boolean(t.cancelable)),n},window.Event.prototype=o.prototype}}(window.WebComponents),window.HTMLImports=window.HTMLImports||{flags:{}},function(e){function t(e,t){t=t||f,r(function(){i(e,t)},t)}function n(e){return"complete"===e.readyState||e.readyState===b}function r(e,t){if(n(t))e&&e();else{var o=function(){("complete"===t.readyState||t.readyState===b)&&(t.removeEventListener(g,o),r(e,t))};t.addEventListener(g,o)}}function o(e){e.target.__loaded=!0}function i(e,t){function n(){c==u&&e&&e({allImports:s,loadedImports:l,errorImports:d})}function r(e){o(e),l.push(this),c++,n()}function i(){d.push(this),c++,n()}var s=t.querySelectorAll("link[rel=import]"),c=0,u=s.length,l=[],d=[];if(u)for(var h,p=0;u>p&&(h=s[p]);p++)a(h)?(l.push(this),c++,n()):(h.addEventListener("load",r),h.addEventListener("error",i));else n()}function a(e){return d?e.__loaded||e.import&&"loading"!==e.import.readyState:e.__importParsed}function s(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)c(t)&&u(t)}function c(e){return"link"===e.localName&&"import"===e.rel}function u(e){var t=e.import;t?o({target:e}):(e.addEventListener("load",o),e.addEventListener("error",o))}var l="import",d=Boolean(l in document.createElement("link")),h=Boolean(window.ShadowDOMPolyfill),p=function(e){return h?window.ShadowDOMPolyfill.wrapIfNeeded(e):e},f=p(document),m={get:function(){var e=window.HTMLImports.currentScript||document.currentScript||("complete"!==document.readyState?document.scripts[document.scripts.length-1]:null);return p(e)},configurable:!0};Object.defineProperty(document,"_currentScript",m),Object.defineProperty(f,"_currentScript",m);var v=/Trident/.test(navigator.userAgent),b=v?"complete":"interactive",g="readystatechange";d&&(new MutationObserver(function(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)t.addedNodes&&s(t.addedNodes)}).observe(document.head,{childList:!0}),function(){if("loading"===document.readyState)for(var e,t=document.querySelectorAll("link[rel=import]"),n=0,r=t.length;r>n&&(e=t[n]);n++)u(e)}()),t(function(e){window.HTMLImports.ready=!0,window.HTMLImports.readyTime=(new Date).getTime();var t=f.createEvent("CustomEvent");t.initCustomEvent("HTMLImportsLoaded",!0,!0,e),f.dispatchEvent(t)}),e.IMPORT_LINK_TYPE=l,e.useNative=d,e.rootDocument=f,e.whenReady=t,e.isIE=v}(window.HTMLImports),function(e){var t=[],n=function(e){t.push(e)},r=function(){t.forEach(function(t){t(e)})};e.addModule=n,e.initializeModules=r}(window.HTMLImports),window.HTMLImports.addModule(function(e){var t=/(url\()([^)]*)(\))/g,n=/(@import[\s]+(?!url\())([^;]*)(;)/g,r={resolveUrlsInStyle:function(e,t){var n=e.ownerDocument,r=n.createElement("a");return e.textContent=this.resolveUrlsInCssText(e.textContent,t,r),e},resolveUrlsInCssText:function(e,r,o){var i=this.replaceUrls(e,o,r,t);return i=this.replaceUrls(i,o,r,n)},replaceUrls:function(e,t,n,r){return e.replace(r,function(e,r,o,i){var a=o.replace(/["']/g,"");return n&&(a=new URL(a,n).href),t.href=a,a=t.href,r+"'"+a+"'"+i})}};e.path=r}),window.HTMLImports.addModule(function(e){var t={async:!0,ok:function(e){return e.status>=200&&300>e.status||304===e.status||0===e.status},load:function(n,r,o){var i=new XMLHttpRequest;return(e.flags.debug||e.flags.bust)&&(n+="?"+Math.random()),i.open("GET",n,t.async),i.addEventListener("readystatechange",function(e){if(4===i.readyState){var n=null;try{var a=i.getResponseHeader("Location");a&&(n="/"===a.substr(0,1)?location.origin+a:a)}catch(e){console.error(e.message)}r.call(o,!t.ok(i)&&i,i.response||i.responseText,n)}}),i.send(),i},loadDocument:function(e,t,n){this.load(e,t,n).responseType="document"}};e.xhr=t}),window.HTMLImports.addModule(function(e){var t=e.xhr,n=e.flags,r=function(e,t){this.cache={},this.onload=e,this.oncomplete=t,this.inflight=0,this.pending={}};r.prototype={addNodes:function(e){this.inflight+=e.length;for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)this.require(t);this.checkDone()},addNode:function(e){this.inflight++,this.require(e),this.checkDone()},require:function(e){var t=e.src||e.href;e.__nodeUrl=t,this.dedupe(t,e)||this.fetch(t,e)},dedupe:function(e,t){return this.pending[e]?(this.pending[e].push(t),!0):this.cache[e]?(this.onload(e,t,this.cache[e]),this.tail(),!0):(this.pending[e]=[t],!1)},fetch:function(e,r){if(n.load&&console.log("fetch",e,r),e)if(e.match(/^data:/)){var o=e.split(","),i=o[0],a=o[1];a=i.indexOf(";base64")>-1?atob(a):decodeURIComponent(a),setTimeout(function(){this.receive(e,r,null,a)}.bind(this),0)}else{var s=function(t,n,o){this.receive(e,r,t,n,o)}.bind(this);t.load(e,s)}else setTimeout(function(){this.receive(e,r,{error:"href must be specified"},null)}.bind(this),0)},receive:function(e,t,n,r,o){this.cache[e]=r;for(var i,a=this.pending[e],s=0,c=a.length;c>s&&(i=a[s]);s++)this.onload(e,i,r,n,o),this.tail();this.pending[e]=null},tail:function(){--this.inflight,this.checkDone()},checkDone:function(){this.inflight||this.oncomplete()}},e.Loader=r}),window.HTMLImports.addModule(function(e){var t=function(e){this.addCallback=e,this.mo=new MutationObserver(this.handler.bind(this))};t.prototype={handler:function(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)"childList"===t.type&&t.addedNodes.length&&this.addedNodes(t.addedNodes)},addedNodes:function(e){this.addCallback&&this.addCallback(e);for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)t.children&&t.children.length&&this.addedNodes(t.children)},observe:function(e){this.mo.observe(e,{childList:!0,subtree:!0})}},e.Observer=t}),window.HTMLImports.addModule(function(e){function t(e){return"link"===e.localName&&e.rel===l}function n(e){var t=r(e);return"data:text/javascript;charset=utf-8,"+encodeURIComponent(t)}function r(e){return e.textContent+o(e)}function o(e){var t=e.ownerDocument;t.__importedScripts=t.__importedScripts||0;var n=e.ownerDocument.baseURI,r=t.__importedScripts?"-"+t.__importedScripts:"";return t.__importedScripts++,"\n//# sourceURL="+n+r+".js\n"}function i(e){var t=e.ownerDocument.createElement("style");return t.textContent=e.textContent,a.resolveUrlsInStyle(t),t}var a=e.path,s=e.rootDocument,c=e.flags,u=e.isIE,l=e.IMPORT_LINK_TYPE,d="link[rel="+l+"]",h={documentSelectors:d,importsSelectors:[d,"link[rel=stylesheet]:not([type])","style:not([type])","script:not([type])",'script[type="application/javascript"]','script[type="text/javascript"]'].join(","),map:{link:"parseLink",script:"parseScript",style:"parseStyle"},dynamicElements:[],parseNext:function(){var e=this.nextToParse();e&&this.parse(e)},parse:function(e){if(this.isParsed(e))return c.parse&&console.log("[%s] is already parsed",e.localName),void 0;var t=this[this.map[e.localName]];t&&(this.markParsing(e),t.call(this,e))},parseDynamic:function(e,t){this.dynamicElements.push(e),t||this.parseNext()},markParsing:function(e){c.parse&&console.log("parsing",e),this.parsingElement=e},markParsingComplete:function(e){e.__importParsed=!0,this.markDynamicParsingComplete(e),e.__importElement&&(e.__importElement.__importParsed=!0,this.markDynamicParsingComplete(e.__importElement)),this.parsingElement=null,c.parse&&console.log("completed",e)},markDynamicParsingComplete:function(e){var t=this.dynamicElements.indexOf(e);t>=0&&this.dynamicElements.splice(t,1)},parseImport:function(e){if(e.import=e.__doc,window.HTMLImports.__importsParsingHook&&window.HTMLImports.__importsParsingHook(e),e.import&&(e.import.__importParsed=!0),this.markParsingComplete(e),e.__resource&&!e.__error?e.dispatchEvent(new CustomEvent("load",{bubbles:!1})):e.dispatchEvent(new CustomEvent("error",{bubbles:!1})),e.__pending)for(var t;e.__pending.length;)t=e.__pending.shift(),t&&t({target:e});this.parseNext()},parseLink:function(e){t(e)?this.parseImport(e):(e.href=e.href,this.parseGeneric(e))},parseStyle:function(e){var t=e;e=i(e),t.__appliedElement=e,e.__importElement=t,this.parseGeneric(e)},parseGeneric:function(e){this.trackElement(e),this.addElementToDocument(e)},rootImportForElement:function(e){for(var t=e;t.ownerDocument.__importLink;)t=t.ownerDocument.__importLink;return t},addElementToDocument:function(e){var t=this.rootImportForElement(e.__importElement||e);t.parentNode.insertBefore(e,t)},trackElement:function(e,t){var n=this,r=function(o){e.removeEventListener("load",r),e.removeEventListener("error",r),t&&t(o),n.markParsingComplete(e),n.parseNext()};if(e.addEventListener("load",r),e.addEventListener("error",r),u&&"style"===e.localName){var o=!1;if(-1==e.textContent.indexOf("@import"))o=!0;else if(e.sheet){o=!0;for(var i,a=e.sheet.cssRules,s=a?a.length:0,c=0;s>c&&(i=a[c]);c++)i.type===CSSRule.IMPORT_RULE&&(o=o&&Boolean(i.styleSheet))}o&&setTimeout(function(){e.dispatchEvent(new CustomEvent("load",{bubbles:!1}))})}},parseScript:function(t){var r=document.createElement("script");r.__importElement=t,r.src=t.src?t.src:n(t),e.currentScript=t,this.trackElement(r,function(){r.parentNode&&r.parentNode.removeChild(r),e.currentScript=null}),this.addElementToDocument(r)},nextToParse:function(){return this._mayParse=[],!this.parsingElement&&(this.nextToParseInDoc(s)||this.nextToParseDynamic())},nextToParseInDoc:function(e,n){if(e&&0>this._mayParse.indexOf(e)){this._mayParse.push(e);for(var r,o=e.querySelectorAll(this.parseSelectorsForNode(e)),i=0,a=o.length;a>i&&(r=o[i]);i++)if(!this.isParsed(r))return this.hasResource(r)?t(r)?this.nextToParseInDoc(r.__doc,r):r:void 0}return n},nextToParseDynamic:function(){return this.dynamicElements[0]},parseSelectorsForNode:function(e){var t=e.ownerDocument||e;return t===s?this.documentSelectors:this.importsSelectors},isParsed:function(e){return e.__importParsed},needsDynamicParsing:function(e){return this.dynamicElements.indexOf(e)>=0},hasResource:function(e){return t(e)&&void 0===e.__doc?!1:!0}};e.parser=h,e.IMPORT_SELECTOR=d}),window.HTMLImports.addModule(function(e){function t(e){return n(e,a)}function n(e,t){return"link"===e.localName&&e.getAttribute("rel")===t}function r(e){return!!Object.getOwnPropertyDescriptor(e,"baseURI")}function o(e,t){var n=document.implementation.createHTMLDocument(a);n._URL=t;var o=n.createElement("base");o.setAttribute("href",t),n.baseURI||r(n)||Object.defineProperty(n,"baseURI",{value:t});var i=n.createElement("meta");return i.setAttribute("charset","utf-8"),n.head.appendChild(i),n.head.appendChild(o),n.body.innerHTML=e,window.HTMLTemplateElement&&HTMLTemplateElement.bootstrap&&HTMLTemplateElement.bootstrap(n),n}var i=e.flags,a=e.IMPORT_LINK_TYPE,s=e.IMPORT_SELECTOR,c=e.rootDocument,u=e.Loader,l=e.Observer,d=e.parser,h={documents:{},documentPreloadSelectors:s,importsPreloadSelectors:[s].join(","),loadNode:function(e){p.addNode(e)},loadSubtree:function(e){var t=this.marshalNodes(e);p.addNodes(t)},marshalNodes:function(e){return e.querySelectorAll(this.loadSelectorsForNode(e))},loadSelectorsForNode:function(e){var t=e.ownerDocument||e;return t===c?this.documentPreloadSelectors:this.importsPreloadSelectors},loaded:function(e,n,r,a,s){if(i.load&&console.log("loaded",e,n),n.__resource=r,n.__error=a,t(n)){var c=this.documents[e];void 0===c&&(c=a?null:o(r,s||e),c&&(c.__importLink=n,this.bootDocument(c)),this.documents[e]=c),n.__doc=c}d.parseNext()},bootDocument:function(e){this.loadSubtree(e),this.observer.observe(e),d.parseNext()},loadedAll:function(){d.parseNext()}},p=new u(h.loaded.bind(h),h.loadedAll.bind(h));if(h.observer=new l,!document.baseURI){var f={get:function(){var e=document.querySelector("base");return e?e.href:window.location.href},configurable:!0};Object.defineProperty(document,"baseURI",f),Object.defineProperty(c,"baseURI",f)}e.importer=h,e.importLoader=p}),window.HTMLImports.addModule(function(e){var t=e.parser,n=e.importer,r={added:function(e){for(var r,o,i,a,s=0,c=e.length;c>s&&(a=e[s]);s++)r||(r=a.ownerDocument,o=t.isParsed(r)),i=this.shouldLoadNode(a),i&&n.loadNode(a),this.shouldParseNode(a)&&o&&t.parseDynamic(a,i)},shouldLoadNode:function(e){return 1===e.nodeType&&o.call(e,n.loadSelectorsForNode(e))},shouldParseNode:function(e){return 1===e.nodeType&&o.call(e,t.parseSelectorsForNode(e))}};n.observer.addCallback=r.added.bind(r);var o=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector}),function(e){function t(){window.HTMLImports.importer.bootDocument(r)}var n=e.initializeModules;if(e.isIE,!e.useNative){n();var r=e.rootDocument;"complete"===document.readyState||"interactive"===document.readyState&&!window.attachEvent?t():document.addEventListener("DOMContentLoaded",t)}}(window.HTMLImports),window.CustomElements=window.CustomElements||{flags:{}},function(e){var t=e.flags,n=[],r=function(e){n.push(e)},o=function(){n.forEach(function(t){t(e)})};e.addModule=r,e.initializeModules=o,e.hasNative=Boolean(document.registerElement),e.isIE=/Trident/.test(navigator.userAgent),e.useNative=!t.register&&e.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule(function(e){function t(e,t){n(e,function(e){return t(e)?!0:(r(e,t),void 0)}),r(e,t)}function n(e,t,r){var o=e.firstElementChild;if(!o)for(o=e.firstChild;o&&o.nodeType!==Node.ELEMENT_NODE;)o=o.nextSibling;for(;o;)t(o,r)!==!0&&n(o,t,r),o=o.nextElementSibling;return null}function r(e,n){for(var r=e.shadowRoot;r;)t(r,n),r=r.olderShadowRoot}function o(e,t){i(e,t,[])}function i(e,t,n){if(e=window.wrap(e),!(n.indexOf(e)>=0)){n.push(e);for(var r,o=e.querySelectorAll("link[rel="+a+"]"),s=0,c=o.length;c>s&&(r=o[s]);s++)r.import&&i(r.import,t,n);t(e)}}var a=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";e.forDocumentTree=o,e.forSubtree=t}),window.CustomElements.addModule(function(e){function t(e,t){return n(e,t)||r(e,t)}function n(t,n){return e.upgrade(t,n)?!0:(n&&a(t),void 0)}function r(e,t){y(e,function(e){return n(e,t)?!0:void 0})}function o(e){T.push(e),E||(E=!0,setTimeout(i))}function i(){E=!1;for(var e,t=T,n=0,r=t.length;r>n&&(e=t[n]);n++)e();T=[]}function a(e){_?o(function(){s(e)}):s(e)}function s(e){e.__upgraded__&&!e.__attached&&(e.__attached=!0,e.attachedCallback&&e.attachedCallback())}function c(e){u(e),y(e,function(e){u(e)})}function u(e){_?o(function(){l(e)}):l(e)}function l(e){e.__upgraded__&&e.__attached&&(e.__attached=!1,e.detachedCallback&&e.detachedCallback())}function d(e){for(var t=e,n=window.wrap(document);t;){if(t==n)return!0;t=t.parentNode||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.host}}function h(e){if(e.shadowRoot&&!e.shadowRoot.__watched){g.dom&&console.log("watching shadow-root for: ",e.localName);for(var t=e.shadowRoot;t;)m(t),t=t.olderShadowRoot}}function p(e,n){if(g.dom){var r=n[0];if(r&&"childList"===r.type&&r.addedNodes&&r.addedNodes){for(var o=r.addedNodes[0];o&&o!==document&&!o.host;)o=o.parentNode;var i=o&&(o.URL||o._URL||o.host&&o.host.localName)||"";i=i.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",n.length,i||"")}var a=d(e);n.forEach(function(e){"childList"===e.type&&(C(e.addedNodes,function(e){e.localName&&t(e,a)}),C(e.removedNodes,function(e){e.localName&&c(e)}))}),g.dom&&console.groupEnd()}function f(e){for(e=window.wrap(e),e||(e=window.wrap(document));e.parentNode;)e=e.parentNode;var t=e.__observer;t&&(p(e,t.takeRecords()),i())}function m(e){if(!e.__observer){var t=new MutationObserver(p.bind(this,e));t.observe(e,{childList:!0,subtree:!0}),e.__observer=t}}function v(e){e=window.wrap(e),g.dom&&console.group("upgradeDocument: ",e.baseURI.split("/").pop());var n=e===window.wrap(document);t(e,n),m(e),g.dom&&console.groupEnd()}function b(e){w(e,v)}var g=e.flags,y=e.forSubtree,w=e.forDocumentTree,_=window.MutationObserver._isPolyfilled&&g["throttle-attached"];e.hasPolyfillMutations=_,e.hasThrottledAttached=_;var E=!1,T=[],C=Array.prototype.forEach.call.bind(Array.prototype.forEach),M=Element.prototype.createShadowRoot;M&&(Element.prototype.createShadowRoot=function(){var e=M.call(this);return window.CustomElements.watchShadow(this),e}),e.watchShadow=h,e.upgradeDocumentTree=b,e.upgradeDocument=v,e.upgradeSubtree=r,e.upgradeAll=t,e.attached=a,e.takeRecords=f}),window.CustomElements.addModule(function(e){function t(t,r){if("template"===t.localName&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(t),!t.__upgraded__&&t.nodeType===Node.ELEMENT_NODE){var o=t.getAttribute("is"),i=e.getRegisteredDefinition(t.localName)||e.getRegisteredDefinition(o);if(i&&(o&&i.tag==t.localName||!o&&!i.extends))return n(t,i,r)}}function n(t,n,o){return a.upgrade&&console.group("upgrade:",t.localName),n.is&&t.setAttribute("is",n.is),r(t,n),t.__upgraded__=!0,i(t),o&&e.attached(t),e.upgradeSubtree(t,o),a.upgrade&&console.groupEnd(),t}function r(e,t){Object.__proto__?e.__proto__=t.prototype:(o(e,t.prototype,t.native),e.__proto__=t.prototype)}function o(e,t,n){for(var r={},o=t;o!==n&&o!==HTMLElement.prototype;){for(var i,a=Object.getOwnPropertyNames(o),s=0;i=a[s];s++)r[i]||(Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(o,i)),r[i]=1);o=Object.getPrototypeOf(o)}}function i(e){e.createdCallback&&e.createdCallback()}var a=e.flags;e.upgrade=t,e.upgradeWithDefinition=n,e.implementPrototype=r}),window.CustomElements.addModule(function(e){function t(t,r){var c=r||{};if(!t)throw Error("document.registerElement: first argument `name` must not be empty");if(0>t.indexOf("-"))throw Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+(t+"")+"'.");if(o(t))throw Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+(t+"")+"'. The type name is invalid.");if(u(t))throw Error("DuplicateDefinitionError: a type with name '"+(t+"")+"' is already registered");return c.prototype||(c.prototype=Object.create(HTMLElement.prototype)),c.__name=t.toLowerCase(),c.lifecycle=c.lifecycle||{},c.ancestry=i(c.extends),a(c),s(c),n(c.prototype),l(c.__name,c),c.ctor=d(c),c.ctor.prototype=c.prototype,c.prototype.constructor=c.ctor,e.ready&&b(document),c.ctor}function n(e){if(!e.setAttribute._polyfilled){var t=e.setAttribute;e.setAttribute=function(e,n){r.call(this,e,n,t)};var n=e.removeAttribute;e.removeAttribute=function(e){r.call(this,e,null,n)},e.setAttribute._polyfilled=!0}}function r(e,t,n){e=e.toLowerCase();var r=this.getAttribute(e);n.apply(this,arguments);var o=this.getAttribute(e);this.attributeChangedCallback&&o!==r&&this.attributeChangedCallback(e,r,o)}function o(e){for(var t=0;E.length>t;t++)if(e===E[t])return!0}function i(e){var t=u(e);return t?i(t.extends).concat([t]):[]}function a(e){for(var t,n=e.extends,r=0;t=e.ancestry[r];r++)n=t.is&&t.tag;e.tag=n||e.__name,n&&(e.is=e.__name)}function s(e){if(!Object.__proto__){var t=HTMLElement.prototype;if(e.is){var n=document.createElement(e.tag);t=Object.getPrototypeOf(n)}for(var r,o=e.prototype,i=!1;o;)o==t&&(i=!0),r=Object.getPrototypeOf(o),r&&(o.__proto__=r),o=r;i||console.warn(e.tag+" prototype not found in prototype chain for "+e.is),e.native=t}}function c(e){return y(M(e.tag),e)}function u(e){return e?T[e.toLowerCase()]:void 0}function l(e,t){T[e]=t}function d(e){return function(){return c(e)}}function h(e,t,n){return e===C?p(t,n):L(e,t)}function p(e,t){e&&(e=e.toLowerCase()),t&&(t=t.toLowerCase());var n=u(t||e);if(n){if(e==n.tag&&t==n.is)return new n.ctor;if(!t&&!n.is)return new n.ctor}var r;return t?(r=p(e),r.setAttribute("is",t),r):(r=M(e),e.indexOf("-")>=0&&w(r,HTMLElement),r)}function f(e,t){var n=e[t];e[t]=function(){var e=n.apply(this,arguments);return g(e),e}}var m,v=e.isIE,b=e.upgradeDocumentTree,g=e.upgradeAll,y=e.upgradeWithDefinition,w=e.implementPrototype,_=e.useNative,E=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],T={},C="http://www.w3.org/1999/xhtml",M=document.createElement.bind(document),L=document.createElementNS.bind(document);m=Object.__proto__||_?function(e,t){return e instanceof t}:function(e,t){if(e instanceof t)return!0;for(var n=e;n;){if(n===t.prototype)return!0;n=n.__proto__}return!1},f(Node.prototype,"cloneNode"),f(document,"importNode"),v&&function(){var e=document.importNode;document.importNode=function(){var t=e.apply(document,arguments);if(t.nodeType==t.DOCUMENT_FRAGMENT_NODE){var n=document.createDocumentFragment();return n.appendChild(t),n}return t}}(),document.registerElement=t,document.createElement=p,document.createElementNS=h,e.registry=T,e.instanceof=m,e.reservedTagList=E,e.getRegisteredDefinition=u,document.register=document.registerElement}),function(e){function t(){i(window.wrap(document)),window.CustomElements.ready=!0;var e=window.requestAnimationFrame||function(e){setTimeout(e,16)};e(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))})})}var n=e.useNative,r=e.initializeModules;if(e.isIE,n){var o=function(){};e.watchShadow=o,e.upgrade=o,e.upgradeAll=o,e.upgradeDocumentTree=o,e.upgradeSubtree=o,e.takeRecords=o,e.instanceof=function(e,t){return e instanceof t}}else r();var i=e.upgradeDocumentTree,a=e.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(e){return e}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(e){e.import&&a(wrap(e.import))}),"complete"===document.readyState||e.flags.eager)t();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var s=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(s,t)}else t()}(window.CustomElements),function(){var e=document.createElement("style");e.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var t=document.querySelector("head");t.insertBefore(e,t.firstChild)}(window.WebComponents),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PointerEventsPolyfill=t()}(this,function(){"use strict";function e(e,t){t=t||Object.create(null);var n=document.createEvent("Event");n.initEvent(e,t.bubbles||!1,t.cancelable||!1);for(var r,o=2;l.length>o;o++)r=l[o],n[r]=t[r]||d[o];n.buttons=t.buttons||0;var i=0;return i=t.pressure?t.pressure:n.buttons?.5:0,n.x=n.clientX,n.y=n.clientY,n.pointerId=t.pointerId||0,n.width=t.width||0,n.height=t.height||0,n.pressure=i,n.tiltX=t.tiltX||0,n.tiltY=t.tiltY||0,n.pointerType=t.pointerType||"",n.hwTimestamp=t.hwTimestamp||0,n.isPrimary=t.isPrimary||!1,n}function t(){this.array=[],this.size=0}function n(e,t,n,r){this.addCallback=e.bind(r),this.removeCallback=t.bind(r),this.changedCallback=n.bind(r),O&&(this.observer=new O(this.mutationWatcher.bind(this)))}function r(e){return"body /shadow-deep/ "+o(e)}function o(e){return'[touch-action="'+e+'"]'}function i(e){return"{ -ms-touch-action: "+e+"; touch-action: "+e+"; touch-action-delay: none; }"}function a(){if(A){I.forEach(function(e){e+""===e?(k+=o(e)+i(e)+"\n",x&&(k+=r(e)+i(e)+"\n")):(k+=e.selectors.map(o)+i(e.rule)+"\n",x&&(k+=e.selectors.map(r)+i(e.rule)+"\n"))});var e=document.createElement("style");e.textContent=k,document.head.appendChild(e)}}function s(){if(!window.PointerEvent){if(window.PointerEvent=h,window.navigator.msPointerEnabled){var e=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:e,enumerable:!0}),_.registerSource("ms",ot)}else _.registerSource("mouse",U),void 0!==window.ontouchstart&&_.registerSource("touch",et);_.register(document)}}function c(e){if(!_.pointermap.has(e))throw Error("InvalidPointerId")}function u(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:J},releasePointerCapture:{value:Q}})}var l=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],d=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],h=e,p=window.Map&&window.Map.prototype.forEach,f=p?Map:t;t.prototype={set:function(e,t){return void 0===t?this.delete(e):(this.has(e)||this.size++,this.array[e]=t,void 0)},has:function(e){return void 0!==this.array[e]},"delete":function(e){this.has(e)&&(delete this.array[e],this.size--)},get:function(e){return this.array[e]},clear:function(){this.array.length=0,this.size=0},forEach:function(e,t){return this.array.forEach(function(n,r){e.call(t,n,r,this)},this)}};var m=f,v=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],b=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],g={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},y="undefined"!=typeof SVGElementInstance,w={pointermap:new m,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(e,t){var n=t,r=n.events;r&&(r.forEach(function(e){n[e]&&(this.eventMap[e]=n[e].bind(n))},this),this.eventSources[e]=n,this.eventSourceList.push(n))},register:function(e){for(var t,n=this.eventSourceList.length,r=0;n>r&&(t=this.eventSourceList[r]);r++)t.register.call(t,e)},unregister:function(e){for(var t,n=this.eventSourceList.length,r=0;n>r&&(t=this.eventSourceList[r]);r++)t.unregister.call(t,e)},contains:function(e,t){try{return e.contains(t)}catch(n){return!1}},down:function(e){e.bubbles=!0,this.fireEvent("pointerdown",e)},move:function(e){e.bubbles=!0,this.fireEvent("pointermove",e)},up:function(e){e.bubbles=!0,this.fireEvent("pointerup",e)},enter:function(e){e.bubbles=!1,this.fireEvent("pointerenter",e)},leave:function(e){e.bubbles=!1,this.fireEvent("pointerleave",e)},over:function(e){e.bubbles=!0,this.fireEvent("pointerover",e)},out:function(e){e.bubbles=!0,this.fireEvent("pointerout",e)},cancel:function(e){e.bubbles=!0,this.fireEvent("pointercancel",e)},leaveOut:function(e){this.out(e),this.contains(e.target,e.relatedTarget)||this.leave(e)},enterOver:function(e){this.over(e),this.contains(e.target,e.relatedTarget)||this.enter(e)},eventHandler:function(e){if(!e._handledByPE){var t=e.type,n=this.eventMap&&this.eventMap[t];n&&n(e),e._handledByPE=!0}},listen:function(e,t){t.forEach(function(t){this.addEvent(e,t)},this)},unlisten:function(e,t){t.forEach(function(t){this.removeEvent(e,t)},this)},addEvent:function(e,t){e.addEventListener(t,this.boundHandler)},removeEvent:function(e,t){e.removeEventListener(t,this.boundHandler)},makeEvent:function(e,t){this.captureInfo[t.pointerId]&&(t.relatedTarget=null);var n=new h(e,t);return t.preventDefault&&(n.preventDefault=t.preventDefault),n._target=n._target||t.target,n},fireEvent:function(e,t){var n=this.makeEvent(e,t);return this.dispatchEvent(n)},cloneEvent:function(e){for(var t,n=Object.create(null),r=0;v.length>r;r++)t=v[r],n[t]=e[t]||b[r],!y||"target"!==t&&"relatedTarget"!==t||n[t]instanceof SVGElementInstance&&(n[t]=n[t].correspondingUseElement);return e.preventDefault&&(n.preventDefault=function(){e.preventDefault()}),n},getTarget:function(e){var t=this.captureInfo[e.pointerId];return t?e._target!==t&&e.type in g?void 0:t:e._target},setCapture:function(e,t){this.captureInfo[e]&&this.releaseCapture(e),this.captureInfo[e]=t;var n=document.createEvent("Event");n.initEvent("gotpointercapture",!0,!1),n.pointerId=e,this.implicitRelease=this.releaseCapture.bind(this,e),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease),n._target=t,this.asyncDispatchEvent(n)},releaseCapture:function(e){var t=this.captureInfo[e];if(t){var n=document.createEvent("Event");n.initEvent("lostpointercapture",!0,!1),n.pointerId=e,this.captureInfo[e]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),n._target=t,this.asyncDispatchEvent(n)}},dispatchEvent:function(e){var t=this.getTarget(e);return t?t.dispatchEvent(e):void 0},asyncDispatchEvent:function(e){requestAnimationFrame(this.dispatchEvent.bind(this,e))}};w.boundHandler=w.eventHandler.bind(w);var _=w,E={shadow:function(e){return e?e.shadowRoot||e.webkitShadowRoot:void 0},canTarget:function(e){return e&&Boolean(e.elementFromPoint)},targetingShadow:function(e){var t=this.shadow(e);return this.canTarget(t)?t:void 0},olderShadow:function(e){var t=e.olderShadowRoot;if(!t){var n=e.querySelector("shadow");n&&(t=n.olderShadowRoot)}return t},allShadows:function(e){for(var t=[],n=this.shadow(e);n;)t.push(n),n=this.olderShadow(n);return t},searchRoot:function(e,t,n){if(e){var r,o,i=e.elementFromPoint(t,n);for(o=this.targetingShadow(i);o;){if(r=o.elementFromPoint(t,n)){var a=this.targetingShadow(r);return this.searchRoot(a,t,n)||r}o=this.olderShadow(o)}return i}},owner:function(e){for(var t=e;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(e){var t=e.clientX,n=e.clientY,r=this.owner(e.target);return r.elementFromPoint(t,n)||(r=document),this.searchRoot(r,t,n)}},T=Array.prototype.forEach.call.bind(Array.prototype.forEach),C=Array.prototype.map.call.bind(Array.prototype.map),M=Array.prototype.slice.call.bind(Array.prototype.slice),L=Array.prototype.filter.call.bind(Array.prototype.filter),O=window.MutationObserver||window.WebKitMutationObserver,S="[touch-action]",N={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};n.prototype={watchSubtree:function(e){this.observer&&E.canTarget(e)&&this.observer.observe(e,N)},enableOnSubtree:function(e){this.watchSubtree(e),e===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(e)},installNewSubtree:function(e){T(this.findElements(e),this.addElement,this)},findElements:function(e){return e.querySelectorAll?e.querySelectorAll(S):[]},removeElement:function(e){this.removeCallback(e)},addElement:function(e){this.addCallback(e)},elementChanged:function(e,t){this.changedCallback(e,t)},concatLists:function(e,t){return e.concat(M(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(e){return e.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(e){var t=C(e,this.findElements,this);return t.push(L(e,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(e){e.forEach(this.mutationHandler,this)},mutationHandler:function(e){if("childList"===e.type){var t=this.flattenMutationTree(e.addedNodes);t.forEach(this.addElement,this);var n=this.flattenMutationTree(e.removedNodes);n.forEach(this.removeElement,this)}else"attributes"===e.type&&this.elementChanged(e.target,e.oldValue)}};var P=n,I=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],k="",A=window.PointerEvent||window.MSPointerEvent,x=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,D=_.pointermap,R=25,H=[1,4,2,8,16],j=!1;try{j=1===new MouseEvent("test",{buttons:1}).buttons}catch(F){}var q,Y={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(e){_.listen(e,this.events)},unregister:function(e){_.unlisten(e,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(e){for(var t,n=this.lastTouches,r=e.clientX,o=e.clientY,i=0,a=n.length;a>i&&(t=n[i]);i++){var s=Math.abs(r-t.x),c=Math.abs(o-t.y);if(R>=s&&R>=c)return!0}},prepareEvent:function(e){var t=_.cloneEvent(e),n=t.preventDefault;return t.preventDefault=function(){e.preventDefault(),n()},t.pointerId=this.POINTER_ID,t.isPrimary=!0,t.pointerType=this.POINTER_TYPE,t},prepareButtonsForMove:function(e,t){var n=D.get(this.POINTER_ID);e.buttons=n?n.buttons:0,t.buttons=e.buttons},mousedown:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=D.get(this.POINTER_ID),n=this.prepareEvent(e);j||(n.buttons=H[n.button],t&&(n.buttons|=t.buttons),e.buttons=n.buttons),D.set(this.POINTER_ID,e),t?_.move(n):_.down(n)}},mousemove:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);j||this.prepareButtonsForMove(t,e),_.move(t)}},mouseup:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=D.get(this.POINTER_ID),n=this.prepareEvent(e);if(!j){var r=H[n.button];n.buttons=t?t.buttons&~r:0,e.buttons=n.buttons}D.set(this.POINTER_ID,e),0===n.buttons||n.buttons===H[n.button]?(this.cleanupMouse(),_.up(n)):_.move(n)}},mouseover:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);j||this.prepareButtonsForMove(t,e),_.enterOver(t)}},mouseout:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);j||this.prepareButtonsForMove(t,e),_.leaveOut(t)}},cancel:function(e){var t=this.prepareEvent(e);_.cancel(t),this.cleanupMouse()},cleanupMouse:function(){D.delete(this.POINTER_ID)}},U=Y,X=_.captureInfo,B=E.findTarget.bind(E),z=E.allShadows.bind(E),W=_.pointermap,V=2500,K=200,G="touch-action",$=!1,Z={events:["touchstart","touchmove","touchend","touchcancel"],register:function(e){$?_.listen(e,this.events):q.enableOnSubtree(e)},unregister:function(e){$&&_.unlisten(e,this.events)},elementAdded:function(e){var t=e.getAttribute(G),n=this.touchActionToScrollType(t);n&&(e._scrollType=n,_.listen(e,this.events),z(e).forEach(function(e){e._scrollType=n,_.listen(e,this.events)},this))},elementRemoved:function(e){e._scrollType=void 0,_.unlisten(e,this.events),z(e).forEach(function(e){e._scrollType=void 0,_.unlisten(e,this.events)},this)},elementChanged:function(e,t){var n=e.getAttribute(G),r=this.touchActionToScrollType(n),o=this.touchActionToScrollType(t);r&&o?(e._scrollType=r,z(e).forEach(function(e){e._scrollType=r},this)):o?this.elementRemoved(e):r&&this.elementAdded(e)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(e){var t=e,n=this.scrollTypes;return"none"===t?"none":t===n.XSCROLLER?"X":t===n.YSCROLLER?"Y":n.SCROLLER.exec(t)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){(0===W.size||1===W.size&&W.has(1))&&(this.firstTouch=e.identifier,this.firstXY={X:e.clientX,Y:e.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(e){e.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var e=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(e,K)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(e){var t=0;return("touchstart"===e||"touchmove"===e)&&(t=1),t},touchToPointer:function(e){var t=this.currentTouchEvent,n=_.cloneEvent(e),r=n.pointerId=e.identifier+2;n.target=X[r]||B(n),n.bubbles=!0,n.cancelable=!0,n.detail=this.clickCount,n.button=0,n.buttons=this.typeToButtons(t.type),n.width=e.radiusX||e.webkitRadiusX||0,n.height=e.radiusY||e.webkitRadiusY||0,n.pressure=e.force||e.webkitForce||.5,n.isPrimary=this.isPrimaryTouch(e),n.pointerType=this.POINTER_TYPE;var o=this;return n.preventDefault=function(){o.scrolling=!1,o.firstXY=null,t.preventDefault()},n},processTouches:function(e,t){var n=e.changedTouches;this.currentTouchEvent=e;for(var r,o=0;n.length>o;o++)r=n[o],t.call(this,this.touchToPointer(r))},shouldScroll:function(e){if(this.firstXY){var t,n=e.currentTarget._scrollType;if("none"===n)t=!1;else if("XY"===n)t=!0;else{var r=e.changedTouches[0],o=n,i="Y"===n?"X":"Y",a=Math.abs(r["client"+o]-this.firstXY[o]),s=Math.abs(r["client"+i]-this.firstXY[i]);t=a>=s}return this.firstXY=null,t}},findTouch:function(e,t){for(var n,r=0,o=e.length;o>r&&(n=e[r]);r++)if(n.identifier===t)return!0},vacuumTouches:function(e){var t=e.touches;if(W.size>=t.length){var n=[];W.forEach(function(e,r){if(1!==r&&!this.findTouch(t,r-2)){var o=e.out;n.push(o)}},this),n.forEach(this.cancelOut,this)}},touchstart:function(e){this.vacuumTouches(e),this.setPrimaryTouch(e.changedTouches[0]),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(e,this.overDown))},overDown:function(e){W.set(e.pointerId,{target:e.target,out:e,outTarget:e.target}),_.over(e),_.enter(e),_.down(e)},touchmove:function(e){this.scrolling||(this.shouldScroll(e)?(this.scrolling=!0,this.touchcancel(e)):(e.preventDefault(),this.processTouches(e,this.moveOverOut)))},moveOverOut:function(e){var t=e,n=W.get(t.pointerId);if(n){var r=n.out,o=n.outTarget;_.move(t),r&&o!==t.target&&(r.relatedTarget=t.target,t.relatedTarget=o,r.target=o,t.target?(_.leaveOut(r),_.enterOver(t)):(t.target=o,t.relatedTarget=null,this.cancelOut(t))),n.out=t,n.outTarget=t.target}},touchend:function(e){this.dedupSynthMouse(e),this.processTouches(e,this.upOut)},upOut:function(e){this.scrolling||(_.up(e),_.out(e),_.leave(e)),this.cleanUpPointer(e)},touchcancel:function(e){this.processTouches(e,this.cancelOut)},cancelOut:function(e){_.cancel(e),_.out(e),_.leave(e),this.cleanUpPointer(e)},cleanUpPointer:function(e){W.delete(e.pointerId),this.removePrimaryPointer(e)},dedupSynthMouse:function(e){var t=U.lastTouches,n=e.changedTouches[0];if(this.isPrimaryTouch(n)){var r={x:n.clientX,y:n.clientY};t.push(r);var o=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}.bind(null,t,r);setTimeout(o,V)}}};$||(q=new P(Z.elementAdded,Z.elementRemoved,Z.elementChanged,Z));var J,Q,et=Z,tt=_.pointermap,nt=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,rt={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(e){_.listen(e,this.events)},unregister:function(e){_.unlisten(e,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(e){var t=e;return nt&&(t=_.cloneEvent(e),t.pointerType=this.POINTER_TYPES[e.pointerType]),t},cleanup:function(e){tt.delete(e)},MSPointerDown:function(e){tt.set(e.pointerId,e);var t=this.prepareEvent(e);_.down(t)},MSPointerMove:function(e){var t=this.prepareEvent(e);_.move(t)},MSPointerUp:function(e){var t=this.prepareEvent(e);_.up(t),this.cleanup(e.pointerId)},MSPointerOut:function(e){var t=this.prepareEvent(e);_.leaveOut(t)},MSPointerOver:function(e){var t=this.prepareEvent(e);_.enterOver(t)},MSPointerCancel:function(e){var t=this.prepareEvent(e);_.cancel(t),this.cleanup(e.pointerId)},MSLostPointerCapture:function(e){var t=_.makeEvent("lostpointercapture",e);_.dispatchEvent(t)},MSGotPointerCapture:function(e){var t=_.makeEvent("gotpointercapture",e);_.dispatchEvent(t)}},ot=rt,it=window.navigator;it.msPointerEnabled?(J=function(e){c(e),this.msSetPointerCapture(e)},Q=function(e){c(e),this.msReleasePointerCapture(e)}):(J=function(e){c(e),_.setCapture(e,this)},Q=function(e){c(e),_.releaseCapture(e,this)}),a(),s(),u();var at={dispatcher:_,Installer:P,PointerEvent:h,PointerMap:m,targetFinding:E};return at}),function(){function e(e){var t=D.call(e);return x[t]||(x[t]=t.match(R)[1].toLowerCase())}function t(n,r){var o=t[r||e(n)];return o?o(n):n}function n(t){return H[e(t)]?[t]:Array.prototype.slice.call(t,0)}function r(e,t){return(t||j).length?n(e.querySelectorAll(t)):[]}function o(e){e()}function i(n,r,o){var i=e(o);return"object"==i&&"object"==e(n[r])?X.merge(n[r],o):n[r]=t(o,i),n}function a(e,t,n){var r,o={};for(var i in t)o[i.split(":")[0]]=i;for(i in n)r=o[i.split(":")[0]],"function"==typeof t[r]?(r.match(":mixins")||(t[r+":mixins"]=t[r],delete t[r],r+=":mixins"),t[r].__mixin__=X.applyPseudos(i+(i.match(":mixins")?"":":mixins"),n[i],e.pseudos,t[r].__mixin__)):(t[i]=n[i],delete t[r])}function s(e,t,n){for(var r in n)t[r+":__mixin__("+F++ +")"]=X.applyPseudos(r,n[r],e.pseudos)}function c(e,t){for(var n=e.length;n--;)t.unshift(e[n]),X.mixins[e[n]].mixins&&c(X.mixins[e[n]].mixins,t);return t}function u(e){return c(e.mixins,[]).forEach(function(t){var n=X.mixins[t];for(var r in n){var o=n[r],i=e[r];if(i)switch(r){case"mixins":break;case"events":s(e,i,o);break;case"accessors":case"prototype":for(var c in o)i[c]?a(e,i[c],o[c],t):i[c]=o[c];break;default:a(e,i,o,t)}else e[r]=o}}),e}function l(e,t){for(var n,r=t.target,o=t.currentTarget;!n&&r&&r!=o;)r.tagName&&A.call(r,e.value)&&(n=r),r=r.parentNode;return!n&&o.tagName&&A.call(o,e.value)&&(n=o),n?e.listener=e.listener.bind(n):null}function d(e){return 0===e.button}function h(e,t,n,r){r?t[e]=n[e]:Object.defineProperty(t,e,{writable:!0,enumerable:!0,value:n[e]})}function p(e,t){var n=Object.getOwnPropertyDescriptor(e,"target");for(var r in t)q[r]||h(r,e,t,n);e.baseEvent=t}function f(e,t,n,r,o){_[o].call(e,n,t&&t.boolean?"":r)}function m(e,t,n,r,o){if(t&&(t.property||t.selector))for(var i=t.property?[e.xtag[t.property]]:t.selector?X.query(e,t.selector):[],a=i.length;a--;)i[a][o](n,r)}function v(e,t,n,r,o,i){var a=n.split(":"),s=a[0];"get"==s?(a[0]=t,e.prototype[t].get=X.applyPseudos(a.join(":"),r[n],e.pseudos,r[n])):"set"==s?(a[0]=t,e.prototype[t].set=X.applyPseudos(a.join(":"),o?function(e){var t,a="setAttribute";o.boolean?(e=!!e,t=this.hasAttribute(i),e||(a="removeAttribute")):(e=o.validate?o.validate.call(this,e):e,t=this.getAttribute(i)),f(this,o,i,e,a),r[n].call(this,e,t),m(this,o,i,e,a)}:r[n]?function(e){r[n].call(this,e)}:null,e.pseudos,r[n]),o&&(o.setter=r[n])):e.prototype[t][n]=r[n]}function b(e,t){e.prototype[t]={};var n,r=e.accessors[t],o=r.attribute;o&&(n=o.name=(o?o.name||t.replace(O,"$1-$2"):t).toLowerCase(),o.key=t,e.attributes[n]=o);for(var i in r)v(e,t,i,r,o,n);if(o){if(!e.prototype[t].get){var a=(o.boolean?"has":"get")+"Attribute";e.prototype[t].get=function(){return this[a](n)}}e.prototype[t].set||(e.prototype[t].set=function(e){e=o.boolean?!!e:o.validate?o.validate.call(this,e):e;var t=o.boolean?e?"setAttribute":"removeAttribute":"setAttribute";f(this,o,n,e,t),m(this,o,n,e,t)})}}function g(e){return"function"==typeof e?U.exec(""+e)[1]:e}var y=window,w=document,_={setAttribute:Element.prototype.setAttribute,removeAttribute:Element.prototype.removeAttribute},E=Element.prototype.createShadowRoot,T=w.createElement("div"),C=function(){},M=function(){return!0},L=/,/g,O=/([a-z])([A-Z])/g,S=/\(|\)/g,N=/:(\w+)\u276A(.+?(?=\u276B))|:(\w+)/g,P=/(\d+)/g,I={action:function(e,t){return e.value.match(P).indexOf(t.keyCode+"")>-1==("keypass"==e.name)||null}},k=function(){var e=Object.keys(window).join(),t=(e.match(/,(ms)/)||e.match(/,(moz)/)||e.match(/,(O)/)||[null,"webkit"])[1].toLowerCase();return{dom:"ms"==t?"MS":t,lowercase:t,css:"-"+t+"-",js:"ms"==t?t:t.charAt(0).toUpperCase()+t.substring(1)}}(),A=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype[k.lowercase+"MatchesSelector"],x={},D=x.toString,R=/\s([a-zA-Z]+)/;t.object=function(e){var n={};for(var r in e)n[r]=t(e[r]);return n},t.array=function(e){for(var n=e.length,r=Array(n);n--;)r[n]=t(e[n]);return r};var H={undefined:1,"null":1,number:1,"boolean":1,string:1,"function":1},j="",F=0,q={};for(var Y in w.createEvent("CustomEvent"))q[Y]=1;var U=/\/\*!?(?:\@preserve)?[ \t]*(?:\r\n|\n)([\s\S]*?)(?:\r\n|\n)\s*\*\//,X={tags:{},defaultOptions:{pseudos:[],mixins:[],events:{},methods:{},accessors:{},lifecycle:{},attributes:{},prototype:{xtag:{get:function(){return this.__xtag__?this.__xtag__:this.__xtag__={data:{}}}}}},register:function(e,t){var r;if("string"!=typeof e)throw"First argument must be a Custom Element string name";r=e.toLowerCase(),X.tags[r]=t||{};var o=t.prototype;delete t.prototype;var i=X.tags[r].compiled=u(X.merge({},X.defaultOptions,t)),a=i.prototype,s=i.lifecycle;for(var c in i.events)i.events[c]=X.parseEvent(c,i.events[c]);for(c in s)s[c.split(":")[0]]=X.applyPseudos(c,s[c],i.pseudos,s[c]);for(c in i.methods)a[c.split(":")[0]]={value:X.applyPseudos(c,i.methods[c],i.pseudos,i.methods[c]),enumerable:!0};for(c in i.accessors)b(i,c);i.shadow&&(i.shadow=i.shadow.nodeName?i.shadow:X.createFragment(i.shadow)),i.content&&(i.content=i.content.nodeName?i.content.innerHTML:g(i.content));var l=s.created,d=s.finalized;a.createdCallback={enumerable:!0,value:function(){var e=this;i.shadow&&E&&this.createShadowRoot().appendChild(i.shadow.cloneNode(!0)),i.content&&(this.appendChild(document.createElement("div")).outerHTML=i.content);var t=l?l.apply(this,arguments):null;X.addEvents(this,i.events);for(var n in i.attributes){var r=i.attributes[n],o=this.hasAttribute(n),a=void 0!==r.def;(o||r.boolean||a)&&(this[r.key]=r.boolean?o:!o&&a?r.def:this.getAttribute(n))}return i.pseudos.forEach(function(t){t.onAdd.call(e,t)}),this.xtagComponentReady=!0,d&&d.apply(this,arguments),t}};var h=s.inserted,p=s.removed;(h||p)&&(a.attachedCallback={value:function(){return p&&(this.xtag.__parentNode__=this.parentNode),h?h.apply(this,arguments):void 0},enumerable:!0}),p&&(a.detachedCallback={value:function(){var e=n(arguments);e.unshift(this.xtag.__parentNode__);var t=p.apply(this,e);return delete this.xtag.__parentNode__,t},enumerable:!0}),s.attributeChanged&&(a.attributeChangedCallback={value:s.attributeChanged,enumerable:!0}),a.setAttribute={writable:!0,enumerable:!0,value:function(e,t){var n,r=e.toLowerCase(),o=i.attributes[r];o&&(n=this.getAttribute(r),t=o.boolean?"":o.validate?o.validate.call(this,t):t),f(this,o,r,t,"setAttribute"),o&&(o.setter&&o.setter.call(this,o.boolean?!0:t,n),m(this,o,r,t,"setAttribute"))}},a.removeAttribute={writable:!0,enumerable:!0,value:function(e){var t=e.toLowerCase(),n=i.attributes[t],r=this.hasAttribute(t);f(this,n,t,"","removeAttribute"),n&&(n.setter&&n.setter.call(this,n.boolean?!1:void 0,r),m(this,n,t,"","removeAttribute"))}};var v={},_=o instanceof y.HTMLElement,T=i["extends"]&&(v["extends"]=i["extends"]);return o&&Object.getOwnPropertyNames(o).forEach(function(e){var t=a[e],n=_?Object.getOwnPropertyDescriptor(o,e):o[e];if(t)for(var r in n)t[r]="function"==typeof n[r]&&t[r]?X.wrap(n[r],t[r]):n[r];a[e]=t||n}),v.prototype=Object.create(T?Object.create(w.createElement(T).constructor).prototype:y.HTMLElement.prototype,a),w.registerElement(r,v)},mixins:{},prefix:k,captureEvents:{focus:1,blur:1,scroll:1,DOMMouseScroll:1},customEvents:{animationstart:{attach:[k.dom+"AnimationStart"]},animationend:{attach:[k.dom+"AnimationEnd"]},transitionend:{attach:[k.dom+"TransitionEnd"]},move:{attach:["pointermove"]},enter:{attach:["pointerenter"]},leave:{attach:["pointerleave"]},scrollwheel:{attach:["DOMMouseScroll","mousewheel"],condition:function(e){return e.delta=e.wheelDelta?e.wheelDelta/40:Math.round(-1*(e.detail/3.5)),!0}},tap:{attach:["pointerdown","pointerup"],condition:function(e,t){if("pointerdown"==e.type)t.startX=e.clientX,t.startY=e.clientY;else if(0===e.button&&10>Math.abs(t.startX-e.clientX)&&10>Math.abs(t.startY-e.clientY))return!0}},tapstart:{attach:["pointerdown"],condition:d},tapend:{attach:["pointerup"],condition:d},tapmove:{attach:["pointerdown"],condition:function(e,t){if("pointerdown"==e.type){var n=t.listener.bind(this);t.tapmoveListeners||(t.tapmoveListeners=X.addEvents(document,{pointermove:n,pointerup:n,pointercancel:n}))}else("pointerup"==e.type||"pointercancel"==e.type)&&(X.removeEvents(document,t.tapmoveListeners),t.tapmoveListeners=null);return!0}},taphold:{attach:["pointerdown","pointerup"],condition:function(e,t){if("pointerdown"==e.type)(t.pointers=t.pointers||{})[e.pointerId]=setTimeout(X.fireEvent.bind(null,this,"taphold"),t.duration||1e3);else{if("pointerup"!=e.type)return!0;t.pointers&&(clearTimeout(t.pointers[e.pointerId]),delete t.pointers[e.pointerId])}}}},pseudos:{__mixin__:{},mixins:{onCompiled:function(e,t){var n=t.source&&t.source.__mixin__||t.source;if(!n)return e;switch(t.value){case null:case"":case"before":return function(){return n.apply(this,arguments),e.apply(this,arguments)};case"after":return function(){var t=e.apply(this,arguments);return n.apply(this,arguments),t};case"none":return e}}},keypass:I,keyfail:I,delegate:{action:l},preventable:{action:function(e,t){return!t.defaultPrevented}},duration:{onAdd:function(e){e.source.duration=Number(e.value)}},capture:{onCompiled:function(e,t){t.source&&(t.source.capture=!0)}}},clone:t,typeOf:e,toArray:n,wrap:function(e,t){return function(){var n=e.apply(this,arguments);return t.apply(this,arguments),n}},merge:function(t,n,r){if("string"==e(n))return i(t,n,r);for(var o=1,a=arguments.length;a>o;o++){var s=arguments[o];for(var c in s)i(t,c,s[c])}return t},uid:function(){return Math.random().toString(36).substr(2,10)},query:r,skipTransition:function(e,t,n){var r=k.js+"TransitionProperty";e.style[r]=e.style.transitionProperty="none";var o=t?t.call(n||e):null;return X.skipFrame(function(){e.style[r]=e.style.transitionProperty="",o&&o.call(n||e)})},requestFrame:function(){var e=y.requestAnimationFrame||y[k.lowercase+"RequestAnimationFrame"]||function(e){return y.setTimeout(e,20)};return function(t){return e(t)}}(),cancelFrame:function(){var e=y.cancelAnimationFrame||y[k.lowercase+"CancelAnimationFrame"]||y.clearTimeout;return function(t){return e(t)}}(),skipFrame:function(e){var t=X.requestFrame(function(){t=X.requestFrame(e)});return t},matchSelector:function(e,t){return A.call(e,t)},set:function(e,t,n){e[t]=n,window.CustomElements&&CustomElements.upgradeAll(e)},innerHTML:function(e,t){X.set(e,"innerHTML",t)},hasClass:function(e,t){return e.className.split(" ").indexOf(t.trim())>-1},addClass:function(e,t){var n=e.className.trim().split(" ");return t.trim().split(" ").forEach(function(e){~n.indexOf(e)||n.push(e)}),e.className=n.join(" ").trim(),e},removeClass:function(e,t){var n=t.trim().split(" ");return e.className=e.className.trim().split(" ").filter(function(e){return e&&!~n.indexOf(e)}).join(" "),e},toggleClass:function(e,t){return X[X.hasClass(e,t)?"removeClass":"addClass"].call(null,e,t)},queryChildren:function(e,t){var r=e.id,o="#"+(e.id=r||"x_"+X.uid())+" > ",i=e.parentNode||!T.appendChild(e);t=o+(t+"").replace(L,","+o);var a=e.parentNode.querySelectorAll(t);return r||e.removeAttribute("id"),i||T.removeChild(e),n(a)},createFragment:function(e){var t=document.createElement("template");return e&&(e.nodeName?n(arguments).forEach(function(e){t.content.appendChild(e)}):t.innerHTML=g(e)),document.importNode(t.content,!0)},manipulate:function(e,t){var n=e.nextSibling,r=e.parentNode,o=t.call(e)||e;n?r.insertBefore(o,n):r.appendChild(o)},applyPseudos:function(e,t,r,i){var a=t,s={};if(e.match(":")){var c=[],u=0;e.replace(S,function(e){return"("==e?1==++u?"âª":"(":--u?")":"â«"}).replace(N,function(e,t,n,r){c.push([t||r,n])});for(var l=c.length;l--;)o(function(){var o=c[l][0],u=c[l][1];if(!X.pseudos[o])throw"pseudo not found: "+o+" "+u;u=""===u||u===void 0?null:u;var d=s[l]=Object.create(X.pseudos[o]);d.key=e,d.name=o,d.value=u,d.arguments=(u||"").split(","),d.action=d.action||M,d.source=i,d.onAdd=d.onAdd||C,d.onRemove=d.onRemove||C;var h=d.listener=a;a=function(){var e=d.action.apply(this,[d].concat(n(arguments)));return null===e||e===!1?e:(e=d.listener.apply(this,arguments),d.listener=h,e)},r?r.push(d):d.onAdd.call(t,d)})}for(var d in s)s[d].onCompiled&&(a=s[d].onCompiled(a,s[d])||a);return a},removePseudos:function(e,t){t.forEach(function(t){t.onRemove.call(e,t)})},parseEvent:function(e,t){var r=e.split(":"),o=r.shift(),i=X.customEvents[o],a=X.merge({type:o,stack:C,condition:M,capture:X.captureEvents[o],attach:[],_attach:[],pseudos:"",_pseudos:[],onAdd:C,onRemove:C},i||{});a.attach=n(a.base||a.attach),a.chain=o+(a.pseudos.length?":"+a.pseudos:"")+(r.length?":"+r.join(":"):"");var s=X.applyPseudos(a.chain,t,a._pseudos,a);return a.stack=function(e){e.currentTarget=e.currentTarget||this;var t=e.detail||{};return t.__stack__?t.__stack__==s?(e.stopPropagation(),e.cancelBubble=!0,s.apply(this,arguments)):void 0:s.apply(this,arguments)},a.listener=function(e){var t=n(arguments),r=a.condition.apply(this,t.concat([a]));return r?e.type!=o&&e.baseEvent&&e.type!=e.baseEvent.type?(X.fireEvent(e.target,o,{baseEvent:e,detail:r!==!0&&(r.__stack__=s)?r:{__stack__:s}}),void 0):a.stack.apply(this,t):r},a.attach.forEach(function(e){a._attach.push(X.parseEvent(e,a.listener))}),a},addEvent:function(e,t,n,r){var o="function"==typeof n?X.parseEvent(t,n):n;return o._pseudos.forEach(function(t){t.onAdd.call(e,t)}),o._attach.forEach(function(t){X.addEvent(e,t.type,t)}),o.onAdd.call(e,o,o.listener),e.addEventListener(o.type,o.stack,r||o.capture),o},addEvents:function(e,t){var n={};for(var r in t)n[r]=X.addEvent(e,r,t[r]);return n},removeEvent:function(e,t,n){n=n||t,n.onRemove.call(e,n,n.listener),X.removePseudos(e,n._pseudos),n._attach.forEach(function(t){X.removeEvent(e,t)}),e.removeEventListener(n.type,n.stack)},removeEvents:function(e,t){for(var n in t)X.removeEvent(e,t[n])},fireEvent:function(e,t,n){var r=w.createEvent("CustomEvent");n=n||{},r.initCustomEvent(t,n.bubbles!==!1,n.cancelable!==!1,n.detail),n.baseEvent&&p(r,n.baseEvent),e.dispatchEvent(r)}};y.xtag=X,w.addEventListener("WebComponentsReady",function(){X.fireEvent(w.body,"DOMComponentsLoaded")})}();;(function(){'use strict';/**
  * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
  *
  * @codingstandard ftlabs-jsv2
  * @copyright The Financial Times Limited [All Rights Reserved]
  * @license MIT License (see LICENSE.txt)
  */
/*jslint browser:true, node:true*/
/*global define, Event, Node*/
/**
  * Instantiate fast-clicking listeners on the specified layer.
  *
  * @constructor
  * @param {Element} layer The layer to listen on
  * @param {Object} [options={}] The options to override the defaults
  */
function FastClick(layer,options){var oldOnClick;options=options||{};/**
   * Whether a click is currently being tracked.
   *
   * @type boolean
   */
this.trackingClick=false;/**
   * Timestamp for when click tracking started.
   *
   * @type number
   */
this.trackingClickStart=0;/**
   * The element being tracked for a click.
   *
   * @type EventTarget
   */
this.targetElement=null;/**
   * X-coordinate of touch start event.
   *
   * @type number
   */
this.touchStartX=0;/**
   * Y-coordinate of touch start event.
   *
   * @type number
   */
this.touchStartY=0;/**
   * ID of the last touch, retrieved from Touch.identifier.
   *
   * @type number
   */
this.lastTouchIdentifier=0;/**
   * Touchmove boundary, beyond which a click will be cancelled.
   *
   * @type number
   */
this.touchBoundary=options.touchBoundary||10;/**
   * The FastClick layer.
   *
   * @type Element
   */
this.layer=layer;/**
   * The minimum time between tap(touchstart and touchend) events
   *
   * @type number
   */
this.tapDelay=options.tapDelay||200;/**
   * The maximum time for a tap
   *
   * @type number
   */
this.tapTimeout=options.tapTimeout||700;if(FastClick.notNeeded(layer)){return;}
function bind(method,context){return function(){return method.apply(context,arguments);};}
var methods=['onMouse','onClick','onTouchStart','onTouchMove','onTouchEnd','onTouchCancel'];var context=this;for(var i=0,l=methods.length;i<l;i++){context[methods[i]]=bind(context[methods[i]],context);}
if(deviceIsAndroid||deviceIsIOS){layer.addEventListener('mouseover',this.onMouse,true);layer.addEventListener('mousedown',this.onMouse,true);layer.addEventListener('mouseup',this.onMouse,true);}
layer.addEventListener('click',this.onClick,true);layer.addEventListener('touchstart',this.onTouchStart,false);layer.addEventListener('touchmove',this.onTouchMove,false);layer.addEventListener('touchend',this.onTouchEnd,false);layer.addEventListener('touchcancel',this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;if(type==='click'){rmv.call(layer,type,callback.hijacked||callback,capture);}else{rmv.call(layer,type,callback,capture);}};layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;if(type==='click'){adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){if(!event.propagationStopped){callback(event);}}),capture);}else{adv.call(layer,type,callback,capture);}};}
if(typeof layer.onclick==='function'){oldOnClick=layer.onclick;layer.addEventListener('click',function(event){oldOnClick(event);},false);layer.onclick=null;}}
/**
 * Windows Phone 8.1 fakes user agent string to look like Android and iPhone.
 *
 * @type boolean
 */
var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0;/**
  * Android requires exceptions.
  *
  * @type boolean
  */
var deviceIsAndroid=navigator.userAgent.indexOf('Android')>0&&!deviceIsWindowsPhone;/**
  * iOS requires exceptions.
  *
  * @type boolean
  */
var deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone;/**
  * iOS 4 requires an exception for select elements.
  *
  * @type boolean
  */
var deviceIsIOS4=deviceIsIOS&&(/OS 4_\d(_\d)?/).test(navigator.userAgent);/**
  * iOS 6.0-7.* requires the target element to be manually derived
  *
  * @type boolean
  */
var deviceIsIOSWithBadTarget=deviceIsIOS&&(/OS [6-7]_\d/).test(navigator.userAgent);/**
  * BlackBerry requires exceptions.
  *
  * @type boolean
  */
var deviceIsBlackBerry10=navigator.userAgent.indexOf('BB10')>0;/**
  * Determine whether a given element requires a native click.
  *
  * @param {EventTarget|Element} target Target DOM element
  * @returns {boolean} Returns true if the element needs a native click
  */
FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case'button':case'select':case'textarea':if(target.disabled){return true;}
break;case'input':if((deviceIsIOS&&target.type==='file')||target.disabled){return true;}
break;case'label':case'iframe':case'video':return true;}
var currentElement=target.parentNode;while(currentElement&&currentElement.parentNode&&currentElement.parentNode.nodeName!=='HTML'){if(currentElement.classList.contains('childrenneedsclick')){return true;}
currentElement=currentElement.parentNode;}
return(/\bneedsclick\b/).test(target.className);};/**
  * Determine whether a given element requires a call to focus to simulate click into element.
  *
  * @param {EventTarget|Element} target Target DOM element
  * @returns {boolean} Returns true if the element requires a call to focus to simulate native click.
  */
FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case'textarea':return true;case'select':return!deviceIsAndroid;case'input':switch(target.type){case'button':case'checkbox':case'file':case'image':case'radio':case'submit':return false;}
return!target.disabled&&!target.readOnly;default:return(/\bneedsfocus\b/).test(target.className);}};/**
  * Send a click event to the specified element.
  *
  * @param {EventTarget|Element} targetElement
  * @param {Event} event
  */
FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;if(document.activeElement&&document.activeElement!==targetElement){document.activeElement.blur();}
touch=event.changedTouches[0];clickEvent=document.createEvent('MouseEvents');clickEvent.initMouseEvent(this.determineEventType(targetElement),true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);clickEvent.forwardedTouchEvent=true;targetElement.dispatchEvent(clickEvent);};FastClick.prototype.determineEventType=function(targetElement){if(deviceIsAndroid&&targetElement.tagName.toLowerCase()==='select'){return'mousedown';}
return'click';};/**
  * @param {EventTarget|Element} targetElement
  */
FastClick.prototype.focus=function(targetElement){var length;if(deviceIsIOS&&targetElement.setSelectionRange&&targetElement.type.indexOf('date')!==0&&targetElement.type!=='time'&&targetElement.type!=='month'){length=targetElement.value.length;targetElement.setSelectionRange(length,length);}else{targetElement.focus();}};/**
  * Check whether the given target element is a child of a scrollable layer and if so, set a flag on it.
  *
  * @param {EventTarget|Element} targetElement
  */
FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;scrollParent=targetElement.fastClickScrollParent;if(!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement;targetElement.fastClickScrollParent=parentElement;break;}
parentElement=parentElement.parentElement;}while(parentElement);}
if(scrollParent){scrollParent.fastClickLastScrollTop=scrollParent.scrollTop;}};/**
  * @param {EventTarget} targetElement
  * @returns {Element|EventTarget}
  */
FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){if(eventTarget.nodeType===Node.TEXT_NODE){return eventTarget.parentNode;}
return eventTarget;};/**
  * On touch start, record the position and scroll offset.
  *
  * @param {Event} event
  * @returns {boolean}
  */
FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1){return true;}
targetElement=this.getTargetElementFromEventTarget(event.target);touch=event.targetTouches[0];if(deviceIsIOS){selection=window.getSelection();if(selection.rangeCount&&!selection.isCollapsed){return true;}
if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier){event.preventDefault();return false;}
this.lastTouchIdentifier=touch.identifier;this.updateScrollParent(targetElement);}}
this.trackingClick=true;this.trackingClickStart=event.timeStamp;this.targetElement=targetElement;this.touchStartX=touch.pageX;this.touchStartY=touch.pageY;if((event.timeStamp-this.lastClickTime)<this.tapDelay){event.preventDefault();}
return true;};/**
  * Based on a touchmove event object, check whether the touch has moved past a boundary since it started.
  *
  * @param {Event} event
  * @returns {boolean}
  */
FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;if(Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary){return true;}
return false;};/**
  * Update the last position.
  *
  * @param {Event} event
  * @returns {boolean}
  */
FastClick.prototype.onTouchMove=function(event){if(!this.trackingClick){return true;}
if(this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event)){this.trackingClick=false;this.targetElement=null;}
return true;};/**
  * Attempt to find the labelled control for the given label element.
  *
  * @param {EventTarget|HTMLLabelElement} labelElement
  * @returns {Element|null}
  */
FastClick.prototype.findControl=function(labelElement){if(labelElement.control!==undefined){return labelElement.control;}
if(labelElement.htmlFor){return document.getElementById(labelElement.htmlFor);}
return labelElement.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea');};/**
  * On touch end, determine whether to send a click event at once.
  *
  * @param {Event} event
  * @returns {boolean}
  */
FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick){return true;}
if((event.timeStamp-this.lastClickTime)<this.tapDelay){this.cancelNextClick=true;return true;}
if((event.timeStamp-this.trackingClickStart)>this.tapTimeout){return true;}
this.cancelNextClick=false;this.lastClickTime=event.timeStamp;trackingClickStart=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(deviceIsIOSWithBadTarget){touch=event.changedTouches[0];targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement;targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent;}
targetTagName=targetElement.tagName.toLowerCase();if(targetTagName==='label'){forElement=this.findControl(targetElement);if(forElement){this.focus(targetElement);if(deviceIsAndroid){return false;}
targetElement=forElement;}}else if(this.needsFocus(targetElement)){if((event.timeStamp-trackingClickStart)>100||(deviceIsIOS&&window.top!==window&&targetTagName==='input')){this.targetElement=null;return false;}
this.focus(targetElement);this.sendClick(targetElement,event);if(!deviceIsIOS||targetTagName!=='select'){this.targetElement=null;event.preventDefault();}
return false;}
if(deviceIsIOS&&!deviceIsIOS4){scrollParent=targetElement.fastClickScrollParent;if(scrollParent&&scrollParent.fastClickLastScrollTop!==scrollParent.scrollTop){return true;}}
if(!this.needsClick(targetElement)){event.preventDefault();this.sendClick(targetElement,event);}
return false;};/**
  * On touch cancel, stop tracking the click.
  *
  * @returns {void}
  */
FastClick.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null;};/**
  * Determine mouse events which should be permitted.
  *
  * @param {Event} event
  * @returns {boolean}
  */
FastClick.prototype.onMouse=function(event){if(!this.targetElement){return true;}
if(event.forwardedTouchEvent){return true;}
if(!event.cancelable){return true;}
if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(event.stopImmediatePropagation){event.stopImmediatePropagation();}else{event.propagationStopped=true;}
event.stopPropagation();event.preventDefault();return false;}
return true;};/**
  * On actual clicks, determine whether this is a touch-generated click, a click action occurring
  * naturally after a delay after a touch (which needs to be cancelled to avoid duplication), or
  * an actual click which should be permitted.
  *
  * @param {Event} event
  * @returns {boolean}
  */
FastClick.prototype.onClick=function(event){var permitted;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true;}
if(event.target.type==='submit'&&event.detail===0){return true;}
permitted=this.onMouse(event);if(!permitted){this.targetElement=null;}
return permitted;};/**
  * Remove all FastClick's event listeners.
  *
  * @returns {void}
  */
FastClick.prototype.destroy=function(){var layer=this.layer;if(deviceIsAndroid){layer.removeEventListener('mouseover',this.onMouse,true);layer.removeEventListener('mousedown',this.onMouse,true);layer.removeEventListener('mouseup',this.onMouse,true);}
layer.removeEventListener('click',this.onClick,true);layer.removeEventListener('touchstart',this.onTouchStart,false);layer.removeEventListener('touchmove',this.onTouchMove,false);layer.removeEventListener('touchend',this.onTouchEnd,false);layer.removeEventListener('touchcancel',this.onTouchCancel,false);};/**
  * Check whether FastClick is needed.
  *
  * @param {Element} layer The layer to listen on
  */
FastClick.notNeeded=function(layer){var metaViewport;var chromeVersion;var blackberryVersion;if(typeof window.ontouchstart==='undefined'){return true;}
chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(chromeVersion){if(deviceIsAndroid){metaViewport=document.querySelector('meta[name=viewport]');if(metaViewport){if(metaViewport.content.indexOf('user-scalable=no')!==-1){return true;}
if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth){return true;}}}else{return true;}}
if(deviceIsBlackBerry10){blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(blackberryVersion[1]>=10&&blackberryVersion[2]>=3){metaViewport=document.querySelector('meta[name=viewport]');if(metaViewport){if(metaViewport.content.indexOf('user-scalable=no')!==-1){return true;}
if(document.documentElement.scrollWidth<=window.outerWidth){return true;}}}}
if(layer.style.msTouchAction==='none'){return true;}
if(layer.style.touchAction==='none'){return true;}
return false;};/**
  * Factory method for creating a FastClick object
  *
  * @param {Element} layer The layer to listen on
  * @param {Object} [options={}] The options to override the defaults
  */
FastClick.attach=function(layer,options){return new FastClick(layer,options);};if(typeof define=='function'&&typeof define.amd=='object'&&define.amd){define(function(){return FastClick;});}else if(typeof module!=='undefined'&&module.exports){module.exports=FastClick.attach;module.exports.FastClick=FastClick;}
window.FastClick=FastClick;}());/*
    json_parse.js
    2012-06-20

    Public Domain.

    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.

    This file creates a json_parse function.

        json_parse(text, reviver)
            This method parses a JSON text to produce an object or array.
            It can throw a SyntaxError exception.

            The optional reviver parameter is a function that can filter and
            transform the results. It receives each of the keys and values,
            and its return value is used instead of the original value.
            If it returns what it received, then the structure is not modified.
            If it returns undefined then the member is deleted.

            Example:

            // Parse the text. Values that look like ISO date strings will
            // be converted to Date objects.

            myData = json_parse(text, function (key, value) {
                var a;
                if (typeof value === 'string') {
                    a =
/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
                    if (a) {
                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],
                            +a[5], +a[6]));
                    }
                }
                return value;
            });

    This is a reference implementation. You are free to copy, modify, or
    redistribute.

    This code should be minified before deployment.
    See http://javascript.crockford.com/jsmin.html

    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO
    NOT CONTROL.
*/
/*members "", "\"", "\/", "\\", at, b, call, charAt, f, fromCharCode,
    hasOwnProperty, message, n, name, prototype, push, r, t, text
*/
window.JSON=window.JSON||{};window.JSON.parse=(function(){"use strict";var at,ch,escapee={'"':'"','\\':'\\','/':'/',b:'\b',f:'\f',n:'\n',r:'\r',t:'\t'},text,error=function(m){throw{name:'SyntaxError',message:m,at:at,text:text};},next=function(c){if(c&&c!==ch){error("Expected '"+c+"' instead of '"+ch+"'");}
ch=text.charAt(at);at+=1;return ch;},number=function(){var number,string='';if(ch==='-'){string='-';next('-');}
while(ch>='0'&&ch<='9'){string+=ch;next();}
if(ch==='.'){string+='.';while(next()&&ch>='0'&&ch<='9'){string+=ch;}}
if(ch==='e'||ch==='E'){string+=ch;next();if(ch==='-'||ch==='+'){string+=ch;next();}
while(ch>='0'&&ch<='9'){string+=ch;next();}}
number=+string;if(!isFinite(number)){error("Bad number");}else{return number;}},string=function(){var hex,i,string='',uffff;if(ch==='"'){while(next()){if(ch==='"'){next();return string;}
if(ch==='\\'){next();if(ch==='u'){uffff=0;for(i=0;i<4;i+=1){hex=parseInt(next(),16);if(!isFinite(hex)){break;}
uffff=uffff*16+hex;}
string+=String.fromCharCode(uffff);}else if(typeof escapee[ch]==='string'){string+=escapee[ch];}else{break;}}else{string+=ch;}}}
error("Bad string");},white=function(){while(ch&&ch<=' '){next();}},word=function(){switch(ch){case't':next('t');next('r');next('u');next('e');return true;case'f':next('f');next('a');next('l');next('s');next('e');return false;case'n':next('n');next('u');next('l');next('l');return null;}
error("Unexpected '"+ch+"'");},value,array=function(){var array=[];if(ch==='['){next('[');white();if(ch===']'){next(']');return array;}
while(ch){array.push(value());white();if(ch===']'){next(']');return array;}
next(',');white();}}
error("Bad array");},object=function(){var key,object={};if(ch==='{'){next('{');white();if(ch==='}'){next('}');return object;}
while(ch){key=string();white();next(':');if(Object.hasOwnProperty.call(object,key)){error('Duplicate key "'+key+'"');}
object[key]=value();white();if(ch==='}'){next('}');return object;}
next(',');white();}}
error("Bad object");};value=function(){white();switch(ch){case'{':return object();case'[':return array();case'"':return string();case'-':return number();default:return ch>='0'&&ch<='9'?number():word();}};return function(source,reviver){var result;text=source;at=0;ch=' ';result=value();white();if(ch){error("Syntax error");}
return typeof reviver==='function'?(function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}({'':result},'')):result;};}());(function(){function p(b,a,d){return("string"===typeof a?a:a.toString()).replace(b.define||h,function(a,c,e,g){0===c.indexOf("def.")&&(c=c.substring(4));c in d||(":"===e?(b.defineParams&&g.replace(b.defineParams,function(a,b,l){d[c]={arg:b,text:l}}),c in d||(d[c]=g)):(new Function("def","def['"+c+"']="+g))(d));return""}).replace(b.use||h,function(a,c){b.useParams&&(c=c.replace(b.useParams,function(a,b,c,l){if(d[c]&&d[c].arg&&l)return a=(c+":"+l).replace(/'|\\/g,"_"),d.__exp=d.__exp||{},d.__exp[a]=d[c].text.replace(new RegExp("(^|[^\\w$])"+d[c].arg+"([^\\w$])","g"),"$1"+l+"$2"),b+"def.__exp['"+a+"']"}));var e=(new Function("def","return "+c))(d);return e?p(b,e,d):e})}function k(b){return b.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var f={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0},m;f.encodeHTMLSource=function(b){var a={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},d=b?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(b){return b?b.toString().replace(d,function(b){return a[b]||b}):b}};m=function(){return this||(0,eval)("this")}();"undefined"!==typeof module&&module.exports?module.exports=f:"function"===typeof define&&define.amd?define(function(){return f}):m.doT=f;var r={start:"'+(",end:")+'",startencode:"'+encodeHTML("},s={start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("},h=/$^/;f.template=function(b,a,d){a=a||f.templateSettings;var n=a.append?r:s,c,e=0,g;b=a.use||a.define?p(a,b,d||{}):b;b=("var out='"+(a.strip?b.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):b).replace(/'|\\/g,"\\$&").replace(a.interpolate||h,function(b,a){return n.start+k(a)+n.end}).replace(a.encode||h,function(b,a){c=!0;return n.startencode+k(a)+n.end}).replace(a.conditional||h,function(b,a,c){return a?c?"';}else if("+k(c)+"){out+='":"';}else{out+='":c?"';if("+k(c)+"){out+='":"';}out+='"}).replace(a.iterate||h,function(b,a,c,d){if(!a)return"';} } out+='";e+=1;g=d||"i"+e;a=k(a);return"';var arr"+
e+"="+a+";if(arr"+e+"){var "+c+","+g+"=-1,l"+e+"=arr"+e+".length-1;while("+g+"<l"+e+"){"+c+"=arr"+e+"["+g+"+=1];out+='"}).replace(a.evaluate||h,function(a,b){return"';"+k(b)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"");c&&(a.selfcontained||!m||m._encodeHTML||(m._encodeHTML=f.encodeHTMLSource(a.doNotSkipEncoded)),b="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+f.encodeHTMLSource.toString()+"("+(a.doNotSkipEncoded||"")+"));"+b);try{return new Function(a.varname,b)}catch(q){throw"undefined"!==typeof console&&console.log("Could not create a template function: "+b),q;}};f.compile=function(b,a){return f.template(b,null,a)}
if(!window.doT){window.doT=f;}})();doT.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:}}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:'jo',strip:false,append:true,selfcontained:false};function encodeHTML(text){'use strict';var encode={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"};return text?text.toString().replace(/&|<|>|"|'|\//g,function(letter){return encode[letter]||letter;}):text;}
function decodeHTML(text){'use strict';var decode={"&#38;":"&","&amp;":"&","&#60;":"<","&#62;":">","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'","&#47;":"/"};return text?text.toString().replace(/&#38;|&amp;|&#60;|&#62;|&lt;|&gt;|&#34;|&#39;|&#47;/g,function(letter){return decode[letter]||letter;}):text;}
function ml(func){'use strict';func=func.toString();return func.substring(func.indexOf('/*')+2,func.indexOf('*/'));}
if(window.evt===undefined){window.evt={};}
function touchDeviceTest(){'use strict';return(('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch)||false;}
function getDeviceType(){'use strict';if(evt.touchDevice===false){return'desktop';}
if(evt.touchDevice===true&&screen.width>500){return'tablet';}
return'phone';}
/*DOC
Name:
    evt.*

Description:
    This is a collection of global variables that are used for browser-type detection and for using different events for different devices.
    The reason for this is because even though the 'mousedown' event works on a phone it is substantially slower than if you had used 'touchstart',
    But if you used 'touchstart' it wouldn't work on the computer so we wrap both under the name evt.mousedown and only give mobile browsers
    'touchstart' and desktop browsers 'mousedown' so that you dont have to differentiate.
    
List of variables:
    evt.touchDevice  equals true|false depending on whether or not we are on a touch-enabled devide
    evt.deviceType   equals 'desktop'|'tablet'|'phone' depending on what type of device you are on
    
    evt.mousedown    if we are on a touch device: 'touchstart'  else  'mousedown'
    evt.mouseover    if we are on a touch device: 'touchenter'  else  'mouseover'
    evt.mousemove    if we are on a touch device: 'touchmove'   else  'mousemove'
    evt.mouseout     if we are on a touch device: 'touchleave'  else  'mouseout'
    evt.mouseup      if we are on a touch device: 'touchend'    else  'mouseup'
    evt.click        if we are on a touch device: 'touchend'    else  'click'

*/
evt.touchDevice=touchDeviceTest();evt.deviceType=getDeviceType();evt.mousedown=evt.touchDevice?'touchstart':'mousedown';evt.mouseover=evt.touchDevice?'touchenter':'mouseover';evt.mousemove=evt.touchDevice?'touchmove':'mousemove';evt.mouseout=evt.touchDevice?'touchleave':'mouseout';evt.mouseup=evt.touchDevice?'touchend':'mouseup';evt.click='click';/*
//DO NOT UNCOMMENT
//To use:
//Add this javascript to the test.sh file
//Append to greyspots.js after the rsync of the web_root files
window.addEventListener('load', function () {
    var styleElement, helperElement, helperFunction;
    
    styleElement = document.createElement('style');
    styleElement.innerHTML = 'body, body gs-panel, body gs-panel gs-header, body gs-panel gs-body, ' +
                             'body gs-page, body gs-page gs-header, body gs-page gs-body {\n' +
                             '    background-color: #FFBBBB;\n' +
                             '}';
    
    document.head.appendChild(styleElement);
});
*/
if(window.GS===undefined){window.GS={};GS.version=function(){'use strict';return'1.1.1';};window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.version','GS.version','GS.version();');});}
if(window.shimmed===undefined){window.shimmed={};}
if(window.functionality===undefined){window.functionality={"errors":{}};}
if(typeof console==='undefined'||!console.log){window.console={log:function(){'use strict';},info:function(){'use strict';},debug:function(){'use strict';},warn:function(){'use strict';},trace:function(){'use strict';},error:function(){'use strict';}};}
/*
if (evt.touchDevice) {
    (function () {
        var startTime, startTouchTop, endTime, endTouchTop, lastTouchTop, currentTouchTop,
            bolCurrentlyMonitoring = false, bolTouchScrollPrevented = false, currentScrollingElement, scrollingLooper;
        
        window.ontouchstart = function(event){
            lastTouchTop = GS.mousePosition(event).top;
        };
        
        //window.addEventListener('scroll', function (event) {
        //    console.log(event);
        //}, true);
        
        window.ontouchmove = function (event) {
            var currentTouchTop = GS.mousePosition(event).top, currentElement = GS.scrollParent(event.target), bolFoundScrollable = Boolean(currentElement);
            
            //console.log(currentElement,
            //            event.target,
            //            bolFoundScrollable,
            //            currentElement.scrollTop,
            //            currentElement.clientHeight,
            //            currentElement.scrollHeight,
            //            currentTouchTop,
            //            lastTouchTop);
            //console.log(currentElement.scrollTop <= 0,
            //            currentTouchTop > lastTouchTop,
            //            currentElement.scrollTop + currentElement.clientHeight >= currentElement.scrollHeight,
            //            currentTouchTop < lastTouchTop);
            
            if (bolFoundScrollable === false ||
                (currentElement.scrollTop <= 0 && currentTouchTop > lastTouchTop) ||
                (currentElement.scrollTop + currentElement.clientHeight >= currentElement.scrollHeight && currentTouchTop < lastTouchTop)) {
                
                //console.log('prevent default');
                
                bolTouchScrollPrevented = true;
                event.preventDefault();
                //event.stopPropagation();
                
            } else if (bolFoundScrollable === true && bolTouchScrollPrevented === true) {
                currentElement.scrollTop += (lastTouchTop - currentTouchTop);
            }
            
            currentScrollingElement = currentElement;
            lastTouchTop = currentTouchTop;
        };
        
        window.ontouchend = function () {
            bolTouchScrollPrevented = false;
        };
    })();
}*/
GS.database={"engine":"","type":{}};GS.database.engine="postgres";(function(){"use strict";function getCookie(c_name){var c_value=document.cookie,c_end,c_start=c_value.indexOf(" "+c_name+"=");if(c_start===-1){c_start=c_value.indexOf(c_name+"=");}
if(c_start===-1){c_value=null;}else{c_start=c_value.indexOf("=",c_start)+1;c_end=c_value.indexOf(";",c_start);if(c_end===-1){c_end=c_value.length;}
c_value=decodeURIComponent(c_value.substring(c_start,c_end));}
return c_value;};if((getCookie('DB')||'PG').toUpperCase()==='PG'){GS.database.engine='postgres';}else{GS.database.engine='mssqlserver'}
if(GS.database.engine==="postgres"){GS.database.type.text="text";GS.database.type.timestamp="timestamptz";}else if(GS.database.engine==="mssqlserver"){GS.database.type.text="nvarchar(MAX)";GS.database.type.timestamp="datetime";}}());window.addEventListener('click',function(event){'use strict';var labelElement,targetElement;if(event.target.nodeName==='LABEL'){labelElement=event.target;}else if(GS.findParentTag(event.target,'LABEL')){labelElement=GS.findParentTag(event.target,'LABEL');}
if(labelElement&&labelElement.hasAttribute('for')){targetElement=document.getElementById(labelElement.getAttribute('for'));if(targetElement&&targetElement.focus&&!targetElement.hasAttribute('disabled')){targetElement.focus();}}});(function(){function aboutDialog(){'use strict';var templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
            <gs-page>
                <gs-header><center><h3>About Envelope</h3></center></gs-header>
                <gs-body padded>
                    <gs-grid widths="1,1" reflow-at="767px">
                        <gs-block>
                            <center><h3><a target="_blank" href="http://x-tag.github.io/">X-Tag</a></h3></center>
                        </gs-block>
                        <gs-block>
                            <center><h4>Version Unknown</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center><h3><a target="_blank" href="http://olado.github.io/doT/">doT.js</a></h3></center>
                        </gs-block>
                        <gs-block>
                            <center><h4>{{DOT}}</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center><h3><a target="_blank" href="http://ace.c9.io/">Ace Editor</a></h3></center>
                        </gs-block>
                        <gs-block>
                            <center><h4>1.2.3</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center><h3><a target="_blank" href="http://jsbeautifier.org/">JSBeautifier</a></h3></center>
                        </gs-block>
                        <gs-block>
                            <center><h4>Version Unknown</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center>
                                <h3><a target="_blank" href="https://github.com/douglascrockford/JSON-js">
                                    json_parse.js (modified)
                                </a></h3>
                            </center>
                        </gs-block>
                        <gs-block>
                            <center><h4>Version Unknown</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center>
                                <h3><a target="_blank" href="https://www.polymer-project.org/1.0/">
                                    HTML Template Polyfill (modified)
                                </a></h3>
                            </center>
                        </gs-block>
                        <gs-block>
                            <center><h4>Version Unknown</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center>
                                <h3><a target="_blank" href="https://github.com/ftlabs/fastclick">FastClick</a></h3>
                            </center>
                        </gs-block>
                        <gs-block>
                            <center><h4>Version Unknown</h4></center>
                        </gs-block>
                        <br />
                        <gs-block>
                            <center>
                                <h3><a target="_blank" href="https://code.google.com/archive/p/crypto-js/">CryptoJS (MD5 Portion)</a></h3>
                            </center>
                        </gs-block>
                        <gs-block>
                            <center><h4>3.1.2</h4></center>
                        </gs-block>
                        
                    </gs-grid>
                    
                    <div>
                        All other source code and documentation copyright Workflow Products, LLC. All Rights Reserved.
                        <br /><br />
                        The Envelope platform is available for many platforms and most embedded devices. If you'd like your application built using Envelope technology please contact us.
                        <br /><br />
                        Commercial license terms for the Envelope platform are available for a small fee. Contact us for details.
                        <br /><br />
                        <center><b>Workflow Products, L.L.C.</b></center>
                        <center>7813 Harwood Road</center>
                        <center>North Richland Hills Texas 76180</center>
                        <center>(817) 503-9545</center>
                    </div>
                    <br />
                    <center><small><i>Copyright &copy; 2016-present by Workflow Products, L.L.C. (817) 503-9545</i></small></center>
                </gs-body>
                <gs-footer>
                    <gs-button dialogclose>Done</gs-button>
                </gs-footer>
            </gs-page>
        */}).replace(/\{\{DOT\}\}/gi,doT.version);GS.openDialog(templateElement);}
window.addEventListener('load',function(){'use strict';var bolOpen,intMaxHeight,curlElement,menuElement,strPostageUName,strHTML,toggleCurl;if(window.bolCurl!==false){bolOpen=false;intMaxHeight=0;curlElement=document.createElement('div');menuElement=document.createElement('div');strPostageUName=GS.getCookie('postage_uname');strHTML='';curlElement.setAttribute('id','gs-document-curl-container');curlElement.innerHTML='<div id="gs-document-curl-part-1"></div>'+'<div id="gs-document-curl-part-2"></div>'+'<div id="gs-document-curl-part-3"></div>'+'<div id="gs-document-curl-part-4"></div>';document.body.appendChild(curlElement);if(evt.deviceType==='phone'){curlElement.setAttribute('style','font-size: 1.3em;');}else{curlElement.setAttribute('style','font-size: 0.7em;');}
menuElement.setAttribute('id','gs-document-menu-container');menuElement.setAttribute('style','height: 0px;');if(location.pathname.indexOf('/env/')===0){strHTML+='<center><b><a target="_self" href="/env/app/all/index.html">Back To Main Menu</a></b></center>';strHTML+='<center>'+'<gs-button target="_self" href="/env/auth/?action=logout" inline>Log out</gs-button><br />'+'<gs-button onclick="GS.userChangePassword()" inline>Change Password</gs-button>'+'</center>';intMaxHeight+=4.8;}else{strHTML+='<center>'+'<gs-button target="_self" href="/postage/auth?action=logout" inline>Log out</gs-button><br />'+'<gs-button onclick="GS.userChangePassword()" inline>Change Password</gs-button>'+'</center>';intMaxHeight+=3.4;}
strHTML+='<center><gs-button onclick="GS.showShimmed()" inline>Browser Support</gs-button></center>';intMaxHeight+=1.9;strHTML+='<center><gs-button onclick="window.location.reload(true);" inline>Update Software</gs-button></center>';intMaxHeight+=1.9;if(location.pathname.indexOf('/env/')===0){strHTML+='<center><gs-button id="gs-button-about" inline>About</gs-button></center>';intMaxHeight+=1.9;}
intMaxHeight+=1;menuElement.innerHTML='<div id="gs-document-menu-link-container" style="height: '+intMaxHeight+'em;">'+strHTML+'</div>';document.body.appendChild(menuElement);if(location.pathname.indexOf('/env/')===0){document.getElementById('gs-button-about').addEventListener('click',aboutDialog);}
toggleCurl=function(){var intFontSize=GS.pxToEm(document.body,window.innerWidth)/4,intBottomLine=window.innerHeight-(GS.emToPx(document.body,intFontSize)),closedSize=(evt.deviceType==='phone'?'1.3em':'0.7em');if(GS.pxToEm(document.body,intBottomLine)>intMaxHeight){intBottomLine=GS.emToPx(document.body,intMaxHeight);}
if(bolOpen===false){document.body.insertBefore(GS.stringToElement('<div id="gs-document-curl-modal-background"></div>'),curlElement);document.getElementById('gs-document-curl-modal-background').addEventListener('click',toggleCurl);curlElement.style.fontSize=intFontSize+'em';curlElement.style.bottom=intBottomLine+'px';menuElement.style.height=intBottomLine+'px';bolOpen=true;}else{document.body.removeChild(document.getElementById('gs-document-curl-modal-background'));curlElement.style.fontSize=closedSize;curlElement.style.bottom='0px';menuElement.style.height='0px';bolOpen=false;}};curlElement.addEventListener('click',toggleCurl);}});})();if('addEventListener'in document){document.addEventListener('DOMContentLoaded',function(){'use strict';FastClick.attach(document.body);},false);}
/*
HTMLTemplateElement.prototype.contentTemplate = function () {
    'use strict';
    
    if (this.content) {
        
    } else {
        
    }
};
*/
window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.showShimmed','GS.showShimmed','GS.showShimmed();');});window.addEventListener('load',function(){'use strict';function cleanFunctionForTest(fn){fn=fn.toString().toLowerCase();fn=fn.substring(fn.indexOf('{'));fn=fn.replace(/ /gim,'');return fn;}
function nativeTest(fn){if(!fn){return false;}
fn=cleanFunctionForTest(fn);return fn.indexOf('[nativecode]')>-1||fn===cleanFunctionForTest(document.createElement);}
shimmed.matchesSelector=!nativeTest(Element.prototype.matchesSelector)&&!nativeTest(Element.prototype.webkitMatchesSelector)&&!nativeTest(Element.prototype.mozMatchesSelector)&&!nativeTest(Element.prototype.msMatchesSelector)&&!nativeTest(Element.prototype.MSMatchesSelector);shimmed.MutationObserver=!nativeTest(window.MutationObserver);shimmed.WeakMap=!nativeTest(window.WeakMap);shimmed.registerElement=!nativeTest(document.registerElement);shimmed.DOMTokenList=!nativeTest(window.DOMTokenList);shimmed.HTMLTemplateElement=Boolean(HTMLTemplateElement.bootstrap);functionality.matchesSelector=false;try{var bodyElement=document.body,matchesSelector=(Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.MSMatchesSelector);functionality.matchesSelector=matchesSelector.apply(bodyElement,['body']);}catch(e){functionality.matchesSelector=false;functionality.errors.matchesSelector=e;}
functionality.MutationObserver=false;try{var testElement=document.createElement('div'),observer;observer=new MutationObserver(function(mutations){functionality.MutationObserver=(mutations.length>0);});observer.observe(testElement,{'childList':true});testElement.appendChild(document.createElement('div'));}catch(e){functionality.MutationObserver=false;functionality.errors.MutationObserver=e;}
functionality.WeakMap=false;try{var testMap=new WeakMap(),testObject=function(){};testMap.set(testObject,'asdfasdf');functionality.WeakMap=(testMap.get(testObject)==='asdfasdf');functionality.WeakMap=(functionality.WeakMap&&testMap.has(testObject)===true);testMap.delete(testObject);functionality.WeakMap=(functionality.WeakMap&&testMap.has(testObject)===false);}catch(e){functionality.WeakMap=false;functionality.errors.WeakMap=e;}
functionality.registerElement=false;try{var prototype=Object.create(HTMLElement.prototype);prototype.testmethod=function(){return true;};document.registerElement('asdf-test',{'prototype':prototype});var testElement;testElement=document.createElement('asdf-test');functionality.registerElement=testElement.testmethod();}catch(e){functionality.registerElement=false;functionality.errors.registerElement=e;}
functionality.DOMTokenList=false;try{functionality.DOMTokenList=Boolean(document.body.classList);}catch(e){functionality.DOMTokenList=false;functionality.errors.DOMTokenList=e;}
functionality.HTMLTemplateElement=false;try{var testElement=document.createElement('template');xtag.register('asdf-test-two',{'lifecycle':{'created':function(){var divElement=document.createElement('div');divElement.classList.add('find-me');this.appendChild(divElement);}}});testElement.innerHTML='<div></div><p></p><asdf-test-two></asdf-test-two>';functionality.HTMLTemplateElement=(xtag.query(testElement,'.find-me').length===0);}catch(e){functionality.HTMLTemplateElement=false;functionality.errors.HTMLTemplateElement=e;}
GS.showShimmed=function(){var strHTML='',key,templateElement;strHTML+='<br />\n'+'<center>This dialog is for developers so that they can determine what technologies this browser supports and what technologies are being implemented manually.</center>\n'+'<br />\n'+'<hr />\n';for(key in shimmed){strHTML+='<gs-grid reflow-at="450px">\n'+'    <gs-block><center>'+encodeHTML(key)+'</center></gs-block>\n'+'    <gs-block>\n'+'        <center><b>'+(shimmed[key]?'SHIMMED':'NATIVE')+'</center></b>\n'+'    </gs-block>\n'+'    <gs-block>\n'+'        <center>'+(functionality[key]?'<b style="color: #3F9A3F;">FUNCTION PASS':'<b style="color: #F00;">FUNCTION FAIL')+'</center></b>\n'+'    </gs-block>\n'+'</gs-grid>\n'+'<hr />\n';}
strHTML+='<br />';templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
            <gs-page>
                <gs-header><center><h3>Native Detection</h3></center></gs-header>
                <gs-body padded>
                    {{HTML}}
                </gs-body>
                <gs-footer><gs-button dialogclose>Done</gs-button></gs-footer>
            </gs-page>
        */}).replace('{{HTML}}',strHTML);GS.openDialog(templateElement);};});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.addUnloadEvent','GS.addUnloadEvent','GS.addUnloadEvent(function () {'+'    $0'+'});');});(function(){'use strict';var arrFunctions=[],unloadFunction=function(){var i,len,ret,current;for(i=0,len=arrFunctions.length;i<len;i+=1){current=arrFunctions[i]();if(current&&!ret){ret=current;}}
if(ret){return ret;}};window.addEventListener('load',function(){if(window.onbeforeunload&&window.onbeforeunload!==unloadFunction){console.error('Please use the GS.addUnloadEvent function to run code onbeforeunload.');}});GS.addBeforeUnloadEvent=function(functionToCall){if(typeof functionToCall!=='function'){throw new TypeError('GS.addUnloadEvent takes one argument, and it must be a function.');}
if(!window.onbeforeunload){window.onbeforeunload=unloadFunction;}else if(window.onbeforeunload!==unloadFunction){console.error('Please use just the GS.addBeforeUnloadEvent function to run code onbeforeunload.');window.onbeforeunload=unloadFunction;}
arrFunctions.push(functionToCall);};})();/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
var CryptoJS=CryptoJS||function(h,r){var k={},l=k.lib={},n=function(){},f=l.Base={extend:function(a){n.prototype=this;var b=new n;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},j=l.WordArray=f.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=r?b:4*a.length},toString:function(a){return(a||s).stringify(this)},concat:function(a){var b=this.words,d=a.words,c=this.sigBytes;a=a.sigBytes;this.clamp();if(c%4)for(var e=0;e<a;e++)b[c+e>>>2]|=(d[e>>>2]>>>24-8*(e%4)&255)<<24-8*((c+e)%4);else if(65535<d.length)for(e=0;e<a;e+=4)b[c+e>>>2]=d[e>>>2];else b.push.apply(b,d);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-8*(b%4);a.length=h.ceil(b/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],d=0;d<a;d+=4)b.push(4294967296*h.random()|0);return new j.init(b,a)}}),m=k.enc={},s=m.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var d=[],c=0;c<a;c++){var e=b[c>>>2]>>>24-8*(c%4)&255;d.push((e>>>4).toString(16));d.push((e&15).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,d=[],c=0;c<b;c+=2)d[c>>>3]|=parseInt(a.substr(c,2),16)<<24-4*(c%8);return new j.init(d,b/2)}},p=m.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var d=[],c=0;c<a;c++)d.push(String.fromCharCode(b[c>>>2]>>>24-8*(c%4)&255));return d.join("")},parse:function(a){for(var b=a.length,d=[],c=0;c<b;c++)d[c>>>2]|=(a.charCodeAt(c)&255)<<24-8*(c%4);return new j.init(d,b)}},t=m.Utf8={stringify:function(a){try{return decodeURIComponent(escape(p.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return p.parse(unescape(encodeURIComponent(a)))}},q=l.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new j.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=t.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,d=b.words,c=b.sigBytes,e=this.blockSize,f=c/(4*e),f=a?h.ceil(f):h.max((f|0)-this._minBufferSize,0);a=f*e;c=h.min(4*a,c);if(a){for(var g=0;g<a;g+=e)this._doProcessBlock(d,g);g=d.splice(0,a);b.sigBytes-=c}return new j.init(g,c)},clone:function(){var a=f.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});l.Hasher=q.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,d){return(new a.init(d)).finalize(b)}},_createHmacHelper:function(a){return function(b,d){return(new u.HMAC.init(a,d)).finalize(b)}}});var u=k.algo={};return k}(Math);/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(E){function h(a,f,g,j,p,h,k){a=a+(f&g|~f&j)+p+k;return(a<<h|a>>>32-h)+f}function k(a,f,g,j,p,h,k){a=a+(f&j|g&~j)+p+k;return(a<<h|a>>>32-h)+f}function l(a,f,g,j,h,k,l){a=a+(f^g^j)+h+l;return(a<<k|a>>>32-k)+f}function n(a,f,g,j,h,k,l){a=a+(g^(f|~j))+h+l;return(a<<k|a>>>32-k)+f}for(var r=CryptoJS,q=r.lib,F=q.WordArray,s=q.Hasher,q=r.algo,a=[],t=0;64>t;t++)a[t]=4294967296*E.abs(E.sin(t+1))|0;q=q.MD5=s.extend({_doReset:function(){this._hash=new F.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(m,f){for(var g=0;16>g;g++){var j=f+g,p=m[j];m[j]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360}var g=this._hash.words,j=m[f+0],p=m[f+1],q=m[f+2],r=m[f+3],s=m[f+4],t=m[f+5],u=m[f+6],v=m[f+7],w=m[f+8],x=m[f+9],y=m[f+10],z=m[f+11],A=m[f+12],B=m[f+13],C=m[f+14],D=m[f+15],b=g[0],c=g[1],d=g[2],e=g[3],b=h(b,c,d,e,j,7,a[0]),e=h(e,b,c,d,p,12,a[1]),d=h(d,e,b,c,q,17,a[2]),c=h(c,d,e,b,r,22,a[3]),b=h(b,c,d,e,s,7,a[4]),e=h(e,b,c,d,t,12,a[5]),d=h(d,e,b,c,u,17,a[6]),c=h(c,d,e,b,v,22,a[7]),b=h(b,c,d,e,w,7,a[8]),e=h(e,b,c,d,x,12,a[9]),d=h(d,e,b,c,y,17,a[10]),c=h(c,d,e,b,z,22,a[11]),b=h(b,c,d,e,A,7,a[12]),e=h(e,b,c,d,B,12,a[13]),d=h(d,e,b,c,C,17,a[14]),c=h(c,d,e,b,D,22,a[15]),b=k(b,c,d,e,p,5,a[16]),e=k(e,b,c,d,u,9,a[17]),d=k(d,e,b,c,z,14,a[18]),c=k(c,d,e,b,j,20,a[19]),b=k(b,c,d,e,t,5,a[20]),e=k(e,b,c,d,y,9,a[21]),d=k(d,e,b,c,D,14,a[22]),c=k(c,d,e,b,s,20,a[23]),b=k(b,c,d,e,x,5,a[24]),e=k(e,b,c,d,C,9,a[25]),d=k(d,e,b,c,r,14,a[26]),c=k(c,d,e,b,w,20,a[27]),b=k(b,c,d,e,B,5,a[28]),e=k(e,b,c,d,q,9,a[29]),d=k(d,e,b,c,v,14,a[30]),c=k(c,d,e,b,A,20,a[31]),b=l(b,c,d,e,t,4,a[32]),e=l(e,b,c,d,w,11,a[33]),d=l(d,e,b,c,z,16,a[34]),c=l(c,d,e,b,C,23,a[35]),b=l(b,c,d,e,p,4,a[36]),e=l(e,b,c,d,s,11,a[37]),d=l(d,e,b,c,v,16,a[38]),c=l(c,d,e,b,y,23,a[39]),b=l(b,c,d,e,B,4,a[40]),e=l(e,b,c,d,j,11,a[41]),d=l(d,e,b,c,r,16,a[42]),c=l(c,d,e,b,u,23,a[43]),b=l(b,c,d,e,x,4,a[44]),e=l(e,b,c,d,A,11,a[45]),d=l(d,e,b,c,D,16,a[46]),c=l(c,d,e,b,q,23,a[47]),b=n(b,c,d,e,j,6,a[48]),e=n(e,b,c,d,v,10,a[49]),d=n(d,e,b,c,C,15,a[50]),c=n(c,d,e,b,t,21,a[51]),b=n(b,c,d,e,A,6,a[52]),e=n(e,b,c,d,r,10,a[53]),d=n(d,e,b,c,y,15,a[54]),c=n(c,d,e,b,p,21,a[55]),b=n(b,c,d,e,w,6,a[56]),e=n(e,b,c,d,D,10,a[57]),d=n(d,e,b,c,u,15,a[58]),c=n(c,d,e,b,B,21,a[59]),b=n(b,c,d,e,s,6,a[60]),e=n(e,b,c,d,z,10,a[61]),d=n(d,e,b,c,q,15,a[62]),c=n(c,d,e,b,x,21,a[63]);g[0]=g[0]+b|0;g[1]=g[1]+c|0;g[2]=g[2]+d|0;g[3]=g[3]+e|0},_doFinalize:function(){var a=this._data,f=a.words,g=8*this._nDataBytes,j=8*a.sigBytes;f[j>>>5]|=128<<24-j%32;var h=E.floor(g/4294967296);f[(j+64>>>9<<4)+15]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360;f[(j+64>>>9<<4)+14]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360;a.sigBytes=4*(f.length+1);this._process();a=this._hash;f=a.words;for(g=0;4>g;g++)j=f[g],f[g]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360;return a},clone:function(){var a=s.clone.call(this);a._hash=this._hash.clone();return a}});r.MD5=s._createHelper(q);r.HmacMD5=s._createHmacHelper(q)})(Math);/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){if("function"==typeof ArrayBuffer){var b=CryptoJS.lib.WordArray,e=b.init;(b.init=function(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));if(a instanceof Int8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);if(a instanceof Uint8Array){for(var b=a.byteLength,d=[],c=0;c<b;c++)d[c>>>2]|=a[c]<<24-8*(c%4);e.call(this,d,b)}else e.apply(this,arguments)}).prototype=b}})();(function(){"use strict";function getCookie(c_name){var c_value=document.cookie,c_end,c_start=c_value.indexOf(" "+c_name+"=");if(c_start===-1){c_start=c_value.indexOf(c_name+"=");}
if(c_start===-1){c_value=null;}else{c_start=c_value.indexOf("=",c_start)+1;c_end=c_value.indexOf(";",c_start);if(c_end===-1){c_end=c_value.length;}
c_value=decodeURIComponent(c_value.substring(c_start,c_end));}
return c_value;};if((getCookie('DB')||'PG').toUpperCase()==='PG'){GS.utfSafeMD5=CryptoJS.MD5;}else{GS.utfSafeMD5=function(str){"use strict";var buf=new ArrayBuffer(str.length*2);var bufView=new Uint16Array(buf);var i;var strLen;for(i=0,strLen=str.length;i<strLen;i+=1){bufView[i]=str.charCodeAt(i);}
return CryptoJS.MD5(CryptoJS.lib.WordArray.create(bufView));}}}());window.addEventListener('design-register-element',function(){registerDesignSnippet('Lorem Ipsum','Lorem Ipsum','Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.');registerDesignSnippet('Document Start','Document Start','<!DOCTYPE html>\n'+'<html>\n'+'    <head>\n'+'        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\n'+'        <meta name="apple-mobile-web-app-capable" content="yes" />\n'+'        <meta name="apple-mobile-web-app-status-bar-style" content="black" />\n'+'        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, minimal-ui" />\n'+'        <!-- Make this page use standard caching procedure when used as an iframe -->\n'+'        <meta http-equiv="Cache-control" content="no-store, must-revalidate" />\n'+'        \n'+'        <title>${1:New Page}</title>\n'+'        \n'+'        <script src="/js/greyspots.js" type="text/javascript"></script>\n'+'        <link href="/css/greyspots.css" type="text/css" rel="stylesheet" />\n'+'    </head>\n'+'    <body>\n'+'        $0\n'+'    </body>\n'+'</html>');registerDesignSnippet('Centered H1','Centered H1','<center><h1>$0</h1></center>');registerDesignSnippet('Centered H2','Centered H2','<center><h2>$0</h2></center>');registerDesignSnippet('Centered H3','Centered H3','<center><h3>$0</h3></center>');registerDesignSnippet('Centered H4','Centered H4','<center><h4>$0</h4></center>');registerDesignSnippet('Centered H5','Centered H5','<center><h5>$0</h5></center>');registerDesignSnippet('Centered H6','Centered H6','<center><h6>$0</h6></center>');registerDesignSnippet('Window Load','window.addEventListener','window.addEventListener(\'load\', function () {\n'+'    $0\n'+'});');registerDesignSnippet('Multiline String','Multiline String','ml(function () {/*\n'+'    ${0}\n'+'})');registerDesignSnippet('ml()','ml()','ml(function () {/*\n'+'    ${0}\n'+'*/})');registerDesignSnippet('<style>','<style>','style>\n'+'    $0\n'+'</style>');registerDesignSnippet('<script>','<script>','script>\n'+'    $0\n'+'</script>');registerDesignSnippet('<link>','<link>','link href="${1}" type="text/css" rel="stylesheet" />');registerDesignSnippet('Curved Borders','Curved Borders','-webkit-border-radius: ${1:50%};\n'+'-moz-border-radius: ${1:50%};\n'+'-ms-border-radius: ${1:50%};\n'+'-o-border-radius: ${1:50%};\n'+'border-radius: ${1:50%};');registerDesignSnippet('border-radius','border-radius','-webkit-border-radius: ${1:50%};\n'+'-moz-border-radius: ${1:50%};\n'+'-ms-border-radius: ${1:50%};\n'+'-o-border-radius: ${1:50%};\n'+'border-radius: ${1:50%};');registerDesignSnippet('box-sizing','box-sizing','-webkit-box-sizing: ${1:border-box};\n'+'-moz-box-sizing: ${1:border-box};\n'+'-ms-box-sizing: ${1:border-box};\n'+'-o-box-sizing: ${1:border-box};\n'+'box-sizing: ${1:border-box};');registerDesignSnippet('transform','transform','-webkit-transform: ${1:rotate(42deg)};\n'+'-moz-transform: ${1:rotate(42deg)};\n'+'-ms-transform: ${1:rotate(42deg)};\n'+'-o-transform: ${1:rotate(42deg)};\n'+'transform: ${1:rotate(42deg)};');registerDesignSnippet('Desktop Media Query','Desktop Media Query','@media only screen and (max-width: 5000px) {\n'+'    $0\n'+'}');registerDesignSnippet('Tablet Media Query','Tablet Media Query','@media only screen and (max-width: 768px) {\n'+'    $0\n'+'}');registerDesignSnippet('Phone Media Query','Phone Media Query','@media only screen and (max-width: 321px) {\n'+'    $0\n'+'}');});window.addEventListener('design-register-element',function(){var strNormalCallbackContent='    if (!error) {\n'+'        $0\n'+'    } else {\n'+'        GS.ajaxErrorDialog(data);\n'+'    }\n';registerDesignSnippet('JSON Ajax','JSON Ajax','GS.ajaxJSON(\'/env/${1:test.action_ship}\', \'${2:action=ship&id=}\', function (data, error) {\n'+
strNormalCallbackContent+'});');registerDesignSnippet('GS.ajaxJSON','GS.ajaxJSON','GS.ajaxJSON(\'/env/${1:test.action_ship}\', \'${2:action=ship&id=}\', function (data, error) {\n'+
strNormalCallbackContent+'});');registerDesignSnippet('TEXT Ajax','TEXT Ajax','GS.ajaxText(\'/env/${1:test.action_description}\', \'${2:action=get&id=}\', function (data, error) {\n'+
strNormalCallbackContent+'});');registerDesignSnippet('GS.ajaxText','GS.ajaxText','GS.ajaxText(\'/env/${1:test.action_description}\', \'${2:action=get&id=}\', function (data, error) {\n'+
strNormalCallbackContent+'});');registerDesignSnippet('PG FUNCTION AJAX','PG FUNCTION AJAX','GS.ajaxJSON(\'/env/${1:test.action_ship}\', \'${2:action=ship&id=}\', function (data, error) {\n'+
strNormalCallbackContent+'});');registerDesignSnippet('GS.ajaxErrorDialog','GS.ajaxErrorDialog','GS.ajaxErrorDialog(data,\n'+'                   function () {\n'+'                       // Try Again Button Callback\n'+'                       // delete this function if you dont want a try again button\n'+'                   },\n'+'                   function () {\n'+'                       // Cance Button Callback\n'+'                       // if you dont need to do anything when the cancel button is clicked: delete this function\n'+'                   });');registerDesignSnippet('GS.dataFetch','GS.dataFetch','function getData(bolClearPrevious) {\n'+'    var data, strLink, dataResultHandler, dataEventFunction;\n'+'    \n'+'    // create function that will use the data\n'+'    dataResultHandler = function (data, error) {\n'+'        \n'+'    };\n'+'    \n'+'    // save data from request or\n'+'    //     start ajax if it hasn\'t already gotten the data yet or\n'+'    //     start new ajax if bolClearPrevious is true\n'+'    data = GS.dataFetch(strLink, bolClearPrevious);\n'+'    \n'+'    // if this request already has been completed\n'+'    if (data) {\n'+'        // handle result\n'+'        dataResultHandler(data.response, data.error);\n'+'    } else {\n'+'        dataEventFunction = function (event) {\n'+'            // unbind data event function\n'+'            document.removeEventListener(\'dataready_\' + encodeURIComponent(strLink), dataEventFunction);\n'+'            \n'+'            // handle result\n'+'            dataResultHandler(event.detail.response, event.detail.error);\n'+'        };\n'+'        \n'+'        // bind data event function\n'+'        document.addEventListener(\'dataready_\' + encodeURIComponent(strLink), dataEventFunction);\n'+'    }\n'+'}');});(function(){'use strict';function ajaxCheckJSONResponseForError(request){if(request.responseJSON){if(request.responseJSON.stat===false){return true;}}else{return true;}
return false;}
function ajaxNormalizeError(request){var response=request.response,jsnTemp,jsnRet={'error_title':'','error_hint':'','error_text':'','error_file':'','error_context':'','original_response':response};if(request.bolFrontEndTimeout===true){jsnRet.error_text='Front-end Timeout Reached';jsnRet.error_title='Front-end Timeout Reached';jsnRet.error_hint='This request took too long. Please report this to a system administrator.';}else if(response.status===403){jsnRet.error_title='403 Link Is Forbidden';jsnRet.error_hint='You have no permission to use this link. If you need this link contact a system administrator and request permission for this link.';}else if(response.status===404){jsnRet.error_title='404 Link Could Not Be Found';jsnRet.error_hint='This link does not exist. Please report this to a system administrator.';}else if(response.status===408){jsnRet.error_title='408 Request Took Too Long';jsnRet.error_hint='This link is broken. Please report this to a system administrator.';}else if(response.status===500){jsnRet.error_title='500 Internal Server Error';jsnRet.error_hint='This call to the server failed. Please report this to a system administrator.';}else if(response.status===502){jsnRet.error_title='502 Bad Gateway';jsnRet.error_hint='This link is broken. Please report this to a system administrator.';}else if(response.status===504){jsnRet.error_title='504 Gateway Timeout';jsnRet.error_hint='This link is broken. Please report this to a system administrator.';}
try{jsnTemp=JSON.parse(response.responseText||response).dat;jsnRet.error_text=jsnTemp.error;jsnRet.error_file=jsnTemp.filename;jsnRet.error_context=jsnTemp.context;if(!jsnRet.error_text){jsnRet.error_text=JSON.parse(response.responseText||response).dat;}}catch(err){if(response){jsnRet.error_text=response.responseText||JSON.stringify(response);}else{jsnRet.error_text=jsnRet.error_text||response;}}
jsnRet.error_file=jsnRet.error_file||'';return jsnRet;}
GS.ajaxJSON=function(strLink,strParams,callback,intTimeout){var request=new XMLHttpRequest();callback=callback||function(){};request.onreadystatechange=function(){var normalizedError;if(request.readyState===4){if(request.status===440){window.location='/index.html?error=Connection%20timed%20out&redirect='+encodeURIComponent(window.location.pathname);}else{try{request.responseJSON=JSON.parse(request.responseText||request.response);}catch(e){}
if(!ajaxCheckJSONResponseForError(request)){callback(request.responseJSON);}else{normalizedError=ajaxNormalizeError(request);if((normalizedError.error_text.indexOf('Session expired')===0||normalizedError.error_text.indexOf('No Cookie')!==-1||normalizedError.error_text.indexOf('requires you to login')!==-1)&&strLink.indexOf('action_info')===-1){GS.normalUserLogin(function(){window.location.reload();},'',request.responseJSON.dat.default_subdomain);}else{callback(normalizedError,'error');}}}}};request.open('POST',strLink+'?anticache='+((new Date()).getMilliseconds()+Math.floor(Math.random()*1e9)),true);request.setRequestHeader('Content-type','application/x-www-form-urlencoded; charset=UTF-8');request.send(strParams);if(typeof intTimeout==='number'){if(request&&request.readyState!==4){setTimeout(function(){request.bolFrontEndTimeout=true;request.abort();},intTimeout);}}
return request;};GS.ajaxText=function(strLink,strParams,callback,intTimeout){var request=new XMLHttpRequest();callback=callback||function(){};request.onreadystatechange=function(){var normalizedError;if(request.readyState===4){if(request.status===200){callback(request.responseText);}else if(request.status===440){window.location='/index.html?error=Connection%20timed%20out&redirect='+encodeURIComponent(window.location.pathname);}else{normalizedError=ajaxNormalizeError(request);if((normalizedError.error_text.indexOf('Session expired')===0||normalizedError.error_text.indexOf('No Cookie')!==-1||normalizedError.error_text.indexOf('requires you to login')!==-1)&&strLink.indexOf('action_info')===-1){GS.normalUserLogin(function(){window.location.reload();});}else{callback(normalizedError,'error');}}}};request.open('POST',strLink+'?anticache='+((new Date()).getMilliseconds()+Math.floor(Math.random()*1e9)),true);request.setRequestHeader('Content-type','application/x-www-form-urlencoded; charset=UTF-8');request.send(strParams);if(typeof intTimeout==='number'){if(request&&request.readyState!==4){setTimeout(function(){request.bolFrontEndTimeout=true;request.abort();},intTimeout);}}
return request;};}());(function(){"use strict";function cleanErrorValue(strValue){strValue=strValue||'';if(strValue.indexOf('DB_exec failed:')!==-1){strValue=strValue.replace(/[.\s\S]*DB_exec\ failed:/mi,'');}
if(strValue.indexOf('Query failed:')!==-1){strValue=strValue.replace(/[.\s\S]*Query\ failed:/mi,'');}
if(strValue.indexOf('FATAL')!==-1){strValue=strValue.replace(/[.\s\S]*FATAL/mi,'');}
strValue=strValue.replace(/\\?\\n/gi,'\n').replace(/\\?\\t/gi,'\t').replace(/\[.*\]/gi,'').replace(/\([0-9]*\)/gi,'');return GS.trim(strValue.trim(),'"');}
function errorJSONToHTML(errorJSON){return'<pre style="word-break: break-all; white-space: pre-wrap;">'+'There was an error:'+
(errorJSON.error_text?'<br /><br />'+encodeHTML(errorJSON.error_text):'')+
(errorJSON.error_file?'<br /><br />The error was on file: '+encodeHTML(errorJSON.error_file):'')+
(errorJSON.error_hint?'<br /><br />'+encodeHTML(errorJSON.error_hint):'')+
(errorJSON.error_context?'<br /><br />'+encodeHTML(errorJSON.error_context):'')+
(errorJSON.error_addin?'<br /><br />'+encodeHTML(errorJSON.error_addin):'')+'</pre>';}
GS.ajaxErrorDialog=function(jsnError,tryAgainCallback,cancelCallback){'use strict';var templateElement=document.createElement('template'),strHTML;var jsnErrorCopy={};jsnErrorCopy.error_text=cleanErrorValue(jsnError.error_text);jsnErrorCopy.error_file=cleanErrorValue(jsnError.error_file);jsnErrorCopy.error_hint=cleanErrorValue(jsnError.error_hint);jsnErrorCopy.error_context=cleanErrorValue(jsnError.error_context);jsnErrorCopy.error_addin=cleanErrorValue(jsnError.error_addin);templateElement.setAttribute('data-theme','error');strHTML=ml(function(){/*
            <gs-page>
                <gs-header><center><h3>There was an error!</h3></center></gs-header>
                <gs-body padded>
                    {{HTML}}
                    <gs-button class="error-button-show-full-text">Show Full Error Text</gs-button>
                </gs-body>
                <gs-footer>{{BUTTONS}}</gs-footer>
            </gs-page>
        */}).replace('{{HTML}}',errorJSONToHTML(jsnErrorCopy));var openFunction=function(){xtag.query(this,'.error-button-show-full-text')[0].addEventListener('click',function(){var templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                    <gs-page>
                        <gs-header><center><h3>Full Error Text</h3></center></gs-header>
                        <gs-body padded>
                            {{HTML}}
                        </gs-body>
                        <gs-footer><gs-button dialogclose>Done</gs-button></gs-footer>
                    </gs-page>
                */}).replace('{{HTML}}',errorJSONToHTML(jsnError));GS.openDialog(templateElement);});};if(typeof tryAgainCallback==='function'){templateElement.innerHTML=strHTML.replace('{{BUTTONS}}','<gs-grid>'+'   <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>'+'   <gs-block><gs-button dialogclose listen-for-return>Try Again</gs-button></gs-block>'+'</gs-grid>');GS.openDialog(templateElement,openFunction,function(event,strAnswer){if(strAnswer==='Try Again'){tryAgainCallback(strAnswer);}else{if(typeof cancelCallback==='function'){cancelCallback(strAnswer);}}});}else{templateElement.innerHTML=strHTML.replace('{{BUTTONS}}','<gs-button dialogclose listen-for-return>Ok</gs-button>');GS.openDialog(templateElement,openFunction);}};}());/*

var strLink = '/env/action_select?view=wtkv2.ttime&where=user_name%20%3D%20\'michael%40tocci.org\'&offset=0&limit=25&order_by=id%20DESC&header=true';

document.addEventListener('dataready_' + encodeURIComponent(strLink), function (event) {
    console.log(event);
});f

dataFetch(strLink, false);

*/
if(GS.dataLedger===undefined){GS.dataLedger={};}
GS.dataFetch=function(strLink,bolClearPrevious){'use strict';var arrLinkParts=strLink.split('?'),strId=encodeURIComponent(strLink);if(GS.dataLedger[strId]===undefined||bolClearPrevious===true){GS.dataLedger[strId]={'status':'waiting','response':''};GS.ajaxJSON(arrLinkParts[0],arrLinkParts[1]||'',function(data,error){var event;if(document.createEvent){event=document.createEvent('HTMLEvents');event.initEvent('dataready_'+strId,true,true);event.eventName='dataready_'+strId;}else{event=document.createEventObject();event.eventType='dataready_'+strId;event.eventName='dataready_'+strId;}
if(!error){GS.dataLedger[strId].response=(data.dat!==undefined?data.dat:data);GS.dataLedger[strId].status='finished';event.detail={'response':GS.dataLedger[strId].response};}else{GS.dataLedger[strId].data=data;GS.dataLedger[strId].status='error';GS.dataLedger[strId].error='error';event.detail={'response':data,'error':'error'};}
if(document.createEvent){document.dispatchEvent(event);}else{document.fireEvent('on'+event.eventType,event);}});return'';}
if(GS.dataLedger[strId].status==='finished'||GS.dataLedger[strId].status==='error'){return GS.dataLedger[strId];}
return'';};window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.findParentTag','GS.findParentTag','GS.findParentTag(${1:element}, \'${0:tag-to-find}\');');registerDesignSnippet('GS.findParentElement','GS.findParentElement','GS.findParentElement(${1:element}, ${0:\'selector, element or function\'});');registerDesignSnippet('GS.insertElementAfter','GS.insertElementAfter','GS.insertElementAfter(${1:elementToInsert}, \'${0:elementToInsertAfter}\');');registerDesignSnippet('GS.getElementOffset','GS.getElementOffset','GS.getElementOffset(${0:element});');registerDesignSnippet('GS.animateStyle','GS.animateStyle','GS.animateStyle(${1:elementToAnimate}, '+'${2:CSSPropertyToAnimate}, '+'${3:startValue}, '+'${4:endValue}, '+'${5:callbackAfterAnimation}, '+'${6:durationInMilliseconds}, '+'${0:numberOfFrames});');registerDesignSnippet('GS.stringToElement','GS.stringToElement','GS.stringToElement(\'${0:<div>your HTML here</div>}\');');registerDesignSnippet('GS.cloneElement','GS.cloneElement','GS.cloneElement(${0:element});');registerDesignSnippet('GS.isElementFocusable','GS.isElementFocusable','GS.isElementFocusable(${0:element});');registerDesignSnippet('GS.scrollParent','GS.scrollParent','GS.scrollParent(${0:element});');registerDesignSnippet('GS.scrollIntoView','GS.scrollIntoView','GS.scrollIntoView(${0:element});');registerDesignSnippet('GS.getInputSelection','GS.getInputSelection','GS.getInputSelection(${0:inputOrTextareaElement});');registerDesignSnippet('GS.setInputSelection','GS.setInputSelection','GS.setInputSelection(${1:inputOrTextareaElement}, ${2:startAtNumber}, ${0:endAtNumber});');registerDesignSnippet('GS.getElementPositionData','GS.getElementPositionData','GS.getElementPositionData(${0:element});');});GS.findParentTag=function(element,strTagName){'use strict';var currentElement=element.parentNode;strTagName=strTagName.toUpperCase();while(currentElement&&currentElement.nodeName!==strTagName&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}
if(!currentElement||currentElement.nodeName!==strTagName){return undefined;}
return currentElement;};GS.findParentElement=function(element,checkParameter){'use strict';var currentElement=element;if(typeof checkParameter==='function'){while(currentElement&&!checkParameter(currentElement)&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}}else if(typeof checkParameter==='string'){while(currentElement&&!xtag.matchSelector(currentElement,checkParameter)&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}}else{while(currentElement&&currentElement!==checkParameter&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}}
if(!currentElement){return undefined;}
return currentElement;};GS.insertElementAfter=function(elementToInsert,target){if(target.nextElementSibling){target.parentNode.insertBefore(elementToInsert,target.nextElementSibling);}else{target.parentNode.appendChild(elementToInsert);}};GS.getElementOffset=function(element){'use strict';var intX=0,intY=0,ret;if(element.getBoundingClientRect){ret=element.getBoundingClientRect();}else{while(element&&element.nodeName!=='HTML'){intX+=element.offsetLeft-element.scrollLeft;intY+=element.offsetTop-element.scrollTop;element=element.parentNode;}
ret={left:intX,top:intY};}
return ret;};GS.animateStyle=function(element,strStyleProperty,strStart,strEnd,callback,intDuration,intFrames){var intStart=parseInt(strStart,10),intEnd=parseInt(strEnd,10),strStartUnit=strStart.replace(/[0-9\.-]/gi,'').toLowerCase(),intFrameDuration=intDuration/intFrames,i,timeoutFunction,intCurrent,intJump;intCurrent=intStart;intJump=(intEnd-intStart)/intFrames;i=1;element.style[strStyleProperty]=strStart;timeoutFunction=function(){setTimeout(function(){intCurrent+=intJump;if(i<intFrames){element.style[strStyleProperty]=intCurrent+strStartUnit;i+=1;timeoutFunction();}else{element.style[strStyleProperty]=strEnd;callback();}},intFrameDuration);};timeoutFunction();};GS.stringToElement=function(strHTML,optionalTargetDocument){var strFirstTagName,parentElement,indexInElement,parsedElement,targetDocument;if(optionalTargetDocument){targetDocument=optionalTargetDocument;}else{targetDocument=document;}
strFirstTagName=strHTML.substring(strHTML.indexOf('<')+1,strHTML.indexOf('>'));if(strFirstTagName.indexOf(' ')>-1){strFirstTagName=strFirstTagName.substring(0,strFirstTagName.indexOf(' '));}
if(strFirstTagName==='body'){parentElement=targetDocument.createElement('html');indexInElement=1;}else if(strFirstTagName==='thead'||strFirstTagName==='tbody'){parentElement=targetDocument.createElement('table');indexInElement=0;}else if(strFirstTagName==='tr'){parentElement=targetDocument.createElement('tbody');indexInElement=0;}else if(strFirstTagName==='td'||strFirstTagName==='th'){parentElement=targetDocument.createElement('tr');indexInElement=0;}else if(strFirstTagName==='li'){parentElement=targetDocument.createElement('ul');indexInElement=0;}else{parentElement=targetDocument.createElement('div');indexInElement=0;}
parentElement.innerHTML=strHTML;parsedElement=parentElement.children[indexInElement];return parsedElement;};GS.cloneElement=function(element,optionalTargetDocument){if(xtag.query(element,'template').length>0||optionalTargetDocument){return GS.stringToElement(element.outerHTML,optionalTargetDocument);}
return element.cloneNode(true);};/*
// change the tag of an element
GS.changeElementTag = function (element, strNewTag, alterCallback) {
    var strHTML = element.outerHTML.trim(), newElement;
    
    strHTML = '<' + strNewTag + strHTML.substring(strHTML.indexOf(' '), strHTML.lastIndexOf('</')) + '</' + strNewTag + '>';
    
    //console.log(strHTML);
    
    newElement = GS.stringToElement(strHTML);
    
    if (typeof alterCallback === 'function') {
        alterCallback.apply(newElement);
    }
    
    return newElement;
};*/
GS.isElementFocusable=function(element){return(element.nodeName==='INPUT'||element.nodeName==='TEXTAREA'||element.nodeName==='SELECT'||element.nodeName==='BUTTON'||element.nodeName==='IFRAME'||(element.hasAttribute('tabindex')&&element.getAttribute('tabindex')!=='-1')||(element.focus&&element.focus.toString().indexOf('[native code]')===-1&&element.focus.toString()!==document.createElement('div').focus.toString())||(element.nodeName==='A'&&element.hasAttribute('href'))||(element.nodeName==='AREA'&&element.hasAttribute('href')))&&!element.hasAttribute('disabled');};GS.getInputSelection=function(input){'use strict';var start=0,end=0,normalizedValue,range,textInputRange,len,endRange;if(typeof input.selectionStart==="number"&&typeof input.selectionEnd==="number"){start=input.selectionStart;end=input.selectionEnd;}else{range=(document.createRange()||document.selection.createRange());if(range&&range.parentElement()==input){len=input.value.length;normalizedValue=input.value.replace(/\r\n/g,"\n");textInputRange=input.createTextRange();textInputRange.moveToBookmark(range.getBookmark());endRange=input.createTextRange();endRange.collapse(false);if(textInputRange.compareEndPoints("StartToEnd",endRange)>-1){start=end=len;}else{start=-textInputRange.moveStart("character",-len);start+=normalizedValue.slice(0,start).split("\n").length-1;if(textInputRange.compareEndPoints("EndToEnd",endRange)>-1){end=len;}else{end=-textInputRange.moveEnd("character",-len);end+=normalizedValue.slice(0,end).split("\n").length-1;}}}}
return{start:start,end:end};};GS.setInputSelection=function(input,intStart,intEnd){'use strict';var range;if(intStart===undefined||intStart===''||isNaN(intStart)||intStart===null){intStart=input.value.length;}
if(intEnd===undefined||intEnd===''||isNaN(intEnd)||intEnd===null){intEnd=intStart;}
if(input.createTextRange){range=input.createTextRange();range.collapse();range.moveStart('character',intStart);range.collapse();range.moveEnd('character',intEnd);range.select();}else if(input.setSelectionRange){input.focus();input.setSelectionRange(intStart,intEnd);}};GS.getElementPositionData=function(element){var objElementOffset=GS.getElementOffset(element),intElementWidth=element.offsetWidth,intElementHeight=element.offsetHeight,intElementTop=objElementOffset.top,intElementLeft=objElementOffset.left,intElementBottom=window.innerHeight-(intElementTop+intElementHeight),intElementRight=window.innerWidth-(intElementLeft+intElementWidth),intRoomAbove=window.innerHeight-(intElementBottom+intElementHeight),intRoomBelow=intElementBottom,intRoomLeft=window.innerWidth-(intElementRight+intElementWidth),intRoomRight=intElementRight;/*console.log(element, '\n' +
                'intElementWidth:   ' + intElementWidth + '\n' +
                'intElementHeight:  ' + intElementHeight + '\n' +
                'intElementTop:     ' + intElementTop + '\n' +
                'intElementBottom:  ' + intElementBottom + '\n' +
                'intElementLeft:    ' + intElementLeft + '\n' +
                'intElementRight:   ' + intElementRight + '\n' +
                'intRoomAbove:      ' + intRoomAbove + '\n' +
                'intRoomBelow:      ' + intRoomBelow + '\n' +
                'intRoomLeft:       ' + intRoomLeft + '\n' +
                'intRoomRight:      ' + intRoomRight);*/
return{'element':element,'objElementOffset':objElementOffset,'intElementWidth':intElementWidth,'intElementHeight':intElementHeight,'intElementTop':intElementTop,'intElementLeft':intElementLeft,'intElementBottom':intElementBottom,'intElementRight':intElementRight,'intRoomAbove':intRoomAbove,'intRoomBelow':intRoomBelow,'intRoomLeft':intRoomLeft,'intRoomRight':intRoomRight};};/*                                       ,--- the problem with this code is the DOM we get back is not 100% reliably inert. 
                                         V          To make it reliable I believe I have to change how my elements work.
GS.createDocumentFragment = function (strHTML) {
    'use strict';
    var element = document.createElement('div'),
        fragment = document.createDocumentFragment(),
        arrChildren = element.childNodes;
    
    // fill element with HTML
    element.innerHTML = strHTML;
    
    // append the element to the body (NECCESSARY FOR THE HTML TO BE INERT, I DON'T KNOW WHY -michael)
    document.body.appendChild(element);
    
    // transfer children from element to fragment
    while (arrChildren[0]) {
        fragment.appendChild(arrChildren[0]);
    }
    
    // remove element from the body
    document.body.removeChild(element);
    
    // return inert fragment
    return fragment;
};

GS.getDocumentFragmentHTML = function (fragment) {
    'use strict';
    var strHTML, i, len, arrChildren = fragment.children;
    
    for (strHTML = '', i = 0, len = arrChildren.length; i < len; i += 1) {
        strHTML += arrChildren[i].outerHTML;
    }
    
    return strHTML;
};
*/
/*tell papa if you uncomment
GS.createInertDOM = function (strHTML) {
    'use strict';
    var templateElement = document.createElement('template'), iframeElement;
    
    // if the content property is on a template element: no iframe neccessary
    if ('content' in templateElement) {
        templateElement.innerHTML = strHTML;
        
        return templateElement.content;
        
    // else: use iframe to create inert HTML
    } else {
        if (!document.getElementById('gs-inert-dom-generator')) {
            iframeElement = document.createElement('iframe');
            
            iframeElement.setAttribute('id', 'gs-inert-dom-generator');
            iframeElement.setAttribute('hidden', '');
            
            document.body.appendChild(iframeElement);
            
        } else {
            iframeElement = document.getElementById('gs-inert-dom-generator');
        }
        
        iframeElement.contentWindow.inertDOM = iframeElement.contentWindow.document.createElement('div');
        iframeElement.contentWindow.inertDOM.innerHTML = strHTML;
        
        return iframeElement.contentWindow.inertDOM;
    }
};

GS.getInertDOMHTML = function (inertDOM) {
    'use strict';
    var strHTML, i, len, arrChildren = inertDOM.children;
    
    for (strHTML = '', i = 0, len = arrChildren.length; i < len; i += 1) {
        strHTML += arrChildren[i].outerHTML;
    }
    
    return strHTML;
};
*/
(function(){'use strict';function getCellFromTarget(element){var currentElement=element;while(currentElement.nodeName!=='TD'&&currentElement.nodeName!=='TH'&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}
if(currentElement&&currentElement.nodeName!=='TD'&&currentElement.nodeName!=='TH'){return undefined;}
return currentElement;}
function selectHandler(tableElement,dragOrigin,dragCurrentCell,dragMode){var bolThead,bolFirstTh,arrRecords,arrCells,arrRecordsToAffect=[],arrCellsToAffect=[],arrNewSelection=[],arrCellsToRemoveFromSelection=[],i,len,intFrom,intTo;arrRecords=xtag.query(tableElement,'tr');arrCells=xtag.query(tableElement,'td, th');if(arrRecords.length>0){bolThead=Boolean(xtag.queryChildren(tableElement,'thead')[0]);if((bolThead&&arrRecords.length>1)||(!bolThead&&arrRecords>0)){if(bolThead){bolFirstTh=arrRecords[1].children[0].nodeName==='TH';}else{bolFirstTh=arrRecords[0].children[0].nodeName==='TH';}}
if(bolThead&&bolFirstTh&&dragOrigin.parentNode.rowIndex===0&&dragCurrentCell.parentNode.rowIndex===0&&dragOrigin.cellIndex===0&&dragCurrentCell.cellIndex===0){arrCellsToAffect=arrCells;}else if(bolFirstTh&&dragOrigin.cellIndex===0&&dragCurrentCell.cellIndex===0){arrRecordsToAffect=arrRecords.slice(Math.min(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex),Math.max(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex)+1);for(i=0,len=arrRecordsToAffect.length;i<len;i+=1){Array.prototype.push.apply(arrCellsToAffect,xtag.toArray(arrRecordsToAffect[i].children));}}else if(bolThead&&dragOrigin.parentNode.rowIndex===0&&dragCurrentCell.parentNode.rowIndex===0){intFrom=Math.min(dragOrigin.cellIndex,dragCurrentCell.cellIndex);intTo=Math.max(dragOrigin.cellIndex,dragCurrentCell.cellIndex)+1;for(i=0,len=arrRecords.length;i<len;i+=1){Array.prototype.push.apply(arrCellsToAffect,xtag.toArray(arrRecords[i].children).slice(intFrom,intTo));}}else{arrRecordsToAffect=arrRecords.slice(Math.min(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex),Math.max(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex)+1);intFrom=Math.min(dragOrigin.cellIndex,dragCurrentCell.cellIndex);intTo=Math.max(dragOrigin.cellIndex,dragCurrentCell.cellIndex)+1;for(i=0,len=arrRecordsToAffect.length;i<len;i+=1){Array.prototype.push.apply(arrCellsToAffect,xtag.toArray(arrRecordsToAffect[i].children).slice(intFrom,intTo));}}
if(dragMode==='select'){for(i=0,len=tableElement.selectionSelectedCells.length;i<len;i+=1){if(arrCellsToAffect.indexOf(tableElement.selectionSelectedCells[i])===-1){arrCellsToRemoveFromSelection.push(tableElement.selectionSelectedCells[i]);}}
tableElement.selectionSelectedCells=arrCellsToAffect;arrNewSelection=tableElement.selectedCells;for(i=0,len=arrCellsToAffect.length;i<len;i+=1){GS.listAdd(arrNewSelection,arrCellsToAffect[i]);}
for(i=0,len=arrCellsToRemoveFromSelection.length;i<len;i+=1){arrNewSelection.splice(arrNewSelection.indexOf(arrCellsToRemoveFromSelection[i]),1);}
tableElement.selectedCells=arrNewSelection;}else{arrNewSelection=tableElement.selectedCells;for(i=0,len=arrCellsToAffect.length;i<len;i+=1){if(arrNewSelection.indexOf(arrCellsToAffect[i])>-1){arrNewSelection.splice(arrNewSelection.indexOf(arrCellsToAffect[i]),1);}}
tableElement.selectedCells=arrNewSelection;}}}
function getSelectedCopyHTML(element){var strHTMLCopyString,intFromRecord,intToRecord,intFromCell=9999999,intToCell=0,i,len,cell_i,cell_len,arrSelected,strCellHTML,arrRecords,arrCells,strHTMLRecordString,strNull,bolColumns;arrSelected=element.selectedCells;strNull=(element.getAttribute('null-values')||"NULL");bolColumns=(element.getAttribute('column-names')||"true")==="true";if(arrSelected.length>0){intFromRecord=arrSelected[0].parentNode.rowIndex;intToRecord=arrSelected[arrSelected.length-1].parentNode.rowIndex+1;for(i=0,len=arrSelected.length;i<len;i+=1){if(arrSelected[i].cellIndex<intFromCell){intFromCell=arrSelected[i].cellIndex;intFromCell=(intFromCell===0?1:intFromCell);}
if(arrSelected[i].cellIndex+1>intToCell){intToCell=arrSelected[i].cellIndex+1;}}
arrRecords=xtag.query(element,'tr');strHTMLCopyString='';if(bolColumns&&intFromRecord>0){arrCells=arrRecords[0].children;strHTMLRecordString='';for(cell_i=intFromCell,cell_len=intToCell;cell_i<cell_len;cell_i+=1){strCellHTML='';if(arrCells[cell_i].nodeName==='TH'&&arrCells[cell_i].firstElementChild){strCellHTML=arrCells[cell_i].firstElementChild.textValue||arrCells[cell_i].firstElementChild.value||(arrCells[cell_i].firstElementChild.checked||'').toString()||arrCells[cell_i].firstElementChild.textContent||'';}else if(arrCells[cell_i].lastElementChild){strCellHTML=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString()||arrCells[cell_i].lastElementChild.textContent||'';}else{strCellHTML=arrCells[cell_i].textContent;}
strCellHTML=encodeHTML(strCellHTML).replace(/\n/gim,'<br />');strCellHTML='<'+'td rowspan="1" colspan="1">'+(strCellHTML||'')+'</td>'
strHTMLRecordString+=(cell_i===intFromCell?'<'+'tr>':'');strHTMLRecordString+=(strCellHTML||'');strHTMLRecordString+=(cell_i===(intToCell-1)?'<'+'/tr>':'');}
if(strHTMLRecordString.trim()){strHTMLCopyString+=strHTMLRecordString;}}
for(i=intFromRecord,len=intToRecord;i<len;i+=1){arrCells=arrRecords[i].children;strHTMLRecordString='';if(!arrRecords[i].classList.contains('insert-record')){for(cell_i=intFromCell,cell_len=intToCell;cell_i<cell_len;cell_i+=1){strCellHTML='';if(arrCells[cell_i].hasAttribute('selected')||(i===0&&bolColumns)){if(arrCells[cell_i].nodeName==='TH'&&arrCells[cell_i].firstElementChild){strCellHTML=arrCells[cell_i].firstElementChild.textValue||arrCells[cell_i].firstElementChild.value||(arrCells[cell_i].firstElementChild.checked||'').toString()||arrCells[cell_i].firstElementChild.textContent||'';}else if(arrCells[cell_i].lastElementChild){strCellHTML=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString()||arrCells[cell_i].lastElementChild.textContent||'';}else{strCellHTML=arrCells[cell_i].textContent;}
strCellHTML=encodeHTML(strCellHTML).replace(/\n/gim,'<br />');if(strCellHTML==='NULL'||strCellHTML==='\N'){strCellHTML=strNull;}}
strCellHTML='<'+'td rowspan="1" colspan="1">'+(strCellHTML||'')+'</td>'
strHTMLRecordString+=(cell_i===intFromCell?'<'+'tr>':'');strHTMLRecordString+=(strCellHTML||'');strHTMLRecordString+=(cell_i===(intToCell-1)?'<'+'/tr>':'');}}
if(strHTMLRecordString.trim()){strHTMLCopyString+=strHTMLRecordString;}}
if(strHTMLCopyString){strHTMLCopyString='<'+'style>'+'br { mso-data-placement:same-cell; } '+'th, td { white-space: pre-wrap; }'+'<'+'/style>'+'<'+'table border="0" cellpadding="0" cellspacing="0">'+strHTMLCopyString+'<'+'/table>';}}
return strHTMLCopyString||'';}
function getSelectedCopyText(element){var strTextCopyString,intFromRecord,intToRecord,intFromCell=9999999,intToCell=0,i,len,cell_i,cell_len,arrSelected,strCellText,arrRecords,arrCells,arrCellIndexes,strTextRecordString,strQuoteType,strQuoteChar,strFieldDelimiter,strRowDelimiter,strNull,bolColumns,quoteRegex;strQuoteType=(element.getAttribute('quote-type')||"strings");strQuoteChar=(element.getAttribute('quote-char')||'"');strFieldDelimiter=(element.getAttribute('field-delimiter')||"\t");strNull=(element.getAttribute('null-values')||"NULL");bolColumns=(element.getAttribute('column-names')||"true")==="true";strRowDelimiter=(element.getAttribute('row-delimiter')||"\n");quoteRegex=new RegExp(strQuoteChar,'g');arrSelected=element.selectedCells;if(arrSelected.length>0){intFromRecord=arrSelected[0].parentNode.rowIndex;intToRecord=arrSelected[arrSelected.length-1].parentNode.rowIndex+1;for(i=0,len=arrSelected.length;i<len;i+=1){if(arrSelected[i].cellIndex<intFromCell){intFromCell=arrSelected[i].cellIndex;intFromCell=(intFromCell===0?1:intFromCell);}
if(arrSelected[i].cellIndex+1>intToCell){intToCell=arrSelected[i].cellIndex+1;}}
arrRecords=xtag.query(element,'tr');strTextCopyString='';if(bolColumns&&intFromRecord>0){arrCells=arrRecords[0].children;strTextRecordString='';for(cell_i=intFromCell,cell_len=intToCell;cell_i<cell_len;cell_i+=1){strCellText='';if(arrCells[cell_i].nodeName==='TH'&&arrCells[cell_i].firstElementChild){strCellText=arrCells[cell_i].firstElementChild.textValue||arrCells[cell_i].firstElementChild.value||(arrCells[cell_i].firstElementChild.checked||'').toString()||arrCells[cell_i].firstElementChild.textContent||'';}else if(arrCells[cell_i].lastElementChild){strCellText=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString();}else{strCellText=arrCells[cell_i].textContent;}
strCellText=strCellText.replace(quoteRegex,(strQuoteChar+strQuoteChar));if(strCellText==='NULL'||strCellText==='\N'){strCellText=strNull;}else{if(strQuoteType==='all'){strCellText=strQuoteChar+strCellText+strQuoteChar;}else if(strQuoteType==='strings'&&isNaN(strCellText)){strCellText=strQuoteChar+strCellText+strQuoteChar;}}
strTextRecordString+=(cell_i!==intFromCell?strFieldDelimiter:'');strTextRecordString+=(strCellText||'');}
strTextCopyString+=strTextRecordString;strTextCopyString+=strRowDelimiter;}
for(i=intFromRecord,len=intToRecord;i<len;i+=1){arrCells=arrRecords[i].children;strTextRecordString='';for(cell_i=intFromCell,cell_len=intToCell;cell_i<cell_len;cell_i+=1){strCellText='';if(arrCells[cell_i].hasAttribute('selected')){if(arrCells[cell_i].nodeName==='TH'&&arrCells[cell_i].firstElementChild){strCellText=arrCells[cell_i].firstElementChild.textValue||arrCells[cell_i].firstElementChild.value||(arrCells[cell_i].firstElementChild.checked||'').toString()||arrCells[cell_i].firstElementChild.textContent;}else if(arrCells[cell_i].lastElementChild){strCellText=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString();}else{strCellText=arrCells[cell_i].textContent;}
strCellText=strCellText.replace(quoteRegex,(strQuoteChar+strQuoteChar));if(strCellText==='NULL'||strCellText==='\N'){strCellText=strNull;}else{if(strQuoteType==='all'){strCellText=strQuoteChar+strCellText+strQuoteChar;}else if(strQuoteType==='strings'&&isNaN(strCellText)){strCellText=strQuoteChar+strCellText+strQuoteChar;}}}else{if(strQuoteType==='all'||strQuoteType==='strings'){strCellText=strQuoteChar+strCellText+strQuoteChar;}}
strTextRecordString+=(cell_i!==intFromCell?strFieldDelimiter:'');strTextRecordString+=(strCellText||'');}
strTextCopyString+=strTextRecordString;if(i+1!==len){strTextCopyString+=strRowDelimiter;}}}
return strTextCopyString||'';}
function handleClipboardData(event,strCopyString,strType){var clipboardData=event.clipboardData||window.clipboardData,strMime;if(!clipboardData){return;}
if(!clipboardData.setData){return;}
if(strType==='text'){if(window.clipboardData&&window.clipboardData.getData){strMime='Text';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/plain';}}else if(strType==='html'){if(window.clipboardData&&window.clipboardData.getData){strMime='';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/html';}}else{throw'handleClipboardData Error: Type "'+strType+'" not recognized, recognized types are "text" and "html".';}
if(strMime){if(strCopyString&&strMime){return clipboardData.setData(strMime,strCopyString)!==false;}else{return clipboardData.getData(strMime);}}}
GS.makeTableSelectable=function(tableElement,bolSingleRecord){var copyElement;if(!tableElement||tableElement.nodeName!=='TABLE'){throw'GS.makeTableSelectable Error: you must provide a <table> element as the first parameter.';}
Object.defineProperty(tableElement,'selectedCells',{get:function(){return xtag.query(this,'[selected]');},set:function(newValue){var i,len,intIdIndex,arrCells=this.selectedCells,arrRecords,cell_i,cell_len;for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');}
arrCells=xtag.query(this,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue==='object'&&newValue.length===undefined){arrCells=[newValue];}else{arrCells=newValue;}
for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].setAttribute('selected','');}
arrRecords=this.selectedRecords;for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].children;for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){if(!arrCells[cell_i].hasAttribute('selected')){arrCells[cell_i].setAttribute('selected-secondary','');}}}
GS.triggerEvent(this,'after_selection');}});Object.defineProperty(tableElement,'selectedRecords',{get:function(){var i,len,intRecordIndex=-1,arrRecord=[],selected=this.selectedCells;for(i=0,len=selected.length;i<len;i+=1){if(selected[i].parentNode.rowIndex>intRecordIndex&&selected[i].parentNode.parentNode.nodeName!=='THEAD'){intRecordIndex=selected[i].parentNode.rowIndex;arrRecord.push(selected[i].parentNode);}}
return arrRecord;},set:function(newValue){var i,len,cell_i,cell_len,intIdIndex,arrCells=this.selectedCells,arrRecords,arrCellChildren;for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');}
arrCells=xtag.query(this,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue==='object'&&newValue.length===undefined){arrRecords=[newValue];}else{arrRecords=newValue;}
for(i=0,len=arrRecords.length,arrCells=[];i<len;i+=1){arrCellChildren=arrRecords[i].children;for(cell_i=0,cell_len=arrCellChildren.length;cell_i<cell_len;cell_i+=1){arrCells.push(arrCellChildren[cell_i]);}}
this.selectedCells=arrCells;GS.triggerEvent(this,'after_selection');}});if(evt.touchDevice||bolSingleRecord===true){tableElement.addEventListener(evt.mousedown,function(event){var target=event.target;if(target.nodeName==='TD'||target.nodeName==='TH'||getCellFromTarget(target)){tableElement.selectedCells=[];if(GS.findParentTag(target,'tr')){tableElement.selectedCells=GS.findParentTag(target,'tr').children;}}});}else{tableElement.addEventListener(evt.mousedown,function(event){var target=event.target,cellFromTarget=getCellFromTarget(target),closestCell,arrSelectedCells,i,len;if(GS.findParentTag(event.target,'table')){if(cellFromTarget){closestCell=cellFromTarget;}
if(closestCell){tableElement.dragAllowed=true;tableElement.dragCurrentCell=closestCell;tableElement.selectionSelectedCells=[];if(event.shiftKey&&tableElement.selectionPreviousOrigin){if(tableElement.selectionPreviousSelectedCells){arrSelectedCells=tableElement.selectedCells;for(i=0,len=tableElement.selectionPreviousSelectedCells.length;i<len;i+=1){arrSelectedCells.splice(arrSelectedCells.indexOf(tableElement.selectionPreviousSelectedCells[i]),1);}
tableElement.selectedCells=arrSelectedCells;}
tableElement.dragOrigin=tableElement.selectionPreviousOrigin;tableElement.dragMode='select';}else if(!event.shiftKey&&(event.metaKey||event.ctrlKey)&&!closestCell.hasAttribute('selected')){tableElement.dragOrigin=closestCell;tableElement.dragMode='select';}else if(!event.shiftKey&&(event.metaKey||event.ctrlKey)&&closestCell.hasAttribute('selected')){tableElement.dragOrigin=closestCell;tableElement.dragMode='deselect';}else{tableElement.selectedCells=[];tableElement.dragOrigin=closestCell;tableElement.dragMode='select';}
selectHandler(tableElement,tableElement.dragOrigin,tableElement.dragCurrentCell,tableElement.dragMode);}}});tableElement.addEventListener(evt.mousemove,function(event){var target,closestCell,cellFromTarget;if(event.which!==0){target=event.target;cellFromTarget=getCellFromTarget(target);if(cellFromTarget){closestCell=cellFromTarget;}
if(tableElement.dragAllowed&&tableElement.dragCurrentCell!==closestCell){tableElement.dragCurrentCell=getCellFromTarget(closestCell);selectHandler(tableElement,tableElement.dragOrigin,tableElement.dragCurrentCell,tableElement.dragMode);}}else{tableElement.dragAllowed=false;tableElement.selectionPreviousOrigin=tableElement.dragOrigin;tableElement.selectionPreviousSelectedCells=tableElement.selectionSelectedCells;}});tableElement.addEventListener(evt.mouseup,function(event){tableElement.dragAllowed=false;if(tableElement.dragMode==='select'){tableElement.selectionPreviousOrigin=tableElement.dragOrigin;tableElement.selectionPreviousSelectedCells=tableElement.selectionSelectedCells;}});}
copyElement=document.createElement('input');copyElement.value='Firefox compatibility input';copyElement.setAttribute('gs-dynamic','');copyElement.setAttribute('style','position: fixed; left: 50%; top: 50%; z-index: -5000; opacity: 0.00000001;');tableElement.appendChild(copyElement);tableElement.tabIndex=0;tableElement.addEventListener('focus',function(event){if(document.activeElement===tableElement){tableElement.focus();GS.setInputSelection(copyElement,0,'Firefox compatibility input'.length);}});document.body.addEventListener('copy',function(event){var elementClosestTable=GS.findParentTag(document.activeElement,'table'),strTextCopyString,strHTMLCopyString;if(elementClosestTable===tableElement&&(document.activeElement.value==='Firefox compatibility input'||document.activeElement.selectionStart===document.activeElement.selectionEnd)){GS.setInputSelection(document.activeElement,document.activeElement.value.length,document.activeElement.value.length);strTextCopyString=getSelectedCopyText(tableElement);strHTMLCopyString=getSelectedCopyHTML(tableElement);if(strTextCopyString&&strHTMLCopyString){if(handleClipboardData(event,strTextCopyString,'text')){event.preventDefault(event);}
if(handleClipboardData(event,strHTMLCopyString,'html')){event.preventDefault(event);}}
GS.setInputSelection(document.activeElement,0,document.activeElement.value.length);}});};})();window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.qryFromJSON','GS.qryFromJSON','GS.qryFromJSON(${0:jsnObjectToConvert});');registerDesignSnippet('GS.qryToJSON','GS.qryToJSON','GS.qryToJSON(${0:strQueryStringToConvert});');registerDesignSnippet('GS.qryToWhere','GS.qryToWhere','GS.qryToWhere(${1:strQueryString}, ${2:strColumnNameInQueryString}, ${0:strColumnNameInTarget});');registerDesignSnippet('GS.qryGetKeys','GS.qryGetKeys','GS.qryGetKeys(${0:queryString});');registerDesignSnippet('GS.qryGetVals','GS.qryGetVals','GS.qryGetVals(${0:queryString});');registerDesignSnippet('GS.qryGetVal','GS.qryGetVal','GS.qryGetVal(${1:queryString}, \'${0:keyToGet}\');');registerDesignSnippet('GS.qrySetVal','GS.qrySetVal','GS.qrySetVal(${1:queryString}, \'${0:newKeyValuePair}\');');registerDesignSnippet('GS.qryDeleteKey','GS.qryDeleteKey','GS.qryDeleteKey(${1:queryString}, \'${0:keyToDelete}\');');registerDesignSnippet('GS.getQueryString','GS.getQueryString','GS.getQueryString();');registerDesignSnippet('GS.pushQueryString','GS.pushQueryString','GS.pushQueryString(${0:newQueryString});');registerDesignSnippet('GS.removeFromQueryString','GS.removeFromQueryString','GS.removeFromQueryString(${0:removeKeys});');});GS.qryFromJSON=function(jsnToConvert){'use strict';var key,strRet='',strType,currentValue;for(key in jsnToConvert){currentValue=jsnToConvert[key];strType=typeof currentValue;if(strType==='number'||strType==='string'||strType==='boolean'){strRet+=(strRet===''?'':'&')+key+'='+encodeURIComponent(jsnToConvert[key]);}else if(currentValue===null||currentValue===undefined){strRet+=(strRet===''?'':'&')+key+'=';}else if(typeof currentValue!=='object'){throw'GS.qryFromJSON Error: Invalid value: '+JSON.stringify(currentValue);}}
return strRet;};GS.qryToJSON=function(strQueryString){'use strict';var arrKeyValueList=[],jsnQueryString={},strKeyValue,i,len,strKey,strValue,jsnNavigator,arrSubParts,sub_i,sub_len;if(strQueryString){arrKeyValueList=strQueryString.split('&');for(i=0,len=arrKeyValueList.length;i<len;i+=1){strKeyValue=arrKeyValueList[i];strKey=strKeyValue.substring(0,strKeyValue.indexOf('='));strValue=decodeURIComponent(strKeyValue.substring(strKeyValue.indexOf('=')+1));jsnQueryString[strKey]=strValue;if(strKey.indexOf('.')>-1){arrSubParts=strKey.split('.');jsnNavigator=jsnQueryString;for(sub_i=0,sub_len=arrSubParts.length;sub_i<sub_len;sub_i+=1){if(sub_i<sub_len-1){jsnNavigator[arrSubParts[sub_i]]=jsnNavigator[arrSubParts[sub_i]]||{};}else{jsnNavigator[arrSubParts[sub_i]]=jsnNavigator[arrSubParts[sub_i]]||strValue;}
jsnNavigator=jsnNavigator[arrSubParts[sub_i]];}}}}
return jsnQueryString;};GS.qryToWhere=function(strQS,strColumnNameInQS,strColumnNameInTarget){'use strict';var strWhere='',key,jsnArgs;if(strColumnNameInQS){strColumnNameInTarget=(strColumnNameInTarget||strColumnNameInQS);if(!isNaN(GS.qryGetVal(strQS,strColumnNameInQS))){strWhere=strColumnNameInTarget+'='+GS.qryGetVal(strQS,strColumnNameInQS);}else{strWhere='CAST('+strColumnNameInTarget+' AS '+GS.database.type.text+') = '+'CAST($WhereQUOTE$'+
encodeURIComponent(GS.qryGetVal(strQS,strColumnNameInQS))+'$WhereQUOTE$ AS '+GS.database.type.text+')';}}else{jsnArgs=GS.qryToJSON(strQS);for(key in jsnArgs){if(jsnArgs.hasOwnProperty(key)){if(!isNaN(jsnArgs[key])){strWhere+=(strWhere===''?'':' AND ')+key+'='+jsnArgs[key];}else{strWhere+=(strWhere===''?'':' AND ')+'CAST('+key+' AS '+GS.database.type.text+') = '+'CAST($WhereQUOTE$'+encodeURIComponent(jsnArgs[key])+'$WhereQUOTE$ AS '+GS.database.type.text+')';}}}}
return strWhere;};GS.qryGetKeys=function(strQueryString){'use strict';var arrKeyValueList=[],arrKeys=[],i,len,strKeyValue;if(strQueryString){arrKeyValueList=strQueryString.split('&');for(i=0,len=arrKeyValueList.length;i<len;i+=1){strKeyValue=arrKeyValueList[i];arrKeys.push(strKeyValue.substring(0,strKeyValue.indexOf('=')));}}
return arrKeys;};GS.qryGetVals=function(strQueryString){'use strict';var arrKeyValueList=[],arrValues=[],i,len,strKeyValue;if(strQueryString){arrKeyValueList=strQueryString.split('&');for(i=0,len=arrKeyValueList.length;i<len;i+=1){strKeyValue=arrKeyValueList[i];arrValues.push(decodeURIComponent(strKeyValue.substring(strKeyValue.indexOf('=')+1)));}}
return arrValues;};GS.qryGetVal=function(strQueryString,strKey){'use strict';var arrKeyValueList,strSlice,i,len;if(strQueryString){arrKeyValueList=strQueryString.split('&');for(i=0,len=arrKeyValueList.length;i<len;i=i+1){strSlice=arrKeyValueList[i];if(strSlice.split('=')[0]===strKey){return decodeURIComponent(strSlice.substring(strSlice.indexOf('=')+1));}}}
return'';};GS.qrySetVal=function(strQueryString,strKeyValue){'use strict';strQueryString=GS.qryDeleteKey(strQueryString,strKeyValue.split('=')[0]);strQueryString=strQueryString+(strQueryString?'&':'')+strKeyValue;return strQueryString;};GS.qryDeleteKey=function(strQueryString,strKey){'use strict';var arrKeyValueList,strSlice,i,len;if(strQueryString){arrKeyValueList=strQueryString.split('&');for(i=0,len=arrKeyValueList.length;i<len;i=i+1){strSlice=arrKeyValueList[i];if(strSlice.split('=')[0]===strKey){arrKeyValueList.splice(i,1);break;}}
return arrKeyValueList.join('&');}
return'';};GS.getQueryString=function(){'use strict';return window.location.search.substring(1);};GS.pushQueryString=function(QS){var arrNewQS=QS.split('&'),i,len,newQS=GS.getQueryString();for(i=0,len=arrNewQS.length;i<len;i+=1){newQS=GS.qrySetVal(newQS,arrNewQS[i]);}
GS.pushState({},'','?'+newQS);};GS.removeFromQueryString=function(keys){var arrRemoveKeys=keys.split(','),i,len,newQS=GS.getQueryString();for(i=0,len=arrRemoveKeys.length;i<len;i+=1){newQS=GS.qryDeleteKey(newQS,arrRemoveKeys[i]);}
GS.pushState({},'','?'+newQS);};window.addEventListener('design-register-element',function(){'use strict';});GS.templateColumnToValue=function(templateHTML){'use strict';var templateElementEncoded=document.createElement('template'),templateElementNonEncoded=document.createElement('template'),arrTemplateElementEncoded,arrTemplateElementNonEncoded,jsnTemplates={},arrColumnElement=[],templateHTMLEncoded,bolInCommand,i,len,strID;for(i=0,len=templateHTML.length,templateHTMLEncoded='',bolInCommand=false;i<len;i+=1){if(!bolInCommand&&templateHTML[i]==='{'&&templateHTML[i+1]==='{'){bolInCommand=true;i+=1;templateHTMLEncoded+='{{';}else if(bolInCommand&&templateHTML[i]==='}'&&templateHTML[i+1]==='}'){bolInCommand=false;i+=1;templateHTMLEncoded+='}}';}else if(!bolInCommand&&templateHTML[i]==='&'){templateHTMLEncoded+='&amp;';}else{templateHTMLEncoded+=templateHTML[i];}}
templateElementEncoded.innerHTML=templateHTMLEncoded;templateElementNonEncoded.innerHTML=templateHTML;arrTemplateElementEncoded=xtag.query(templateElementEncoded.content,'template');arrTemplateElementNonEncoded=xtag.query(templateElementNonEncoded.content,'template');i=0;while(arrTemplateElementEncoded.length>0&&i<500){if(arrTemplateElementNonEncoded[0].parentNode&&arrTemplateElementNonEncoded[0].parentNode.hasAttribute&&(arrTemplateElementNonEncoded[0].parentNode.hasAttribute('src')||arrTemplateElementNonEncoded[0].parentNode.hasAttribute('source'))){strID='UnIqUE_PLaCEh0LDER-'+GS.GUID()+'-UniQUE_PLaCEh0LdER';jsnTemplates[strID]=arrTemplateElementNonEncoded[0].outerHTML;arrTemplateElementEncoded[0].outerHTML=strID;}else{arrTemplateElementEncoded=arrTemplateElementEncoded.concat(xtag.query(arrTemplateElementEncoded[0].content,'template'));arrTemplateElementNonEncoded=arrTemplateElementNonEncoded.concat(xtag.query(arrTemplateElementNonEncoded[0].content,'template'));arrColumnElement=arrColumnElement.concat(xtag.query(arrTemplateElementEncoded[0].content,'[column]'));}
arrTemplateElementEncoded.splice(0,1);arrTemplateElementNonEncoded.splice(0,1);i+=1;}
arrColumnElement=arrColumnElement.concat(xtag.query(templateElementEncoded.content,'[column]'));for(i=0,len=arrColumnElement.length;i<len;i+=1){if(!arrColumnElement[i].hasAttribute('value')){arrColumnElement[i].setAttribute('value','{{! row.'+arrColumnElement[i].getAttribute('column')+' }}');}}
templateHTML=templateElementEncoded.innerHTML;for(strID in jsnTemplates){templateHTML=templateHTML.replace(new RegExp(strID,'g'),jsnTemplates[strID].replace(/\$/g,'$$$$'));}
return templateHTML;};GS.templateWithQuerystring=function(templateText){'use strict';var strWrapperTemplate='{{##def.snippet:\n'+'    {{ var qs = jo; }} {{# def.template }}\n'+'#}}\n'+'{{#def.snippet}}';return doT.template(strWrapperTemplate,null,{'template':templateText})(GS.qryToJSON(GS.getQueryString())).trim();};GS.templateHideSubTemplates=function(templateHTML,bolRecord){'use strict';var templateElement,strID,arrTemplates,i,len,jsnTemplates,strRet,strStart,strEnd;if(bolRecord){strStart='<table><tbody>';strEnd='</tbody></table>';templateHTML=(strStart+templateHTML+strEnd);}
templateElement=document.createElement('template');templateElement.innerHTML=templateHTML;i=0;arrTemplates=xtag.query(templateElement.content,'template');jsnTemplates={};while(arrTemplates.length>0&&i<100){if(arrTemplates[0].parentNode&&arrTemplates[0].parentNode.hasAttribute&&(arrTemplates[0].parentNode.hasAttribute('src')||arrTemplates[0].parentNode.hasAttribute('source'))){strID='UNIqUE_PLaCEhOLDER-'+GS.GUID()+'-UNiQUE_PLaCEhOLdER';jsnTemplates[strID]=arrTemplates[0].outerHTML;arrTemplates[0].outerHTML=strID;}else if(arrTemplates[0].content){arrTemplates.push.apply(arrTemplates,xtag.query(arrTemplates[0].content,'template'));}
arrTemplates.splice(0,1);i+=1;}
strRet=decodeHTML(templateElement.innerHTML);if(bolRecord){strRet=strRet.substring(strStart.length,strRet.length-strEnd.length);}
return{'templateHTML':strRet,'templateData':jsnTemplates}};GS.templateShowSubTemplates=function(strRet,jsnTemplate){'use strict';var strID;for(strID in jsnTemplate.templateData){strRet=strRet.replace(new RegExp(strID,'g'),jsnTemplate.templateData[strID].replace(/\$/g,'$$$$'));}
return strRet;};GS.templateWithEnvelopeData=function(templateHTML,data,i,len,rowNumberOffset){'use strict';return doT.template(ml(function(){/*
        {{##def.snippet:
            {{ var row, row_number, i, len, col_i, col_len
                 , qs = GS.qryToJSON(GS.getQueryString())
                 , rowNumberOffset = (jo.rowNumberOffset || 0);
            
            if (!isNaN(jo.i)) {
                i = jo.i;
                len = (jo.len === undefined || jo.len === null ? jo.i + 1 : jo.len);
                
            } else {
                i = 0;
                len = jo.data.dat.length;
            }
            
            for (; i < len; i += 1) {
                row = {};
                row_number = (i + 1) + rowNumberOffset;
                row.row_number = row_number;
                
                for (col_i = 0, col_len = jo.data.arr_column.length; col_i < col_len; col_i += 1) {
                    if (jo.data.dat[i][col_i] === undefined || jo.data.dat[i][col_i] === null) {
                        row[jo.data.arr_column[col_i]] = '';
                    } else {
                        row[jo.data.arr_column[col_i]] = jo.data.dat[i][col_i];
                    }
                } }}{{# def.record }}
            {{ } }}
        #}}
        {{#def.snippet}}*/ console.log;}),null,{"record":templateHTML})({'data':data,'i':i,'len':len,'rowNumberOffset':rowNumberOffset});};window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.userChangePassword','GS.userChangePassword','GS.userChangePassword();');registerDesignSnippet('GS.normalUserLogin','GS.normalUserLogin','GS.normalUserLogin(${0:loggedInCallback});');});(function(){function changePassword(strLink,strRank){var templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
            <gs-page>
                <gs-header><center><h3>Change {{RANK}} Password</h3></center></gs-header>
                <gs-body padded>
                    <div id="pword-error" style="color: #FF0000;"></div>
                    <label for="old-password">Old Password:</label>
                    <gs-text id="old-password" type="password"></gs-text>
                    <label for="new-password">New Password:</label>
                    <gs-text id="new-password" type="password"></gs-text>
                    <label for="new-password-confirm">Confirm New Password:</label>
                    <gs-text id="new-password-confirm" type="password"></gs-text>
                </gs-body>
                <gs-footer>
                    <gs-grid>
                        <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                        <gs-block><gs-button id="button-change-password" disabled>Change {{RANK}} Password</gs-button></gs-block>
                    </gs-grid>
                </gs-footer>
            </gs-page>
        */}).replace(/\{\{RANK\}\}/gim,strRank);GS.openDialog(templateElement,function(){var dialog=this,keydownHandler;keydownHandler=function(event){var intKeyCode=event.which||event.keyCode;if(intKeyCode===13&&document.getElementById('old-password').value&&document.getElementById('new-password').value&&document.getElementById('new-password-confirm').value){GS.triggerEvent(document.getElementById('button-change-password'),'click');}else{if(document.getElementById('old-password').value&&document.getElementById('new-password').value&&document.getElementById('new-password-confirm').value){document.getElementById('button-change-password').removeAttribute('disabled');}else{document.getElementById('button-change-password').setAttribute('disabled');}}};document.getElementById('old-password').addEventListener('keydown',keydownHandler);document.getElementById('new-password').addEventListener('keydown',keydownHandler);document.getElementById('new-password-confirm').addEventListener('keydown',keydownHandler);document.getElementById('button-change-password').addEventListener('click',function(){var newPassword,parameters;if(document.getElementById('new-password').value===document.getElementById('new-password-confirm').value){parameters='action=change_pw'+'&password_old='+encodeURIComponent(document.getElementById('old-password').value)+'&password_new='+encodeURIComponent(document.getElementById('new-password').value);document.getElementById('old-password').value='';document.getElementById('new-password').value='';document.getElementById('new-password-confirm').value='';GS.ajaxJSON(location.pathname.indexOf('/env/')===0?'/env/auth':'/postage/auth',parameters,function(data,error){if(!error){GS.pushMessage('Password Successfully Changed',1000);GS.closeDialog(dialog,'change');}else{document.getElementById('pword-error').textContent=data.error_text;}});}else{document.getElementById('pword-error').textContent='New Password Doesn\'t Match Confirm New Password.';}});});}
GS.userChangePassword=function(){changePassword('env','User');};})();GS.normalUserLogin=function(loggedInCallback,strOldError,strDefaultSubDomain){'use strict';GS.removeAllLoaders();if(!window.userLogin){window.userLogin=true;GS.ajaxJSON('/env/action_info','',function(data,error){var templateElement=document.createElement('template');if(!error&&data.dat){if(typeof loggedInCallback==='function'){loggedInCallback(data.dat,strDefaultSubDomain);}}else{templateElement.innerHTML=ml(function(){/*
                    <gs-page>
                        <gs-header><center><h3>Login</h3></center></gs-header>
                        <gs-body padded>
                            You are not currently logged in, please fill in the login form below.<br /><br />
                            <label for="normal-uname">Username:</label>
                            <gs-text id="normal-uname" autocapitalize="off" autocomplete="off" autocorrect="off"></gs-text>
                            <label for="normal-pword">Password:</label>
                            <gs-text id="normal-pword" type="password"></gs-text>
                            {{ERROR}}
                        </gs-body>
                        <gs-footer>
                            <gs-grid>
                                <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                                <gs-block><gs-button id="normal-login">Log In</gs-button></gs-block>
                            </gs-grid>
                        </gs-footer>
                    </gs-page>
                */}).replace('{{ERROR}}',(strOldError?'<br /><div style="color: #FF0000">'+strOldError+'</div>':''));if(GS.getCookie('greyspots_uname')){xtag.query(templateElement.content,'#normal-uname')[0].setAttribute('value',decodeURIComponent(GS.getCookie('greyspots_uname')));xtag.query(templateElement.content,'#normal-pword')[0].setAttribute('autofocus','');}else{xtag.query(templateElement.content,'#normal-uname')[0].setAttribute('autofocus','');}
GS.openDialog(templateElement,function(){var dialog=this;document.getElementById('normal-pword').addEventListener('keydown',function(event){var intKeyCode=event.which||event.keyCode;if(intKeyCode===13){GS.triggerEvent(document.getElementById('normal-login'),'click');}});document.getElementById('normal-login').addEventListener('click',function(){var strUserName=document.getElementById('normal-uname').value,strLink;if(document.getElementById('normal-pword').value){GS.addLoader('log-in','Logging In...');GS.ajaxJSON('/env/auth','action=login'+'&username='+encodeURIComponent(document.getElementById('normal-uname').value)+'&password='+encodeURIComponent(document.getElementById('normal-pword').value),function(data,error){GS.removeLoader('log-in');GS.closeDialog(dialog,'');window.userLogin=false;if(!error){GS.setCookie('greyspots_uname',strUserName,30);if(typeof loggedInCallback==='function'){if(window.location.hostname.substring(0,window.location.hostname.indexOf('.'))===strDefaultSubDomain){GS.normalUserLogin(loggedInCallback,'',strDefaultSubDomain);}else{loggedInCallback(data.dat,strDefaultSubDomain);}}}else{GS.normalUserLogin(loggedInCallback,data.error_text,strDefaultSubDomain);}});}});});}});}};(function(){'use strict';function encodeForTabDelimited(strValue){return strValue==='\\N'?strValue:strValue.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/\t/g,'\\t').replace(/^NULL$/g,'\\N');}
GS.bolPreventErrors=false;function webSocketConnectionErrorDialog(socket,addinText,retryCallback,cancelCallback){if(!document.getElementById('dialog-from-dialog-ws-conn-error')&&GS.bolPreventErrors===false){var templateElement=document.createElement('template');GS.removeAllLoaders();templateElement.setAttribute('id','dialog-ws-conn-error');templateElement.setAttribute('data-theme','error');templateElement.innerHTML=ml(function(){/*
                <gs-page>
                    <gs-header><center><h3>There was an error!</h3></center></gs-header>
                    <gs-body padded>
                        <pre style="white-space: pre-wrap;">
    There has been an error with the Database connection.{{ADDIN}}</pre>
                    </gs-body>
                    <gs-footer>
                        <gs-grid gutter reflow-at="420">
                            <gs-block><gs-button dialogclose>Try to reconnect</gs-button></gs-block>
                            <gs-block><gs-button dialogclose>Dismiss so I can copy my progress</gs-button></gs-block>
                        </gs-grid>
                    </gs-footer>
                </gs-page>
            */}).replace('{{ADDIN}}',(addinText?'\n\n'+addinText:''));GS.openDialog(templateElement,'',function(event,strAnswer){if(strAnswer==='Try to reconnect'){GS.closeSocket(GS.envSocket);GS.envSocket=GS.openSocket('env',socket.GSSessionID,socket.notifications);}else{GS.bolPreventErrors=true;}});}}
function webSocketNormalizeError(event){var i;var len;var arrLines;var arrLine;var strData;var jsnRet={'error_title':'','error_text':'','error_detail':'','error_hint':'','error_query':'','error_context':'','error_position':'','error_notice':'','original_data':event};event=event||{};jsnRet.error_text=event.reason||'';if(event.data){strData=event.data;if(strData.substring(0,strData.indexOf(' '))==='messageid'){strData=strData.substring(strData.indexOf('\n')+1);}
if(strData.substring(0,strData.indexOf(' '))==='responsenumber'){strData=strData.substring(strData.indexOf('\n')+1);}
if(strData.indexOf('FATAL\n')===0){strData=strData.substring(strData.indexOf('\n')+1);}
if(strData.indexOf('Query failed: ')===0){strData=strData.substring('Query failed: '.length);}
jsnRet.error_text=strData;arrLines=strData.trim().split('\n');for(i=0,len=arrLines.length;i<len;i+=1){arrLine=arrLines[i].split('\t');jsnRet[arrLine[0]]=GS.decodeFromTabDelimited(arrLine[1]||'');}}
if(event.code===1001){jsnRet.error_title='Going Away';jsnRet.error_hint='The server or client closed the connection because of server shutdown or navigating away from the page.';}else if(event.code===1002){jsnRet.error_title='Protocol';jsnRet.error_hint='The connection was closed because of error related to the protocol used.';}else if(event.code===1003){jsnRet.error_title='Unsupported Data';jsnRet.error_hint='The connection was closed because the data that was received was not it a supported format.';}else if(event.code===1005){jsnRet.error_title='No Status Received';jsnRet.error_hint='The connection was closed because it received an empty status.';}else if(event.code===1006){jsnRet.error_title='Abnormal Closure';jsnRet.error_hint='The connection was closed because of abnormal circumstances.';}else if(event.code===1007){jsnRet.error_title='Invalid Payload Data';jsnRet.error_hint='The connection was closed because the payload type did not match the defined message type.';}else if(event.code===1008){jsnRet.error_title='Policy Violation';jsnRet.error_hint='The connection was closed because policy governing this connection was violated.';}else if(event.code===1009){jsnRet.error_title='Message Too Big';jsnRet.error_hint='The connection was closed because the message was too long for it to proccess.';}else if(event.code===1010){jsnRet.error_title='Mandatory Extension';jsnRet.error_hint='The client closed the connection because the server was supposed to negotiate extension(s) but it did not.';}else if(event.code===1011){jsnRet.error_title='Internal Server';jsnRet.error_hint='The server closed the connection because it could not fulfill the request.';}else if(event.code===1015){jsnRet.error_title='TLS handshake';jsnRet.error_hint='The connection was closed because the handshake failed.';}
return jsnRet;}
function cleanErrorValue(strValue){strValue=strValue||'';if(strValue.indexOf('DB_exec failed:')!==-1){strValue=strValue.replace(/[.\s\S]*DB_exec\ failed:/mi,'');}
if(strValue.indexOf('Query failed:')!==-1){strValue=strValue.replace(/[.\s\S]*Query\ failed:/mi,'');}
if(strValue.indexOf('FATAL')!==-1){strValue=strValue.replace(/[.\s\S]*FATAL/mi,'');}
strValue=strValue.replace(/\\n/gi,'\n').replace(/\\t/gi,'\t').replace(/\[.*\]/gi,'').replace(/\([0-9]*\)/gi,'');return GS.trim(strValue.trim(),'"');}
function errorJSONToHTML(errorJSON){console.log(errorJSON);return'<pre style="word-break: break-all; white-space: pre-wrap;">'+
(errorJSON.error_title?'There was '+
(['A','E','I','O','U'].indexOf(errorJSON.error_title[0].toUpperCase())===-1?'a':'an')+' "'+encodeHTML(errorJSON.error_title)+'" error:':'There was an error:')+
(errorJSON.error_text?'<br /><br />'+encodeHTML(errorJSON.error_text):(errorJSON.error_hint?'<br /><br />HINT: '+encodeHTML(errorJSON.error_hint):'')+
(errorJSON.error_detail?'<br /><br />DETAIL: '+encodeHTML(errorJSON.error_detail):'')+
(errorJSON.error_query?'<br /><br />QUERY: '+encodeHTML(errorJSON.error_query):'')+
(errorJSON.error_position?'<br /><br />ERROR POSITION: '+encodeHTML(errorJSON.error_position):'')+
(errorJSON.error_context?'<br /><br />CONTEXT: '+encodeHTML(errorJSON.error_context):'')+
(errorJSON.error_notice?'<br /><br /><br />'+encodeHTML(errorJSON.error_notice):''))+'</pre>';}
GS.webSocketErrorDialog=function(jsnError,tryAgainCallback,cancelCallback){if(GS.bolPreventErrors===false){var templateElement=document.createElement('template'),strHTML,jsnErrorClean;jsnErrorClean={};jsnErrorClean.error_text=cleanErrorValue(jsnError.error_text);jsnErrorClean.error_hint=cleanErrorValue(jsnError.error_hint);jsnErrorClean.error_detail=cleanErrorValue(jsnError.error_detail);jsnErrorClean.error_query=cleanErrorValue(jsnError.error_query);jsnErrorClean.error_position=cleanErrorValue(jsnError.error_position);jsnErrorClean.error_context=cleanErrorValue(jsnError.error_context);jsnErrorClean.error_notice=cleanErrorValue(jsnError.error_notice);templateElement.setAttribute('data-theme','error');strHTML=ml(function(){/*
                <gs-page>
                    <gs-header><center><h3>There was an error!</h3></center></gs-header>
                    <gs-body padded>
                        {{HTML}}
                        <br />
                        <gs-button class="error-button-show-full-text">Show Full Error Text</gs-button>
                    </gs-body>
                    <gs-footer>{{BUTTONS}}</gs-footer>
                </gs-page>
            */}).replace('{{HTML}}',errorJSONToHTML(jsnErrorClean));var openFunction=function(){xtag.query(this,'.error-button-show-full-text')[0].addEventListener('click',function(){var templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                        <gs-page>
                            <gs-header><center><h3>Full Error Text</h3></center></gs-header>
                            <gs-body padded>
                                {{HTML}}
                            </gs-body>
                            <gs-footer><gs-button dialogclose>Done</gs-button></gs-footer>
                        </gs-page>
                    */}).replace('{{HTML}}',errorJSONToHTML(jsnError));GS.openDialog(templateElement);});};if(typeof tryAgainCallback==='function'){templateElement.innerHTML=strHTML.replace('{{BUTTONS}}','<gs-grid>'+'    <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>'+'    <gs-block><gs-button dialogclose listen-for-return>Try Again</gs-button></gs-block>'+'</gs-grid>');GS.openDialog(templateElement,openFunction,function(event,strAnswer){if(strAnswer==='Try Again'){tryAgainCallback(strAnswer);}else{if(typeof cancelCallback==='function'){cancelCallback(strAnswer);}}});}else{templateElement.innerHTML=strHTML.replace('{{BUTTONS}}','<gs-button dialogclose listen-for-return>Ok</gs-button>');GS.openDialog(templateElement,openFunction);}}};GS.websockets=new Array();GS.closeAllSockets=function(){var i,len=GS.websockets.length;for(i=0;i<len;i++){GS.closeSocket(GS.websockets[i]);}};var sequence=0,jsnMessages={},arrWaitingCalls=[];GS.openSocket=function(strLink,relinkSessionID,relinkSessionNotifications){var strLoc=window.location.toString(),intUrlStart=strLoc.indexOf('/postage/')+9,strConn=strLoc.substring(intUrlStart,strLoc.substring(intUrlStart).indexOf('/')+intUrlStart);var socket=new WebSocket((window.location.protocol.toLowerCase().indexOf('https')===0?'wss':'ws')+'://'+(window.location.host||window.location.hostname)+'/postage/'+strConn+'/'+strLink+
(relinkSessionID?'?sessionid='+relinkSessionID:''));GS.websockets.push(socket);if(relinkSessionID){socket.GSSessionID=relinkSessionID;socket.oldSessionID=relinkSessionID;}
if(relinkSessionNotifications){socket.notifications=relinkSessionNotifications;}else{socket.notifications=[];}
socket.onmessage=function(event){var message=event.data,messageID,responseNumber,key,strError,arrLines,i,len,jsnMessage,startFrom;if(typeof(message)==='object'){var buf=message;message=String.fromCharCode.apply(null,new Uint8Array(buf));}
if(message.indexOf('sessionid = ')===0){socket.GSSessionID=message.substring('sessionid = '.length,message.indexOf('\n'));GS.triggerEvent(window,'socket-connect');for(key in jsnMessages){jsnMessage=jsnMessages[key];if(jsnMessage&&(jsnMessage.session===socket.GSSessionID||jsnMessage.session===socket.oldSessionID)&&jsnMessage.bolFinished===false){jsnMessage.session=socket.GSSessionID;startFrom=1;for(i=0,len=jsnMessage.arrResponseNumbers.length;i<len;i+=1){if(startFrom!==jsnMessage.arrResponseNumbers[i]){break;}
startFrom+=1;}
GS.requestFromSocket(socket,'SEND FROM\t'+startFrom,'',jsnMessage.id);}}
for(i=0,len=arrWaitingCalls.length;i<len;i+=1){arrWaitingCalls[0]();arrWaitingCalls.splice(0,1);}}else{messageID=message.substring('messageid = '.length,message.indexOf('\n'));message=message.substring(message.indexOf('\n')+1);jsnMessage=jsnMessages[messageID];if(jsnMessage){arrLines=message.split('\n');if(message.indexOf('responsenumber = ')===-1||(message.indexOf('responsenumber = ')===0&&(arrLines[1]==='TRANSACTION COMPLETED'||arrLines[2]==='OK'))){jsnMessage.bolFinished=true;}
if(message.indexOf('responsenumber = ')===0){responseNumber=message.substring('responsenumber = '.length,message.indexOf('\n'));message=message.substring(message.indexOf('\n')+1);jsnMessage.arrResponseNumbers.push(parseInt(responseNumber,10));jsnMessage.arrResponses.push(message);GS.requestFromSocket(socket,'CONFIRM\t'+responseNumber,'',messageID);}
arrLines=message.split('\n');if(arrLines[0].indexOf('transactionid')===0&&arrLines[1]==='FATAL'){strError='error';message=message.substring(message.indexOf('\n')+1);message=message.substring(message.indexOf('\n')+1);message=arrLines[0]+'\n'+message;}else if(arrLines[0]==='FATAL'){strError='error';message=message.substring(message.indexOf('\n')+1);}
if(message==='TRANSACTION COMPLETED'){jsnMessage.arrResponseNumbers=[];jsnMessage.arrResponses=[];jsnMessage.bolFinished=true;}
if(strError){jsnMessage.bolFinished=true;jsnMessage.callback.apply(null,[message,strError,webSocketNormalizeError(event)]);}else{jsnMessage.callback.apply(null,[message]);}
if(jsnMessage.bolFinished===true){delete jsnMessages[messageID];}}else if(messageID==='NULL'){socket.notifications.push(message);GS.triggerEvent(window,'notification',{'socket':socket,'message':message});}}};socket.onopen=function(event){};socket.onerror=function(event){var i,len;console.log('SOCKET ERROR',event);socket.bolError=true;};socket.onclose=function(event){console.log('SOCKET CLOSING',socket.stayClosed,socket.bolError,event);if(socket.bolError&&arrWaitingCalls.length>0){if(event.code===1006){webSocketConnectionErrorDialog(socket,'The connection to the database has been closed. We cannot display the reasons for this closure because the browser does not give us access to those details, please check the server logs for the error details.');}else if(event.code===1002){webSocketConnectionErrorDialog(socket,'The connection to the database has been closed. Either the server or the browser has closed the connection because of a Websocket Protocol error.');}else if(event.code===1003){webSocketConnectionErrorDialog(socket,'The connection to the database has been closed. Either the server or the browser has closed the connection because of it was sent a data type it could not understand.');}else{webSocketConnectionErrorDialog(socket,'The connection to the database has been closed. The cause of this is unknown.');}}
if(!socket.stayClosed){setTimeout(function(){console.log('ATTEMPTING SOCKET RE-OPEN',socket);GS.triggerEvent(window,'socket-reconnect');GS.closeSocket(GS.envSocket);GS.envSocket=GS.openSocket('env',GS.envSocket.GSSessionID,GS.envSocket.notifications);},1000);}else{if(socket.bolError){console.log('SOCKET NOT RE-OPENING DUE TO ERROR');}else{console.log('SOCKET NOT RE-OPENING DUE TO MANUAL CLOSE');}}};return socket;};GS.requestFromSocket=function(socket,strMessage,callback,forceMessageID){var oldOnOpen,messageID;if(!socket||socket.readyState===socket.CLOSED){if(!GS.envSocket||GS.envSocket.readyState===socket.CLOSED){GS.envSocket=GS.openSocket('env');}
socket=GS.envSocket;}
if(socket.readyState===socket.OPEN&&socket.GSSessionID){if(!forceMessageID){sequence+=1;messageID=socket.GSSessionID+'_'+sequence;jsnMessages[messageID]={'id':messageID,'session':socket.GSSessionID,'callback':callback,'arrResponseNumbers':[],'arrResponses':[],'bolFinished':false};}else{messageID=forceMessageID;}
if(typeof(strMessage)==='object'){jsnMessages[messageID].parameters=new Blob(['messageid = '+messageID+'\n',strMessage],{type:'application/x-binary'});}else{jsnMessages[messageID].parameters='messageid = '+messageID+'\n'+strMessage;}
socket.send(jsnMessages[messageID].parameters);return messageID;}else if(socket.readyState===socket.CONNECTING||socket.readyState===socket.OPEN){arrWaitingCalls.push(function(){GS.requestFromSocket(socket,strMessage,callback);});}else if(socket.readyState===socket.CLOSED){callback.apply(null,['Socket Is Closed','error',webSocketNormalizeError({'reason':'Socket Is Closed'})]);}else if(socket.readyState===socket.CLOSING){callback.apply(null,['Socket Is Closing','error',webSocketNormalizeError({'reason':'Socket Is Closing'})]);}};GS.requestActionFromSocket=function(socket,strSchema,strObject,strArgs,finalCallback){var strMessage='ACTION\t'+encodeForTabDelimited(strSchema)+'\t'+encodeForTabDelimited(strObject)+'\t'+encodeForTabDelimited(strArgs)+'\n',intResponse=0,strRet;GS.requestFromSocket(socket,strMessage,function(data,error,errorData){var arrLines,i,len;if(!error){if(intResponse===0){strRet=data;}else{finalCallback(strRet,error);}}else{finalCallback(errorData,error);}
intResponse+=1;});};GS.requestRawFromSocket=function(socket,strQuery,callback,bolAutocommit){var intResponsePart=0,intQueryNumber=0,intCallbackNumber=0,intCallbackNumberThisQuery=0,intResponseNumberThisQuery=0,arrMessages,arrColumnNames,arrColumnTypes,arrStart,dteStart,arrEnd,dteEnd,intRows;return GS.requestFromSocket(socket,'RAW'+(bolAutocommit?'\tAUTOCOMMIT\n':'\n')+strQuery,function(data,error,errorData){var arrRecords,arrLines,i,len,strMode;if(!error){if(intResponseNumberThisQuery===0){strQuery='';arrMessages=[];arrColumnNames=[];arrColumnTypes=[];}
if(data.indexOf('QUERY\n')===0){intResponsePart=0;intCallbackNumberThisQuery=0;}
if(data.indexOf('Rows Affected\n')===0||data==='EMPTY'||data==='TRANSACTION COMPLETED'){intResponsePart+=1;}
if(intResponsePart===0){arrLines=data.split('\n');for(i=0,len=arrLines.length;i<len;i+=1){if(arrLines[i].indexOf('QUERY\t')===0||arrLines[i].indexOf('START\t')===0||arrLines[i].indexOf('END\t')===0||arrLines[i].indexOf('ROWS\t')===0||arrLines[i].indexOf('DEBUG\t')===0||arrLines[i].indexOf('LOG\t')===0||arrLines[i].indexOf('INFO\t')===0||arrLines[i].indexOf('NOTICE\t')===0||arrLines[i].indexOf('WARNING\t')===0||arrLines[i]==='COLUMNS'){if(arrLines[i]==='COLUMNS'){strMode=arrLines[i];}else{strMode=arrLines[i].substring(0,arrLines[i].indexOf('\t'));}}
if(strMode==='QUERY'){strQuery=GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1));}else if(strMode==='START'){arrStart=GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1)).split('\t');dteStart=new Date(arrStart[0]+' '+arrStart[1]+' GMT');if(arrStart[2]){dteStart.setMilliseconds(parseInt(arrStart[2],10)/1000);}}else if(strMode==='END'){arrEnd=GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1)).split('\t');dteEnd=new Date(arrEnd[0]+' '+arrEnd[1]+' GMT');if(arrEnd[2]){dteEnd.setMilliseconds(parseInt(arrEnd[2],10)/1000);}}else if(strMode==='ROWS'){intRows=parseInt(GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1)),10);}else if(strMode==='DEBUG'){arrMessages.push({'level':'DEBUG','content':GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1).replace(/\\n$/,''))});}else if(strMode==='LOG'){arrMessages.push({'level':'LOG','content':GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1).replace(/\\n$/,''))});}else if(strMode==='INFO'){arrMessages.push({'level':'INFO','content':GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1).replace(/\\n$/,''))});}else if(strMode==='NOTICE'){arrMessages.push({'level':'NOTICE','content':GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1).replace(/\\n$/,''))});}else if(strMode==='WARNING'){arrMessages.push({'level':'WARNING','content':GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1).replace(/\\n$/,''))});}else if(strMode==='COLUMNS'){arrColumnNames=arrLines[i+1].split('\t');arrColumnTypes=arrLines[i+2].split('\t');intResponsePart+=1;break;}}}else if(intResponsePart>=1){if(typeof callback==='function'){callback({'intQueryNumber':intQueryNumber,'intCallbackNumber':intCallbackNumber,'intCallbackNumberThisQuery':intCallbackNumberThisQuery,'strQuery':strQuery,'dteStart':dteStart,'dteEnd':dteEnd,'intRows':intRows,'arrMessages':arrMessages,'arrColumnNames':arrColumnNames,'arrColumnTypes':arrColumnTypes,'strMessage':(data!=='TRANSACTION COMPLETED'?data:''),'bolLastMessage':(data==='TRANSACTION COMPLETED')},error);intCallbackNumber+=1;intCallbackNumberThisQuery+=1;}}
intResponseNumberThisQuery+=1;if(data==='\\.'||data.indexOf('Rows Affected\n')===0){intQueryNumber+=1;intCallbackNumberThisQuery=0;intResponsePart=0;intResponseNumberThisQuery=0;}}else{if(data.indexOf('QUERY\n')===0){intResponsePart=0;intCallbackNumberThisQuery=0;}
if(intResponsePart===0){arrLines=data.split('\n');for(i=0,len=arrLines.length;i<len;i+=1){if(arrLines[i].indexOf('QUERY\t')===0||arrLines[i].indexOf('START\t')===0||arrLines[i].indexOf('END\t')===0||arrLines[i].indexOf('ROWS\t')===0||arrLines[i].indexOf('DEBUG\t')===0||arrLines[i].indexOf('LOG\t')===0||arrLines[i].indexOf('INFO\t')===0||arrLines[i].indexOf('NOTICE\t')===0||arrLines[i].indexOf('WARNING\t')===0||arrLines[i]==='COLUMNS'){if(arrLines[i]==='COLUMNS'){strMode=arrLines[i];}else{strMode=arrLines[i].substring(0,arrLines[i].indexOf('\t'));}}
if(strMode==='QUERY'){strQuery=GS.decodeFromTabDelimited(arrLines[i].substring(arrLines[i].indexOf('\t')+1));}else if(strMode==='COLUMNS'){break;}}}
errorData.strQuery=strQuery;errorData.arrMessages=arrMessages
if(typeof callback==='function'){callback(errorData,error);}}});};GS.requestSelectFromSocket=function(socket,strSchema,strObject,strReturnCols,strWhere,strOrd,strLimit,strOffset,finalCallback){var strMessage='SELECT\t'+encodeForTabDelimited(strSchema)+'\t'+encodeForTabDelimited(strObject)+'\nRETURN\t'+strReturnCols+'\n\n'+'where\t'+(strOrd?'order by\t':'')+'limit\toffset\n'+
encodeForTabDelimited(strWhere||'1=1')+'\t'+(strOrd?encodeForTabDelimited(strOrd)+'\t':'')+
encodeForTabDelimited(strLimit||'ALL')+'\t'+encodeForTabDelimited(strOffset||'0'),intResponse=0,intCallback=0,arrColumnNames,arrColumnTypes,arrDecodedColumnNames,arrDecodedColumnTypes;GS.requestFromSocket(socket,strMessage,function(data,error,errorData){var arrLines,i,len;if(!error){if(intResponse===0){arrLines=data.split('\n');arrColumnNames=arrLines[0].split('\t');arrColumnTypes=arrLines[1].split('\t');arrDecodedColumnNames=[];arrDecodedColumnTypes=[];for(i=0,len=arrColumnNames.length;i<len;i+=1){arrDecodedColumnNames.push(GS.decodeFromTabDelimited(arrColumnNames[i]));}
for(i=0,len=arrColumnTypes.length;i<len;i+=1){arrDecodedColumnTypes.push(GS.decodeFromTabDelimited(arrColumnTypes[i]));}}else{finalCallback({'arrColumnNames':arrColumnNames,'arrColumnTypes':arrColumnTypes,'arrDecodedColumnNames':arrDecodedColumnNames,'arrDecodedColumnTypes':arrDecodedColumnTypes,'intCallback':intCallback,'strMessage':data},error);intCallback+=1;}}else{finalCallback(errorData,error);}
intResponse+=1;});};GS.requestArbitrarySelectFromSocket=function(socket,strSQL,strWhere,strOrd,strLimit,strOffset,finalCallback){var strMessage=('SELECT\t'+encodeForTabDelimited(strSQL)+'\nRETURN\t*\n\n'+'where\t'+
(strOrd?'order by\t':'')+'limit\t'+'offset\n'+
encodeForTabDelimited(strWhere||'1=1')+'\t'+
(strOrd?encodeForTabDelimited(strOrd)+'\t':'')+
encodeForTabDelimited(strLimit||'ALL')+'\t'+
encodeForTabDelimited(strOffset||'0'));var intResponse=0;var intCallback=0;var arrColumnNames;var arrColumnTypes;var arrDecodedColumnNames;var arrDecodedColumnTypes;GS.requestFromSocket(socket,strMessage,function(data,error,errorData){var arrLines,i,len;if(!error){if(intResponse===0){arrLines=data.split('\n');arrColumnNames=arrLines[0].split('\t');arrColumnTypes=arrLines[1].split('\t');arrDecodedColumnNames=[];arrDecodedColumnTypes=[];for(i=0,len=arrColumnNames.length;i<len;i+=1){arrDecodedColumnNames.push(GS.decodeFromTabDelimited(arrColumnNames[i]));}
for(i=0,len=arrColumnTypes.length;i<len;i+=1){arrDecodedColumnTypes.push(GS.decodeFromTabDelimited(arrColumnTypes[i]));}}else{finalCallback({'arrColumnNames':arrColumnNames,'arrColumnTypes':arrColumnTypes,'arrDecodedColumnNames':arrDecodedColumnNames,'arrDecodedColumnTypes':arrDecodedColumnTypes,'intCallback':intCallback,'strMessage':data},error);intCallback+=1;}}else{finalCallback(errorData,error);}
intResponse+=1;});};/*
        INSERT test rmultiple_pk_test
        RETURN id1 id2 id3 page_name_pk id4 test1 test2 test3
        PK id1 id2 id3 page_name_pk id4
        SEQ test.seq1 test.seq2   
        
        page_name_pk test1 test2 test3
        page_name_pk1 test1 test2 test3
        page_name_pk2 test1 test2 test3
        page_name_pk3 test1 test2 test3
        page_name_pk4 test1 test2 test3
        
        
        
        If a column is being inserted, then the SEQ entry for it needs to be empty
    */
GS.requestInsertFromSocket=function(socket,strSchema,strObject,strReturnCols,strPkCols,strSeqCols,insertData,beginCallback,confirmCallback,finalCallback){var strMessage='INSERT\t'+encodeForTabDelimited(strSchema)+'\t'+encodeForTabDelimited(strObject)+'\nRETURN\t'+strReturnCols+
(strPkCols?'\nPK\t'+strPkCols:'')+
(strPkCols?'\nSEQ\t'+strSeqCols:'')+'\n\n'+insertData;GS.requestBegin(socket,function(data,error){var transactionID;if(!error){transactionID=data;if(typeof beginCallback==='function'){beginCallback(data,error);}
GS.requestFromSocket(GS.envSocket,'transactionid = '+transactionID+'\n'+strMessage,function(data,error,errorData){var commitFunction,rollbackFunction;if(!error){data=data.substring(data.indexOf('\n')+1);}
console.log('INSERT DATA:',data);console.log('INSERT TRANSID:',transactionID);commitFunction=function(){GS.requestCommit(socket,transactionID,function(data,error){if(!error){data=data.substring(data.indexOf('\n')+1);}
finalCallback('COMMIT',data,error);});};rollbackFunction=function(){GS.requestRollback(socket,transactionID,function(data,error){if(!error){data=data.substring(data.indexOf('\n')+1);}
finalCallback('ROLLBACK',data,error);});};if(!error){confirmCallback(data,error,transactionID,commitFunction,rollbackFunction);}else{confirmCallback(errorData,error,transactionID,commitFunction,rollbackFunction);}});}else{if(typeof beginCallback==='function'){beginCallback(data,error);}}});};GS.requestUpdateFromSocket=function(socket,strSchema,strObject,strReturnCols,strHashCols,updateData,beginCallback,confirmCallback,finalCallback){var strMessage='UPDATE\t'+encodeForTabDelimited(strSchema)+'\t'+encodeForTabDelimited(strObject)+'\nRETURN\t'+strReturnCols+
(strHashCols?'\nHASH\t'+strHashCols:'')+'\n\n'+updateData;GS.requestBegin(socket,function(data,error){var transactionID;if(!error){transactionID=data;if(typeof beginCallback==='function'){beginCallback(data,error);}
GS.requestFromSocket(GS.envSocket,'transactionid = '+transactionID+'\n'+strMessage,function(data,error,errorData){var commitFunction,rollbackFunction;if(!error){data=data.substring(data.indexOf('\n')+1);}
commitFunction=function(){GS.requestCommit(socket,transactionID,function(data,error){if(!error){data=data.substring(data.indexOf('\n')+1);}
finalCallback('COMMIT',data,error);});};rollbackFunction=function(){GS.requestRollback(socket,transactionID,function(data,error){if(!error){data=data.substring(data.indexOf('\n')+1);}
finalCallback('ROLLBACK',data,error);});};if(!error){confirmCallback(data,error,transactionID,commitFunction,rollbackFunction);}else{confirmCallback(errorData,error,transactionID,commitFunction,rollbackFunction);}});}else{if(typeof beginCallback==='function'){beginCallback(data,error);}}});};GS.requestDeleteFromSocket=function(socket,strSchema,strObject,strHashCols,deleteData,beginCallback,confirmCallback,finalCallback){var strMessage='DELETE\t'+encodeForTabDelimited(strSchema)+'\t'+encodeForTabDelimited(strObject)+
(strHashCols?'\nHASH\t'+strHashCols:'')+'\n\n'+
deleteData;GS.requestBegin(socket,function(data,error){var transactionID;if(!error){transactionID=data;if(typeof beginCallback==='function'){beginCallback(data,error);}
GS.requestFromSocket(GS.envSocket,'transactionid = '+transactionID+'\n'+strMessage,function(data,error,errorData){var commitFunction,rollbackFunction;if(!error){data=data.substring(data.indexOf('\n')+1);}
commitFunction=function(){GS.requestCommit(socket,transactionID,function(data,error){if(!error){data=data.substring(data.indexOf('\n')+1);}
finalCallback('COMMIT',data,error);});};rollbackFunction=function(){GS.requestRollback(socket,transactionID,function(data,error){if(!error){data=data.substring(data.indexOf('\n')+1);}
finalCallback('ROLLBACK',data,error);});};if(!error){confirmCallback(data,error,transactionID,commitFunction,rollbackFunction);}else{confirmCallback(errorData,error,transactionID,commitFunction,rollbackFunction);}});}else{if(typeof beginCallback==='function'){beginCallback(data,error);}}});};GS.requestBegin=function(socket,callback){GS.requestFromSocket(GS.envSocket,'BEGIN',function(data,error,errorData){var transactionID;if(typeof callback==='function'){if(!error){transactionID=data.substring('transactionid = '.length,data.indexOf('\n'));callback(transactionID,error);}else{callback(errorData,error);}}});};GS.requestRollback=function(socket,transactionID,callback){GS.requestFromSocket(GS.envSocket,'transactionid = '+transactionID+'\nROLLBACK',function(data,error,errorData){if(typeof callback==='function'){if(!error){callback(data,error);}else{callback(errorData,error);}}});};GS.requestCommit=function(socket,transactionID,callback){GS.requestFromSocket(GS.envSocket,'transactionid = '+transactionID+'\nCOMMIT',function(data,error,errorData){if(typeof callback==='function'){if(!error){callback(data,error);}else{callback(errorData,error);}}});};GS.rebootSocket=function(socket){socket.stayClosed=false;socket.close();};GS.closeSocket=function(socket){socket.stayClosed=true;socket.close();};var cacheLedger=[];window.testtesttest=cacheLedger;GS.requestCachingSelect=function(socket,strSchema,strObject,strColumns,strWhere,strOrd,strLimit,strOffset,callback,bolClearCache){var strKey=(strSchema+strObject+strColumns+strWhere+strOrd+strLimit+strOffset),intQueryIndex,i,len,currentEntry;console.log(strKey,bolClearCache,cacheLedger[strKey]);if(bolClearCache){cacheLedger[strKey]=null;}
if(cacheLedger[strKey]){for(i=0,len=cacheLedger[strKey].results.length;i<len;i+=1){callback(cacheLedger[strKey].results[i][0],cacheLedger[strKey].results[i][1]);}
cacheLedger[strKey].callbacks.push({'callback':callback,'ready':true});}else{currentEntry=cacheLedger[strKey]={results:[],callbacks:[{'callback':callback,'ready':true}]};GS.requestSelectFromSocket(socket,strSchema,strObject,strColumns,strWhere,strOrd,strLimit,strOffset,function(data,error){var i,len;currentEntry.results.push([data,error]);for(i=0,len=currentEntry.callbacks.length;i<len;i+=1){if(currentEntry.callbacks[i].ready){currentEntry.callbacks[i].callback(data,error);}}});}};/*
    var cacheQueries = [], cacheCallbacks = [], cacheResults = [];
    GS.requestCachingSelect = function (socket, strSchema, strObject, strColumns, strWhere, strOrd, strLimit, strOffset, callback, bolClearCache) {
        var strKey = (strSchema + strObject + strColumns + strWhere + strOrd + strLimit + strOffset)
          , intQueryIndex, i, len;
        
        if (bolClearCache) {
            intQueryIndex = cacheQueries.indexOf(strKey);
            
            cacheQueries.splice(intQueryIndex, 1);
            cacheCallbacks.splice(intQueryIndex, 1);
            cacheResults.splice(intQueryIndex, 1);
        }
        
        intQueryIndex = cacheQueries.indexOf(strKey);
        
        if (intQueryIndex !== -1) {
            for (i = 0, len = cacheResults[intQueryIndex].length; i < len; i += 1) {
                callback(cacheResults[intQueryIndex][i][0], cacheResults[intQueryIndex][i][1]);
            }
            cacheCallbacks[intQueryIndex].push({'callback': callback, 'ready': true});
            
        } else {
            console.log(strKey);
            console.log(cacheQueries.length);
            cacheQueries.push(strKey);
            cacheCallbacks.push([{'callback': callback, 'ready': true}]);
            cacheResults.push([]);
            console.log(cacheQueries.length);
            intQueryIndex = (cacheQueries.length - 1);
            console.log(intQueryIndex);
            
            GS.requestSelectFromSocket(socket, strSchema, strObject, strColumns
                                     , strWhere, strOrd, strLimit, strOffset
                                     , function (data, error) {
                var i, len;
                
                cacheResults[intQueryIndex].push([data, error]);
                
                for (i = 0, len = cacheCallbacks[intQueryIndex].length; i < len; i += 1) {
                    if (cacheCallbacks[intQueryIndex][i].ready) {
                        cacheCallbacks[intQueryIndex][i].callback(data, error);
                    }
                }
            });
        }
    };*/})();GS.encodeForTabDelimited=function(strValue,nullValue){'use strict';strValue=String(strValue||'');if(strValue==='\\N'){return strValue;}else{strValue=strValue.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/\t/g,'\\t');if(strValue===nullValue){strValue='\\N';}
return strValue;}};GS.decodeFromTabDelimited=function(strValue,nullValue){'use strict';var i,len,strRet='';if(nullValue===undefined){nullValue='\\N';}
for(i=0,len=strValue.length;i<len;i+=1){if(strValue[i]==='\\'&&strValue[i+1]){i+=1;if(strValue[i]==='n'){strRet+='\n';}else if(strValue[i]==='r'){strRet+='\r';}else if(strValue[i]==='t'){strRet+='\t';}else if(strValue[i]==='N'){strRet+=nullValue;}else if(strValue[i]==='\\'){strRet+='\\';}else{strRet+='\\'+strValue[i];}}else{strRet+=strValue[i];}}
return strRet;};window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.rightPad','GS.rightPad','GS.rightPad(${1:stringToPad}, \'${2:stringToPadWith}\', ${0:lengthToPadTo});');registerDesignSnippet('GS.leftPad','GS.leftPad','GS.leftPad(${1:stringToPad}, \'${2:stringToPadWith}\', ${0:lengthToPadTo});');registerDesignSnippet('GS.pxToEm','GS.pxToEm','GS.pxToEm(${1:elementToTestIn}, ${0:pxToConvert});');registerDesignSnippet('GS.emToPx','GS.emToPx','GS.emToPx(${1:elementToTestIn}, ${0:emToConvert});');registerDesignSnippet('GS.keyCode','GS.keyCode','GS.keyCode(\'${0:characterToGetTheKeyCodeOf}\');');registerDesignSnippet('GS.charFromKeyCode','GS.charFromKeyCode','GS.charFromKeyCode(\'${0:eventObject}\');');registerDesignSnippet('GS.getStyle','GS.getStyle','GS.getStyle(${1:element}, \'${0:CSSProperty}\');');registerDesignSnippet('GS.listAdd','GS.listAdd','GS.listAdd(${1:arrayToAddTo}, \'${0:valueToAddIfUnique}\');');registerDesignSnippet('GS.triggerEvent','GS.triggerEvent','GS.triggerEvent(${1:target}, \'${2:eventName}\', ${0:jsnModifiers});');registerDesignSnippet('GS.strToTitle','GS.strToTitle','GS.strToTitle(${0:valueToConvert});');registerDesignSnippet('GS.mousePosition','GS.mousePosition','GS.mousePosition(${0:event});');registerDesignSnippet('GS.GUID','GS.GUID','GS.GUID();');registerDesignSnippet('GS.safeDecodeURIComponent','GS.safeDecodeURIComponent','GS.safeDecodeURIComponent(${0:valueToDecode});');registerDesignSnippet('GS.getTextHeight','GS.getTextHeight','GS.getTextHeight(${1:elementToTestIn}, ${0:bolNormalLineHeight});');registerDesignSnippet('GS.getTextWidth','GS.getTextWidth','GS.getTextWidth(${1:elementToTestIn}, ${0:strTextToGetTheWidthOf});');registerDesignSnippet('GS.scrollParent','GS.scrollParent','GS.scrollParent(${0:elementToStartFrom});');registerDesignSnippet('GS.scrollIntoView','GS.scrollIntoView','GS.scrollIntoView(${0:elementToScrollIntoView});');registerDesignSnippet('GS.envGetCell','GS.envGetCell','GS.envGetCell(${1:envelopeData}, ${2:recordNumber}, \'${0:columnName}\');');registerDesignSnippet('GS.trim','GS.trim','GS.trim(${1:stringToBeTrimmed}, \'${0:stringToTrimOff}\');');registerDesignSnippet('GS.setCookie','GS.setCookie','GS.setCookie(\'${1:cookieName}\', ${2:newValue}, ${0:daysUntilExpire});');registerDesignSnippet('GS.getCookie','GS.getCookie','GS.getCookie(\'${1:cookieName}\');');registerDesignSnippet('GS.pushState','GS.pushState','GS.pushState(${1:stateObj}, ${2:title}, ${0:newURL});');registerDesignSnippet('GS.replaceState','GS.replaceState','GS.replaceState(${1:stateObj}, ${2:title}, ${0:newURL});');registerDesignSnippet('GS.searchToWhere','GS.searchToWhere','GS.searchToWhere(\'${1:columns}\', ${0:searchClause});');registerDesignSnippet('GS.iconList','GS.iconList','GS.iconList();');registerDesignSnippet('GS.lorem','GS.lorem','GS.lorem();');registerDesignSnippet('GS.numberSuffix','GS.numberSuffix','GS.numberSuffix(${1:intNumber});');registerDesignSnippet('GS.hitLink','GS.hitLink','GS.hitLink(${1:strLink});');registerDesignSnippet('GS.log','GS.log','GS.log(\'${1:send}\', ${2:message});');});GS.hitLink=function(strLink){"use strict";var iframeElement;iframeElement=document.createElement('iframe');iframeElement.setAttribute('hidden','');iframeElement.addEventListener('load',function(){if(iframeElement.parentNode===document.body){document.body.removeChild(iframeElement);}});iframeElement.setAttribute("src",strLink);document.body.appendChild(iframeElement);};GS.log=function(bolsend,message){"use strict";if(bolsend){console.log(message);}};GS.numberSuffix=function(intNumber){'use strict';var strNumber=String(intNumber),jsnSuffixes={'0':'th','1':'st','2':'nd','3':'rd','4':'th','5':'th','6':'th','7':'th','8':'th','9':'th'};return strNumber+jsnSuffixes[strNumber[strNumber.length-1]];}
GS.rightPad=function(str,padString,padToLength){'use strict';str=String(str);while(str.length<padToLength){str+=padString;}
return str;};GS.leftPad=function(str,padString,padToLength){'use strict';str=String(str);while(str.length<padToLength){str=padString+str;}
return str;};GS.pxToEm=function(elementScope,fromPX){'use strict';var intPX=parseFloat(fromPX),heightTestElement=document.createElement('div'),intElementHeight;elementScope=elementScope||document.body;heightTestElement.style.fontSize='1em';heightTestElement.style.margin='0';heightTestElement.style.padding='0';heightTestElement.style.lineHeight='1';heightTestElement.style.border='0';heightTestElement.innerHTML='a';elementScope.appendChild(heightTestElement);intElementHeight=heightTestElement.offsetHeight;elementScope.removeChild(heightTestElement);return parseFloat((intPX/intElementHeight).toFixed(8),10);};GS.emToPx=function(elementScope,fromEM){'use strict';var intEM=parseFloat(fromEM),heightTestElement=document.createElement('div'),intElementHeight;elementScope=elementScope||document.body;heightTestElement.style.fontSize='1em';heightTestElement.style.margin='0';heightTestElement.style.padding='0';heightTestElement.style.lineHeight='1';heightTestElement.style.border='0';heightTestElement.innerHTML='a';elementScope.appendChild(heightTestElement);intElementHeight=heightTestElement.offsetHeight;elementScope.removeChild(heightTestElement);return Math.round(intEM*intElementHeight);};GS.charFromKeyCode=function(event){'use strict';var code=event.which;var ignoredCodes={16:true,37:true,38:true,39:true,40:true,20:true,17:true,18:true,91:true};if(ignoredCodes[code]===true){return false;}
var exceptions={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,96:'0'.charCodeAt(0),97:'1'.charCodeAt(0),98:'2'.charCodeAt(0),99:'3'.charCodeAt(0),100:'4'.charCodeAt(0),101:'5'.charCodeAt(0),102:'6'.charCodeAt(0),103:'7'.charCodeAt(0),104:'8'.charCodeAt(0),105:'9'.charCodeAt(0)};if(exceptions[code]!==undefined){code=exceptions[code];}
var ch=String.fromCharCode(code);if(event.shiftKey){var special={1:'!',2:'@',3:'#',4:'$',5:'%',6:'^',7:'&',8:'*',9:'(',0:')',',':'<','.':'>','/':'?',';':':',"'":'"','[':'{',']':'}','\\':'|','`':'~','-':'_','=':'+'};if(special[ch]!==undefined){ch=special[ch];}}else{ch=ch.toLowerCase();}
return ch;};GS.keyCode=function(inChar){"use strict";/*
 Key  Code
backspace  8
tab  9
enter  13
shift  16
ctrl  17
alt  18
pause/break  19
caps lock  20
escape  27
(space)  32
page up  33
page down  34
end  35
home  36
left arrow  37
up arrow  38
right arrow  39
down arrow  40
insert  45
delete  46
0  48
1  49
2  50
3  51
4  52
5  53
6  54
7  55
8  56
9  57
a  65
b  66
c  67
d  68

Key  Code
e  69
f  70
g  71
h  72
i  73
j  74
k  75
l  76
m  77
n  78
o  79
p  80
q  81
r  82
s  83
t  84
u  85
v  86
w  87
x  88
y  89
z  90
left window key  91
right window key  92
select key  93
numpad 0  96
numpad 1  97
numpad 2  98
numpad 3  99
numpad 4  100
numpad 5  101
numpad 6  102
numpad 7  103
*/
inChar=inChar.toLowerCase();return'\b'==inChar?'8':'backspace'==inChar?'8':'\t'==inChar?'9':'tab'==inChar?'9':'\r'==inChar?'13':'\n'==inChar?'13':'enter'==inChar?'13':'return'==inChar?'13':'newline'==inChar?'13':'shift'==inChar?'16':'ctrl'==inChar?'17':'alt'==inChar?'18':'pause/break'==inChar?'19':'caps lock'==inChar?'20':'escape'==inChar?'27':'space'==inChar?'32':' '==inChar?'32':'page up'==inChar?'33':'page down'==inChar?'34':'end'==inChar?'35':'home'==inChar?'36':'left arrow'==inChar?'37':'up arrow'==inChar?'38':'right arrow'==inChar?'39':'down arrow'==inChar?'40':'insert'==inChar?'45':'delete'==inChar?'46':'0'==inChar?'48':'1'==inChar?'49':'2'==inChar?'50':'3'==inChar?'51':'4'==inChar?'52':'5'==inChar?'53':'6'==inChar?'54':'7'==inChar?'55':'8'==inChar?'56':'9'==inChar?'57':'a'==inChar?'65':'b'==inChar?'66':'c'==inChar?'67':'d'==inChar?'68':'e'==inChar?'69':'f'==inChar?'70':'g'==inChar?'71':'h'==inChar?'72':'i'==inChar?'73':'j'==inChar?'74':'k'==inChar?'75':'l'==inChar?'76':'m'==inChar?'77':'n'==inChar?'78':'o'==inChar?'79':'p'==inChar?'80':'q'==inChar?'81':'r'==inChar?'82':'s'==inChar?'83':'t'==inChar?'84':'u'==inChar?'85':'v'==inChar?'86':'w'==inChar?'87':'x'==inChar?'88':'y'==inChar?'89':'z'==inChar?'90':'left window key'==inChar?'91':'right window key'==inChar?'92':'select key'==inChar?'93':'numpad 0'==inChar?'96':'numpad 1'==inChar?'97':'numpad 2'==inChar?'98':'numpad 3'==inChar?'99':'numpad 4'==inChar?'100':'numpad 5'==inChar?'101':'numpad 6'==inChar?'102':'numpad 7'==inChar?'103':'numpad 8'==inChar?'104':'numpad 9'==inChar?'105':'multiply'==inChar?'106':'add'==inChar?'107':'+'==inChar?'107':'subtract'==inChar?'109':'-'==inChar?'109':'decimal point'==inChar?'110':'divide'==inChar?'111':'f1'==inChar?'112':'f2'==inChar?'113':'f3'==inChar?'114':'f4'==inChar?'115':'f5'==inChar?'116':'f6'==inChar?'117':'f7'==inChar?'118':'f8'==inChar?'119':'f9'==inChar?'120':'f10'==inChar?'121':'f11'==inChar?'122':'f12'==inChar?'123':'num lock'==inChar?'144':'scroll lock'==inChar?'145':'semi-colon'==inChar?'186':';'==inChar?'186':'equal sign'==inChar?'187':'='==inChar?'187':'comma'==inChar?'188':','==inChar?'188':'dash'==inChar?'189':'-'==inChar?'189':'period'==inChar?'190':'.'==inChar?'190':'forward slash'==inChar?'191':'/'==inChar?'191':'grave accent'==inChar?'192':'open bracket'==inChar?'219':'['==inChar?'219':'back slash'==inChar?'220':'\\'==inChar?'220':'close bracket'==inChar?'221':']'==inChar?'221':'single quote'==inChar?'222':'\''==inChar?'222':'';/*
Key  Code
numpad 8  104
numpad 9  105
multiply  106
add  107
subtract  109
decimal point  110
divide  111
f1  112
f2  113
f3  114
f4  115
f5  116
f6  117
f7  118
f8  119
f9  120
f10  121
f11  122
f12  123
num lock  144
scroll lock  145
semi-colon  186
equal sign  187
comma  188
dash  189
period  190
forward slash  191
grave accent  192
open bracket  219
back slash  220
close braket  221
single quote  222
*/};GS.getStyle=function(element,style){if(element.currentStyle!==undefined){return element.currentStyle[style];}
return document.defaultView.getComputedStyle(element,null)[style];};GS.listAdd=function(arrArray,newValue){'use strict';if(arrArray.indexOf(newValue)===-1){arrArray.push(newValue);}};GS.triggerEvent=function(target,strEventName,jsnConfig){'use strict';var event,key;if(document.createEvent){event=document.createEvent('HTMLEvents');event.initEvent(strEventName,true,true);}else{event=document.createEventObject();event.eventType=strEventName;}
event.eventName=strEventName;if(jsnConfig){for(key in jsnConfig){event[key]=jsnConfig[key];}}
if(document.createEvent){target.dispatchEvent(event);}else{target.fireEvent("on"+event.eventType,event);}
return event;};GS.strToTitle=function(strInput){'use strict';var i,len,chrCurrent,chrLast='',strRet='';strInput=strInput||'';for(i=0,len=strInput.length;i<len;i+=1){chrCurrent=strInput.charAt(i);if(!(/[a-zA-Z]/).test(chrLast)){strRet+=chrCurrent.toUpperCase();}else if(chrCurrent==='_'){strRet+=' ';}else{strRet+=chrCurrent;}
chrLast=chrCurrent;}
return strRet;};GS.mousePosition=function(event){'use strict';var pageX=(evt.touchDevice?event.touches[0].pageX:event.pageX),pageY=(evt.touchDevice?event.touches[0].pageY:event.pageY);return{'top':pageY,'left':pageX,'bottom':window.innerHeight-pageY,'right':window.innerWidth-pageX,'x':pageX,'y':pageY};};GS.GUID=function(){var strTime=new Date().getTime().toString();function randomString(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return randomString()+randomString()+'-'+
randomString()+'-'+
randomString()+'-'+
randomString()+'-'+
strTime.substring(strTime.length-4)+'-'+
randomString()+randomString()+randomString();};/*  ,---- no longer works
//  V
GS.getSelectedText = function () {
    if (window.getSelection) {
        return window.getSelection() + '';
    }
    
    // FireFox
    if (document.getSelection) {
        return document.getSelection() + '';
    }
    
    // IE 6/7
    if (document.selection) {
        return document.selection.createRange().text + '';
    }
    
    console.warn('GS.getSelectedText warning: no selection collection function found (could not find a way to get the selected text)');
    return '';
}*/
GS.safeDecodeURIComponent=function(string){var strRet;try{strRet=decodeURIComponent(string);}catch(error){if(error.toString().indexOf('URI malformed')>-1){strRet=string;}else{throw error;}}
return strRet;};GS.getTextHeight=function(scope,bolNormalLineHeight){var divElement=document.createElement('div'),intHeight;scope=scope||document.body;divElement.style.visibility='invisible';divElement.style.fontSize='1em';divElement.style.margin='0';divElement.style.padding='0';divElement.style.lineHeight=(bolNormalLineHeight?'normal':'1');divElement.style.border='0';divElement.textContent='a';scope.appendChild(divElement);intHeight=divElement.clientHeight;scope.removeChild(divElement);return intHeight;};GS.getTextWidth=function(scope,strText,bolWhitePreserve){var divElement=document.createElement('div'),intWidth;scope=scope||document.body;divElement.style.display='inline-block';divElement.style.visibility='invisible';divElement.style.fontSize='1em';divElement.style.margin='0';divElement.style.padding='0';divElement.style.letterSpacing='inherit';divElement.style.border='0';divElement.style.whiteSpace=(bolWhitePreserve?'pre':'');divElement.textContent=strText;scope.appendChild(divElement);intWidth=divElement.clientWidth;scope.removeChild(divElement);return intWidth;};GS.scrollParent=function(element,strDirection){"use strict";var strDirectionText;if(strDirection){strDirectionText=strDirection;}else{strDirectionText='vertical';}
var i=0;var currentElement=element;var bolFoundScrollable=false;var strOverflow;if(currentElement){while(currentElement&&currentElement.nodeName!=='HTML'&&bolFoundScrollable===false&&i<75){strOverflow=GS.getStyle(currentElement,'overflow');if(strOverflow==='scroll'||(strOverflow==='auto'&&strDirectionText==='vertical'&&currentElement.clientHeight<currentElement.scrollHeight)||(strOverflow==='auto'&&strDirectionText==='horizontal'&&currentElement.clientWidth<currentElement.scrollWidth)){bolFoundScrollable=true;}else{currentElement=currentElement.parentNode;i+=1;}}
if(!currentElement||currentElement.nodeName==='HTML'){return document.body;}
return(bolFoundScrollable?currentElement:undefined);}
return undefined;}
GS.scrollIntoView=function(element,strDirection){var strDirectionText;if(strDirection){strDirectionText=strDirection;}else{strDirectionText='vertical';}
var scrollingContainer=GS.scrollParent(element,strDirectionText),arrSiblings,i,len,intScrollTop,intScrollLeft;if(scrollingContainer){if(strDirectionText==='horizontal'){arrSiblings=element.parentNode.children;for(i=0,intScrollLeft=0,len=arrSiblings.length;i<len;i+=1){if(arrSiblings[i]===element){intScrollLeft+=arrSiblings[i].offsetWidth/2;break;}else{intScrollLeft+=arrSiblings[i].offsetWidth;}}
intScrollLeft=intScrollLeft-(scrollingContainer.offsetWidth/2);scrollingContainer.scrollLeft=intScrollLeft;}else{arrSiblings=element.parentNode.children;for(i=0,intScrollTop=0,len=arrSiblings.length;i<len;i+=1){if(arrSiblings[i]===element){intScrollTop+=arrSiblings[i].offsetHeight/2;break;}else{intScrollTop+=arrSiblings[i].offsetHeight;}}
intScrollTop=intScrollTop-(scrollingContainer.offsetHeight/2);scrollingContainer.scrollTop=intScrollTop;}}};GS.envGetCell=function(data,record_number,column_name){'use strict';var index;if(data.stat){data=data.dat;}
index=data.arr_column.indexOf(column_name);if(index===-1){console.error(column_name,data);throw'Error in GS.envGetCell: column not found';}
return data.dat[record_number][index];};GS.trim=function(string,strStringToTrim){"use strict";var safeRegexString=strStringToTrim.replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1'),trimRegex=new RegExp('^'+safeRegexString+'+|'+safeRegexString+'+$','g');return string.replace(trimRegex,'');};GS.setCookie=function(c_name,value,exdays){'use strict';var exDayNum;if(!exdays){exDayNum=30;}else{exDayNum=exdays;}
var hostname=location.hostname;var exdate=new Date(),c_value;hostname=hostname.substring(hostname.indexOf('.'));exdate.setDate(exdate.getDate()+exDayNum);c_value=encodeURIComponent(value)+((exDayNum===null||exDayNum===undefined)?'':'; expires='+exdate.toUTCString())+'; domain='+hostname+'; path=/';document.cookie=c_name+'='+c_value;};GS.getCookie=function(c_name){'use strict';var c_value=document.cookie,c_end,c_start=c_value.indexOf(" "+c_name+"=");if(c_start===-1){c_start=c_value.indexOf(c_name+"=");}
if(c_start===-1){c_value=null;}else{c_start=c_value.indexOf("=",c_start)+1;c_end=c_value.indexOf(";",c_start);if(c_end===-1){c_end=c_value.length;}
c_value=decodeURIComponent(c_value.substring(c_start,c_end));}
return c_value;};GS.pushState=function(stateObj,title,url){history.pushState(stateObj,title,url);GS.triggerEvent(window,'pushstate');};GS.replaceState=function(stateObj,title,url){history.replaceState(stateObj,title,url);GS.triggerEvent(window,'replacestate');};GS.searchToWhere=function(columns,searchClause){var arrToken,arrNoQuotes=[],strNoQuotes='',arrColumn,arrRequired=[],strRequired='',arrWhere=[],strWhere='',strRet='',token,numTokens,col,numCols,i,len,strSearch;if(!searchClause){return'1=1';}
arrColumn=columns.split(',');arrToken=searchClause.match(/[\+|\-]?"[^"]*?"/g);if(arrToken){for(token=0,numTokens=arrToken.length;token<numTokens;token+=1){arrToken[token]=GS.trim(arrToken[token],'+');for(col=0,numCols=arrColumn.length;col<numCols;col+=1){if(arrToken[token][0]==='-'){arrToken[token]=GS.trim(arrToken[token],'-');arrRequired[token]=(arrRequired[token]?arrRequired[token]+' AND ':'')+'CASE WHEN '+arrColumn[col]+' IS NOT NULL THEN '+arrColumn[col]+' NOT ILIKE \'%'+GS.trim(arrToken[token],'"')+'%\' ELSE TRUE END';arrToken[token]='-'+arrToken[token];}else{arrRequired[token]=(arrRequired[token]?arrRequired[token]+' OR ':'')+
(arrColumn[col]+' ILIKE \'%'+GS.trim(arrToken[token],'"')+'%\'');}}}
for(i=0,len=arrRequired.length;i<len;i+=1){strRequired=(strRequired?strRequired+' AND ':'')+'('+arrRequired[i]+')';}}
/*
    //NOT CROSS BROWSER
    arrNoQuotes = strSearch.split(/([\+|\-]?"[^"]*?")/);
    strNoQuotes = arrNoQuotes.join(' ');
    arrNoQuotes = strNoQuotes.split(/[ ]+/);
    */
strSearch=searchClause.trim();strSearch=strSearch.replace('-"','"');strSearch=strSearch.replace('+"','"');strSearch=strSearch.replace(/"[^"]*"/,'""');arrNoQuotes=strSearch.split('""');strNoQuotes=arrNoQuotes.join(' ');strNoQuotes=strNoQuotes.replace('  ',' ');strNoQuotes=strNoQuotes.replace('  ',' ');arrNoQuotes=strNoQuotes.split(' ');/*
    //DIDN'T WORK
    strSearch = searchClause.trim();
    strSearch = strSearch.replace('-"', '"');
    strSearch = strSearch.replace('+"', '"');
    arrNoQuotes = strSearch.split('"');
    strSearch = '';
    if (searchClause.trim()[0] === '"') {
        for (i = 1, len = arrNoQuotes.length; i < len; i += 2) {
            strSearch = strSearch + (strSearch === '' ? '' : ' ') + arrNoQuotes[i].trim();
        }
    } else {
        for (i = 0, len = arrNoQuotes.length; i < len; i += 2) {
            strSearch = strSearch + (strSearch === '' ? '' : ' ') + arrNoQuotes[i].trim();
        }
    }
    //console.log(strSearch);
    strSearch = strSearch.replace('  ', ' ');
    strSearch = strSearch.replace('  ', ' ');
    arrNoQuotes = strSearch.split(' ');
    //console.log(arrNoQuotes);
    */
arrRequired=[''];if(arrNoQuotes.length>0){for(token=0,numTokens=arrNoQuotes.length;token<numTokens;token+=1){for(col=0,numCols=arrColumn.length;col<numCols;col+=1){if(arrNoQuotes[token].length>0){if(arrNoQuotes[token][0]==='-'){arrRequired[token]=(arrRequired[token]?arrRequired[token]+' AND ':'')+' CASE WHEN '+arrColumn[col]+' IS NOT NULL THEN '+arrColumn[col]+' NOT ILIKE $$%'+GS.trim(GS.trim(arrNoQuotes[token],'-'),' ')+'%$$ ELSE TRUE END ';}else if(arrNoQuotes[token][0]==='+'){arrRequired[token]=(arrRequired[token]?arrRequired[token]+' OR ':'')+
arrColumn[col]+' ILIKE $$%'+
GS.trim(GS.trim(arrNoQuotes[token],'+'),' ')+'%$$ ';}else{arrWhere[token]=(arrWhere[token]?arrWhere[token]+' OR ':'')+
arrColumn[col]+' ILIKE $$%'+GS.trim(arrNoQuotes[token],' ')+'%$$ ';}}}}}
if(arrRequired.length>0){for(i=0,len=arrRequired.length;i<len;i+=1){if(arrRequired[i]){strRequired=(strRequired?strRequired+' AND ':'')+'('+arrRequired[i]+')';}}}
if(arrWhere.length>0){for(i=0,len=arrWhere.length;i<len;i+=1){if(arrWhere[i]){strWhere=(strWhere?strWhere+' AND ':'')+'('+arrWhere[i]+')';}}}
strRet=(strWhere&&strRequired?'('+strWhere+') AND ('+strRequired+')':strWhere?strWhere:strRequired);return strRet;};GS.iconList=function(){return[{"name":"500px","code":"f26e"},{"name":"adjust","code":"f042"},{"name":"adn","code":"f170"},{"name":"align-center","code":"f037"},{"name":"align-justify","code":"f039"},{"name":"align-left","code":"f036"},{"name":"align-right","code":"f038"},{"name":"amazon","code":"f270"},{"name":"ambulance","code":"f0f9"},{"name":"anchor","code":"f13d"},{"name":"android","code":"f17b"},{"name":"angellist","code":"f209"},{"name":"angle-double-down","code":"f103"},{"name":"angle-double-left","code":"f100"},{"name":"angle-double-right","code":"f101"},{"name":"angle-double-up","code":"f102"},{"name":"angle-down","code":"f107"},{"name":"angle-left","code":"f104"},{"name":"angle-right","code":"f105"},{"name":"angle-up","code":"f106"},{"name":"apple","code":"f179"},{"name":"archive","code":"f187"},{"name":"area-chart","code":"f1fe"},{"name":"arrow-circle-down","code":"f0ab"},{"name":"arrow-circle-left","code":"f0a8"},{"name":"arrow-circle-o-down","code":"f01a"},{"name":"arrow-circle-o-left","code":"f190"},{"name":"arrow-circle-o-right","code":"f18e"},{"name":"arrow-circle-o-up","code":"f01b"},{"name":"arrow-circle-right","code":"f0a9"},{"name":"arrow-circle-up","code":"f0aa"},{"name":"arrow-down","code":"f063"},{"name":"arrow-left","code":"f060"},{"name":"arrow-right","code":"f061"},{"name":"arrow-up","code":"f062"},{"name":"arrows","code":"f047"},{"name":"arrows-alt","code":"f0b2"},{"name":"arrows-h","code":"f07e"},{"name":"arrows-v","code":"f07d"},{"name":"asterisk","code":"f069"},{"name":"at","code":"f1fa"},{"name":"automobile","code":"f1b9"},{"name":"backward","code":"f04a"},{"name":"balance-scale","code":"f24e"},{"name":"ban","code":"f05e"},{"name":"bank","code":"f19c"},{"name":"bar-chart","code":"f080"},{"name":"bar-chart-o","code":"f080"},{"name":"barcode","code":"f02a"},{"name":"bars","code":"f0c9"},{"name":"battery-0","code":"f244"},{"name":"battery-1","code":"f243"},{"name":"battery-2","code":"f242"},{"name":"battery-3","code":"f241"},{"name":"battery-4","code":"f240"},{"name":"battery-empty","code":"f244"},{"name":"battery-full","code":"f240"},{"name":"battery-half","code":"f242"},{"name":"battery-quarter","code":"f243"},{"name":"battery-three-quarters","code":"f241"},{"name":"bed","code":"f236"},{"name":"beer","code":"f0fc"},{"name":"behance","code":"f1b4"},{"name":"behance-square","code":"f1b5"},{"name":"bell","code":"f0f3"},{"name":"bell-o","code":"f0a2"},{"name":"bell-slash","code":"f1f6"},{"name":"bell-slash-o","code":"f1f7"},{"name":"bicycle","code":"f206"},{"name":"binoculars","code":"f1e5"},{"name":"birthday-cake","code":"f1fd"},{"name":"bitbucket","code":"f171"},{"name":"bitbucket-square","code":"f172"},{"name":"bitcoin","code":"f15a"},{"name":"black-tie","code":"f27e"},{"name":"bluetooth","code":"f293"},{"name":"bluetooth-b","code":"f294"},{"name":"bold","code":"f032"},{"name":"bolt","code":"f0e7"},{"name":"bomb","code":"f1e2"},{"name":"book","code":"f02d"},{"name":"bookmark","code":"f02e"},{"name":"bookmark-o","code":"f097"},{"name":"briefcase","code":"f0b1"},{"name":"btc","code":"f15a"},{"name":"bug","code":"f188"},{"name":"building","code":"f1ad"},{"name":"building-o","code":"f0f7"},{"name":"bullhorn","code":"f0a1"},{"name":"bullseye","code":"f140"},{"name":"bus","code":"f207"},{"name":"buysellads","code":"f20d"},{"name":"cab","code":"f1ba"},{"name":"calculator","code":"f1ec"},{"name":"calendar","code":"f073"},{"name":"calendar-check-o","code":"f274"},{"name":"calendar-minus-o","code":"f272"},{"name":"calendar-o","code":"f133"},{"name":"calendar-plus-o","code":"f271"},{"name":"calendar-times-o","code":"f273"},{"name":"camera","code":"f030"},{"name":"camera-retro","code":"f083"},{"name":"car","code":"f1b9"},{"name":"caret-down","code":"f0d7"},{"name":"caret-left","code":"f0d9"},{"name":"caret-right","code":"f0da"},{"name":"caret-square-o-down","code":"f150"},{"name":"caret-square-o-left","code":"f191"},{"name":"caret-square-o-right","code":"f152"},{"name":"caret-square-o-up","code":"f151"},{"name":"caret-up","code":"f0d8"},{"name":"cart-arrow-down","code":"f218"},{"name":"cart-plus","code":"f217"},{"name":"cc","code":"f20a"},{"name":"cc-amex","code":"f1f3"},{"name":"cc-diners-club","code":"f24c"},{"name":"cc-discover","code":"f1f2"},{"name":"cc-jcb","code":"f24b"},{"name":"cc-mastercard","code":"f1f1"},{"name":"cc-paypal","code":"f1f4"},{"name":"cc-stripe","code":"f1f5"},{"name":"cc-visa","code":"f1f0"},{"name":"certificate","code":"f0a3"},{"name":"chain","code":"f0c1"},{"name":"chain-broken","code":"f127"},{"name":"check","code":"f00c"},{"name":"check-circle","code":"f058"},{"name":"check-circle-o","code":"f05d"},{"name":"check-square","code":"f14a"},{"name":"check-square-o","code":"f046"},{"name":"chevron-circle-down","code":"f13a"},{"name":"chevron-circle-left","code":"f137"},{"name":"chevron-circle-right","code":"f138"},{"name":"chevron-circle-up","code":"f139"},{"name":"chevron-down","code":"f078"},{"name":"chevron-left","code":"f053"},{"name":"chevron-right","code":"f054"},{"name":"chevron-up","code":"f077"},{"name":"child","code":"f1ae"},{"name":"chrome","code":"f268"},{"name":"circle","code":"f111"},{"name":"circle-o","code":"f10c"},{"name":"circle-o-notch","code":"f1ce"},{"name":"circle-thin","code":"f1db"},{"name":"clipboard","code":"f0ea"},{"name":"clock-o","code":"f017"},{"name":"clone","code":"f24d"},{"name":"close","code":"f00d"},{"name":"cloud","code":"f0c2"},{"name":"cloud-download","code":"f0ed"},{"name":"cloud-upload","code":"f0ee"},{"name":"cny","code":"f157"},{"name":"code","code":"f121"},{"name":"code-fork","code":"f126"},{"name":"codepen","code":"f1cb"},{"name":"codiepie","code":"f284"},{"name":"coffee","code":"f0f4"},{"name":"cog","code":"f013"},{"name":"cogs","code":"f085"},{"name":"columns","code":"f0db"},{"name":"comment","code":"f075"},{"name":"comment-o","code":"f0e5"},{"name":"commenting","code":"f27a"},{"name":"commenting-o","code":"f27b"},{"name":"comments","code":"f086"},{"name":"comments-o","code":"f0e6"},{"name":"compass","code":"f14e"},{"name":"compress","code":"f066"},{"name":"connectdevelop","code":"f20e"},{"name":"contao","code":"f26d"},{"name":"copy","code":"f0c5"},{"name":"copyright","code":"f1f9"},{"name":"creative-commons","code":"f25e"},{"name":"credit-card","code":"f09d"},{"name":"credit-card-alt","code":"f283"},{"name":"crop","code":"f125"},{"name":"crosshairs","code":"f05b"},{"name":"css3","code":"f13c"},{"name":"cube","code":"f1b2"},{"name":"cubes","code":"f1b3"},{"name":"cut","code":"f0c4"},{"name":"cutlery","code":"f0f5"},{"name":"dashboard","code":"f0e4"},{"name":"dashcube","code":"f210"},{"name":"database","code":"f1c0"},{"name":"dedent","code":"f03b"},{"name":"delicious","code":"f1a5"},{"name":"desktop","code":"f108"},{"name":"deviantart","code":"f1bd"},{"name":"diamond","code":"f219"},{"name":"digg","code":"f1a6"},{"name":"dollar","code":"f155"},{"name":"dot-circle-o","code":"f192"},{"name":"download","code":"f019"},{"name":"dribbble","code":"f17d"},{"name":"dropbox","code":"f16b"},{"name":"drupal","code":"f1a9"},{"name":"edge","code":"f282"},{"name":"edit","code":"f044"},{"name":"eject","code":"f052"},{"name":"ellipsis-h","code":"f141"},{"name":"ellipsis-v","code":"f142"},{"name":"empire","code":"f1d1"},{"name":"envelope","code":"f0e0"},{"name":"envelope-o","code":"f003"},{"name":"envelope-square","code":"f199"},{"name":"eraser","code":"f12d"},{"name":"eur","code":"f153"},{"name":"euro","code":"f153"},{"name":"exchange","code":"f0ec"},{"name":"exclamation","code":"f12a"},{"name":"exclamation-circle","code":"f06a"},{"name":"exclamation-triangle","code":"f071"},{"name":"expand","code":"f065"},{"name":"expeditedssl","code":"f23e"},{"name":"external-link","code":"f08e"},{"name":"external-link-square","code":"f14c"},{"name":"eye","code":"f06e"},{"name":"eye-slash","code":"f070"},{"name":"eyedropper","code":"f1fb"},{"name":"facebook","code":"f09a"},{"name":"facebook-f","code":"f09a"},{"name":"facebook-official","code":"f230"},{"name":"facebook-square","code":"f082"},{"name":"fast-backward","code":"f049"},{"name":"fast-forward","code":"f050"},{"name":"fax","code":"f1ac"},{"name":"feed","code":"f09e"},{"name":"female","code":"f182"},{"name":"fighter-jet","code":"f0fb"},{"name":"file","code":"f15b"},{"name":"file-archive-o","code":"f1c6"},{"name":"file-audio-o","code":"f1c7"},{"name":"file-code-o","code":"f1c9"},{"name":"file-excel-o","code":"f1c3"},{"name":"file-image-o","code":"f1c5"},{"name":"file-movie-o","code":"f1c8"},{"name":"file-o","code":"f016"},{"name":"file-pdf-o","code":"f1c1"},{"name":"file-photo-o","code":"f1c5"},{"name":"file-picture-o","code":"f1c5"},{"name":"file-powerpoint-o","code":"f1c4"},{"name":"file-sound-o","code":"f1c7"},{"name":"file-text","code":"f15c"},{"name":"file-text-o","code":"f0f6"},{"name":"file-video-o","code":"f1c8"},{"name":"file-word-o","code":"f1c2"},{"name":"file-zip-o","code":"f1c6"},{"name":"files-o","code":"f0c5"},{"name":"film","code":"f008"},{"name":"filter","code":"f0b0"},{"name":"fire","code":"f06d"},{"name":"fire-extinguisher","code":"f134"},{"name":"firefox","code":"f269"},{"name":"flag","code":"f024"},{"name":"flag-checkered","code":"f11e"},{"name":"flag-o","code":"f11d"},{"name":"flash","code":"f0e7"},{"name":"flask","code":"f0c3"},{"name":"flickr","code":"f16e"},{"name":"floppy-o","code":"f0c7"},{"name":"folder","code":"f07b"},{"name":"folder-o","code":"f114"},{"name":"folder-open","code":"f07c"},{"name":"folder-open-o","code":"f115"},{"name":"font","code":"f031"},{"name":"fonticons","code":"f280"},{"name":"fort-awesome","code":"f286"},{"name":"forumbee","code":"f211"},{"name":"forward","code":"f04e"},{"name":"foursquare","code":"f180"},{"name":"frown-o","code":"f119"},{"name":"futbol-o","code":"f1e3"},{"name":"gamepad","code":"f11b"},{"name":"gavel","code":"f0e3"},{"name":"gbp","code":"f154"},{"name":"ge","code":"f1d1"},{"name":"gear","code":"f013"},{"name":"gears","code":"f085"},{"name":"genderless","code":"f22d"},{"name":"get-pocket","code":"f265"},{"name":"gg","code":"f260"},{"name":"gg-circle","code":"f261"},{"name":"gift","code":"f06b"},{"name":"git","code":"f1d3"},{"name":"git-square","code":"f1d2"},{"name":"github","code":"f09b"},{"name":"github-alt","code":"f113"},{"name":"github-square","code":"f092"},{"name":"gittip","code":"f184"},{"name":"glass","code":"f000"},{"name":"globe","code":"f0ac"},{"name":"google","code":"f1a0"},{"name":"google-plus","code":"f0d5"},{"name":"google-plus-square","code":"f0d4"},{"name":"google-wallet","code":"f1ee"},{"name":"graduation-cap","code":"f19d"},{"name":"gratipay","code":"f184"},{"name":"group","code":"f0c0"},{"name":"h-square","code":"f0fd"},{"name":"hacker-news","code":"f1d4"},{"name":"hand-grab-o","code":"f255"},{"name":"hand-lizard-o","code":"f258"},{"name":"hand-o-down","code":"f0a7"},{"name":"hand-o-left","code":"f0a5"},{"name":"hand-o-right","code":"f0a4"},{"name":"hand-o-up","code":"f0a6"},{"name":"hand-paper-o","code":"f256"},{"name":"hand-peace-o","code":"f25b"},{"name":"hand-pointer-o","code":"f25a"},{"name":"hand-rock-o","code":"f255"},{"name":"hand-scissors-o","code":"f257"},{"name":"hand-spock-o","code":"f259"},{"name":"hand-stop-o","code":"f256"},{"name":"hashtag","code":"f292"},{"name":"hdd-o","code":"f0a0"},{"name":"header","code":"f1dc"},{"name":"headphones","code":"f025"},{"name":"heart","code":"f004"},{"name":"heart-o","code":"f08a"},{"name":"heartbeat","code":"f21e"},{"name":"history","code":"f1da"},{"name":"home","code":"f015"},{"name":"hospital-o","code":"f0f8"},{"name":"hotel","code":"f236"},{"name":"hourglass","code":"f254"},{"name":"hourglass-1","code":"f251"},{"name":"hourglass-2","code":"f252"},{"name":"hourglass-3","code":"f253"},{"name":"hourglass-end","code":"f253"},{"name":"hourglass-half","code":"f252"},{"name":"hourglass-o","code":"f250"},{"name":"hourglass-start","code":"f251"},{"name":"houzz","code":"f27c"},{"name":"html5","code":"f13b"},{"name":"i-cursor","code":"f246"},{"name":"ils","code":"f20b"},{"name":"image","code":"f03e"},{"name":"inbox","code":"f01c"},{"name":"indent","code":"f03c"},{"name":"industry","code":"f275"},{"name":"info","code":"f129"},{"name":"info-circle","code":"f05a"},{"name":"inr","code":"f156"},{"name":"instagram","code":"f16d"},{"name":"institution","code":"f19c"},{"name":"internet-explorer","code":"f26b"},{"name":"intersex","code":"f224"},{"name":"ioxhost","code":"f208"},{"name":"italic","code":"f033"},{"name":"joomla","code":"f1aa"},{"name":"jpy","code":"f157"},{"name":"jsfiddle","code":"f1cc"},{"name":"key","code":"f084"},{"name":"keyboard-o","code":"f11c"},{"name":"krw","code":"f159"},{"name":"language","code":"f1ab"},{"name":"laptop","code":"f109"},{"name":"lastfm","code":"f202"},{"name":"lastfm-square","code":"f203"},{"name":"leaf","code":"f06c"},{"name":"leanpub","code":"f212"},{"name":"legal","code":"f0e3"},{"name":"lemon-o","code":"f094"},{"name":"level-down","code":"f149"},{"name":"level-up","code":"f148"},{"name":"life-bouy","code":"f1cd"},{"name":"life-buoy","code":"f1cd"},{"name":"life-ring","code":"f1cd"},{"name":"life-saver","code":"f1cd"},{"name":"lightbulb-o","code":"f0eb"},{"name":"line-chart","code":"f201"},{"name":"link","code":"f0c1"},{"name":"linkedin","code":"f0e1"},{"name":"linkedin-square","code":"f08c"},{"name":"linux","code":"f17c"},{"name":"list","code":"f03a"},{"name":"list-alt","code":"f022"},{"name":"list-ol","code":"f0cb"},{"name":"list-ul","code":"f0ca"},{"name":"location-arrow","code":"f124"},{"name":"lock","code":"f023"},{"name":"long-arrow-down","code":"f175"},{"name":"long-arrow-left","code":"f177"},{"name":"long-arrow-right","code":"f178"},{"name":"long-arrow-up","code":"f176"},{"name":"magic","code":"f0d0"},{"name":"magnet","code":"f076"},{"name":"mail-forward","code":"f064"},{"name":"mail-reply","code":"f112"},{"name":"mail-reply-all","code":"f122"},{"name":"male","code":"f183"},{"name":"map","code":"f279"},{"name":"map-marker","code":"f041"},{"name":"map-o","code":"f278"},{"name":"map-pin","code":"f276"},{"name":"map-signs","code":"f277"},{"name":"mars","code":"f222"},{"name":"mars-double","code":"f227"},{"name":"mars-stroke","code":"f229"},{"name":"mars-stroke-h","code":"f22b"},{"name":"mars-stroke-v","code":"f22a"},{"name":"maxcdn","code":"f136"},{"name":"meanpath","code":"f20c"},{"name":"medium","code":"f23a"},{"name":"medkit","code":"f0fa"},{"name":"meh-o","code":"f11a"},{"name":"mercury","code":"f223"},{"name":"microphone","code":"f130"},{"name":"microphone-slash","code":"f131"},{"name":"minus","code":"f068"},{"name":"minus-circle","code":"f056"},{"name":"minus-square","code":"f146"},{"name":"minus-square-o","code":"f147"},{"name":"mixcloud","code":"f289"},{"name":"mobile","code":"f10b"},{"name":"mobile-phone","code":"f10b"},{"name":"modx","code":"f285"},{"name":"money","code":"f0d6"},{"name":"moon-o","code":"f186"},{"name":"mortar-board","code":"f19d"},{"name":"motorcycle","code":"f21c"},{"name":"mouse-pointer","code":"f245"},{"name":"music","code":"f001"},{"name":"navicon","code":"f0c9"},{"name":"neuter","code":"f22c"},{"name":"newspaper-o","code":"f1ea"},{"name":"object-group","code":"f247"},{"name":"object-ungroup","code":"f248"},{"name":"odnoklassniki","code":"f263"},{"name":"odnoklassniki-square","code":"f264"},{"name":"opencart","code":"f23d"},{"name":"openid","code":"f19b"},{"name":"opera","code":"f26a"},{"name":"optin-monster","code":"f23c"},{"name":"outdent","code":"f03b"},{"name":"pagelines","code":"f18c"},{"name":"paint-brush","code":"f1fc"},{"name":"paper-plane","code":"f1d8"},{"name":"paper-plane-o","code":"f1d9"},{"name":"paperclip","code":"f0c6"},{"name":"paragraph","code":"f1dd"},{"name":"paste","code":"f0ea"},{"name":"pause","code":"f04c"},{"name":"pause-circle","code":"f28b"},{"name":"pause-circle-o","code":"f28c"},{"name":"paw","code":"f1b0"},{"name":"paypal","code":"f1ed"},{"name":"pencil","code":"f040"},{"name":"pencil-square","code":"f14b"},{"name":"pencil-square-o","code":"f044"},{"name":"percent","code":"f295"},{"name":"phone","code":"f095"},{"name":"phone-square","code":"f098"},{"name":"photo","code":"f03e"},{"name":"picture-o","code":"f03e"},{"name":"pie-chart","code":"f200"},{"name":"pied-piper","code":"f1a7"},{"name":"pied-piper-alt","code":"f1a8"},{"name":"pinterest","code":"f0d2"},{"name":"pinterest-p","code":"f231"},{"name":"pinterest-square","code":"f0d3"},{"name":"plane","code":"f072"},{"name":"play","code":"f04b"},{"name":"play-circle","code":"f144"},{"name":"play-circle-o","code":"f01d"},{"name":"plug","code":"f1e6"},{"name":"plus","code":"f067"},{"name":"plus-circle","code":"f055"},{"name":"plus-square","code":"f0fe"},{"name":"plus-square-o","code":"f196"},{"name":"power-off","code":"f011"},{"name":"print","code":"f02f"},{"name":"product-hunt","code":"f288"},{"name":"puzzle-piece","code":"f12e"},{"name":"qq","code":"f1d6"},{"name":"qrcode","code":"f029"},{"name":"question","code":"f128"},{"name":"question-circle","code":"f059"},{"name":"quote-left","code":"f10d"},{"name":"quote-right","code":"f10e"},{"name":"ra","code":"f1d0"},{"name":"random","code":"f074"},{"name":"rebel","code":"f1d0"},{"name":"recycle","code":"f1b8"},{"name":"reddit","code":"f1a1"},{"name":"reddit-alien","code":"f281"},{"name":"reddit-square","code":"f1a2"},{"name":"refresh","code":"f021"},{"name":"registered","code":"f25d"},{"name":"remove","code":"f00d"},{"name":"renren","code":"f18b"},{"name":"reorder","code":"f0c9"},{"name":"repeat","code":"f01e"},{"name":"reply","code":"f112"},{"name":"reply-all","code":"f122"},{"name":"retweet","code":"f079"},{"name":"rmb","code":"f157"},{"name":"road","code":"f018"},{"name":"rocket","code":"f135"},{"name":"rotate-left","code":"f0e2"},{"name":"rotate-right","code":"f01e"},{"name":"rouble","code":"f158"},{"name":"rss","code":"f09e"},{"name":"rss-square","code":"f143"},{"name":"rub","code":"f158"},{"name":"ruble","code":"f158"},{"name":"rupee","code":"f156"},{"name":"safari","code":"f267"},{"name":"save","code":"f0c7"},{"name":"scissors","code":"f0c4"},{"name":"scribd","code":"f28a"},{"name":"search","code":"f002"},{"name":"search-minus","code":"f010"},{"name":"search-plus","code":"f00e"},{"name":"sellsy","code":"f213"},{"name":"send","code":"f1d8"},{"name":"send-o","code":"f1d9"},{"name":"server","code":"f233"},{"name":"share","code":"f064"},{"name":"share-alt","code":"f1e0"},{"name":"share-alt-square","code":"f1e1"},{"name":"share-square","code":"f14d"},{"name":"share-square-o","code":"f045"},{"name":"shekel","code":"f20b"},{"name":"sheqel","code":"f20b"},{"name":"shield","code":"f132"},{"name":"ship","code":"f21a"},{"name":"shirtsinbulk","code":"f214"},{"name":"shopping-bag","code":"f290"},{"name":"shopping-basket","code":"f291"},{"name":"shopping-cart","code":"f07a"},{"name":"sign-in","code":"f090"},{"name":"sign-out","code":"f08b"},{"name":"signal","code":"f012"},{"name":"simplybuilt","code":"f215"},{"name":"sitemap","code":"f0e8"},{"name":"skyatlas","code":"f216"},{"name":"skype","code":"f17e"},{"name":"slack","code":"f198"},{"name":"sliders","code":"f1de"},{"name":"slideshare","code":"f1e7"},{"name":"smile-o","code":"f118"},{"name":"soccer-ball-o","code":"f1e3"},{"name":"sort","code":"f0dc"},{"name":"sort-alpha-asc","code":"f15d"},{"name":"sort-alpha-desc","code":"f15e"},{"name":"sort-amount-asc","code":"f160"},{"name":"sort-amount-desc","code":"f161"},{"name":"sort-asc","code":"f0de"},{"name":"sort-desc","code":"f0dd"},{"name":"sort-down","code":"f0dd"},{"name":"sort-numeric-asc","code":"f162"},{"name":"sort-numeric-desc","code":"f163"},{"name":"sort-up","code":"f0de"},{"name":"soundcloud","code":"f1be"},{"name":"space-shuttle","code":"f197"},{"name":"spinner","code":"f110"},{"name":"spoon","code":"f1b1"},{"name":"spotify","code":"f1bc"},{"name":"square","code":"f0c8"},{"name":"square-o","code":"f096"},{"name":"stack-exchange","code":"f18d"},{"name":"stack-overflow","code":"f16c"},{"name":"star","code":"f005"},{"name":"star-half","code":"f089"},{"name":"star-half-empty","code":"f123"},{"name":"star-half-full","code":"f123"},{"name":"star-half-o","code":"f123"},{"name":"star-o","code":"f006"},{"name":"steam","code":"f1b6"},{"name":"steam-square","code":"f1b7"},{"name":"step-backward","code":"f048"},{"name":"step-forward","code":"f051"},{"name":"stethoscope","code":"f0f1"},{"name":"sticky-note","code":"f249"},{"name":"sticky-note-o","code":"f24a"},{"name":"stop","code":"f04d"},{"name":"stop-circle","code":"f28d"},{"name":"stop-circle-o","code":"f28e"},{"name":"street-view","code":"f21d"},{"name":"strikethrough","code":"f0cc"},{"name":"stumbleupon","code":"f1a4"},{"name":"stumbleupon-circle","code":"f1a3"},{"name":"subscript","code":"f12c"},{"name":"subway","code":"f239"},{"name":"suitcase","code":"f0f2"},{"name":"sun-o","code":"f185"},{"name":"superscript","code":"f12b"},{"name":"support","code":"f1cd"},{"name":"table","code":"f0ce"},{"name":"tablet","code":"f10a"},{"name":"tachometer","code":"f0e4"},{"name":"tag","code":"f02b"},{"name":"tags","code":"f02c"},{"name":"tasks","code":"f0ae"},{"name":"taxi","code":"f1ba"},{"name":"television","code":"f26c"},{"name":"tencent-weibo","code":"f1d5"},{"name":"terminal","code":"f120"},{"name":"text-height","code":"f034"},{"name":"text-width","code":"f035"},{"name":"th","code":"f00a"},{"name":"th-large","code":"f009"},{"name":"th-list","code":"f00b"},{"name":"thumb-tack","code":"f08d"},{"name":"thumbs-down","code":"f165"},{"name":"thumbs-o-down","code":"f088"},{"name":"thumbs-o-up","code":"f087"},{"name":"thumbs-up","code":"f164"},{"name":"ticket","code":"f145"},{"name":"times","code":"f00d"},{"name":"times-circle","code":"f057"},{"name":"times-circle-o","code":"f05c"},{"name":"tint","code":"f043"},{"name":"toggle-down","code":"f150"},{"name":"toggle-left","code":"f191"},{"name":"toggle-off","code":"f204"},{"name":"toggle-on","code":"f205"},{"name":"toggle-right","code":"f152"},{"name":"toggle-up","code":"f151"},{"name":"trademark","code":"f25c"},{"name":"train","code":"f238"},{"name":"transgender","code":"f224"},{"name":"transgender-alt","code":"f225"},{"name":"trash","code":"f1f8"},{"name":"trash-o","code":"f014"},{"name":"tree","code":"f1bb"},{"name":"trello","code":"f181"},{"name":"tripadvisor","code":"f262"},{"name":"trophy","code":"f091"},{"name":"truck","code":"f0d1"},{"name":"try","code":"f195"},{"name":"tty","code":"f1e4"},{"name":"tumblr","code":"f173"},{"name":"tumblr-square","code":"f174"},{"name":"turkish-lira","code":"f195"},{"name":"tv","code":"f26c"},{"name":"twitch","code":"f1e8"},{"name":"twitter","code":"f099"},{"name":"twitter-square","code":"f081"},{"name":"umbrella","code":"f0e9"},{"name":"underline","code":"f0cd"},{"name":"undo","code":"f0e2"},{"name":"university","code":"f19c"},{"name":"unlink","code":"f127"},{"name":"unlock","code":"f09c"},{"name":"unlock-alt","code":"f13e"},{"name":"unsorted","code":"f0dc"},{"name":"upload","code":"f093"},{"name":"usb","code":"f287"},{"name":"usd","code":"f155"},{"name":"user","code":"f007"},{"name":"user-md","code":"f0f0"},{"name":"user-plus","code":"f234"},{"name":"user-secret","code":"f21b"},{"name":"user-times","code":"f235"},{"name":"users","code":"f0c0"},{"name":"venus","code":"f221"},{"name":"venus-double","code":"f226"},{"name":"venus-mars","code":"f228"},{"name":"viacoin","code":"f237"},{"name":"video-camera","code":"f03d"},{"name":"vimeo","code":"f27d"},{"name":"vimeo-square","code":"f194"},{"name":"vine","code":"f1ca"},{"name":"vk","code":"f189"},{"name":"volume-down","code":"f027"},{"name":"volume-off","code":"f026"},{"name":"volume-up","code":"f028"},{"name":"warning","code":"f071"},{"name":"wechat","code":"f1d7"},{"name":"weibo","code":"f18a"},{"name":"weixin","code":"f1d7"},{"name":"whatsapp","code":"f232"},{"name":"wheelchair","code":"f193"},{"name":"wifi","code":"f1eb"},{"name":"wikipedia-w","code":"f266"},{"name":"windows","code":"f17a"},{"name":"won","code":"f159"},{"name":"wordpress","code":"f19a"},{"name":"wrench","code":"f0ad"},{"name":"xing","code":"f168"},{"name":"xing-square","code":"f169"},{"name":"y-combinator","code":"f23b"},{"name":"y-combinator-square","code":"f1d4"},{"name":"yahoo","code":"f19e"},{"name":"yc","code":"f23b"},{"name":"yc-square","code":"f1d4"},{"name":"yelp","code":"f1e9"},{"name":"yen","code":"f157"},{"name":"youtube","code":"f167"},{"name":"youtube-play","code":"f16a"},{"name":"youtube-square","code":"f166"}];};GS.lorem=function(){return'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.';};if(!String.prototype.repeat){String.prototype.repeat=function(count){'use strict';if(this==null){throw new TypeError('can\'t convert '+this+' to object');}
var str=''+this;count=+count;if(count!=count){count=0;}
if(count<0){throw new RangeError('repeat count must be non-negative');}
if(count==Infinity){throw new RangeError('repeat count must be less than infinity');}
count=Math.floor(count);if(str.length==0||count==0){return'';}
if(str.length*count>=1<<28){throw new RangeError('repeat count must not overflow maximum string size');}
var rpt='';for(;;){if((count&1)==1){rpt+=str;}
count>>>=1;if(count==0){break;}
str+=str;}
return rpt;}}
if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,'');};}
window.addEventListener('design-register-element',function(){registerDesignSnippet('Add Loader (to page)','GS.addLoader','addLoader(\'${0:class-name}\', \'${1:Loading...}\');');registerDesignSnippet('Add Loader (to element)','GS.addLoader','addLoader(${0:document.getElementById(\'id\')}, \'${1:Loading...}\');');registerDesignSnippet('Remove Loader (from page)','GS.removeLoader','removeLoader(\'${0:class-name}\');');registerDesignSnippet('Remove Loader (from element)','GS.removeLoader','removeLoader(${0:document.getElementById(\'id\')});');});document.addEventListener('DOMContentLoaded',function(){xtag.register('gs-loader',{lifecycle:{},events:{},accessors:{},methods:{}});});GS.addLoader=function(loaderClassOrTarget,loaderContent){var loaderElement=document.createElement('gs-loader'),loaderClass,loaderTarget;if(typeof loaderClassOrTarget==='string'){loaderClass=loaderClassOrTarget;}else if(typeof loaderClassOrTarget==='object'){loaderTarget=loaderClassOrTarget;}
if(loaderClass){loaderElement.classList.add('loader-'+loaderClass);}
if(!loaderTarget){loaderTarget=document.body;}
loaderElement.innerHTML='<div class="loader-positioning" gs-dynamic>'+'<div class="loader" gs-dynamic></div>'+'<div class="loader-inner spinning" gs-dynamic></div>'+'<div class="loader-inner-inner spinning" gs-dynamic></div>'+'<div class="loader-inner-inner-inner spinning" gs-dynamic></div>'+
(loaderContent?'<div class="loader-content" gs-dynamic>'+loaderContent+'</div>':'')+'</div>';loaderElement.addEventListener('mousewheel',function(event){event.preventDefault();});loaderTarget.appendChild(loaderElement);};GS.removeLoader=function(loaderClassOrTarget){var element,i,len,arrLoaders,loaderClass,loaderTarget;if(typeof loaderClassOrTarget==='string'){loaderClass=loaderClassOrTarget;}else if(typeof loaderClassOrTarget==='object'){loaderTarget=loaderClassOrTarget;}
if(loaderClass){element=document.getElementsByClassName('loader-'+loaderClass)[0];}else if(loaderTarget){element=xtag.queryChildren(loaderTarget,'gs-loader')[0];}else{arrLoaders=xtag.queryChildren(document.body,'gs-loader');for(i=0,len=arrLoaders.length;i<len;i+=1){if(!arrLoaders[i].hasAttribute('id')){element=arrLoaders[i];break;}}}
if(element){element.parentNode.removeChild(element);}else{console.warn('GS.removeLoader Error: loader'+(loaderClass?' class: "'+loaderClass+'"':'')+' not found');}};GS.removeAllLoaders=function(){'use strict';var i,len,arrLoaders;arrLoaders=xtag.query(document.body,'gs-loader');for(i=0,len=arrLoaders.length;i<len;i+=1){if(!arrLoaders[i].hasAttribute('id')){arrLoaders[i].parentNode.removeChild(arrLoaders[i]);}}};window.addEventListener('design-register-element',function(){window.designElementProperty_GSBODY=function(selectedElement){addFlexContainerProps(selectedElement);addProp('Padded',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('padded'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'padded',(this.value==='true'),true);});};registerDesignSnippet('<gs-body>','<gs-body>','gs-body>\n'+'    $0\n'+'</gs-body>');designRegisterElement('gs-body','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-page.html');});document.addEventListener('DOMContentLoaded',function(){xtag.register('gs-body',{lifecycle:{},events:{},accessors:{},methods:{}});});(function(){'use strict';function defineButton(strTagName,strDocLink,arrDisableWhenEmptyAttributes,designAdditionalFunction,clickFunction){strDocLink=strDocLink||'/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-buttons-toggle.html';designAdditionalFunction=designAdditionalFunction||function(){};clickFunction=clickFunction||function(){};window.addEventListener('design-register-element',function(){registerDesignSnippet('<'+strTagName+'>','<'+strTagName+'>',strTagName+'>${1}</'+strTagName+'>');designRegisterElement(strTagName,strDocLink);window['designElementProperty_'+strTagName.replace(/[^a-z0-9]/gi,'').toUpperCase()]=function(selectedElement){var strIconPos='',strIconRotation='',strVisibilityAttribute='',strFontAttribute='',strBackgroundAttribute='';addProp('Icon',true,'<div flex-horizontal>'+'     <gs-text id="prop-icon-input" class="target" value="'+(selectedElement.getAttribute('icon')||'')+'" mini flex></gs-text>'+'     <gs-button id="prop-icon-picker-button" mini icononly icon="list"></gs-button>'+'     <style>#prop-icon-picker-button:after {font-size: 1em;}</style>'+'</div>',function(){return setOrRemoveTextAttribute(selectedElement,'icon',this.value,false);});document.getElementById('prop-icon-picker-button').addEventListener('click',function(){var i,len,html,arrIcons=GS.iconList(),strName,templateElement;for(i=0,len=arrIcons.length,html='';i<len;i+=1){strName=arrIcons[i].name;html+='<gs-block>'+'<gs-button iconleft icon="'+strName+'" dialogclose>'+strName+'</gs-button>'+'</gs-block>';}
templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','1100px');templateElement.innerHTML='<gs-page>'+'    <gs-header><center><h3>Choose An Icon</h3></center></gs-header>'+'    <gs-body padded><gs-grid widths="1,1,1,1" reflow-at="767px">'+html+'</gs-grid></gs-body>'+'    <gs-footer><gs-button dialogclose>Cancel</gs-button></gs-footer>'+'</gs-page>';GS.openDialog(templateElement,'',function(event,strAnswer){var propInput=document.getElementById('prop-icon-input');if(strAnswer!=='Cancel'){propInput.value=strAnswer;GS.triggerEvent(propInput,'change');}});});if(selectedElement.hasAttribute('iconleft')){strIconPos='iconleft';}else if(selectedElement.hasAttribute('iconright')){strIconPos='iconright';}else if(selectedElement.hasAttribute('icontop')){strIconPos='icontop';}else if(selectedElement.hasAttribute('iconbottom')){strIconPos='iconbottom';}else if(selectedElement.hasAttribute('icononly')){strIconPos='icononly';}
addProp('Icon Position',true,'<gs-select class="target" value="'+strIconPos+'" mini>'+'   <option value="">Default</option>'+'   <option value="iconleft">Left</option>'+'   <option value="iconright">Right</option>'+'   <option value="icontop">Top</option>'+'   <option value="iconbottom">Bottom</option>'+'   <option value="icononly">Icononly</option>'+'</gs-select>',function(){selectedElement.removeAttribute('iconleft');selectedElement.removeAttribute('iconright');selectedElement.removeAttribute('icontop');selectedElement.removeAttribute('iconbottom');selectedElement.removeAttribute('icononly');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});if(selectedElement.hasAttribute('iconrotateright')){strIconRotation='iconrotateright';}else if(selectedElement.hasAttribute('iconrotatedown')){strIconRotation='iconrotatedown';}else if(selectedElement.hasAttribute('iconrotateleft')){strIconRotation='iconrotateleft';}
addProp('Icon&nbsp;Rotation',true,'<gs-select class="target" value="'+strIconRotation+'" mini>'+'   <option value="">None</option>'+'   <option value="iconrotateright">90 degrees</option>'+'   <option value="iconrotatedown">180 degrees</option>'+'   <option value="iconrotateleft">270 degrees</option>'+'</gs-select>',function(){selectedElement.removeAttribute('iconrotateright');selectedElement.removeAttribute('iconrotatedown');selectedElement.removeAttribute('iconrotateleft');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value,false);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value,false);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Jumbo',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('jumbo'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'jumbo',(this.value==='true'),true);});addProp('Focusable',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-focus'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-focus',(this.value==='true'),false);});/* TODO: remove emphasis and add other colors
                addProp('Emphasis', true, '<gs-checkbox class="target" value="' + (!selectedElement.hasAttribute('emphasis')) + '" mini></gs-checkbox>', function () {
                    return setOrRemoveBooleanAttribute(selectedElement, 'emphasis', (this.value === 'true'), true);
                });
                */
strFontAttribute='';if(selectedElement.hasAttribute('txt-primary')){strFontAttribute='txt-primary';}
if(selectedElement.hasAttribute('txt-success')){strFontAttribute='txt-success';}
if(selectedElement.hasAttribute('txt-info')){strFontAttribute='txt-info';}
if(selectedElement.hasAttribute('txt-warning')){strFontAttribute='txt-warning';}
if(selectedElement.hasAttribute('txt-danger')){strFontAttribute='txt-danger';}
addProp('Font Color',true,'<gs-select class="target" value="'+strFontAttribute+'" mini>'+'<option value="">Default</option>'+'<option value="txt-primary">Primary</option>'+'<option value="txt-success">Success</option>'+'<option value="txt-info">Info</option>'+'<option value="txt-warning">Warning</option>'+'<option value="txt-danger">Danger</option>'+'</gs-select>',function(){selectedElement.removeAttribute('txt-primary');selectedElement.removeAttribute('txt-success');selectedElement.removeAttribute('txt-info');selectedElement.removeAttribute('txt-warning');selectedElement.removeAttribute('txt-danger');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});strBackgroundAttribute='';if(selectedElement.hasAttribute('bg-primary')){strBackgroundAttribute='bg-primary';}
if(selectedElement.hasAttribute('bg-success')){strBackgroundAttribute='bg-success';}
if(selectedElement.hasAttribute('bg-info')){strBackgroundAttribute='bg-info';}
if(selectedElement.hasAttribute('bg-warning')){strBackgroundAttribute='bg-warning';}
if(selectedElement.hasAttribute('bg-danger')){strBackgroundAttribute='bg-danger';}
addProp('Background Color',true,'<gs-select class="target" value="'+strBackgroundAttribute+'" mini>'+'<option value="">Default</option>'+'<option value="bg-primary">Primary</option>'+'<option value="bg-success">Success</option>'+'<option value="bg-info">Info</option>'+'<option value="bg-warning">Warning</option>'+'<option value="bg-danger">Danger</option>'+'</gs-select>',function(){selectedElement.removeAttribute('bg-primary');selectedElement.removeAttribute('bg-success');selectedElement.removeAttribute('bg-info');selectedElement.removeAttribute('bg-warning');selectedElement.removeAttribute('bg-danger');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'0')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Inline',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('inline'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'inline',(this.value==='true'),true);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Key',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('key')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'key',this.value,false);});addProp('No Modifier Key For Hot Key',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-modifier-key')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-modifier-key',this.value==='true',true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});designAdditionalFunction(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){function handleDisable(element){var i,len;element.removeAttribute('disabled');for(i=0,len=arrDisableWhenEmptyAttributes.length;i<len;i+=1){if(!element.getAttribute(arrDisableWhenEmptyAttributes[i])){element.setAttribute('disabled','');break;}}}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.setAttribute('value',strQSValue);}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var strKey,strQSValue;if(element.tagName.toUpperCase()==='GS-DELETE-BUTTON'&&!element.hasAttribute('src')){console.warn(element,'gs-delete-button needs a [src=""] attribute!');}
if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
if(!element.hasAttribute('no-focus')){if((!element.tabIndex)||element.tabIndex===-1){element.tabIndex=0;}}else{element.removeAttribute('tabindex');}
if(!evt.touchDevice){element.addEventListener('focus',function(event){element.classList.add('focus');});element.addEventListener('blur',function(event){element.classList.remove('focus');});element.addEventListener(evt.mousedown,function(event){element.classList.add('down');});element.addEventListener(evt.mouseout,function(event){element.classList.remove('down');element.classList.remove('hover');});element.addEventListener(evt.mouseover,function(event){element.classList.remove('down');element.classList.add('hover');});element.addEventListener('keydown',function(event){if(!element.hasAttribute('disabled')&&!element.classList.contains('down')&&(event.keyCode===13||event.keyCode===32)){element.classList.add('down');}});element.addEventListener('keyup',function(event){if(!element.hasAttribute('disabled')&&element.classList.contains('down')&&(event.keyCode===13||event.keyCode===32)){GS.triggerEvent(element,'click');}});}
element.addEventListener('click',function(event){element.classList.remove('down');clickFunction(element);});element.addEventListener('keypress',function(event){if(event.keyCode===13||event.keyCode===32){event.preventDefault();event.stopPropagation();}});if(element.getAttribute('key')){strKey=element.getAttribute('key');if(GS.keyCode(strKey)){if(strKey.match(/[arfcvxzntypq]/gim)){console.warn('gs-skype-button Warning: by setting the hot key of this button to "'+strKey+'" you may be overriding browser functionality.',element);}
window.addEventListener('keydown',function(event){if(String(event.keyCode||event.which)===GS.keyCode(strKey)&&((element.hasAttribute('no-modifier-key')&&!event.metaKey&&!event.ctrlKey)||(!element.hasAttribute('no-modifier-key')&&(event.metaKey||event.ctrlKey)))){event.preventDefault();event.stopPropagation();element.focus();GS.triggerEvent(element,'click');}});}else if(strKey.length>1){console.error('gs-skype-button Error: \'key="'+strKey+'"\' is not a valid hot-key.',element);}}
handleDisable(element);}}}
xtag.register(strTagName,{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='no-focus'){if(!this.hasAttribute('no-focus')){if((!this.tabIndex)||this.tabIndex===-1){this.tabIndex=0;}}else{this.removeAttribute('tabindex');}}else if(strAttrName==='disabled'){this.classList.remove('down');}else if(arrDisableWhenEmptyAttributes.indexOf(strAttrName)>-1){handleDisable(this);}}}},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(newValue){this.setAttribute('value',newValue);}}}});});}
defineButton('gs-email-button','',['value'],'',function(element){var emailAddress=element.getAttribute('value'),linkIframe,mousedownHandler;if(emailAddress){linkIframe=document.createElement('iframe');document.body.appendChild(linkIframe);linkIframe.setAttribute('src','mailto:'+emailAddress);mousedownHandler=function(){document.body.removeChild(linkIframe);window.removeEventListener('mousedown',mousedownHandler);};window.addEventListener('mousedown',mousedownHandler);}});defineButton('gs-facetime-button','',['value'],'',function(element){var appleID=element.getAttribute('value');if(appleID){window.open('facetime:'+appleID);}});defineButton('gs-map-button','',['value'],'',function(element){var strLocation=encodeURIComponent(element.getAttribute('value'));if(strLocation){if(element.hasAttribute('google')===true){window.open('https://maps.google.com/maps?q='+strLocation);}else if(element.hasAttribute('bing')===true){window.open('http://www.bing.com/maps/default.aspx?q='+strLocation);}else{window.open('https://maps.google.com/maps?q='+strLocation);}}});defineButton('gs-phone-button','',['value'],'',function(element){var phoneNumber=element.getAttribute('value');if(phoneNumber){if(evt.deviceType==='phone'){window.open('tel:'+phoneNumber);}else{GS.msgbox('Phone Number','<center>'+phoneNumber+'</center>',['Done']);}}});defineButton('gs-tracking-button','',['value'],function(selectedElement){var strService='';if(selectedElement.hasAttribute('usps')){strService='usps';}else if(selectedElement.hasAttribute('ups')){strService='ups';}else if(selectedElement.hasAttribute('fedex')){strService='fedex';}else if(selectedElement.hasAttribute('royal')){strService='royal';}else if(selectedElement.hasAttribute('amz')){strService='amz';}
addProp('Service',true,'<gs-select class="target" value="'+strService+'" mini>'+'   <option value="">None</option>'+'   <option value="usps">USPS</option>'+'   <option value="ups">UPS</option>'+'   <option value="fedex">FEDEX</option>'+'   <option value="royal">Royal Mail</option>'+'   <option value="amz">Amazon</option>'+'</gs-select>',function(){selectedElement.removeAttribute('usps');selectedElement.removeAttribute('ups');selectedElement.removeAttribute('fedex');selectedElement.removeAttribute('royal');selectedElement.removeAttribute('amazon');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});},function(element){var strTrackingNumber=element.getAttribute('value');if(strTrackingNumber){if(element.hasAttribute('usps')===true){window.open(' https://tools.usps.com/go/TrackConfirmAction?tLabels='+strTrackingNumber);}else if(element.hasAttribute('ups')===true){window.open('http://www.ups.com/WebTracking/processInputRequest?tracknum='+strTrackingNumber);}else if(element.hasAttribute('fedex')===true){window.open('https://www.fedex.com/apps/fedextrack/index.html?tracknumbers='+strTrackingNumber);}else if(element.hasAttribute('royal')===true){window.open('https://www.royalmail.com/track-your-item?trackNumber='+strTrackingNumber);}else if(element.hasAttribute('amz')===true){window.open(decodeURIComponent(strTrackingNumber));}else{GS.msgbox('Please Choose...','<center>Please Choose UPS, USPS, Fedex, Royal Mail or Amazon</center>',['UPS','USPS','Fedex','Royal Mail','Amazon'],function(strAnswer){if(strAnswer==='UPS'){window.open('http://www.ups.com/WebTracking/processInputRequest?tracknum='+strTrackingNumber);}else if(strAnswer==='USPS'){window.open('https://tools.usps.com/go/TrackConfirmAction?tLabels='+strTrackingNumber);}else if(strAnswer==='Fedex'){window.open('https://www.fedex.com/apps/fedextrack/index.html?tracknumbers='+strTrackingNumber);}else if(strAnswer==='Royal Mail'){window.open('https://www.royalmail.com/track-your-item?trackNumber'+strTrackingNumber);}else if(strAnswer==='Amazon'){window.open(strTrackingNumber);}});}}});defineButton('gs-skype-button','',['value'],'',function(element){if(element.getAttribute('value')){window.open('skype:'+element.getAttribute('value'));}});defineButton('gs-delete-button','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-delete-button.html',['value','src'],function(selectedElement){addProp('Source',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('src')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'src',this.value,false);});addProp('Delete Action',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('action-delete')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'action-delete',this.value);});},function(element){if(element.getAttribute('value')){var arrSrcParts=element.getAttribute('src').split('.'),strSchema=arrSrcParts[0],strObject=arrSrcParts[1],strPkColumn,strLockColumn,deleteRecordData,strHashColumns,strRoles,strColumns,strRecord,strDeleteData,strHash,strPkValue,strLockValue;element.classList.remove('down');strPkColumn=element.getAttribute('column')||'id';strLockColumn=strPkColumn;strHashColumns=strLockColumn;strPkValue=GS.encodeForTabDelimited(element.getAttribute('value')||'');strLockValue=element.getAttribute('value')||'';strRoles='pk\thash';strColumns=strPkColumn+'\thash';strHash=CryptoJS.MD5(strLockValue==='NULL'?'':strLockValue).toString();strDeleteData=strPkValue+'\t'+strHash+'\n';strDeleteData=strRoles+'\n'+strColumns+'\n'+strDeleteData;GS.addLoader(element,'Creating Delete Transaction...');GS.requestDeleteFromSocket(GS.envSocket,strSchema,strObject,strHashColumns,strDeleteData,function(data,error,transactionID){if(error){GS.removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){var arrElements,i,len,templateElement;GS.removeLoader(element);if(!error){if(data!=='TRANSACTION COMPLETED'){}else{templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                                <gs-page>
                                    <gs-header><center><h3>Are you sure...</h3></center></gs-header>
                                    <gs-body padded>
                                        <center>Are you sure you want to delete?</center>
                                    </gs-body>
                                    <gs-footer>
                                        <gs-grid>
                                            <gs-block><gs-button dialogclose>No</gs-button></gs-block>
                                            <gs-block><gs-button id="datasheet-focus-me" dialogclose bg-primary tabindex="0">Yes</gs-button></gs-block>
                                        </gs-grid>
                                    </gs-footer>
                                </gs-page>
                            */});GS.openDialog(templateElement,function(){document.getElementById('datasheet-focus-me').focus();},function(event,strAnswer){if(strAnswer==='Yes'){commitFunction();GS.addLoader(element,'Commiting Delete Transaction...');}else{rollbackFunction();GS.addLoader(element,'Rolling Back Delete Transaction...');}});}}else{rollbackFunction();GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){var arrElements,i,len;GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){GS.triggerEvent(element,'success');if(element.hasAttribute('onsuccess')){new Function(element.getAttribute('onsuccess')).apply(element);}}}else{getData(element);GS.webSocketErrorDialog(data);}});}});defineButton('gs-option','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-optionbox.html',[],function(selectedElement){},function(element){});defineButton('gs-dialog-button','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-dialog-button.html',[],function(selectedElement){addProp('Template',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('template')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'template',this.value,false);});addProp('Attach To Element',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('target-element')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'target-element',this.value,false);});addProp('Attachment Direction',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('direction')||'')+'" mini>'+'<option value="">Default</option>'+'<option value="left">Left</option>'+'<option value="right">Right</option>'+'<option value="up">Up</option>'+'<option value="down">Down</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'direction',this.value,false);});addProp('Before Open JS',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('before-open')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'before-open',this.value,false);});addProp('After Open JS',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('after-open')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'after-open',this.value,false);});addProp('Before Close JS',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('before-close')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'before-close',this.value,false);});addProp('After Close JS',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('after-close')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'after-close',this.value,false);});},function(element){var targetElement,strTemplate=element.getAttribute('template'),templateElement,strTargetSelector=element.getAttribute('target'),strDirection=element.getAttribute('direction'),strBeforeOpen=element.getAttribute('before-open'),strAfterOpen=element.getAttribute('after-open'),strBeforeClose=element.getAttribute('before-close'),strAfterClose=element.getAttribute('after-close'),afterOpenFunction,beforeCloseFunction,afterCloseFunction;templateElement=(strTemplate?document.getElementById(strTemplate):xtag.queryChildren(element,'template')[0]);if(templateElement){if(strBeforeOpen){new Function(strBeforeOpen).apply(element);}
GS.triggerEvent(element,'before-open');afterOpenFunction=function(){if(strAfterOpen){new Function(strAfterOpen).apply(this);}
GS.triggerEvent(element,'after-open');};beforeCloseFunction=function(event,strAnswer){if(strBeforeClose){new Function('var strAnswer = \''+strAnswer.replace(/'/g,'donTGueSsThiSUniTokEN1975')+'\''+'.replace(/donTGueSsThiSUniTokEN1975/g, \'\\\'\');\n'+strBeforeClose).apply(this);}
GS.triggerEvent(element,'before-close',{'strAnswer':strAnswer});};afterCloseFunction=function(event,strAnswer){if(strAfterClose){new Function('var strAnswer = \''+strAnswer.replace(/'/g,'donTGueSsThiSUniTokEN1975')+'\''+'.replace(/donTGueSsThiSUniTokEN1975/g, \'\\\'\');\n'+strAfterClose).apply(element);}
GS.triggerEvent(element,'after-close',{'strAnswer':strAnswer});};if(strTargetSelector||element.hasAttribute('target')){strTargetSelector=(strTargetSelector||'this');targetElement=(strTargetSelector==='this'?element:document.querySelector(strTargetSelector));strDirection=(strDirection||'down');GS.openDialogToElement(targetElement,templateElement,strDirection,afterOpenFunction,beforeCloseFunction,afterCloseFunction);}else{GS.openDialog(templateElement,afterOpenFunction,beforeCloseFunction,afterCloseFunction);}}});})();window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-button>','<gs-button>','gs-button>${1}</gs-button>');designRegisterElement('gs-button','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-buttons-toggle.html');window.designElementProperty_GSBUTTON=function(selectedElement){var strIconPos,strIconRotation;addProp('Icon',true,'<div flex-horizontal>'+'     <gs-text id="prop-icon-input" class="target" value="'+(selectedElement.getAttribute('icon')||'')+'" mini flex></gs-text>'+'     <gs-button id="prop-icon-picker-button" mini icononly icon="list"></gs-button>'+'     <style>#prop-icon-picker-button:after {font-size: 1em;}</style>'+'</div>',function(){return setOrRemoveTextAttribute(selectedElement,'icon',this.value);});document.getElementById('prop-icon-picker-button').addEventListener('click',function(){var i,len,html,arrIcons=GS.iconList(),strName,templateElement;for(i=0,len=arrIcons.length,html='';i<len;i+=1){strName=arrIcons[i].name;html+='<gs-block>'+'<gs-button iconleft icon="'+strName+'" dialogclose>'+strName+'</gs-button>'+'</gs-block>';}
templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','1100px');templateElement.innerHTML=ml(function(){/*
                <gs-page>
                    <gs-header><center><h3>Choose An Icon</h3></center></gs-header>
                    <gs-body padded>
                        <gs-grid widths="1,1,1,1" reflow-at="767px">{{HTML}}</gs-grid>
                    </gs-body>
                    <gs-footer><gs-button dialogclose>Cancel</gs-button></gs-footer>
                </gs-page>
            */}).replace('{{HTML}}',html);GS.openDialog(templateElement,'',function(event,strAnswer){var propInput=document.getElementById('prop-icon-input');if(strAnswer!=='Cancel'){propInput.value=strAnswer;GS.triggerEvent(propInput,'change');}});});if(selectedElement.hasAttribute('iconleft')){strIconPos='iconleft';}else if(selectedElement.hasAttribute('iconright')){strIconPos='iconright';}else if(selectedElement.hasAttribute('icontop')){strIconPos='icontop';}else if(selectedElement.hasAttribute('iconbottom')){strIconPos='iconbottom';}else if(selectedElement.hasAttribute('icononly')){strIconPos='icononly';}else{strIconPos='';}
addProp('Icon Position',true,'<gs-select class="target" value="'+strIconPos+'" mini>'+'   <option value="">Default</option>'+'   <option value="iconleft">Left</option>'+'   <option value="iconright">Right</option>'+'   <option value="icontop">Top</option>'+'   <option value="iconbottom">Bottom</option>'+'   <option value="icononly">Icononly</option>'+'</gs-select>',function(){selectedElement.removeAttribute('iconleft');selectedElement.removeAttribute('iconright');selectedElement.removeAttribute('icontop');selectedElement.removeAttribute('iconbottom');selectedElement.removeAttribute('icononly');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});if(selectedElement.hasAttribute('iconrotateright')){strIconRotation='iconrotateright';}else if(selectedElement.hasAttribute('iconrotatedown')){strIconRotation='iconrotatedown';}else if(selectedElement.hasAttribute('iconrotateleft')){strIconRotation='iconrotateleft';}else{strIconRotation='';}
addProp('Icon&nbsp;Rotation',true,'<gs-select class="target" value="'+strIconRotation+'" mini>'+'   <option value="">None</option>'+'   <option value="iconrotateright">90 degrees</option>'+'   <option value="iconrotatedown">180 degrees</option>'+'   <option value="iconrotateleft">270 degrees</option>'+'</gs-select>',function(){selectedElement.removeAttribute('iconrotateright');selectedElement.removeAttribute('iconrotatedown');selectedElement.removeAttribute('iconrotateleft');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Href',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('href')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'href',this.value,false);});if(selectedElement.getAttribute('href')){addProp('Target',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('target')||'')+'" mini>'+'<option value="">New Window</option>'+'<option value="_self">Current Window</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'target',this.value,false);});}
addProp('Jumbo',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('jumbo'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'jumbo',(this.value==='true'),true);});addProp('Focusable',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-focus'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-focus',(this.value==='true'),false);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'0')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Inline',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('inline'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'inline',(this.value==='true'),true);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});/*
        addProp('Emphasis', true, '<gs-checkbox class="target" value="' + (selectedElement.hasAttribute('emphasis')) + '" mini></gs-checkbox>', function () {
            return setOrRemoveBooleanAttribute(selectedElement, 'emphasis', (this.value === 'true'), true);
        });
        */
var strFontAttribute='';if(selectedElement.hasAttribute('txt-primary')){strFontAttribute='txt-primary';}
if(selectedElement.hasAttribute('txt-success')){strFontAttribute='txt-success';}
if(selectedElement.hasAttribute('txt-info')){strFontAttribute='txt-info';}
if(selectedElement.hasAttribute('txt-warning')){strFontAttribute='txt-warning';}
if(selectedElement.hasAttribute('txt-danger')){strFontAttribute='txt-danger';}
addProp('Font Color',true,'<gs-select class="target" value="'+strFontAttribute+'" mini>'+'<option value="">Default</option>'+'<option value="txt-primary">Primary</option>'+'<option value="txt-success">Success</option>'+'<option value="txt-info">Info</option>'+'<option value="txt-warning">Warning</option>'+'<option value="txt-danger">Danger</option>'+'</gs-select>',function(){selectedElement.removeAttribute('txt-primary');selectedElement.removeAttribute('txt-success');selectedElement.removeAttribute('txt-info');selectedElement.removeAttribute('txt-warning');selectedElement.removeAttribute('txt-danger');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});var strBackgroundAttribute='';if(selectedElement.hasAttribute('bg-primary')){strBackgroundAttribute='bg-primary';}
if(selectedElement.hasAttribute('bg-success')){strBackgroundAttribute='bg-success';}
if(selectedElement.hasAttribute('bg-info')){strBackgroundAttribute='bg-info';}
if(selectedElement.hasAttribute('bg-warning')){strBackgroundAttribute='bg-warning';}
if(selectedElement.hasAttribute('bg-danger')){strBackgroundAttribute='bg-danger';}
addProp('Background Color',true,'<gs-select class="target" value="'+strBackgroundAttribute+'" mini>'+'<option value="">Default</option>'+'<option value="bg-primary">Primary</option>'+'<option value="bg-success">Success</option>'+'<option value="bg-info">Info</option>'+'<option value="bg-warning">Warning</option>'+'<option value="bg-danger">Danger</option>'+'</gs-select>',function(){selectedElement.removeAttribute('bg-primary');selectedElement.removeAttribute('bg-success');selectedElement.removeAttribute('bg-info');selectedElement.removeAttribute('bg-warning');selectedElement.removeAttribute('bg-danger');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Key',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('key')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'key',this.value,false);});addProp('No Modifier Key For Hot Key',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-modifier-key')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-modifier-key',this.value==='true',true);});addProp('Text',true,'<gs-text class="target" value="'+(selectedElement.textContent||'')+'" mini></gs-text>',function(){selectedElement.textContent=this.value;return selectedElement;});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Dialog Close',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('dialogclose')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'dialogclose',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function refreshAnchor(element){var strLink=element.getAttribute('href')||element.getAttribute('value');if(element.anchorElement){element.removeChild(element.anchorElement);}
if(strLink){element.anchorElement=document.createElement('a');element.anchorElement.setAttribute('gs-dynamic','');element.anchorElement.setAttribute('target',element.getAttribute('target')||'_blank');element.anchorElement.setAttribute('href',strLink);if(element.getAttribute('onclick')){element.anchorElement.setAttribute('onclick',element.getAttribute('onclick'));}
if(element.hasAttribute('download')){element.anchorElement.setAttribute('download',element.getAttribute('download'));}
element.appendChild(element.anchorElement);}}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.setAttribute('value',strQSValue);}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var strKey;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
if(!element.hasAttribute('no-focus')){if((!element.tabIndex)||element.tabIndex===-1){element.tabIndex=0;}}else{element.removeAttribute('tabindex');}
element.classList.remove('down');element.classList.remove('hover');if(!evt.touchDevice){element.addEventListener('focus',function(event){element.classList.add('focus');});element.addEventListener('blur',function(event){element.classList.remove('focus');});element.addEventListener(evt.mousedown,function(event){element.classList.add('down');});element.addEventListener(evt.mouseout,function(event){element.classList.remove('down');element.classList.remove('hover');});element.addEventListener(evt.mouseover,function(event){element.classList.remove('down');element.classList.add('hover');});element.addEventListener('keydown',function(event){if(!element.hasAttribute('disabled')&&(event.keyCode===13||event.keyCode===32)){element.classList.add('down');}});element.addEventListener('keyup',function(event){if(!element.hasAttribute('disabled')&&element.classList.contains('down')&&(event.keyCode===13||event.keyCode===32)){GS.triggerEvent(element,'click');}});}
refreshAnchor(element);element.addEventListener('click',function(event){element.classList.remove('down');});element.addEventListener('keypress',function(event){if(event.keyCode===13||event.keyCode===32){event.preventDefault();event.stopPropagation();}});strKey=element.getAttribute('key');if(strKey){if(GS.keyCode(strKey)){if(strKey.match(/[arfcvxzntypq]/gim)){console.warn('gs-button Warning: by setting the hot key of this button to "'+strKey+'" you may be overriding browser functionality.',element);}
window.addEventListener('keydown',function(event){if(String(event.keyCode||event.which)===GS.keyCode(strKey)&&((element.hasAttribute('no-modifier-key')&&!event.metaKey&&!event.ctrlKey)||(!element.hasAttribute('no-modifier-key')&&(event.metaKey||event.ctrlKey)))){event.preventDefault();event.stopPropagation();element.focus();GS.triggerEvent(element,'click');}});}else if(strKey.length>1){console.error('gs-button Error: \'key="'+strKey+'"\' is not a valid hot-key.',element);}}}}}
xtag.register('gs-button',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='no-focus'){if(!this.hasAttribute('no-focus')&&!this.hasAttribute('tabindex')){this.setAttribute('tabindex',0);}else if(this.hasAttribute('no-focus')){this.removeAttribute('tabindex');}}else if(strAttrName==='disabled'){this.classList.remove('down');}else if(strAttrName==='href'||strAttrName==='target'||strAttrName==='onclick'||strAttrName==='download'){refreshAnchor(this);}}}},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-checkbox>','<gs-checkbox>','gs-checkbox type="smallint" column="${1:ready_to_ship}">${2}</gs-checkbox>');registerDesignSnippet('<gs-checkbox> With Label','<gs-checkbox>','label for="${1:date-insert-ready_to_ship}">${2:Ready To Ship?}:</label>\n'+'<gs-checkbox id="${1:date-insert-ready_to_ship}" type="smallint" column="${3:ready_to_ship}"></gs-checkbox>');designRegisterElement('gs-checkbox','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-checkbox.html');window.designElementProperty_GSCHECKBOX=function(selectedElement){var strVisibilityAttribute;addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Triple State',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('triplestate'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'triplestate',(this.value==='true'),true);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Inline',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('inline'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'inline',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Type',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('type')||'')+'" mini>'+'<option value="">Detect</option>'+'<option value="smallint">Smallint</option>'+'<option value="boolean">Boolean</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'type',this.value);});strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'    <option value="">Visible</option>'+'    <option value="hidden">Invisible</option>'+'    <option value="hide-on-desktop">Invisible at desktop size</option>'+'    <option value="hide-on-tablet">Invisible at tablet size</option>'+'    <option value="hide-on-phone">Invisible at phone size</option>'+'    <option value="show-on-desktop">Visible at desktop size</option>'+'    <option value="show-on-tablet">Visible at tablet size</option>'+'    <option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){element.internal.bolQSFirstRun=true;if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
element.addEventListener('focus',function(event){element.classList.add('focus');});element.addEventListener('blur',function(event){element.classList.remove('focus');});element.addEventListener(evt.mouseout,function(event){element.classList.remove('hover');});element.addEventListener(evt.mouseover,function(event){element.classList.add('hover');});if(element.getAttribute('type')==='smallint'){element.value=element.getAttribute('value')||0;}else{element.value=element.getAttribute('value')||false;}
if(!element.hasAttribute('tabindex')){element.tabIndex=0;}}}}
xtag.register('gs-checkbox',{lifecycle:{created:function(){var element=this;if(!element.getAttribute('value')&&element.value!==null&&element.value!==undefined&&(typeof element.value==='boolean'||element.value==='-1'||element.value==='0'||element.value==='true'||element.value==='false'||element.value==='null'||element.value==='n')){element.setAttribute('value',element.value);delete element.value;}
elementCreated(element);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{'mousedown':function(){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){this.classList.add('down');}},'mouseout':function(){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(this.classList.contains('down')){this.classList.remove('down');}}},'click':function(event){var bolTripleState;var strValue;var strType;if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){bolTripleState=this.hasAttribute('triplestate');strValue=this.getAttribute('value').trim().toLowerCase();strType=this.getAttribute('type');if(strType!=='smallint'&&strType!=='boolean'){if(strValue==='false'||strValue==='true'||strValue==='null'){strType='boolean';}else if(strValue==='0'||strValue==='-1'||strValue==='n'){strType='smallint';}else{strType='boolean';}}
if(strType==='smallint'){if(strValue==='0'||strValue==='false'){strValue='0';}else if(strValue==='-1'||strValue==='true'){strValue='-1';}else if(strValue==='n'||strValue==='null'){strValue='n';}else{strValue='0';}}else if(strType==='boolean'){if(strValue==='0'||strValue==='false'){strValue='false';}else if(strValue==='-1'||strValue==='true'){strValue='true';}else if(strValue==='n'||strValue==='null'){strValue='null';}else{strValue='false';}}
if(strType==='smallint'){if(strValue==='0'){strValue='-1';}else if(strValue==='-1'){if(bolTripleState){strValue='n';}else{strValue='0';}}else if(strValue==='n'){strValue='0';}}else if(strType==='boolean'){if(strValue==='false'){strValue='true';}else if(strValue==='true'){if(bolTripleState){strValue='null';}else{strValue='false';}}else if(strValue==='null'){strValue='false';}}
this.setAttribute('value',strValue);this.classList.remove('down');xtag.fireEvent(this,'change',{bubbles:true,cancelable:true});}},'keydown':function(event){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){if(event.keyCode===13||event.keyCode===32){event.preventDefault();event.stopPropagation();}
if(!this.attributes.disabled&&(event.keyCode===13||event.keyCode===32)){xtag.fireEvent(this,'click',{bubbles:true,cancelable:true});}}}},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(newValue){this.setAttribute('value',newValue);}},textValue:{get:function(){var currentValue=this.getAttribute('value');if(currentValue==='-1'||currentValue==='true'){return'YES';}
if(currentValue==='0'||currentValue==='false'){return'NO';}
return'';},set:function(newValue){if(newValue==='YES'){newValue='true';}
if(newValue==='NO'){newValue='false';}
this.setAttribute('value',newValue);}}},methods:{}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-combo>','<gs-combo>','gs-combo src="${1:test.tpeople}" column="${2}"></gs-combo>');designRegisterElement('gs-combo','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-combo.html');window.designElementProperty_GSCOMBO=function(selectedElement){addProp('Source',true,'<gs-memo class="target" value="'+encodeHTML(decodeURIComponent(selectedElement.getAttribute('src')||selectedElement.getAttribute('source')||''))+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'src',encodeURIComponent(this.value));});addProp('Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('cols')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'cols',this.value);});addProp('Initialize Source',true,'<gs-memo class="target" value="'+encodeHTML(decodeURIComponent(selectedElement.getAttribute('initialize')||''))+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'initialize',encodeURIComponent(this.value));});addProp('Hide Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('hide')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'hide',this.value);});addProp('Where',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('where')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'where',this.value);});addProp('Order By',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('ord')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'ord',this.value);});addProp('Limit',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('limit')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'limit',this.value);});addProp('Offset',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('offset')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'offset',this.value);});addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Allow Empty',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('allow-empty'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'allow-empty',(this.value==='true'),true);});addProp('Limit&nbsp;To&nbsp;List',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('limit-to-list'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'limit-to-list',(this.value==='true'),true);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addProp('Refresh On Querystring Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('refresh-on-querystring-values')||'')+'" mini></gs-text>',function(){this.removeAttribute('refresh-on-querystring-change');return setOrRemoveTextAttribute(selectedElement,'refresh-on-querystring-values',this.value);});addProp('Refresh On Querystring Change',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('refresh-on-querystring-change'))+'" mini></gs-checkbox>',function(){this.removeAttribute('refresh-on-querystring-values');return setOrRemoveBooleanAttribute(selectedElement,'refresh-on-querystring-change',this.value==='true',true);});addFlexProps(selectedElement);addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function scrollToSelectedRecord(element){var positioningContainer,scrollingContainer,arrTrs,i,len,intScrollTop,bolFoundSelected=false;if(element.currentDropDownContainer){positioningContainer=xtag.queryChildren(element.currentDropDownContainer,'.gs-combo-positioning-container')[0];scrollingContainer=xtag.queryChildren(positioningContainer,'.gs-combo-scroll-container')[0];arrTrs=xtag.query(element.dropDownTable,'tr');for(i=0,intScrollTop=0,len=arrTrs.length;i<len;i+=1){if(arrTrs[i].hasAttribute('selected')){intScrollTop+=arrTrs[i].offsetHeight/2;bolFoundSelected=true;break;}else{intScrollTop+=arrTrs[i].offsetHeight;}}
if(bolFoundSelected){intScrollTop=intScrollTop-scrollingContainer.offsetHeight/2;}else{intScrollTop=0;}
scrollingContainer.scrollTop=intScrollTop;}}
function clearSelection(element){var i,len,arrSelectedTrs;arrSelectedTrs=xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr[selected]');for(i=0,len=arrSelectedTrs.length;i<len;i+=1){arrSelectedTrs[i].removeAttribute('selected');}}
function highlightRecord(element,record){clearSelection(element);record.setAttribute('selected','');}
function findRecordFromString(element,strSearchString,bolPartialMatchAllowed){var i,len,matchedRecord,arrTrs=xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr');if(bolPartialMatchAllowed===true){strSearchString=strSearchString.toLowerCase();for(i=0,len=arrTrs.length;i<len;i+=1){if(xtag.queryChildren(arrTrs[i],'td')[0].textContent.toLowerCase().indexOf(strSearchString)===0){matchedRecord=arrTrs[i];break;}}}else{for(i=0,len=arrTrs.length;i<len;i+=1){if(arrTrs[i].getAttribute('value')===strSearchString||xtag.queryChildren(arrTrs[i],'td')[0].textContent===strSearchString){matchedRecord=arrTrs[i];break;}}}
return matchedRecord;}
function selectRecord(element,record,bolChange){highlightRecord(element,record);handleChange(element,bolChange);}
function selectRecordFromValue(element,strValue,bolChange){var record=findRecordFromString(element,strValue,false);if(record){selectRecord(element,record,bolChange);}else if(element.hasAttribute('limit-to-list')&&bolChange){if(strValue===''&&element.hasAttribute('allow-empty')){handleChange(element,bolChange);}else{alert('The text you entered is not in the list');openDropDown(element);GS.setInputSelection(element.control,0,strValue.length);}}else{clearSelection(element);if(!element.hasAttribute('limit-to-list')){element.control.value=strValue;element.innerValue=strValue;}
handleChange(element,bolChange);}}
function handleChange(element,bolChange){var arrSelectedTrs,strHiddenValue='',strTextValue='',beforechangeevent,oldRecord,oldInnerValue=element.innerValue,oldControlValue=element.control.value;if(element.dropDownTable){arrSelectedTrs=xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr[selected]');if(arrSelectedTrs.length>0){strHiddenValue=arrSelectedTrs[0].getAttribute('value');var firstTd=xtag.queryChildren(arrSelectedTrs[0],'td')[0],lastChild=firstTd.lastElementChild;if(lastChild&&lastChild.tagName.substring(0,3)==='GS-'){strTextValue=lastChild.textValue||lastChild.value||lastChild.textContent;}else{strTextValue=firstTd.textContent;}}else{strTextValue=element.control.value;}}else{strTextValue=element.control.value;}
element.innerValue=strHiddenValue||strTextValue;element.control.value=strTextValue||strHiddenValue;if(bolChange){if(document.createEvent){beforechangeevent=document.createEvent('HTMLEvents');beforechangeevent.initEvent('beforechange',true,true);}else{beforechangeevent=document.createEventObject();beforechangeevent.eventType='beforechange';}
beforechangeevent.eventName='beforechange';if(document.createEvent){element.dispatchEvent(beforechangeevent);}else{element.fireEvent("on"+beforechangeevent.eventType,beforechangeevent);}
if(beforechangeevent.defaultPrevented!==true){xtag.fireEvent(element,'change',{bubbles:true,cancelable:true});}else{element.innerValue=oldInnerValue;element.control.value=oldControlValue;oldRecord=findRecordFromString(element,oldInnerValue,false);if(oldRecord){highlightRecord(element,oldRecord);}else{clearSelection(element);}}
element.ignoreChange=false;}}
function openDropDown(element){if(!element.droppingDown){if(element.getAttribute('src')||element.getAttribute('source')){getData(element,false,true,function(){dropDown(element);});}else{dropDown(element);}
element.droppingDown=true;}}
function dropDown(element){var dropDownContainer=document.createElement('div'),overlay,positioningContainer,scrollContainer,observer;element.control.focus();dropDownContainer.classList.add('gs-combo-dropdown-container');dropDownContainer.setAttribute('gs-dynamic','');dropDownContainer.innerHTML='<div class="gs-combo-positioning-container" gs-dynamic>'+'    <div class="gs-combo-scroll-container" gs-dynamic></div>'+'</div>';document.body.appendChild(dropDownContainer);positioningContainer=xtag.queryChildren(dropDownContainer,'.gs-combo-positioning-container')[0];scrollContainer=xtag.queryChildren(positioningContainer,'.gs-combo-scroll-container')[0];element.currentDropDownContainer=dropDownContainer;if(element.dropDownTable){scrollContainer.appendChild(element.dropDownTable);}else{scrollContainer.innerHTML=element.initalHTML;}
observer=new MutationObserver(function(mutations){dropDownSize(element);});observer.observe(scrollContainer,{childList:true,subtree:true});dropDownSize(element);}
function dropDownSize(element){var dropDownContainer=element.currentDropDownContainer,positioningContainer=xtag.queryChildren(dropDownContainer,'.gs-combo-positioning-container')[0],scrollContainer=xtag.queryChildren(positioningContainer,'.gs-combo-scroll-container')[0],overlay,jsnComboOffset,intComboHeight,intComboWidth,intViewportWidth,intViewportHeight,intFromControlToBottomHeight,intFromControlToTopHeight,intContentHeight,intNewWidth,strWidth='',strHeight='',strLeft='',strTop='',strBottom='';intComboHeight=element.offsetHeight;intComboWidth=element.offsetWidth;intViewportHeight=window.innerHeight;intViewportWidth=window.innerWidth;jsnComboOffset=GS.getElementOffset(element);intContentHeight=scrollContainer.scrollHeight;intFromControlToBottomHeight=intViewportHeight-(jsnComboOffset.top+intComboHeight);intFromControlToTopHeight=jsnComboOffset.top;if(!evt.touchDevice){if(window.innerHeight<500&&intContentHeight>intFromControlToTopHeight&&intContentHeight>intFromControlToBottomHeight){strHeight=window.innerHeight+'px';strTop='0px';}else if(intContentHeight<500){strHeight='200px';if(intFromControlToBottomHeight>intFromControlToTopHeight||intFromControlToBottomHeight>200){strTop=(intFromControlToTopHeight+intComboHeight)+'px';}else{strBottom=(intFromControlToBottomHeight+intComboHeight)+'px';}}else if(intFromControlToBottomHeight>=intFromControlToTopHeight){strHeight=intFromControlToBottomHeight+'px';strTop=(intFromControlToTopHeight+intComboHeight)+'px';}else{strHeight=intFromControlToTopHeight+'px';strBottom=(intFromControlToBottomHeight+intComboHeight)+'px';}}else{if(intFromControlToBottomHeight>200&&intContentHeight<500){strHeight=intFromControlToBottomHeight+'px';strTop=(intFromControlToTopHeight+intComboHeight)+'px';}else if(intFromControlToTopHeight>200&&intContentHeight<500){strHeight=intFromControlToTopHeight+'px';strBottom=(intFromControlToBottomHeight+intComboHeight)+'px';}else{strHeight=window.innerHeight+'px';strTop='0px';}}
if(scrollContainer.scrollWidth<=scrollContainer.offsetWidth){if(intComboWidth<150){intNewWidth=(window.innerWidth-jsnComboOffset.left)-20;if(intNewWidth<300){strWidth=intNewWidth+'px';}else{strWidth='300px';}}else{strWidth=intComboWidth+'px';}
strLeft=jsnComboOffset.left+'px';}else{strWidth='100%';strLeft='0px';}
positioningContainer.style.left=strLeft;positioningContainer.style.top=strTop;positioningContainer.style.bottom=strBottom;positioningContainer.style.width=strWidth;positioningContainer.style.height=strHeight;if(strTop){dropDownContainer.classList.add('below');}else{dropDownContainer.classList.add('above');}
if(scrollContainer.clientWidth<scrollContainer.scrollWidth&&xtag.query(scrollContainer,'tbody tr:first-child td, tbody tr:first-child th').length>1){scrollContainer.classList.add('reflow');}
if(intContentHeight<scrollContainer.clientHeight){positioningContainer.style.height=intContentHeight+'px';}
element.classList.add('open');element.open=true;bindDropDown(element);scrollToSelectedRecord(element);}
function bindDropDown(element){var selectableTrs,closeDropDownHandler,selectRecordHandler,i,len,unbindSelectRecordHandler,unbindDropDownEvents,wheelHandler;wheelHandler=function(event){var tableElement=GS.findParentElement(event.target,'.gs-combo-dropdown-container');if(tableElement!==element.currentDropDownContainer){closeDropDownHandler();}};unbindDropDownEvents=function(){var i,len;for(i=0,len=selectableTrs.length;i<len;i+=1){selectableTrs[i].removeEventListener('click',selectRecordHandler);}
window.removeEventListener('resize',closeDropDownHandler);window.removeEventListener('orientationchange',closeDropDownHandler);window.removeEventListener('mousewheel',wheelHandler);document.body.removeEventListener('click',closeDropDownHandler);};selectableTrs=xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr');selectRecordHandler=function(event){selectRecord(element,GS.findParentTag(event.target,'tr'),true);closeDropDownHandler();};for(i=0,len=selectableTrs.length;i<len;i+=1){selectableTrs[i].addEventListener('click',selectRecordHandler);}
closeDropDownHandler=function(event){closeDropDown(element);unbindDropDownEvents();};window.addEventListener('resize',closeDropDownHandler);window.addEventListener('orientationchange',closeDropDownHandler);window.addEventListener('mousewheel',wheelHandler);document.body.addEventListener('click',closeDropDownHandler);}
function closeDropDown(element){if(element.currentDropDownContainer){document.body.removeChild(element.currentDropDownContainer);element.currentDropDownContainer=undefined;element.classList.remove('open');element.open=false;element.droppingDown=false;}}
function handleKeyDown(element,event){var intKeyCode=event.keyCode||event.which,selectedTr,trs,i,len,selectedRecordIndex,firstTd,lastChild,strTextValue;if(!element.hasAttribute('disabled')&&!element.hasAttribute('readonly')){if((intKeyCode===40||intKeyCode===38)&&!event.shiftKey&&!event.metaKey&&!event.ctrlKey&&!element.error){if(!element.open){openDropDown(element);}else{trs=xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr');for(i=0,len=trs.length;i<len;i+=1){if(trs[i].hasAttribute('selected')){selectedRecordIndex=i;selectedTr=trs[i];trs[i].removeAttribute('selected');break;}}
if(intKeyCode===40){if(!selectedTr||selectedRecordIndex===trs.length-1){highlightRecord(element,trs[0]);selectedTr=trs[0];}else{highlightRecord(element,trs[selectedRecordIndex+1]);selectedTr=trs[selectedRecordIndex+1];}}else if(intKeyCode===38){if(!selectedTr||selectedRecordIndex===0){highlightRecord(element,trs[trs.length-1]);selectedTr=trs[trs.length-1];}else{highlightRecord(element,trs[selectedRecordIndex-1]);selectedTr=trs[selectedRecordIndex-1];}}
scrollToSelectedRecord(element);}
if(selectedTr){element.control.value=xtag.queryChildren(selectedTr,'td')[0].textContent;}
GS.setInputSelection(element.control,0,element.control.value.length);event.preventDefault();event.stopPropagation();}else if((intKeyCode===39)&&!event.shiftKey&&!event.metaKey&&!event.ctrlKey&&!element.error){selectedTr=xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr[selected]')[0];if(selectedTr){firstTd=xtag.queryChildren(selectedTr,'td')[0];lastChild=firstTd.lastElementChild;if(lastChild&&lastChild.tagName.substring(0,3)==='GS-'){strTextValue=lastChild.textValue||lastChild.value||lastChild.textContent;}else{strTextValue=firstTd.textContent;}
selectRecord(element,selectedTr,element.innerValue!==(selectedTr.getAttribute('value')||strTextValue));}
event.stopPropagation();}else if(event.keyCode===13||event.keyCode===9){if(element.dropDownTable&&xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr[selected]').length>0){selectRecordFromValue(element,element.control.value,true);element.ignoreChange=true;}
closeDropDown(element);}else if(!event.metaKey&&!event.ctrlKey&&event.keyCode!==37&&event.keyCode!==38&&event.keyCode!==39&&event.keyCode!==40&&event.keyCode!==46&&event.keyCode!==8){element.attemptSearchOnNextKeyup=true;}}else{if(event.keyCode!==9){event.preventDefault();event.stopPropagation();}}}
function handleKeyUp(element,event){var intKeyCode=event.keyCode||event.which,strSearch=element.control.value,matchRecord;if(element.attemptSearchOnNextKeyup===true&&strSearch&&GS.getInputSelection(element.control).start===strSearch.length){if(xtag.queryChildren(xtag.queryChildren(element.dropDownTable,'tbody')[0],'tr').length>2000){var strSearchCol='',templateElement=element.tableTemplate;templateElement=templateElement.substring(templateElement.indexOf('td'),templateElement.indexOf('/td')-1);templateElement=templateElement.substring(templateElement.indexOf('{'),templateElement.length);if(templateElement.indexOf('row.')===-1){if(templateElement.indexOf('row[')===-1){console.warn('There is no doT.js in the first "<td>" in your template please fill your first "<td>" with templating code.');}else{templateElement=templateElement.substring(parseInt(templateElement.indexOf('row['),10)+5,templateElement.length-2-3).trim();}}else{templateElement=templateElement.substring(parseInt(templateElement.indexOf('row.'),10)+4,templateElement.length-3).trim();}
strSearchCol=templateElement;var strSrc=GS.templateWithQuerystring(element.getAttribute('src')),srcParts=strSrc[0]==='('?[strSrc,'']:strSrc.split('.'),strSchema=srcParts[0],strObject=srcParts[1],strColumns=GS.templateWithQuerystring(element.getAttribute('cols')||'*').split(',').join('\t'),strWhere=(element.hasAttribute('where')?GS.templateWithQuerystring(element.getAttribute('where')||'')+' AND '+strSearchCol+'::text ILIKE $UnCOPYQTE$'+strSearch+'%$UnCOPYQTE$':strSearchCol+'::text ILIKE $UnCOPYQTE$'+strSearch+'%$UnCOPYQTE$'),strOrd=GS.templateWithQuerystring(element.getAttribute('ord')||''),strLimit='1',strOffset=GS.templateWithQuerystring(element.getAttribute('offset')||''),response_i=0,response_len=0,arrTotalRecords=[];if(strSearchCol){GS.requestSelectFromSocket(GS.envSocket,strSchema,strObject,strColumns,strWhere,strOrd,strLimit,strOffset,function(data,error){var arrCells,cell_i,cell_len;if(!error){if(data.strMessage!=='TRANSACTION COMPLETED'){arrCells=arrRecords[i].split('\t');element.control.value=arrCells[0]=arrCells[0]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[0]);GS.setInputSelection(element.control,strSearch.length,element.control.value.length);if(element.open){matchRecord=findRecordFromString(element,strSearch,true);if(matchRecord){highlightRecord(element,matchRecord);scrollToSelectedRecord(element);}}}}else{handleData(element,bolInitalLoad,data,error);}});}}else{matchRecord=findRecordFromString(element,strSearch,true);if(matchRecord){highlightRecord(element,matchRecord);element.control.value=xtag.queryChildren(matchRecord,'td')[0].textContent;GS.setInputSelection(element.control,strSearch.length,element.control.value.length);scrollToSelectedRecord(element);}else{clearSelection(element);}}}
if(element.attemptSearchOnNextKeyup===true){element.attemptSearchOnNextKeyup=false;}}
function getData(element,bolInitalLoad,bolClearPrevious,callback){var strSrc=GS.templateWithQuerystring((bolInitalLoad&&element.getAttribute('initialize')?element.getAttribute('initialize'):element.getAttribute('src'))),srcParts=strSrc[0]==='('?[strSrc,'']:strSrc.split('.'),strSchema=srcParts[0],strObject=srcParts[1],strColumns=GS.templateWithQuerystring(element.getAttribute('cols')||'*').split(',').join('\t'),strWhere=GS.templateWithQuerystring(element.getAttribute('where')||''),strOrd=GS.templateWithQuerystring(element.getAttribute('ord')||''),strLimit=GS.templateWithQuerystring(element.getAttribute('limit')||''),strOffset=GS.templateWithQuerystring(element.getAttribute('offset')||''),response_i=0,response_len=0,arrTotalRecords=[];GS.requestCachingSelect(GS.envSocket,strSchema,strObject,strColumns,strWhere,strOrd,strLimit,strOffset,function(data,error){var arrRecords,arrCells,envData,i,len,cell_i,cell_len;if(!error){if(data.strMessage!=='TRANSACTION COMPLETED'){arrRecords=GS.trim(data.strMessage,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}else{element.arrColumnNames=data.arrColumnNames;envData={'arr_column':element.arrColumnNames,'dat':arrTotalRecords};handleData(element,bolInitalLoad,envData);if(typeof callback==='function'){callback();}}}else{handleData(element,bolInitalLoad,data,error);}},bolClearPrevious);}
function handleData(element,bolInitalLoad,data,error){var divElement,tableElement,theadElement,theadCellElements,tbodyElement,tbodyCellElements,lastRecordElement,currentCellLabelElement,template,i,len,arrHeaders=[],strTemplate,arrHide,strHeaderCells,strRecordCells,tableTemplateElement,recordElements,recordElement,jsnTemplate,strHTML;element.classList.remove('error');element.dropDownButton.setAttribute('title','');element.dropDownButton.setAttribute('icon','angle-down');if(!error){element.error=false;if(element.tableTemplate){strTemplate=element.tableTemplate;}else{arrHide=(element.getAttribute('hide')||'').split(/[\s]*,[\s]*/);for(i=0,len=data.arr_column.length,strHeaderCells='',strRecordCells='';i<len;i+=1){if(arrHide.indexOf((i+1)+'')===-1&&arrHide.indexOf(data.arr_column[i])===-1){strHeaderCells+='<th gs-dynamic>'+encodeHTML(data.arr_column[i])+'</th> ';strRecordCells+='<td gs-dynamic>{{! row[\''+data.arr_column[i]+'\'] }}</td> ';}}
strTemplate='<table gs-dynamic>'+'<thead gs-dynamic>'+'<tr gs-dynamic>'+
strHeaderCells+'</tr>'+'</thead>'+'<tbody gs-dynamic>'+'<tr value="{{! row[\''+data.arr_column[0]+'\'] }}" gs-dynamic>'+
strRecordCells+'</tr>'+'</tbody>'+'<table>';}
divElement=document.createElement('div');divElement.innerHTML=strTemplate;tableElement=xtag.queryChildren(divElement,'table')[0];theadElement=xtag.queryChildren(tableElement,'thead')[0];tbodyElement=xtag.queryChildren(tableElement,'tbody')[0];if(tbodyElement){recordElement=xtag.queryChildren(tbodyElement,'tr')[0];if(recordElement){if(theadElement){theadCellElements=xtag.query(theadElement,'td, th');tbodyCellElements=xtag.query(tbodyElement,'td, th');for(i=0,len=theadCellElements.length;i<len;i+=1){currentCellLabelElement=document.createElement('b');currentCellLabelElement.classList.add('cell-label');currentCellLabelElement.setAttribute('data-text',(theadCellElements[i].textContent||'')+':');currentCellLabelElement.setAttribute('gs-dynamic','');if(tbodyCellElements[i].childNodes){tbodyCellElements[i].insertBefore(currentCellLabelElement,tbodyCellElements[i].childNodes[0]);}else{tbodyCellElements[i].insertChild(currentCellLabelElement);}}}
jsnTemplate=GS.templateHideSubTemplates(tbodyElement.innerHTML,true);strHTML=GS.templateWithEnvelopeData(tbodyElement.innerHTML,data);tbodyElement.innerHTML=GS.templateShowSubTemplates(strHTML,jsnTemplate);element.dropDownTable=tableElement;element.ready=true;}}
if(bolInitalLoad&&element.getAttribute('value')){selectRecordFromValue(element,element.getAttribute('value'),false);}else if(element.value){selectRecordFromValue(element,element.value,false);}}else{console.error(data);element.error=true;element.ready=false;element.classList.add('error');element.dropDownButton.setAttribute('title','This combobox has failed to load.');element.dropDownButton.setAttribute('icon','exclamation-circle');if(element.hasAttribute('limit-to-list')){element.setAttribute('disabled','');}}}
function refreshControl(element){var i,len,divElement,arrPassThroughAttributes=['placeholder','name','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','spellcheck','readonly'];if(element.hasAttribute('tabindex')){element.savedTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
element.innerHTML='';divElement=document.createElement('div');divElement.setAttribute('gs-dynamic','');divElement.classList.add('root');element.appendChild(divElement);element.root=divElement;element.root.innerHTML='<input gs-dynamic class="control" type="text" />'+'<gs-button gs-dynamic class="drop_down_button" icononly icon="angle-down" no-focus></gs-button>';element.control=xtag.query(element,'.control')[0];element.dropDownButton=xtag.query(element,'.drop_down_button')[0];for(i=0,len=arrPassThroughAttributes.length;i<len;i+=1){if(element.hasAttribute(arrPassThroughAttributes[i])){element.control.setAttribute(arrPassThroughAttributes[i],element.getAttribute(arrPassThroughAttributes[i])||'');}}
if(element.savedTabIndex!==undefined&&element.savedTabIndex!==null){element.control.setAttribute('tabindex',element.savedTabIndex);}
element.control.addEventListener('change',function(event){event.preventDefault();event.stopPropagation();if(!element.ignoreChange){selectRecordFromValue(element,this.value,true);}
element.ignoreChange=false;});element.control.addEventListener('change',function(event){element.changeOccured=true;});element.control.addEventListener('focus',function(event){element.lastValue=element.control.value;event.target.parentNode.parentNode.classList.add('focus');});element.control.addEventListener('blur',function(event){if(element.changeOccured===true){element.changeOccured=false;}else if(element.control.value!==element.lastValue){GS.triggerEvent(element.control,'change');}
event.target.parentNode.parentNode.classList.remove('focus');});element.control.addEventListener(evt.mouseout,function(event){event.target.parentNode.parentNode.classList.remove('hover');});element.control.addEventListener(evt.mouseover,function(event){event.target.parentNode.parentNode.classList.add('hover');});element.control.addEventListener('keyup',function(event){if((event.keyCode||event.which)===13&&!element.hasAttribute('readonly')){if(element.changeOccured===true){element.changeOccured=false;}else if(element.control.value!==element.lastValue){GS.triggerEvent(element.control,'change');}}});}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var arrPopKeys;var currentValue;var bolRefresh;var strOperator;if(strQSCol){if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}}
if(element.internal.bolQSFirstRun===true){if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){currentValue=GS.qryGetVal(strQS,arrPopKeys[i]);if(element.popValues[arrPopKeys[i]]!==currentValue){bolRefresh=true;}
element.popValues[arrPopKeys[i]]=currentValue;}}else if(element.hasAttribute('refresh-on-querystring-change')){bolRefresh=true;}
if(bolRefresh&&element.hasAttribute('src')){getData(element);}else if(bolRefresh&&!element.hasAttribute('src')){console.warn('gs-combo Warning: element has "refresh-on-querystring-values" or "refresh-on-querystring-change", but no "src".',element);}}else{if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){element.popValues[arrPopKeys[i]]=GS.qryGetVal(strQS,arrPopKeys[i]);}}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var tableTemplateElement,tableTemplateElementCopy,oldRootElement,i,len,recordElement,strQueryString=GS.getQueryString(),arrElement,currentElement,strQSValue;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);element.open=false;element.error=false;element.ready=false;if(element.getAttribute('qs')||element.getAttribute('refresh-on-querystring-values')||element.hasAttribute('refresh-on-querystring-change')){element.popValues={};pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
tableTemplateElement=xtag.queryChildren(element,'template')[0];if(tableTemplateElement){tableTemplateElementCopy=document.createElement('template');tableTemplateElementCopy.innerHTML=tableTemplateElement.innerHTML;recordElement=xtag.query(xtag.query(tableTemplateElementCopy.content,'tbody')[0],'tr')[0];if(recordElement){arrElement=xtag.query(recordElement,'[column]');for(i=0,len=arrElement.length;i<len;i+=1){currentElement=arrElement[i];if((!currentElement.getAttribute('value'))&&currentElement.getAttribute('column')){currentElement.setAttribute('value','{{! row.'+currentElement.getAttribute('column')+' }}');}}
element.tableTemplate=tableTemplateElementCopy.innerHTML;if(!element.getAttribute('src')&&!element.getAttribute('source')&&!element.getAttribute('initalize')){element.dropDownTable=GS.cloneElement(xtag.query(tableTemplateElementCopy.content,'table')[0]);}}}
refreshControl(element);element.addEventListener('click',function(event){var clickHandler;if(event.target.classList.contains('drop_down_button')){if(!element.open&&!element.error){clickHandler=function(){openDropDown(element);window.removeEventListener('click',clickHandler);};window.addEventListener('click',clickHandler);}else{}}});element.addEventListener('keydown',function(event){if(event.target.classList.contains('control')){handleKeyDown(element,event);}});element.addEventListener('keyup',function(event){if(event.target.classList.contains('control')){handleKeyUp(element,event);}});if(xtag.queryChildren(element,'.root').length<1){refreshControl(element);}
if(element.getAttribute('src')||element.getAttribute('source')||element.getAttribute('initalize')){getData(element,true);}else{element.ready=true;if(element.getAttribute('value')){selectRecordFromValue(element,element.getAttribute('value'),false);}else if(element.value){selectRecordFromValue(element,element.value,false);}}}}}
xtag.register('gs-combo',{lifecycle:{created:function(){if(this.value&&!this.hasAttribute('value')){this.setAttribute('value',this.value);delete this.value;}
elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='value'&&oldValue!==newValue){this.value=newValue;}}}},events:{},accessors:{value:{get:function(){if(this.control||this.innerValue){return this.innerValue||this.control.value;}else if(this.getAttribute('value')){return this.getAttribute('value');}
return undefined;},set:function(newValue){if(this.ready===false){if(newValue!==this.getAttribute('value')){this.setAttribute('value',newValue);}}else if(newValue===''&&this.hasAttribute('allow-empty')){this.innerValue='';this.control.value='';}else{selectRecordFromValue(this,newValue,false);}}},textValue:{get:function(){return this.control.value;},set:function(newValue){if(this.ready===false){this.setAttribute('value',newValue);}else{selectRecordFromValue(this,newValue,false);}}}},methods:{focus:function(){this.control.focus();},'getData':function(){getData(this,undefined,true);},'refresh':function(){getData(this,undefined,true);}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-container>','<gs-container>','gs-container min-width="${1:sml;med;lrg;}" ${2:padded}>\n'+'    ${0}\n'+'</gs-container>');designRegisterElement('gs-container','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-container-jumbo.html');window.designElementProperty_GSCONTAINER=function(selectedElement){var strVisibilityAttribute;addProp('Min-Width Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('min-width')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'min-width',this.value);});addProp('Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('media')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'media',this.value);});addProp('Padded',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('padded'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'padded',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var arrTakenContainers=[],intScrollBarWidth;function getScrollBarWidth(){var inner=document.createElement('div'),outer=document.createElement('div'),intWidth;inner.style.height='200px';outer.style.position='absolute';outer.style.top='0';outer.style.left='0';outer.style.visibility='hidden';outer.style.overflow='scroll';outer.style.width='50px';outer.style.height='100px';outer.appendChild(inner);document.body.appendChild(outer);intWidth=(outer.offsetWidth-inner.offsetWidth);document.body.removeChild(outer);return intWidth;};intScrollBarWidth=getScrollBarWidth();function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var styleElement;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;if(!document.getElementById('gs-dynamic-css')){styleElement=document.createElement('style');styleElement.setAttribute('id','gs-dynamic-css');styleElement.setAttribute('gs-dynamic','');document.head.appendChild(styleElement);}
if(element.getAttribute('min-width')){element.handleMinWidthCSS();}else if(element.getAttribute('media')){element.handleMediaCSS();}}}}
xtag.register('gs-container',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='min-width'){this.handleMinWidthCSS();}else if(strAttrName==='media'){this.handleMediaCSS();}}}},events:{},accessors:{},methods:{handleMinWidthCSS:function(){var strMinWidth=this.getAttribute('min-width'),arrMinWidths,strCSS,i,len,arrClassesToRemove,intContainerID,intWidthNumber,strWidthOperator,strNewWidth;arrClassesToRemove=String(this.classList).match(/container-id-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
strMinWidth=GS.trim(strMinWidth.replace(/\s+/g,'').toLowerCase(),';');strMinWidth=strMinWidth.replace(/small|sml/g,'768px').replace(/medium|med/g,'992px').replace(/large|lrg/g,'1200px');arrMinWidths=strMinWidth.split(';');if(arrTakenContainers.indexOf(strMinWidth)===-1){arrTakenContainers.push(strMinWidth);intContainerID=arrTakenContainers.length-1;strCSS='';for(i=0,len=arrMinWidths.length;i<len;i+=1){intWidthNumber=parseInt(arrMinWidths[i]);strWidthOperator=arrMinWidths[i].replace(/[0-9]/g,'');if(strWidthOperator==='px'){intWidthNumber-=intScrollBarWidth;}else if(strWidthOperator==='em'){intWidthNumber-=GS.pxToEm(this.parentNode,intScrollBarWidth);}
strNewWidth=intWidthNumber+strWidthOperator;strCSS+='\n@media (min-width:'+arrMinWidths[i]+') {\n'+'    gs-container.container-id-'+intContainerID+' { width:'+strNewWidth+'; margin-left:auto; margin-right:auto; }\n'+'}\n';}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* container #'+intContainerID+' */\n'+strCSS;}else{intContainerID=arrTakenContainers.indexOf(strMinWidth);}
this.classList.add('container-id-'+intContainerID);},handleMediaCSS:function(){var strMedia=this.getAttribute('media'),arrMedias,strCSS,i,len,arrClassesToRemove,arrParts,strCurrentMedia,strWidth,intContainerID;arrClassesToRemove=String(this.classList).match(/container-id-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
strMedia=GS.trim(strMedia.trim().replace(/\}/g,'').toLowerCase(),';');strMedia=strMedia.replace(/small|sml/g,'768px').replace(/medium|med/g,'992px').replace(/large|lrg/g,'1200px');arrMedias=strMedia.split(';');if(arrTakenContainers.indexOf(strMedia)===-1){arrTakenContainers.push(strMedia);intContainerID=arrTakenContainers.length-1;strCSS='';for(i=0,len=arrMedias.length;i<len;i+=1){arrParts=arrMedias[i].split('{');strCurrentMedia=arrParts[0].trim()||'all';strWidth=arrParts[1].trim()||'900px';strCSS+='\n@media '+strCurrentMedia+' {\n'+'    gs-container.container-id-'+intContainerID+' '+'{ width:'+strWidth+'; margin-left:auto; margin-right:auto; }\n'+'}\n';}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* container #'+intContainerID+' */\n'+strCSS;}else{intContainerID=arrTakenContainers.indexOf(strMinWidth);}
this.classList.add('container-id-'+intContainerID);}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-current-record>','<gs-current-record>','gs-current-record for="${1:for}"></gs-current-record>');window.designElementProperty_GSCURRENT_RECORD=function(selectedElement){addProp('For',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('for')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'for',this.value);});addProp('Inline',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('inline')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'inline',this.value==='true',true);});};});document.addEventListener("DOMContentLoaded",function(){"use strict";function buildElement(element){element.forTable=document.getElementById(element.getAttribute('for'));element.forTable.addEventListener('selection_change',function(){element.refresh(element);});element.forTable.addEventListener('after_select',function(){element.refresh(element);});element.forTable.addEventListener('after_selection',function(){element.refresh(element);});element.firstChild.addEventListener('change',function(event){var tableElem=element.forTable;var strValue=event.target.value;var intValue=parseInt(strValue.substring(0,strValue.indexOf(' ')),10);var intMaxRecord=tableElem.internalData.records.length;var intMinColumn=(tableElem.internalDisplay.recordSelectorVisible?-1:0);if(isNaN(intValue)){intValue=1;}
if(intMaxRecord===0){intValue=undefined;}
if(intValue>intMaxRecord){intValue=intMaxRecord;}
if(!isNaN(intValue)){intValue-=1;}
if(intValue!==undefined){tableElem.internalSelection.ranges=[{"start":{"row":intValue,"column":intMinColumn},"end":{"row":intValue,"column":intMinColumn},"negator":false}];}else{tableElem.internalSelection.ranges=[];}
tableElem.goToLine(intValue+1);event.target.parentNode.refresh(event.target.parentNode);});}
function elementInserted(element){if(element.children.length===0){var gsText=document.createElement("gs-text");element.appendChild(gsText);}
if(!element.hasAttribute("suspend-created")&&!element.hasAttribute("suspend-inserted")){if(!element.inserted){element.inserted=true;if(!element.children[0].classList.contains('root')){buildElement(element);}}}}
xtag.register("gs-current-record",{lifecycle:{inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==="suspend-created"&&newValue===null){elementInserted(element);}else if(strAttrName==="suspend-inserted"&&newValue===null){elementInserted(element);}}},events:{},accessors:{},methods:{'refresh':function(element){element.bolRefreshing=true;var tableElem=element.forTable;var intOriginRecord=(tableElem.internalSelection.originRecord);var statusElement=element.firstChild;if(statusElement){if(intOriginRecord!==undefined){statusElement.value=((intOriginRecord+1)+' of '+
tableElem.internalData.records.length);}else{statusElement.value=('nothing selected');}}
element.bolRefreshing=false;}}});});window.addEventListener('design-register-element',function(event){'use strict';registerDesignSnippet('<gs-datasheet>','<gs-datasheet>','gs-datasheet src="${1:test.tpeople}">\n'+'    <template for="hud"></template>\n'+'    <template for="table">\n'+'        <table>\n'+'            <tbody>\n'+'                <tr>\n'+'                    <th heading="#"><gs-static column="row_number"></gs-static></th>\n'+'                    <td heading="">$0</td>\n'+'                </tr>\n'+'            </tbody>\n'+'        </table>\n'+'    </template>\n'+'    <template for="insert"></template>\n'+'</gs-datasheet>');designRegisterElement('gs-datasheet','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-datasheet.html');window.designElementProperty_GSDATASHEET=function(selectedElement){addProp('Source',true,'<gs-memo class="target" autoresize rows="1" value="'+
encodeHTML(decodeURIComponent(selectedElement.getAttribute('src')))+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'src',encodeURIComponent(this.value));});addProp('Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('cols')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'cols',this.value);});addProp('Lock Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('lock')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'lock',this.value);});addProp('Primary Keys',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('pk')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'pk',this.value);});addProp('Where',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('where')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'where',(this.value));});addProp('Order By',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('ord')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'ord',this.value);});addProp('Limit',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('limit')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'limit',this.value);});addProp('Offset',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('offset')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'offset',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Parent&nbsp;Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Line Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('child-column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'child-column',this.value);});addProp('Reflow At',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('reflow-at')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'reflow-at',this.value);});addProp('Scroll To Bottom',true,'<gs-checkbox class="target" value="'+encodeHTML(selectedElement.hasAttribute('scroll-to-bottom')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'scroll-to-bottom',(this.value==='true'),true);});addProp('HUD Paginate',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-hudpaginate'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-hudpaginate',(this.value==='true'),false);});addProp('HUD Refresh',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-hudrefresh'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-hudrefresh',(this.value==='true'),false);});addProp('HUD Delete',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-huddelete'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-huddelete',(this.value==='true'),false);});addProp('Expand&nbsp;To&nbsp;Content',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('expand-to-content'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'expand-to-content',(this.value==='true'),true);});addProp('Null String',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('null-string')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'null-string',this.value);});addProp('Filter Popup',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-filter'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-filter',(this.value==='true'),false);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Refresh On Querystring Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('refresh-on-querystring-values')||'')+'" mini></gs-text>',function(){this.removeAttribute('refresh-on-querystring-change');return setOrRemoveTextAttribute(selectedElement,'refresh-on-querystring-values',this.value);});addProp('Refresh On Querystring Change',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('refresh-on-querystring-change'))+'" mini></gs-checkbox>',function(){this.removeAttribute('refresh-on-querystring-values');return setOrRemoveBooleanAttribute(selectedElement,'refresh-on-querystring-change',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';var KEY_RETURN=13,KEY_TAB=9,KEY_BACKSPACE=8,KEY_DELETE=46,KEY_UP=38,KEY_RIGHT=39,KEY_DOWN=40,KEY_LEFT=37;function deleteSelection(element){var strSchema=GS.templateWithQuerystring(element.getAttribute('schema')),strObject=GS.templateWithQuerystring(element.getAttribute('object')),arrSelectRecords=element.selectedRecords,deleteRecord,deleteRecordData,arrPk,arrLock,strHashColumns,strRoles,strColumns,strRecord,strRecordToHash,strDeleteData,strTemp,i,len,col_i,col_len;if(arrSelectRecords[0]&&arrSelectRecords[0].parentNode.nodeName==='THEAD'){arrSelectRecords.splice(0,1);}
if(element.numberOfSelections===1&&arrSelectRecords.length>0&&arrSelectRecords[0].children[0].hasAttribute('selected')&&!element.deleteButton.hasAttribute('disabled')){arrPk=(element.getAttribute('pk')||'').split(/[\s]*,[\s]*/);arrLock=(element.getAttribute('lock')||'').split(/[\s]*,[\s]*/);for(i=0,len=arrPk.length,strRoles='',strColumns='';i<len;i+=1){strRoles+=(strRoles?'\t':'')+'pk';strColumns+=(strColumns?'\t':'')+arrPk[i];}
for(i=0,len=arrLock.length,strHashColumns='';i<len;i+=1){strHashColumns+=(strHashColumns?'\t':'')+arrLock[i];}
strRoles+=(strRoles?'\t':'')+'hash';strColumns+=(strColumns?'\t':'')+'hash';for(i=0,len=arrSelectRecords.length,strDeleteData='';i<len;i+=1){strRecord='';deleteRecord=arrSelectRecords[i];deleteRecordData=element.internalData.arrRecords[parseInt(deleteRecord.getAttribute('data-index'),10)];for(col_i=0,col_len=arrPk.length;col_i<col_len;col_i+=1){strRecord+=(strRecord?'\t':'');strRecord+=GS.encodeForTabDelimited(deleteRecordData[element.internalData.arrColumnNames.indexOf(arrPk[col_i])],element.nullString);}
strRecordToHash='';for(col_i=0,col_len=arrLock.length;col_i<col_len;col_i+=1){strRecordToHash+=(strRecordToHash?'\t':'');strTemp=deleteRecordData[element.internalData.arrColumnNames.indexOf(arrLock[col_i])];strRecordToHash+=(strTemp==='NULL'?'':strTemp);}
strDeleteData+=(strRecord+(strRecord?'\t':'')+GS.utfSafeMD5(strRecordToHash).toString()+'\n');arrSelectRecords[i].classList.add('bg-red');}
strDeleteData=(strRoles+'\n'+strColumns+'\n'+strDeleteData);GS.addLoader(element,'Creating Delete Transaction...');GS.requestDeleteFromSocket(getSocket(element),strSchema,strObject,strHashColumns,strDeleteData,function(data,error,transactionID){if(error){getData(element);GS.removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){var arrElements,i,len,templateElement;GS.removeLoader(element);if(!error){if(data!=='TRANSACTION COMPLETED'){arrElements=xtag.query(element,'.bg-red');for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].classList.remove('bg-red');arrElements[i].classList.add('bg-amber');}}else{templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                                <gs-page>
                                    <gs-header><center><h3>Are you sure...</h3></center></gs-header>
                                    <gs-body padded>
                                        <center>Are you sure you want to delete {{numberofrecords}} records?</center>
                                    </gs-body>
                                    <gs-footer>
                                        <gs-grid>
                                            <gs-block><gs-button dialogclose>No</gs-button></gs-block>
                                            <gs-block><gs-button id="datasheet-focus-me" dialogclose bg-primary tabindex="0">Yes</gs-button></gs-block>
                                        </gs-grid>
                                    </gs-footer>
                                </gs-page>
                            */}).replace(/\{\{numberofrecords\}\}/gi,xtag.query(element,'.bg-amber').length);GS.openDialog(templateElement,function(){document.getElementById('datasheet-focus-me').focus();},function(event,strAnswer){if(strAnswer==='Yes'){commitFunction();GS.addLoader(element,'Commiting Delete Transaction...');}else{rollbackFunction();GS.addLoader(element,'Rolling Back Delete Transaction...');}});}}else{rollbackFunction();getData(element);GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){var arrElements,i,len;GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){removeRecords(element,'bg-amber');clearSelection(element);GS.triggerEvent(element,'after_delete');}else{clearRecordColor(element,'bg-amber',false);}
arrElements=xtag.query(element,'tbody > tr');for(i=0,len=arrElements.length;i<len;i+=1){if(!arrElements[i].classList.contains('insert-record')){arrElements[i].children[0].textContent=(i+1);}}}else{getData(element);GS.webSocketErrorDialog(data);}});}}
function insertDialog(element){var templateElement=document.createElement('template'),strAddin;if(element.getAttribute('column')||element.getAttribute('qs')){strAddin=(element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs'))+'='+
element.value;}
templateElement.innerHTML=ml(function(){/*
            <gs-page gs-dynamic>
                <gs-header>
                    <center><h3>Insert</h3></center>
                </gs-header>
                <gs-body padded>
                    <gs-insert id="insert-dialog-content-container" src="{{SRC}}" addin="{{ADDIN}}">{{HTML}}</gs-insert>
                </gs-body>
                <gs-footer>
                    <gs-grid widths="1,1" class="width-2">
                        <gs-block width="1">
                            <gs-button dialogclose>Cancel</gs-button>
                        </gs-block>
                        <gs-block width="1">
                            <gs-button class="dialog-envelope-insert" listen-for-return bg-primary>Ok</gs-button>
                        </gs-block>
                    </gs-grid>
                </gs-footer>
            </gs-page>
        */}).replace('{{HTML}}',element.insertTemplate).replace('{{SRC}}',encodeHTML(element.getAttribute('src'))).replace('{{ADDIN}}',encodeHTML(strAddin||''));GS.openDialog(templateElement,function(){var dialog=this;if(element.getAttribute('seq')){document.getElementById('insert-dialog-content-container').setAttribute('seq',element.getAttribute('seq'));}
GS.triggerEvent(element,'insert_dialog_open');xtag.query(dialog,'.dialog-envelope-insert')[0].addEventListener('click',function(){var insertContainer=document.getElementById('insert-dialog-content-container');insertContainer.submit(function(lastval,jsnRow){getData(element);GS.triggerEvent(element,'after_insert');GS.closeDialog(dialog,'Ok');});});});}
function clearSelection(element){element.savedSelection=[];element.savedSelectionCopy=[];element.dragOrigin=null;element.dragCurrentCell=null;element.selectionPreviousOrigin=null;element.numberOfSelections=0;element.selectedCells=[];}
function templateRecordsForInsert(element,strRecords,strClasses){var arrRecords,arrCells,i,len,cell_i,cell_len,col_len,strHTML,intRowNumberAdd;if(element.getAttribute('cols')){col_len=(element.getAttribute('cols')||'').split(/[\s]*,[\s]*/).length;}
arrRecords=strRecords.split('\n');intRowNumberAdd=xtag.query(element,'tr:not(.bg-red):not(.insert-record)').length-1;for(i=1,len=arrRecords.length-1,strHTML='';i<len;i+=1){arrCells=arrRecords[i].split('\t');strHTML+='<tr '+(strClasses?' class="'+strClasses+'"':'');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){strHTML+='data-'+element.internalData.arrColumnNames[cell_i]+'="'+encodeHTML(GS.decodeFromTabDelimited(arrCells[cell_i],element.nullString))+'"';}
strHTML+='><th>'+(intRowNumberAdd+(i))+'</th>';for(cell_i=0,cell_len=(col_len||arrCells.length);cell_i<cell_len;cell_i+=1){strHTML+='<td><textarea rows="1" column="'+element.internalData.arrColumnNames[cell_i]+'">'+
encodeHTML(GS.decodeFromTabDelimited(arrCells[cell_i],element.nullString)||'')+'</textarea></td>';}
strHTML+='</tr>';}
return strHTML;}
function handleData(element,data,bolFirstLoad,bolManualRefresh){var strHTML,i,len,cell_i,cell_len,col_len,arrRecords,arrCells,disabled,arrColumns,arrElements,tbodyElement,trMaker,intStart,bolHeader,strWidth,numberOffset;if(element.getAttribute('cols')){arrColumns=(element.getAttribute('cols')||'').split(/[\s]*,[\s]*/);for(i=0,len=arrColumns.length;i<len;i+=1){arrColumns[i]=data.arrColumnNames.indexOf(arrColumns[i]);}}
disabled=element.hasAttribute('disabled')||!element.hasAttribute('pk');if(data.intCallback===0){if(!element.hasAttribute('lock')){element.setAttribute('lock',data.arrColumnNames.join(','));}
if(!element.hasAttribute('cols')){element.setAttribute('cols',data.arrColumnNames.join(','));}
if(disabled){element.deleteButton.setAttribute('disabled','');}else{element.deleteButton.removeAttribute('disabled');}
element.internalData={'arrColumnNames':data.arrColumnNames||[],'arrColumnTypes':data.arrColumnTypes||[],'arrRecords':[]};if(element.headerTemplateRecord){strHTML=GS.templateWithQuerystring(element.headerTemplateRecord);element.scrollContainer.innerHTML='<table><thead>'+strHTML+'</thead><tbody></tbody></table>';}else{arrElements=xtag.queryChildren(element.tableTemplateRecord,'td, th');for(i=0,len=arrElements.length,strHTML='';i<len;i+=1){strHTML+='<th>'+encodeHTML(arrElements[i].getAttribute('heading')||'')+'</th>';bolHeader=Boolean(arrElements[i].hasAttribute('heading')||'')||bolHeader;}
strHTML='<tr>'+strHTML+'</tr>';if(bolHeader){element.scrollContainer.innerHTML='<table><thead>'+strHTML+'</thead><tbody></tbody></table>';}else{element.scrollContainer.innerHTML='<table><thead hidden>'+strHTML+'</thead><tbody></tbody></table>';}}}
if(data.strMessage!=='TRANSACTION COMPLETED'){arrRecords=data.strMessage.split('\n');intStart=element.internalData.arrRecords.length;for(i=0,len=arrRecords.length-1,strHTML='';i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=GS.decodeFromTabDelimited(arrCells[cell_i],element.nullString);}
element.internalData.arrRecords.push(arrCells);}
if(element.paginated===true&&!isNaN(element.getAttribute('offset'))){numberOffset=parseInt(element.getAttribute('offset'),10);}else{numberOffset=0}
strHTML=GS.templateWithEnvelopeData(element.tableTemplate.templateHTML,{'arr_column':data.arrColumnNames,'dat':element.internalData.arrRecords},intStart,element.internalData.arrRecords.length,numberOffset);strHTML=GS.templateShowSubTemplates(strHTML,element.tableTemplate);trMaker=document.createElement('tbody');trMaker.innerHTML=strHTML;tbodyElement=xtag.query(element.scrollContainer,'tbody')[0];arrElements=xtag.toArray(trMaker.children);for(i=0,len=arrElements.length;i<len;i+=1){tbodyElement.appendChild(arrElements[i]);}}else{arrElements=xtag.query(element.scrollContainer,'tbody tr');if(arrElements[0]&&arrElements[0].children[0].nodeName==='TH'&&!isNaN(arrElements[0].children[0].textContent)){strWidth=(GS.pxToEm(element.hudContainer,GS.getTextWidth(element.hudContainer,String(element.internalData.arrRecords.length+1)))+1)+'em';xtag.query(element.scrollContainer,'thead th')[0].style.width=strWidth;xtag.query(element.scrollContainer,'tbody th')[0].style.width=strWidth;}
if(parseInt((element.getAttribute('limit')||'0'),10)>arrElements.length){element.pageRightButton.setAttribute('disabled','');}else{element.pageRightButton.removeAttribute('disabled');}
arrElements=xtag.query(element.scrollContainer,'tr');if(arrElements[0].parentNode.hasAttribute('hidden')){element.headerContainer.innerHTML='<table><thead hidden>'+arrElements[0].outerHTML+'</thead></table>';}else{element.headerContainer.innerHTML='<table><thead>'+arrElements[0].outerHTML+'</thead></table>';}
element.headerTR=element.headerContainer.children[0].children[0].children[0];refreshReflow(element);refreshHeight(element);synchronize(element,undefined,true,bolManualRefresh);synchronizeHeaderWidths(element);synchronizeHeaderScroll(element);if(bolFirstLoad&&element.hasAttribute('scroll-to-bottom')){element.scrollContainer.scrollTop=element.scrollContainer.scrollHeight;}
GS.triggerEvent(element,'after_select');}}
function synchronizeHeaderWidths(element){'use strict';var guideTR,targetTR,arrChildren,i,len,subtractPadding;targetTR=element.headerTR;if(element.scrollContainer){guideTR=xtag.query(element.scrollContainer,'tr')[0];if(guideTR){arrChildren=xtag.toArray(guideTR.children);subtractPadding=0;if(element.scrollContainer.scrollHeight>element.scrollContainer.clientHeight){element.headerContainer.classList.add('scroll');}else{element.headerContainer.classList.remove('scroll');}
for(i=0,len=arrChildren.length;i<len;i+=1){targetTR.children[i].style.width=(arrChildren[i].clientWidth-subtractPadding)+'px';}}}}
function synchronizeHeaderScroll(element){'use strict';if(element.headerContainer&&element.scrollContainer){if(element.scrollContainer.scrollTop>0){element.headerContainer.classList.add('shadow');}else{element.headerContainer.classList.remove('shadow');}
element.headerContainer.scrollLeft=element.scrollContainer.scrollLeft;}}
function getReturn(element){var arrColumns=[],arrSupplementalColumns=[],arrColsAttr,strColumns,arrPK,arrLock,i,len;arrPK=(element.getAttribute('pk')||'').split(/[\s]*,[\s]*/);for(i=0,len=arrPK.length;i<len;i+=1){if(arrPK[i]){GS.listAdd(arrSupplementalColumns,arrPK[i]);}}
arrLock=(element.getAttribute('lock')||'').split(/[\s]*,[\s]*/);for(i=0,len=arrLock.length;i<len;i+=1){if(arrLock[i]){GS.listAdd(arrSupplementalColumns,arrLock[i]);}}
if(element.internalData&&element.internalData.arrColumnNames){for(i=0,len=element.internalData.arrColumnNames.length;i<len;i+=1){GS.listAdd(arrColumns,element.internalData.arrColumnNames[i]);}}else if(element.getAttribute('cols')){arrColsAttr=element.getAttribute('cols').split(/[\s]*,[\s]*/);for(i=0,len=arrColsAttr.length;i<len;i+=1){GS.listAdd(arrColumns,arrColsAttr[i]);}}
if(arrColumns.length===0||(arrColumns.length===1&&arrColumns[0]==='*')){strColumns='*';}else{for(i=0,len=arrSupplementalColumns.length;i<len;i+=1){GS.listAdd(arrColumns,arrSupplementalColumns[i]);}
strColumns=arrColumns.join('\t');}
return strColumns;}
function valueListToHTML(valueText,fieldDelimiter,recordDelimiter,bolFirstContainsHeadings,quoteCharacter,decodeFunction){var i=0,len=valueText.length,col_i,col_len,arrHeadings=[],arrRecords=[],arrRecord=[],bolInQuote=false,strCell='',strRecord,strHTML='',strPreviousChar;if(valueText[0]===recordDelimiter){i+=1;}
if(valueText[len-1]!==recordDelimiter){valueText+=recordDelimiter;len=valueText.length;}
for(;i<len;i+=1){if(valueText[i]===quoteCharacter&&bolInQuote===false&&(strPreviousChar===fieldDelimiter||strPreviousChar===recordDelimiter||strPreviousChar===undefined)){bolInQuote=true;}else if(valueText[i]===quoteCharacter&&bolInQuote===true){bolInQuote=false;}else if(valueText[i]===fieldDelimiter&&bolInQuote===false){arrRecord.push(decodeFunction(strCell,element.nullString));strCell='';}else if(valueText[i]===recordDelimiter&&bolInQuote===false){arrRecord.push(decodeFunction(strCell,element.nullString));strCell='';arrRecords.push(arrRecord);arrRecord=[];}else{strCell+=valueText[i];}
strPreviousChar=valueText[i];}
for(i=0,len=arrRecords.length;i<len;i+=1){for(col_i=0,col_len=arrRecords[i].length,strRecord='';col_i<col_len;col_i+=1){strRecord+='<td>'+encodeHTML(arrRecords[i][col_i])+'</td>';}
strHTML+='<tr>'+strRecord+'</tr>';}
return'<table>'+strHTML+'</table>';}
function quoteIdent(strValue){strValue=strValue||'';if(!(/[a-z]/).test(strValue[0])||(/[^a-z_]/).test(strValue)){strValue='"'+strValue.replace(/\"/gim,'""')+'"';}
return strValue;}
function stringRepeat(pattern,count){if(count<1)return'';var result='';while(count>1){if(count&1)result+=pattern;count>>=1,pattern+=pattern;}
return result+pattern;}
function getSocket(element){if(element.getAttribute('socket')){return GS[element.getAttribute('socket')];}
return GS.envSocket;}
function getData(element,refocusSelector,refocusSelection,bolFirstLoad,bolManualRefresh){var strSchema=GS.templateWithQuerystring(element.getAttribute('schema')||''),strObject=GS.templateWithQuerystring(element.getAttribute('object')||''),strReturn=getReturn(element)||'',strWhere=GS.templateWithQuerystring(element.getAttribute('where')||'1=1'),strOrd=GS.templateWithQuerystring(element.getAttribute('ord')||''),strLimit=GS.templateWithQuerystring(element.getAttribute('limit')||''),strOffset=GS.templateWithQuerystring(element.getAttribute('offset')||'0'),strWhereColumn;if(element.getAttribute('user-where')){strWhere='('+element.getAttribute('user-where')+')'+(strWhere?' AND '+strWhere:'');}
if((element.getAttribute('column')||element.getAttribute('qs'))&&element.value){strWhereColumn=element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs');if(isNaN(element.value)){strWhere='CAST('+strWhereColumn+' AS '+GS.database.type.text+') = '+'CAST($WhereQUOTE$'+(element.value)+'$WhereQUOTE$ AS '+GS.database.type.text+')'+
(strWhere!==''?' AND ('+strWhere+')':'');}else{strWhere=strWhereColumn+'='+(element.value)+(strWhere!==''?' AND ('+strWhere+')':'');}}
if(strLimit===''){element.pageLeftButton.setAttribute('hidden','');element.pageRightButton.setAttribute('hidden','');}else if(strOffset===''||strOffset==='0'){element.pageLeftButton.setAttribute('disabled','');}
GS.addLoader(element,'Loading...');GS.requestSelectFromSocket(getSocket(element),strSchema,strObject,strReturn,strWhere,strOrd,strLimit,strOffset,function(data,error){var refocusElement;if(!error){handleData(element,data,bolFirstLoad,bolManualRefresh);if(data.strMessage==='TRANSACTION COMPLETED'){GS.removeLoader(element);}
if(data.strMessage==='TRANSACTION COMPLETED'&&refocusSelector){refocusElement=xtag.query(element,refocusSelector)[0];if(refocusElement){refocusElement.focus();if(refocusSelection){GS.setInputSelection(refocusElement,refocusSelection.start,refocusSelection.end);}}}}else{GS.removeLoader(element);if(!element.scrollContainer.innerHTML){element.scrollContainer.innerHTML='<'+'center><h2>Couldn\'t Load Data.</h2></'+'center>';}
GS.webSocketErrorDialog(data);}});}
function getSelectedCopyHTML(element){var strHTMLCopyString,intFromRecord,intToRecord,intFromCell=9999999,intToCell=0,i,len,cell_i,cell_len,arrSelected,strCellHTML,arrRecords,arrCells,strHTMLRecordString;arrSelected=element.selectedCells;if(arrSelected.length>0){intFromRecord=arrSelected[0].parentNode.rowIndex;intToRecord=arrSelected[arrSelected.length-1].parentNode.rowIndex+1;for(i=0,len=arrSelected.length;i<len;i+=1){if(arrSelected[i].cellIndex<intFromCell){intFromCell=arrSelected[i].cellIndex;intFromCell=(intFromCell===0?1:intFromCell);}
if(arrSelected[i].cellIndex+1>intToCell){intToCell=arrSelected[i].cellIndex+1;}}
arrRecords=xtag.query(element,'tr');strHTMLCopyString='';for(i=intFromRecord,len=intToRecord;i<len;i+=1){arrCells=arrRecords[i].children;strHTMLRecordString='';if(!arrRecords[i].classList.contains('insert-record')){for(cell_i=intFromCell,cell_len=intToCell;cell_i<cell_len;cell_i+=1){strCellHTML='';if(arrCells[cell_i].hasAttribute('selected')){if(arrCells[cell_i].lastElementChild){strCellHTML=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString();}else{strCellHTML=arrCells[cell_i].textContent.trim();}
strCellHTML=encodeHTML(strCellHTML).replace(/\n/gim,'<br />');}
strCellHTML='<'+'td rowspan="1" colspan="1">'+(strCellHTML||'')+'</td>'
strHTMLRecordString+=(cell_i===intFromCell?'<'+'tr>':'');strHTMLRecordString+=(strCellHTML||'');strHTMLRecordString+=(cell_i===(intToCell-1)?'<'+'/tr>':'');}}
if(strHTMLRecordString.trim()){strHTMLCopyString+=strHTMLRecordString;}}
if(strHTMLCopyString){strHTMLCopyString='<'+'style>'+'br { mso-data-placement:same-cell; } '+'th, td { white-space: pre-wrap; }'+'<'+'/style>'+'<'+'table border="0" cellpadding="0" cellspacing="0">'+strHTMLCopyString+'<'+'/table>';}}
return strHTMLCopyString||'';}
function getSelectedCopyText(element){var strTextCopyString,intFromRecord,intToRecord,intFromCell=9999999,intToCell=0,i,len,cell_i,cell_len,arrSelected,strCellText,arrRecords,arrCells,arrCellIndexes,strTextRecordString;arrSelected=element.selectedCells;if(arrSelected.length>0){intFromRecord=arrSelected[0].parentNode.rowIndex;intToRecord=arrSelected[arrSelected.length-1].parentNode.rowIndex+1;for(i=0,len=arrSelected.length;i<len;i+=1){if(arrSelected[i].cellIndex<intFromCell){intFromCell=arrSelected[i].cellIndex;intFromCell=(intFromCell===0?1:intFromCell);}
if(arrSelected[i].cellIndex+1>intToCell){intToCell=arrSelected[i].cellIndex+1;}}
arrRecords=xtag.query(element,'tr');strTextCopyString='';for(i=intFromRecord,len=intToRecord;i<len;i+=1){arrCells=arrRecords[i].children;strTextRecordString='';for(cell_i=intFromCell,cell_len=intToCell;cell_i<cell_len;cell_i+=1){if(!arrCells[cell_i].parentNode.classList.contains('insert-record')){strCellText='';if(arrCells[cell_i].hasAttribute('selected')){if(arrCells[cell_i].lastElementChild){strCellText=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString();}else{strCellText=arrCells[cell_i].textContent.trim();}
strCellText=strCellText.replace(/\"/gim,'""');}
strTextRecordString+=(cell_i!==intFromCell?'\t':'');strTextRecordString+=(strCellText||'');}}
strTextCopyString+=strTextRecordString;if(i+1!==len){strTextCopyString+='\n';}}}
return strTextCopyString||'';}
function handleClipboardData(event,strCopyString,strType){var clipboardData=event.clipboardData||window.clipboardData,strMime;if(!clipboardData){return;}
if(!clipboardData.setData){return;}
if(strType==='text'){if(window.clipboardData&&window.clipboardData.getData){strMime='Text';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/plain';}}else if(strType==='html'){if(window.clipboardData&&window.clipboardData.getData){strMime='';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/html';}}else{throw'handleClipboardData Error: Type "'+strType+'" not recognized, recognized types are "text" and "html".';}
if(strMime){if(strCopyString&&strMime){return clipboardData.setData(strMime,strCopyString)!==false;}else{return clipboardData.getData(strMime);}}}
function selectHandler(element,dragOriginCell,dragCurrentCell,dragMode){var arrRecords=xtag.query(element,'tr'),arrCells=xtag.query(element,'td, th'),dragOriginRecord=dragOriginCell.parentNode,dragCurrentRecord=dragCurrentCell.parentNode,intStartRecordIndex,intStartCellIndex,intEndRecordIndex,intEndCellIndex,i,len,col_i,col_len,selectionIndex;if(dragOriginRecord.rowIndex===0&&dragCurrentRecord.rowIndex===0&&dragOriginCell.cellIndex===0&&dragCurrentCell.cellIndex===0){intStartRecordIndex=0;intStartCellIndex=0;intEndRecordIndex=arrRecords.length-1;intEndCellIndex=arrRecords[0].children.length-1;}else if(dragOriginCell.cellIndex===0){intStartRecordIndex=Math.min(dragOriginRecord.rowIndex,dragCurrentRecord.rowIndex);intStartCellIndex=0;intEndRecordIndex=Math.max(dragOriginRecord.rowIndex,dragCurrentRecord.rowIndex);intEndCellIndex=arrRecords[0].children.length-1;}else if(dragOriginRecord.rowIndex===0){intStartRecordIndex=0;intStartCellIndex=Math.min(dragOriginCell.cellIndex,dragCurrentCell.cellIndex);intEndRecordIndex=arrRecords.length-1;intEndCellIndex=Math.max(dragOriginCell.cellIndex,dragCurrentCell.cellIndex);}else{intStartRecordIndex=Math.min(dragOriginRecord.rowIndex,dragCurrentRecord.rowIndex);intStartCellIndex=Math.min(dragOriginCell.cellIndex,dragCurrentCell.cellIndex);intEndRecordIndex=Math.max(dragOriginRecord.rowIndex,dragCurrentRecord.rowIndex);intEndCellIndex=Math.max(dragOriginCell.cellIndex,dragCurrentCell.cellIndex);}
element.savedSelection=element.savedSelectionCopy.slice(0);if(dragMode==='select'){for(i=intStartRecordIndex,len=intEndRecordIndex+1;i<len;i+=1){for(col_i=intStartCellIndex,col_len=intEndCellIndex+1;col_i<col_len;col_i+=1){if(element.savedSelection.indexOf(i+','+col_i)===-1){element.savedSelection.push(i+','+col_i);}}}}else{for(i=intStartRecordIndex,len=intEndRecordIndex+1;i<len;i+=1){for(col_i=intStartCellIndex,col_len=intEndCellIndex+1;col_i<col_len;col_i+=1){selectionIndex=element.savedSelection.indexOf(i+','+col_i);if(selectionIndex>-1){element.savedSelection.splice(selectionIndex,1);}}}}
synchronize(element);}
function synchronize(element,bolScroll,bolOnLoad,bolManualRefresh){var arrRecords=xtag.query(element,'tr'),selectCells=[],i,len,arrParts,arrTextareas,focusedElement,recordIndex,cellIndex;if(element.savedSelection){for(i=0,len=element.savedSelection.length;i<len;i+=1){arrParts=element.savedSelection[i].split(',');recordIndex=parseInt(arrParts[0],10);cellIndex=parseInt(arrParts[1],10);if(recordIndex<arrRecords.length&&cellIndex<arrRecords[0].children.length){selectCells.push(arrRecords[recordIndex].children[cellIndex]);}}
element.selectedCells=selectCells;}
if(element.lastFocusedControl){element.lastFocusedControl.focus();focusedElement=element.lastFocusedControl;}else if(!bolOnLoad||bolManualRefresh){focusedElement=element.copyControl;element.copyControl.focus();}
if(!element.lastFocusedControl&&element.selectedCells.length>0&&bolScroll){GS.scrollIntoView(element.selectedCells[0].parentNode);}
if(focusedElement&&bolScroll){GS.scrollIntoView(GS.findParentElement(document.activeElement,'tr'));}
if(focusedElement&&element.lastTextSelection){GS.setInputSelection(focusedElement,element.lastTextSelection.start,element.lastTextSelection.end);}}
function clearRecordColor(element,strClass,bolGreenFade){var arrElements=xtag.query(element,'tr.'+strClass),i,len;if(bolGreenFade){for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].classList.remove(strClass);arrElements[i].classList.add('bg-green-fade');}
setTimeout(function(){for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].classList.remove('bg-green-fade');}},1000);}else{for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].classList.remove(strClass);}}}
function removeRecords(element,strClass){var arrElements=xtag.query(element,'tr.'+strClass),i,len;for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].parentNode.removeChild(arrElements[i]);}}
function insertRecords(element,strColumns,strInsertData,strLocalData,bolDialog){var strSchema=GS.templateWithQuerystring(element.getAttribute('schema')),strObject=GS.templateWithQuerystring(element.getAttribute('object')),templateElement,strSeq,arrSeq,strPk,arrPk,strColumn,arrColumns,i,len,col_i,col_len,tbodyElement,arrElements,insertRecord;arrSeq=(GS.templateWithQuerystring(element.getAttribute('seq')||'')).split(/[\s]*,[\s]*/);arrPk=(GS.templateWithQuerystring(element.getAttribute('pk')||'')).split(/[\s]*,[\s]*/);arrColumns=strColumns.split('\t');for(i=0,len=arrColumns.length;i<len;i+=1){strColumn=GS.decodeFromTabDelimited(arrColumns[i],element.nullString);if(arrSeq.indexOf(strColumn)>-1){arrSeq[arrSeq.indexOf(strColumn)]='';}}
tbodyElement=document.createElement('tbody');tbodyElement.innerHTML=templateRecordsForInsert(element,strColumns+'\n'+strLocalData,'bg-red');arrElements=xtag.toArray(tbodyElement.children);insertRecord=xtag.query(element,'tr.insert-record')[0];for(i=0,len=arrElements.length;i<len;i+=1){insertRecord.parentNode.insertBefore(arrElements[i],insertRecord);}
element.scrollContainer.scrollTop=element.scrollContainer.scrollHeight;for(i=0,len=arrPk.length,strPk='';i<len;i+=1){strPk+=(strPk?'\t':'')+GS.encodeForTabDelimited(arrPk[i],element.nullString);}
for(i=0,len=arrSeq.length,strSeq='';i<len;i+=1){if(arrColumns.indexOf(arrPk[i])>-1){strSeq+=(i===0?'':'\t')+'';}else{strSeq+=(i===0?'':'\t')+GS.encodeForTabDelimited(arrSeq[i],element.nullString);}}
strInsertData=strColumns+'\n'+strInsertData;GS.addLoader(element,'Creating Insert Transaction...');GS.requestInsertFromSocket(getSocket(element),strSchema,strObject,getReturn(element),strPk,strSeq,strInsertData,function(data,error){if(error){removeRecords(element,'bg-red');GS.removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){var tbodyElement,arrElements,arrReplaceElements,i,len,templateElement;GS.removeLoader(element);if(!error){if(data!=='TRANSACTION COMPLETED'){data=getReturn(element)+'\n'+data;tbodyElement=document.createElement('tbody');tbodyElement.innerHTML=templateRecordsForInsert(element,data,'bg-amber');arrElements=xtag.toArray(tbodyElement.children);arrReplaceElements=xtag.query(element,'tr.bg-red');for(i=0,len=arrElements.length;i<len;i+=1){arrReplaceElements[i].parentNode.replaceChild(arrElements[i],arrReplaceElements[i]);}}else{if(bolDialog){templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                                <gs-page>
                                    <gs-header><center><h3>Are you sure...</h3></center></gs-header>
                                    <gs-body padded>
                                        <center>Are you sure you want create {{numberofrecords}} records?</center>
                                    </gs-body>
                                    <gs-footer>
                                        <gs-grid>
                                            <gs-block><gs-button dialogclose>No</gs-button></gs-block>
                                            <gs-block><gs-button id="datasheet-focus-me" dialogclose bg-primary tabindex="0">Yes</gs-button></gs-block>
                                        </gs-grid>
                                    </gs-footer>
                                </gs-page>
                            */}).replace(/\{\{numberofrecords\}\}/gi,xtag.query(element,'.bg-amber').length);GS.openDialog(templateElement,function(){document.getElementById('datasheet-focus-me').focus();},function(event,strAnswer){if(strAnswer==='Yes'){commitFunction();GS.addLoader(element,'Commiting Insert...');}else{rollbackFunction();GS.addLoader(element,'Rolling Back Insert...');}});}else{commitFunction();}}}else{removeRecords(element,'bg-red');rollbackFunction();GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){clearRecordColor(element,'bg-amber',true);GS.triggerEvent(element,'after_insert');}else{removeRecords(element,'bg-amber');}}else{removeRecords(element,'bg-red');GS.webSocketErrorDialog(data);}});}
function refreshRecordsAfterUpdate(element,arrRecordsToUpdate,data){var arrColumns,arrRecords,arrValues,arrElements,arrColumnTypes,i,len,record_i,record_len,col_i,col_len,controlElement;if(data[data.length-1]==='\n'){data=data.substring(0,data.length-1);}
arrRecords=data.split('\n');arrColumns=arrRecords[0].split('\t');arrRecords.splice(0,1);len=arrRecordsToUpdate.length;record_len=arrRecords.length;i=0;record_i=0;while(i<len&&record_i<record_len){if(arrRecordsToUpdate[i].classList.contains('bg-red')&&arrRecords[record_i]){arrRecordsToUpdate[i].classList.remove('bg-red');arrRecordsToUpdate[i].classList.add('bg-amber');arrValues=arrRecords[record_i].split('\t');for(col_i=0,col_len=arrValues.length;col_i<col_len;col_i+=1){arrRecordsToUpdate[i].setAttribute('data-'+arrColumns[col_i],GS.decodeFromTabDelimited(arrValues[col_i],element.nullString));controlElement=xtag.query(arrRecordsToUpdate[i],'[column="'+arrColumns[col_i]+'"]')[0];if(controlElement){controlElement.value=GS.decodeFromTabDelimited(arrValues[col_i],element.nullString);}}
record_i+=1;}
i+=1;}}
function updateRecords(element,strHashColumns,strUpdateData,arrUpdateRecords,bolDialog){var strSchema=GS.templateWithQuerystring(element.getAttribute('schema')),strObject=GS.templateWithQuerystring(element.getAttribute('object')),templateElement,i,len,refreshData;for(i=0,len=arrUpdateRecords.length;i<len;i+=1){arrUpdateRecords[i].classList.add('bg-red');}
GS.addLoader(element,'Creating Update Transaction...');GS.requestUpdateFromSocket(getSocket(element),strSchema,strObject,getReturn(element),strHashColumns,strUpdateData,function(data,error,transactionID){if(error){getData(element);GS.removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){GS.removeLoader(element);if(!error){if(data!=='TRANSACTION COMPLETED'){refreshData=data;data=getReturn(element)+'\n'+data;refreshRecordsAfterUpdate(element,arrUpdateRecords,data);}else{if(bolDialog){templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                                <gs-page>
                                    <gs-header><center><h3>Are you sure...</h3></center></gs-header>
                                    <gs-body padded>
                                        <center>Are you sure you want to update {{numberofrecords}} records?</center>
                                    </gs-body>
                                    <gs-footer>
                                        <gs-grid>
                                            <gs-block><gs-button dialogclose>No</gs-button></gs-block>
                                            <gs-block><gs-button id="datasheet-focus-me" dialogclose bg-primary tabindex="0">Yes</gs-button></gs-block>
                                        </gs-grid>
                                    </gs-footer>
                                </gs-page>
                            */}).replace(/\{\{numberofrecords\}\}/gi,xtag.query(element,'.bg-amber').length);GS.openDialog(templateElement,function(){document.getElementById('datasheet-focus-me').focus();},function(event,strAnswer){if(strAnswer==='Yes'){commitFunction();GS.addLoader(element,'Commiting Update...');}else{rollbackFunction();GS.addLoader(element,'Rolling Back Update...');}});}else{commitFunction();}}}else{rollbackFunction();getData(element);GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){var arrRecords,arrCells,recordData,recordIndex,i,len,col_i,col_len;GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){clearRecordColor(element,'bg-amber',true);arrRecords=refreshData.split('\n');for(i=0,len=arrUpdateRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');recordIndex=parseInt(arrUpdateRecords[i].getAttribute('data-index'),10);for(col_i=0,col_len=arrCells.length;col_i<col_len;col_i+=1){element.internalData.arrRecords[recordIndex][col_i]=GS.decodeFromTabDelimited(arrCells[col_i],element.nullString)}}
GS.triggerEvent(element,'after_update');}else{getData(element);}}else{getData(element);GS.webSocketErrorDialog(data);}});}
function pasteHandler(element,event){var clipboardData=(event.clipboardData||window.clipboardData),templateElement=document.createElement('template'),pasteHTML,pastePlain,arrPasteRecords,arrSelectRecords,arrSetColumns,strColumn,strColumns,i,len,col_i,col_len,cell,arrPk,arrLock,strRecord,strInsertData,strLocalData,strLeftPad,strRightPad,strTemp,strRecordToHash,strHashColumns,strRoles,strUpdateData,arrRecords,arrUpdateRecords,arrUpdateColumns,updateRecord,updateRecordData,pasteElement;if(window.clipboardData){pastePlain=clipboardData.getData('Text');}else{pasteHTML=clipboardData.getData('text/html');pastePlain=clipboardData.getData('Text');}
if(!pasteHTML||(pasteHTML.indexOf('<'+'table')===-1&&pasteHTML.indexOf('<'+'tr')===-1)){pasteHTML=valueListToHTML(pastePlain,'\t','\n',false,'"',GS.decodeFromTabDelimited);}
templateElement.innerHTML=pasteHTML;arrPasteRecords=xtag.query(xtag.query(templateElement.content,'table')[0],'tr');arrSelectRecords=element.selectedRecords;if(arrSelectRecords[0]&&arrSelectRecords[0].parentNode.nodeName==='THEAD'){arrSelectRecords.splice(0,1);}
if(element.numberOfSelections===1){arrSetColumns=xtag.query(arrSelectRecords[0],'td[selected]');if(arrSelectRecords[0].classList.contains('insert-record')){strColumns='';for(i=0,len=Math.min(arrSetColumns.length,arrPasteRecords[0].children.length);i<len;i+=1){strColumn=arrSetColumns[i].children[0].getAttribute('column');strColumns+=(strColumns?'\t':'')+strColumn;}
strLeftPad=stringRepeat('\t',arrSetColumns[0].cellIndex-1);strRightPad=stringRepeat('\t',(element.internalData.arrColumnNames.length-((arrSetColumns[0].cellIndex-1)+arrSetColumns.length)));for(i=0,len=arrPasteRecords.length,strInsertData='',strLocalData='';i<len;i+=1){for(col_i=0,col_len=arrSetColumns.length,strRecord='';col_i<col_len;col_i+=1){cell=arrPasteRecords[i].children[col_i];strRecord+=(strRecord?'\t':'')+GS.encodeForTabDelimited(cell.innerText||cell.textContent,element.nullString);}
strInsertData+=strRecord+'\n';strLocalData+=strLeftPad+strRecord+strRightPad+'\n';}
insertRecords(element,strColumns,strInsertData,strLocalData,(arrPasteRecords.length>1));}else{if(arrSelectRecords[arrSelectRecords.length-1].parentNode.nodeName==='THEAD'){arrSelectRecords.pop();}
arrPk=(GS.templateWithQuerystring(element.getAttribute('pk')||'')).split(/[\s]*,[\s]*/);arrLock=(GS.templateWithQuerystring(element.getAttribute('lock')||'')).split(/[\s]*,[\s]*/);for(i=0,len=arrPk.length,strRoles='',strColumns='';i<len;i+=1){strRoles+=(strRoles?'\t':'')+'pk';strColumns+=(strColumns?'\t':'')+arrPk[i];}
for(i=0,len=arrLock.length,strHashColumns='';i<len;i+=1){strHashColumns+=(strHashColumns?'\t':'')+arrLock[i];}
strRoles+=(strRoles?'\t':'')+'hash';strColumns+=(strColumns?'\t':'')+'hash';arrUpdateColumns=[];for(i=0,len=Math.min(arrSetColumns.length,arrPasteRecords[0].children.length);i<len;i+=1){pasteElement=xtag.query(arrSetColumns[i],'[column]')[0];if(pasteElement){strColumn=pasteElement.getAttribute('column');strRoles+=(strRoles?'\t':'')+'set';strColumns+=(strColumns?'\t':'')+strColumn;arrUpdateColumns.push(strColumn);}}
arrUpdateRecords=[];for(i=0,len=Math.min(arrSelectRecords.length,arrPasteRecords.length),strUpdateData='';i<len;i+=1){strRecord='';updateRecord=arrSelectRecords[i];updateRecordData=element.internalData.arrRecords[parseInt(updateRecord.getAttribute('data-index'),10)];for(col_i=0,col_len=arrPk.length;col_i<col_len;col_i+=1){strRecord+=(strRecord?'\t':'');strRecord+=GS.encodeForTabDelimited(updateRecordData[element.internalData.arrColumnNames.indexOf(arrPk[col_i])],element.nullString);}
strRecordToHash='';for(col_i=0,col_len=arrLock.length;col_i<col_len;col_i+=1){strRecordToHash+=(strRecordToHash?'\t':'');strTemp=updateRecordData[element.internalData.arrColumnNames.indexOf(arrLock[col_i])];strRecordToHash+=(strTemp==='NULL'?'':strTemp);}
strRecord+=(strRecord?'\t':'')+GS.utfSafeMD5(strRecordToHash).toString();for(col_i=0,col_len=arrSetColumns.length;col_i<col_len;col_i+=1){pasteElement=xtag.query(arrSetColumns[col_i],'[column]')[0];if(pasteElement){cell=arrPasteRecords[i].children[col_i];strRecord+=(strRecord?'\t':'')+GS.encodeForTabDelimited(cell.innerText||cell.textContent,element.nullString);}}
strUpdateData+=strRecord+'\n';arrUpdateRecords.push(arrSelectRecords[i]);}
strUpdateData=(strRoles+'\n'+strColumns+'\n'+strUpdateData);updateRecords(element,strHashColumns,strUpdateData,arrUpdateRecords,(arrPasteRecords.length>1));}}}
function refreshHeight(element){var intHeight;if(element.hasAttribute('expand-to-content')&&element.hudContainer&&element.scrollContainer&&element.scrollContainer.children[0]){element.style.height='';intHeight=(element.hudContainer.scrollHeight+
element.scrollContainer.children[0].scrollHeight);element.style.height=intHeight+'px';element.style.height=(intHeight+(element.scrollContainer.scrollHeight-element.scrollContainer.clientHeight))+'px';}}
function refreshReflow(element){var strReflowAt=GS.templateWithQuerystring(element.getAttribute('reflow-at')||''),intReflowAt,intElementWidth;if(strReflowAt){intElementWidth=element.offsetWidth;intReflowAt=parseInt(strReflowAt,10);if(intElementWidth<intReflowAt){element.dataContainer.classList.add('grid-reflow');}else{element.dataContainer.classList.remove('grid-reflow');}}else{element.dataContainer.classList.remove('grid-reflow');}}
function prepareElement(element){var tableTemplateElement,HUDTemplateElement,strHTML,recordElement,insertTemplateElement,arrParts,headerRecordElement;var i,len,arrElements,arrHeaderElements;var tempTemplateElement;if(!element.hasAttribute('pk')){element.setAttribute('pk','id');}
if(!element.hasAttribute('lock')){element.setAttribute('lock','change_stamp');}
tableTemplateElement=xtag.query(element,'template[for="table"]')[0];HUDTemplateElement=xtag.query(element,'template[for="hud"]')[0];insertTemplateElement=xtag.query(element,'template[for="insert"]')[0];if(!tableTemplateElement||tableTemplateElement.nodeName!=='TEMPLATE'){throw'gs-datasheet error: No table template provided.';}
headerRecordElement=xtag.query(tableTemplateElement.content,'thead tr')[0];if(headerRecordElement){arrHeaderElements=xtag.query(headerRecordElement,'td, th');arrElements=xtag.query(tableTemplateElement.content,'tbody td, tbody th');for(i=0,len=arrHeaderElements.length;i<len;i+=1){if(!arrElements[i].hasAttribute('heading')){arrElements[i].setAttribute('heading',arrHeaderElements[i].textContent);}}
element.headerTemplateRecord=headerRecordElement.outerHTML;}
recordElement=xtag.query(tableTemplateElement.content,'tbody tr')[0];recordElement.setAttribute('data-index','{{= i }}');strHTML=GS.templateColumnToValue(tableTemplateElement.innerHTML);tempTemplateElement=document.createElement('template');tempTemplateElement.innerHTML=strHTML;recordElement=xtag.query(tempTemplateElement.content,'tbody tr')[0];element.tableTemplate=GS.templateHideSubTemplates(recordElement.outerHTML,true);element.tableTemplateRecord=recordElement;if(insertTemplateElement&&insertTemplateElement.innerHTML){element.insertTemplate=insertTemplateElement.innerHTML;}
arrParts=GS.templateWithQuerystring(element.getAttribute('src')).split('.');element.setAttribute('schema',arrParts[0]);element.setAttribute('object',arrParts[1]);strHTML=ml(function(){/*
            <div class="root" flex-vertical flex-fill>
                <div class="hud-container">
                    <gs-button icon="refresh" remove-right icononly no-focus title="Refresh Data." class="refresh-button"></gs-button>
                    <gs-button icon="times" remove-left icononly no-focus title="Delete Selected Records." class="delete-button"></gs-button>
                    
                    <gs-button icon="plus" icononly no-focus title="Create Record." class="insert-button"></gs-button>
                    
                    <gs-button icon="backward" remove-right icononly no-focus title="Go to previous page." class="paginate-left"></gs-button>
                    <gs-button icon="forward" remove-left icononly no-focus title="Go to next page." class="paginate-right"></gs-button>
                    
                    {{HUDHTML}}
                    
                    <gs-button icon="filter" icononly no-focus title="Edit Filters." class="filter-button" hidden></gs-button>
                    <textarea class="hidden-focus-control">Focus Control</textarea>
                </div>
                <div class="data-container" flex>
                    <div class="data-flex-reset">
                        <div class="scroll-container"></div>
                        <div class="header-container"></div>
                        <div class="insert-container"></div>
                    </div>
                </div>
            </div>
        */});if(HUDTemplateElement){strHTML=strHTML.replace(/\{\{HUDHTML\}\}/gi,HUDTemplateElement.innerHTML);}else{strHTML=strHTML.replace(/\{\{HUDHTML\}\}/gi,'');}
element.innerHTML=strHTML;element.root=element.children[0];element.hudContainer=element.root.children[0];element.dataContainer=element.root.children[1];element.dataFlexReset=element.dataContainer.children[0];element.scrollContainer=element.dataFlexReset.children[0];element.headerContainer=element.dataFlexReset.children[1];element.insertContainer=element.dataFlexReset.children[2];element.refreshButton=xtag.queryChildren(element.hudContainer,'.refresh-button')[0];element.deleteButton=xtag.queryChildren(element.hudContainer,'.delete-button')[0];element.insertButton=xtag.queryChildren(element.hudContainer,'.insert-button')[0];element.pageLeftButton=xtag.queryChildren(element.hudContainer,'.paginate-left')[0];element.pageRightButton=xtag.queryChildren(element.hudContainer,'.paginate-right')[0];element.copyControl=xtag.queryChildren(element.hudContainer,'.hidden-focus-control')[0];element.filterButton=xtag.queryChildren(element.hudContainer,'.filter-button')[0];if(element.hasAttribute('no-huddelete')&&element.hasAttribute('no-hudrefresh')){element.hudContainer.removeChild(element.refreshButton);element.hudContainer.removeChild(element.deleteButton);}else if(element.hasAttribute('no-huddelete')){element.hudContainer.removeChild(element.deleteButton);element.refreshButton.removeAttribute('remove-right');}else if(element.hasAttribute('no-hudrefresh')){element.hudContainer.removeChild(element.refreshButton);element.deleteButton.removeAttribute('remove-left');}
if(element.hasAttribute('no-hudpaginate')){element.hudContainer.removeChild(element.pageLeftButton);element.hudContainer.removeChild(element.pageRightButton);}
if(!element.insertTemplate){element.insertButton.setAttribute('hidden','');}}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var arrPopKeys;var currentValue;var bolRefresh;var strOperator;if(strQSCol){if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}}
if(element.internal.bolQSFirstRun===true){if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){currentValue=GS.qryGetVal(strQS,arrPopKeys[i]);if(element.popValues[arrPopKeys[i]]!==currentValue){bolRefresh=true;}
element.popValues[arrPopKeys[i]]=currentValue;}}else if(element.hasAttribute('refresh-on-querystring-change')){bolRefresh=true;}
if(bolRefresh&&element.hasAttribute('src')){getData(element);}else if(bolRefresh&&!element.hasAttribute('src')){console.warn('gs-combo Warning: element has "refresh-on-querystring-values" or "refresh-on-querystring-change", but no "src".',element);}}else{if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){element.popValues[arrPopKeys[i]]=GS.qryGetVal(strQS,arrPopKeys[i]);}}}
element.internal.bolQSFirstRun=true;}
function bindElement(element){var strQSValue;if(element.getAttribute('qs')||element.getAttribute('refresh-on-querystring-values')||element.hasAttribute('refresh-on-querystring-change')){element.popValues={};pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
element.addEventListener('focus',function(event){if(event.target.hasAttribute('column')){event.target.strOldValue=event.target.value;}},true);if(!evt.touchDevice){element.addEventListener('mousedown',function(event){var parentDatasheet=GS.findParentTag(event.target,'gs-datasheet');if(!GS.isElementFocusable(event.target)||!parentDatasheet||parentDatasheet.nodeName!=='GS-DATASHEET'){element.copyControl.focus();}});}
element.copyControl.addEventListener('copy',function(event){var strTextCopyString,strHTMLCopyString;if(document.activeElement.classList.contains('hidden-focus-control')||document.activeElement.selectionStart===document.activeElement.selectionEnd){GS.setInputSelection(document.activeElement,document.activeElement.value.length,document.activeElement.value.length);strTextCopyString=getSelectedCopyText(element);strHTMLCopyString=getSelectedCopyHTML(element);if(strTextCopyString&&strHTMLCopyString){if(handleClipboardData(event,strTextCopyString,'text')){event.preventDefault(event);}
if(handleClipboardData(event,strHTMLCopyString,'html')){event.preventDefault(event);}}
GS.setInputSelection(document.activeElement,0,document.activeElement.value.length);}});window.addEventListener('focus',function(event){if(GS.findParentTag(document.activeElement,'gs-datasheet')===element){element.lastFocusedControl=document.activeElement;}else{element.lastFocusedControl=null;}});element.addEventListener('paste',function(event){if(document.activeElement===element.copyControl){event.preventDefault();pasteHandler(element,event);}});if(!evt.touchDevice){element.dragAllowed=false;element.numberOfSelections=0;element.addEventListener('mousedown',function(event){var target=GS.findParentElement(event.target,'th,td'),originalTarget=event.target;if(target&&(target.nodeName==='TH'||target.nodeName==='TD')){if(GS.findParentElement(target,'div').classList.contains('header-container')){target=xtag.query(element.scrollContainer,'th, td')[target.cellIndex];originalTarget=target;}
element.dragOrigin=target;if(event.shiftKey&&xtag.query(element,'[selected]').length>0){element.dragOrigin=element.selectionPreviousOrigin;}
if(!event.metaKey&&!event.ctrlKey){element.selectedCells=[];element.savedSelection=[];element.numberOfSelections=0;}
element.savedSelectionCopy=element.savedSelection.slice(0);element.dragAllowed=true;element.dragCurrentCell=target;element.numberOfSelections+=1;element.dragMode='select';if(target.hasAttribute('selected')){element.dragMode='deselect';}
if(originalTarget.nodeName==='TH'||originalTarget.nodeName==='TD'||element.dragOrigin!==target||element.selectedCells.length>0){element.lastFocusedControl=null;element.copyControl.focus();GS.triggerEvent(element.copyControl,'focus');event.preventDefault();}
selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);}});element.addEventListener('mousemove',function(event){var cellFromTarget;if(event.which!==0){cellFromTarget=GS.findParentElement(event.target,'th,td');if(cellFromTarget&&element.dragAllowed&&element.dragCurrentCell!==cellFromTarget){element.lastFocusedControl=null;element.copyControl.focus();GS.triggerEvent(element.copyControl,'focus');element.dragCurrentCell=cellFromTarget;selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);event.preventDefault();}}else{element.dragAllowed=false;element.selectionPreviousOrigin=element.dragOrigin;}});element.addEventListener('mouseup',function(event){if(element.dragAllowed){if(document.activeElement===element||document.activeElement===document.body){element.copyControl.focus();GS.triggerEvent(element.copyControl,'focus');}
element.dragAllowed=false;element.selectionPreviousOrigin=element.dragOrigin;}});}
if(!element.hasAttribute('no-filter')){element.filterButton.addEventListener('click',function(){var templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','300px');templateElement.setAttribute('data-overlay-close','true');templateElement.innerHTML=ml(function(){/*
                    <gs-body padded>
                        <label for="memo-datagrid-filters">Filters:</label>
                        <gs-memo id="memo-datagrid-filters" rows="6" no-resize-handle></gs-memo>
                        <br />
                        <gs-grid>
                            <gs-block><gs-button dialogclose remove-right>Cancel</gs-button></gs-block>
                            <gs-block><gs-button dialogclose remove-all style="border-left: 0 none;">Clear Filters</gs-button></gs-block>
                            <gs-block><gs-button dialogclose remove-left style="border-left: 0 none;">Update Filters</gs-button></gs-block>
                        </gs-grid>
                    </gs-body>
                */});GS.openDialogToElement(element.filterButton,templateElement,'down',function(){document.getElementById('memo-datagrid-filters').value=element.getAttribute('user-where').replace(/\sAND\s/gi,'\nAND ');},function(event,strAnswer){var strValue=document.getElementById('memo-datagrid-filters').value;if(strAnswer==='Clear Filters'||(strAnswer==='Update Filters'&&strValue.trim()==='')){element.removeAttribute('user-where');element.filterButton.setAttribute('hidden','');getData(element);}else if(strAnswer==='Update Filters'){element.setAttribute('user-where',strValue);getData(element);}});});var cellFloatingButtonFunction=function(targetCell){var jsnElementPosition=GS.getElementPositionData(targetCell),strHTML;if(targetCell.nodeName==='TH'||xtag.query(targetCell,'[column]').length===0){if(element.cellFloatingButtonContainer&&element.cellFloatingButtonContainer.parentNode){element.cellFloatingButtonContainer.parentNode.removeChild(element.cellFloatingButtonContainer);element.cellFloatingButtonContainer=null;}}else{if(!element.cellFloatingButtonContainer||!element.cellFloatingButtonContainer.parentNode){element.cellFloatingButtonContainer=document.createElement('div');element.cellFloatingButtonContainer.classList.add('floating-button-container');element.cellFloatingButtonContainer.innerHTML='<gs-button icononly icon="filter" inline bg-primary no-focus></gs-button>';element.dataFlexReset.appendChild(element.cellFloatingButtonContainer);element.cellFloatingButtonContainer.addEventListener(evt.mousedown,function(){element.cellFloatingButtonContainer.targetControl.bolSubstring=document.activeElement===element.cellFloatingButtonContainer.targetControl;});element.cellFloatingButtonContainer.addEventListener('click',function(){var targetControl=element.cellFloatingButtonContainer.targetControl,jsnSelection,strMatchText=targetControl.value||targetControl.textContent,templateElement=document.createElement('template');if(targetControl.nodeName==='INPUT'||targetControl.nodeName==='TEXTAREA'){jsnSelection=GS.getInputSelection(element.cellFloatingButtonContainer.targetControl);}
if(targetControl.bolSubstring&&jsnSelection&&jsnSelection.start!==jsnSelection.end){strMatchText=strMatchText.substring(jsnSelection.start,jsnSelection.end);}
templateElement.setAttribute('data-max-width','250px');templateElement.setAttribute('data-overlay-close','true');strHTML='<gs-body padded>';if(evt.touchDevice){strHTML+='<gs-button class="text-left" dialogclose>Select Range</gs-button>';strHTML+='<gs-button class="text-left" dialogclose>Select Records</gs-button><hr />';}
strHTML+='<gs-button class="text-left" dialogclose>Equals "<u>{{VALUE}}</u>"</gs-button>'+'<gs-button class="text-left" dialogclose>Doesn\'t Equal "<u>{{VALUE}}</u>"</gs-button>'+'<gs-button class="text-left" dialogclose>Contains "<u>{{VALUE}}</u>"</gs-button>'+'<gs-button class="text-left" dialogclose>Doesn\'t Contain "<u>{{VALUE}}</u>"</gs-button>'+'<gs-button class="text-left" dialogclose>Starts With "<u>{{VALUE}}</u>"</gs-button>'+'<gs-button class="text-left" dialogclose>Ends With "<u>{{VALUE}}</u>"</gs-button>';strHTML+='</gs-body>';strHTML=strHTML.replace(/\{\{VALUE\}\}/gim,encodeHTML(strMatchText));templateElement.innerHTML=strHTML;GS.openDialogToElement(element.cellFloatingButtonContainer,templateElement,'left','',function(event,strAnswer){var clickFunction,addUserWhere=function(strNewWhere){var strWhere=element.getAttribute('user-where');strWhere=(strWhere?(strWhere+' AND '+strNewWhere):strNewWhere);element.setAttribute('user-where',strWhere);element.filterButton.removeAttribute('hidden');getData(element);},control=element.cellFloatingButtonContainer.targetCell.children[0];if(strAnswer==='Select Range'||strAnswer==='Select Records'){if(strAnswer==='Select Records'){element.dragOrigin=element.cellFloatingButtonContainer.targetCell.parentNode.children[0];}else if(strAnswer==='Select Range'){element.dragOrigin=element.cellFloatingButtonContainer.targetCell;}
element.selectedCells=[];clickFunction=function(event){var target;if(strAnswer==='Select Records'){target=GS.findParentElement(event.target,'tr');element.dragCurrentCell=target.children[0];}else if(strAnswer==='Select Range'){target=GS.findParentElement(event.target,'td,th');element.dragCurrentCell=target;}
if(target){element.selectionPreviousOrigin=element.dragOrigin;element.savedSelection=[];element.savedSelectionCopy=[];element.numberOfSelections=1;element.dragMode='select';selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);document.activeElement.blur();event.preventDefault();element.removeEventListener('click',clickFunction,true);}};element.addEventListener('click',clickFunction,true);}else if(strAnswer.indexOf('Equals')===0){addUserWhere('CAST('+control.getAttribute('column')+'AS '+GS.database.type.text+') '+'= $$'+strMatchText+'$$');}else if(strAnswer.indexOf('Doesn\'t Equal')===0){addUserWhere('CAST('+control.getAttribute('column')+'AS '+GS.database.type.text+') '+'!= $$'+strMatchText+'$$');}else if(strAnswer.indexOf('Contains')===0){addUserWhere('CAST('+control.getAttribute('column')+'AS '+GS.database.type.text+') '+'LIKE $$%'+strMatchText+'%$$');}else if(strAnswer.indexOf('Doesn\'t Contain')===0){addUserWhere('CAST('+control.getAttribute('column')+'AS '+GS.database.type.text+') '+'NOT LIKE $$%'+strMatchText+'%$$');}else if(strAnswer.indexOf('Starts With')===0){addUserWhere('CAST('+control.getAttribute('column')+'AS '+GS.database.type.text+') '+'LIKE $$'+strMatchText+'%$$');}else if(strAnswer.indexOf('Ends With')===0){addUserWhere('CAST('+control.getAttribute('column')+'AS '+GS.database.type.text+') '+'LIKE $$%'+strMatchText+'$$');}});});}
element.cellFloatingButtonContainer.targetCell=targetCell;element.cellFloatingButtonContainer.targetControl=xtag.query(targetCell,'[column]')[0];element.cellFloatingButtonContainer.children[0].removeAttribute('remove-top-left');element.cellFloatingButtonContainer.children[0].removeAttribute('remove-top-right');element.cellFloatingButtonContainer.children[0].removeAttribute('remove-bottom-left');element.cellFloatingButtonContainer.children[0].removeAttribute('remove-bottom-right');if(jsnElementPosition.intRoomAbove>element.cellFloatingButtonContainer.clientHeight&&jsnElementPosition.intRoomLeft>element.cellFloatingButtonContainer.clientWidth){element.cellFloatingButtonContainer.setAttribute('style','left: '+((jsnElementPosition.intElementLeft-
element.cellFloatingButtonContainer.clientWidth)+4)+'px;'+'top: '+((jsnElementPosition.intElementTop-
element.cellFloatingButtonContainer.clientHeight)+4)+'px;');element.cellFloatingButtonContainer.children[0].setAttribute('remove-bottom-right','');}else if(jsnElementPosition.intRoomAbove>element.cellFloatingButtonContainer.clientHeight&&jsnElementPosition.intRoomRight>element.cellFloatingButtonContainer.clientWidth){element.cellFloatingButtonContainer.setAttribute('style','left: '+((jsnElementPosition.intElementLeft+
jsnElementPosition.intElementWidth)-4)+'px;'+'top: '+((jsnElementPosition.intElementTop-
element.cellFloatingButtonContainer.clientHeight)+4)+'px;');element.cellFloatingButtonContainer.children[0].setAttribute('remove-bottom-left','');}else if(jsnElementPosition.intRoomBelow>element.cellFloatingButtonContainer.clientHeight&&jsnElementPosition.intRoomLeft>element.cellFloatingButtonContainer.clientWidth){element.cellFloatingButtonContainer.setAttribute('style','left: '+((jsnElementPosition.intElementLeft-
element.cellFloatingButtonContainer.clientWidth)+4)+'px;'+'top: '+((jsnElementPosition.intElementTop+
jsnElementPosition.intElementHeight)-4)+'px;');element.cellFloatingButtonContainer.children[0].setAttribute('remove-top-right','');}else if(jsnElementPosition.intRoomBelow>element.cellFloatingButtonContainer.clientHeight&&jsnElementPosition.intRoomRight>element.cellFloatingButtonContainer.clientWidth){element.cellFloatingButtonContainer.setAttribute('style','left: '+((jsnElementPosition.intElementLeft+
jsnElementPosition.intElementWidth)-4)+'px;'+'top: '+((jsnElementPosition.intElementTop+
jsnElementPosition.intElementHeight)-4)+'px;');element.cellFloatingButtonContainer.children[0].setAttribute('remove-top-left','');}}};element.addEventListener('after_selection',function(event){var arrSelected=element.selectedCells;if(arrSelected.length===1){cellFloatingButtonFunction(element.dragCurrentCell||arrSelected[arrSelected.length-1]);}else if(element.cellFloatingButtonContainer&&element.cellFloatingButtonContainer.parentNode){element.cellFloatingButtonContainer.parentNode.removeChild(element.cellFloatingButtonContainer);element.cellFloatingButtonContainer=null;}});element.addEventListener('focus',function(event){if(event.target.hasAttribute('column')){cellFloatingButtonFunction(event.target.parentNode);}},true);element.addEventListener('mousewheel',function(event){if(element.cellFloatingButtonContainer&&element.cellFloatingButtonContainer.parentNode){element.cellFloatingButtonContainer.parentNode.removeChild(element.cellFloatingButtonContainer);element.cellFloatingButtonContainer=null;}});element.scrollContainer.addEventListener('scroll',function(event){if(element.cellFloatingButtonContainer&&element.cellFloatingButtonContainer.parentNode){element.cellFloatingButtonContainer.parentNode.removeChild(element.cellFloatingButtonContainer);element.cellFloatingButtonContainer=null;}});}
if(evt.touchDevice){var rangeFloatingButtonFunction=function(arrSelected){var i,len,targetCell,arrSelectedRecords,bolCenter=true,jsnElementPosition,intTopBoundry,intBottomBoundry,intLeftBoundry,intRightBoundry;if(!element.rangeFloatingButtonContainer||!element.rangeFloatingButtonContainer.parentNode){element.rangeFloatingButtonContainer=document.createElement('div');element.rangeFloatingButtonContainer.classList.add('floating-button-container');element.rangeFloatingButtonContainer.innerHTML='<gs-button icononly icon="clipboard" inline bg-primary no-focus></gs-button>'+'<div contenteditable="true" style=" position: fixed;  border: 0 none;'+'margin: 0;        padding: 0;'+'z-index: -5000;   opacity: 0.00000001;'+'-webkit-appearance: none;'+'-moz-appearance: none;"></div>';element.scrollContainer.appendChild(element.rangeFloatingButtonContainer);element.rangeFloatingButtonContainer.control=element.rangeFloatingButtonContainer.children[1];element.rangeFloatingButtonContainer.addEventListener('click',function(){element.rangeFloatingButtonContainer.control.innerHTML=getSelectedCopyHTML(element)||'Nothing To Copy';element.rangeFloatingButtonContainer.control.focus();document.execCommand('selectAll',false,null);});element.rangeFloatingButtonContainer.control.addEventListener('cut',function(){var strSchema=GS.templateWithQuerystring(element.getAttribute('schema')),strObject=GS.templateWithQuerystring(element.getAttribute('object')),strUpdateData='',strRecord,arrSetColumnElements,strHashColumns,arrSetColumns=[],arrPk,arrLock,arrLines,arrRecords,tbodyElement,arrElements,tr_len,i,len,col_i,col_len,colIndex,arrRecordsToRefresh=[],updateFunction,strColumns='',strRoles='',strColumn,strRecordToHash,strTemp;arrRecords=element.selectedRecords;if(arrRecords[0]&&arrRecords[0].parentNode.nodeName==='THEAD'){arrRecords[0].splice(0,1);}
arrSetColumnElements=xtag.query(arrRecords[0],'[selected]:not(th)');arrPk=(element.getAttribute('pk')||'').split(/[\s]*,[\s]*/);arrLock=(element.getAttribute('lock')||'').split(/[\s]*,[\s]*/);for(i=0,len=arrPk.length;i<len;i+=1){strRoles+=(strRoles?'\t':'')+'pk';strColumns+=(strColumns?'\t':'')+arrPk[i];}
for(i=0,len=arrLock.length,strHashColumns='';i<len;i+=1){strHashColumns+=(strHashColumns?'\t':'')+arrLock[i];}
strRoles+=(strRoles?'\t':'')+'hash';strColumns+=(strColumns?'\t':'')+'hash';for(i=0,len=arrSetColumnElements.length;i<len;i+=1){strColumn=arrSetColumnElements[i].children[0].getAttribute('column');strRoles+=(strRoles?'\t':'')+'set';strColumns+=(strColumns?'\t':'')+strColumn;arrSetColumns.push(strColumn);}
for(i=0,len=arrRecords.length;i<len;i+=1){strRecord='';for(col_i=0,col_len=arrPk.length;col_i<col_len;col_i+=1){strRecord+=(strRecord?'\t':'');strRecord+=GS.encodeForTabDelimited(arrRecords[i].getAttribute('data-'+arrPk[col_i]),element.nullString);}
strRecordToHash='';for(col_i=0,col_len=arrLock.length;col_i<col_len;col_i+=1){strRecordToHash+=(strRecordToHash?'\t':'');strTemp=arrRecords[i].getAttribute('data-'+arrLock[col_i]);strRecordToHash+=(strTemp==='NULL'?'':strTemp);}
strRecord+=(strRecord?'\t':'')+GS.utfSafeMD5(strRecordToHash).toString();for(col_i=0,col_len=arrSetColumns.length;col_i<col_len;col_i+=1){strRecord+=(strRecord?'\t':'');}
strRecord+='\n';strUpdateData+=strRecord;arrRecordsToRefresh.push(arrRecords[i]);arrRecords[i].classList.add('bg-red');}
strUpdateData=(strRoles+'\n'+strColumns+'\n'+strUpdateData);GS.addLoader(element,'Creating Update Transaction...');GS.requestUpdateFromSocket(getSocket(element),strSchema,strObject,getReturn(element),strHashColumns,strUpdateData,function(data,error,transactionID){if(error){getData(element);GS.removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){GS.removeLoader(element);if(!error){if(data!=='TRANSACTION COMPLETED'){data=getReturn(element)+'\n'+data;refreshRecordsAfterUpdate(element,arrRecordsToRefresh,data);}else{commitFunction();}}else{rollbackFunction();getData(element);GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){clearRecordColor(element,'bg-amber',true);GS.triggerEvent(element,'after_update');}else{getData(element);}}else{getData(element);GS.webSocketErrorDialog(data);}});});element.rangeFloatingButtonContainer.control.addEventListener('copy',function(event){setTimeout(function(){element.rangeFloatingButtonContainer.control.blur();element.rangeFloatingButtonContainer.control.innerHTML='';},1);});element.rangeFloatingButtonContainer.control.addEventListener('paste',function(event){pasteHandler(element,event);setTimeout(function(){element.rangeFloatingButtonContainer.control.blur();element.rangeFloatingButtonContainer.control.innerHTML='';},1);});}
intTopBoundry=99999999;intBottomBoundry=99999999;intLeftBoundry=99999999;intRightBoundry=99999999;for(i=0,len=arrSelected.length;i<len;i+=1){jsnElementPosition=GS.getElementPositionData(arrSelected[i]);if(jsnElementPosition.intElementTop<intTopBoundry){intTopBoundry=jsnElementPosition.intElementTop;}
if(jsnElementPosition.intElementBottom<intBottomBoundry){intBottomBoundry=jsnElementPosition.intElementBottom;}
if(jsnElementPosition.intElementLeft<intLeftBoundry){intLeftBoundry=jsnElementPosition.intElementLeft;}
if(jsnElementPosition.intElementRight<intRightBoundry){intRightBoundry=jsnElementPosition.intElementRight;}}
if(intTopBoundry>=0&&intRightBoundry>=0){element.rangeFloatingButtonContainer.style.top=(intTopBoundry+4)+'px';element.rangeFloatingButtonContainer.style.right=(intRightBoundry+4)+'px';}else if(intTopBoundry>=0&&intLeftBoundry>=0){element.rangeFloatingButtonContainer.style.top=(intTopBoundry+4)+'px';element.rangeFloatingButtonContainer.style.left=(intLeftBoundry+4)+'px';}else if(intBottomBoundry>=0&&intRightBoundry>=0){element.rangeFloatingButtonContainer.style.bottom=(intBottomBoundry+4)+'px';element.rangeFloatingButtonContainer.style.right=(intRightBoundry+4)+'px';}else if(intBottomBoundry>=0&&intLeftBoundry>=0){element.rangeFloatingButtonContainer.style.bottom=(intBottomBoundry+4)+'px';element.rangeFloatingButtonContainer.style.left=(intLeftBoundry+4)+'px';}};element.addEventListener('after_selection',function(event){var arrSelected=element.selectedCells;if(arrSelected.length>0&&element.numberOfSelections===1){rangeFloatingButtonFunction(arrSelected);}else if(element.rangeFloatingButtonContainer&&element.rangeFloatingButtonContainer.parentNode){element.rangeFloatingButtonContainer.parentNode.removeChild(element.rangeFloatingButtonContainer);element.rangeFloatingButtonContainer=null;}});element.scrollContainer.addEventListener('scroll',function(event){if(element.rangeFloatingButtonContainer&&element.rangeFloatingButtonContainer.parentNode){element.rangeFloatingButtonContainer.parentNode.removeChild(element.rangeFloatingButtonContainer);element.rangeFloatingButtonContainer=null;}});}
element.addEventListener('click',function(event){var target=event.target,intOffset,intLimit
if(target.classList.contains('delete-button')){deleteSelection(element);}else if(target.classList.contains('refresh-button')){getData(element,undefined,undefined,undefined,true);}else if(target.classList.contains('insert-button')){insertDialog(element);}else if(target.classList.contains('paginate-left')||target.classList.contains('paginate-right')){intLimit=parseInt(element.getAttribute('limit'),10);intOffset=parseInt(element.getAttribute('offset')||'0',10);if(target.classList.contains('paginate-left')){intOffset-=intLimit;}else{intOffset+=intLimit;}
if(intOffset<=0){intOffset=0;element.pageLeftButton.setAttribute('disabled','');}else{element.pageLeftButton.removeAttribute('disabled');}
element.setAttribute('offset',intOffset);element.paginated=true;getData(element);}});if(!evt.touchDevice){element.addEventListener('keydown',function(event){var intKeyCode=(event.which||event.keyCode);if(!element.hasAttribute('no-huddelete')){if(event.target===element.copyControl&&(intKeyCode===KEY_BACKSPACE||intKeyCode===KEY_DELETE)){deleteSelection(element);event.preventDefault();}}});}
var updateFromEntry=function(target){var updateRecord=GS.findParentElement(target,'tr'),updateRecordData=element.internalData.arrRecords[parseInt(updateRecord.getAttribute('data-index'),10)],arrPk,arrLock,i,len,col_i,col_len,strRoles,strColumns,strHashColumns,strRecordToHash,strTemp,strRecord,strUpdateData;arrPk=(element.getAttribute('pk')||'').split(/[\s]*,[\s]*/);arrLock=(element.getAttribute('lock')||'').split(/[\s]*,[\s]*/);for(i=0,len=arrPk.length,strRoles='',strColumns='';i<len;i+=1){strRoles+=(strRoles?'\t':'')+'pk';strColumns+=(strColumns?'\t':'')+arrPk[i];}
for(i=0,len=arrLock.length,strHashColumns='';i<len;i+=1){strHashColumns+=(strHashColumns?'\t':'')+arrLock[i];}
strRoles+=(strRoles?'\t':'')+'hash';strColumns+=(strColumns?'\t':'')+'hash';strRoles+=(strRoles?'\t':'')+'set';strColumns+=(strColumns?'\t':'')+target.getAttribute('column');strRecord='';for(col_i=0,col_len=arrPk.length;col_i<col_len;col_i+=1){strRecord+=(strRecord?'\t':'');strRecord+=GS.encodeForTabDelimited(updateRecordData[element.internalData.arrColumnNames.indexOf(arrPk[col_i])],element.nullString);}
strRecordToHash='';for(col_i=0,col_len=arrLock.length;col_i<col_len;col_i+=1){strRecordToHash+=(strRecordToHash?'\t':'');strTemp=updateRecordData[element.internalData.arrColumnNames.indexOf(arrLock[col_i])];strRecordToHash+=(strTemp==='NULL'?'':strTemp);}
strRecord+=(strRecord?'\t':'')+GS.utfSafeMD5(strRecordToHash).toString();strRecord+=(strRecord?'\t':'')+GS.encodeForTabDelimited(target.value,element.nullString);strUpdateData=(strRoles+'\n'+strColumns+'\n'+strRecord+'\n');updateRecords(element,strHashColumns,strUpdateData,[updateRecord],false);};element.addEventListener('change',function(event){var target=event.target;if(target.hasAttribute('column')&&!GS.findParentElement(target,'tr').classList.contains('insert-record')&&!event.shiftKey){updateFromEntry(target);}});var insertFromInsertRecord=function(){var arrElements=xtag.query(element,'tr.insert-record > td > [column]'),i,len,strColumns,strInsertData,strLocalData;for(i=0,len=arrElements.length,strColumns='',strInsertData='',strLocalData='';i<len;i+=1){strColumns+=(strColumns?'\t':'')+arrElements[i].getAttribute('column');strInsertData+=(strInsertData?'\t':'')+GS.encodeForTabDelimited(arrElements[i].value||'NULL',element.nullString);strLocalData+=(strLocalData?'\t':'')+GS.encodeForTabDelimited(arrElements[i].value||'',element.nullString);arrElements[i].value='';}
insertRecords(element,strColumns,strInsertData+'\n',strLocalData+'\n',false);};element.addEventListener('keydown',function(event){var intKeyCode=(event.which||event.keyCode),target=event.target;if(target.hasAttribute('column')&&GS.findParentElement(target,'tr').classList.contains('insert-record')&&!event.shiftKey){if(intKeyCode===KEY_RETURN){insertFromInsertRecord();event.preventDefault();}}});if(!evt.touchDevice){element.addEventListener('keydown',function(event){var intKeyCode=(event.which||event.keyCode),target=event.target,targetValue=target.value||'',bolNavigateMode=false,parentCell,parentRecord,parentTBody,jsnCursorPos,intCursorPosition,bolSelect,bolFullSelection,bolCursorAtFirst,bolCursorAtTop,bolCursorAtLast,bolCursorAtBottom,arrSelected,arrRecords,focusElement;if((event.target.nodeName==='INPUT'||event.target.nodeName==='TEXTAREA')&&!target.classList.contains('hidden-focus-control')){jsnCursorPos=GS.getInputSelection(event.target);if(!(jsnCursorPos.start===0&&jsnCursorPos.end===event.target.value.length&&event.shiftKey)){bolNavigateMode=true;}}else if(target.hasAttribute('column')){jsnCursorPos={'start':0,'end':targetValue.length};if(!event.shiftKey){bolNavigateMode=true;}}
if(bolNavigateMode){if(target.nodeName==='INPUT'||target.nodeName==='TEXTAREA'){jsnCursorPos=GS.getInputSelection(target);}else{jsnCursorPos={'start':0,'end':targetValue.length};}
parentCell=GS.findParentElement(target,'th,td');parentRecord=parentCell.parentNode;parentTBody=parentRecord.parentNode;bolFullSelection=(jsnCursorPos.start===0&&jsnCursorPos.end===targetValue.length);if(!bolFullSelection&&jsnCursorPos.start===jsnCursorPos.end){intCursorPosition=jsnCursorPos.start;bolCursorAtFirst=(intCursorPosition===0);bolCursorAtTop=(intCursorPosition<(targetValue.indexOf('\n')===-1?targetValue.length+1:targetValue.indexOf('\n')+1))||(intCursorPosition===0);bolCursorAtLast=(intCursorPosition===targetValue.length);bolCursorAtBottom=(intCursorPosition>targetValue.lastIndexOf('\n'));}
if(intKeyCode===KEY_LEFT&&(bolFullSelection||bolCursorAtFirst)){if(parentCell.previousElementSibling&&parentCell.previousElementSibling.nodeName!=='TH'){focusElement=parentCell.previousElementSibling;bolSelect=true;}else if(parentRecord.previousElementSibling){focusElement=parentRecord.previousElementSibling.lastElementChild;bolSelect=true;}}else if(intKeyCode===KEY_UP&&(bolFullSelection||bolCursorAtTop)){if(parentRecord.previousElementSibling){focusElement=parentRecord.previousElementSibling.children[parentCell.cellIndex];bolSelect=true;}else if(parentCell.previousElementSibling&&parentCell.previousElementSibling.nodeName!=='TH'){focusElement=parentTBody.lastElementChild.children[parentCell.cellIndex-1];bolSelect=true;}}else if(intKeyCode===KEY_RIGHT&&(bolFullSelection||bolCursorAtLast)){if(parentCell.nextElementSibling&&parentCell.nextElementSibling.nodeName!=='TH'){focusElement=parentCell.nextElementSibling;parentCell.nextElementSibling.children[0].focus();bolSelect=true;}else if(parentRecord.nextElementSibling){focusElement=parentRecord.nextElementSibling.children[1];bolSelect=true;}}else if(intKeyCode===KEY_DOWN&&(bolFullSelection||bolCursorAtBottom)){if(parentRecord.nextElementSibling){focusElement=parentRecord.nextElementSibling.children[parentCell.cellIndex];bolSelect=true;}else if(parentCell.nextElementSibling&&parentCell.nextElementSibling.nodeName!=='TH'){focusElement=parentTBody.firstElementChild.children[parentCell.cellIndex+1];bolSelect=true;}}
if(bolSelect){element.savedSelection=[];element.savedSelectionCopy=[];element.dragOrigin=GS.findParentElement(focusElement,'td, th');element.dragCurrentCell=element.dragOrigin;element.selectionPreviousOrigin=element.dragOrigin;element.numberOfSelections=1;element.dragMode='select';selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);event.preventDefault();event.stopPropagation();}
if(focusElement){focusElement=xtag.query(focusElement,'input, textarea, select, [tabindex]')[0];if(focusElement){focusElement.focus();if(focusElement!==window){if(focusElement.nodeName==='INPUT'||focusElement.nodeName==='TEXTAREA'){GS.setInputSelection(focusElement,0,focusElement.value.length);}
parentRecord=GS.findParentTag(focusElement,'tr');if(parentRecord&&parentRecord.nodeName==='TR'){GS.scrollIntoView(parentRecord);}}}}}else if(event.target===element||event.target.hasAttribute('column')||event.target.classList.contains('hidden-focus-control')){if(!element.dragAllowed){arrSelected=element.selectedCells;if(intKeyCode===KEY_TAB){if(element.dragOrigin){element.dragOrigin.children[0].focus();event.preventDefault();}}else if(intKeyCode===KEY_RETURN){if(arrSelected.length===1){arrSelected[0].children[0].focus();}else{element.dragOrigin.children[0].focus();}
GS.setInputSelection(document.activeElement,document.activeElement.value.length);GS.scrollIntoView(GS.findParentTag(document.activeElement,'tr'));event.preventDefault();}else if(intKeyCode===KEY_UP||intKeyCode===KEY_DOWN||intKeyCode===KEY_LEFT||intKeyCode===KEY_RIGHT){arrRecords=xtag.query(element,'tr');element.dragMode='select';if(arrSelected.length===0){element.savedSelection=[];element.savedSelectionCopy=[];element.dragOrigin=xtag.query(element,'tbody td')[0];element.dragCurrentCell=element.dragOrigin;element.selectionPreviousOrigin=element.dragOrigin;element.numberOfSelections=1;bolSelect=true;}else if(event.shiftKey){element.dragOrigin=element.selectionPreviousOrigin;parentRecord=element.dragCurrentCell.parentNode;if(intKeyCode===37&&element.dragCurrentCell.previousElementSibling){element.dragCurrentCell=element.dragCurrentCell.previousElementSibling;}else if(intKeyCode===38&&arrRecords[parentRecord.rowIndex-1]){element.dragCurrentCell=arrRecords[parentRecord.rowIndex-1].children[element.dragCurrentCell.cellIndex];}else if(intKeyCode===39&&element.dragCurrentCell.nextElementSibling){element.dragCurrentCell=element.dragCurrentCell.nextElementSibling;}else if(intKeyCode===40&&arrRecords[parentRecord.rowIndex+1]){element.dragCurrentCell=arrRecords[parentRecord.rowIndex+1].children[element.dragCurrentCell.cellIndex];}
bolSelect=true;}else{if(arrSelected.length>1){element.dragCurrentCell=element.selectionPreviousOrigin;}
parentRecord=element.dragCurrentCell.parentNode;if(intKeyCode===37&&element.dragCurrentCell.previousElementSibling){element.dragCurrentCell=element.dragCurrentCell.previousElementSibling;}else if(intKeyCode===38&&arrRecords[parentRecord.rowIndex-1]){element.dragCurrentCell=arrRecords[parentRecord.rowIndex-1].children[element.dragCurrentCell.cellIndex];}else if(intKeyCode===39&&element.dragCurrentCell.nextElementSibling){element.dragCurrentCell=element.dragCurrentCell.nextElementSibling;}else if(intKeyCode===40&&arrRecords[parentRecord.rowIndex+1]){element.dragCurrentCell=arrRecords[parentRecord.rowIndex+1].children[element.dragCurrentCell.cellIndex];}
element.savedSelection=[];element.savedSelectionCopy=[];element.dragOrigin=element.dragCurrentCell;element.selectionPreviousOrigin=element.dragCurrentCell;element.numberOfSelections=1;bolSelect=true;}
if(bolSelect){element.lastFocusedControl=null;element.copyControl.focus();selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);GS.scrollIntoView(element.dragCurrentCell.parentNode);event.preventDefault();}}}}});}
element.addEventListener('mousewheel',function(event){synchronizeHeaderScroll(element);});element.scrollContainer.addEventListener('scroll',function(event){synchronizeHeaderScroll(element);});window.addEventListener('resize',function(event){refreshReflow(element);refreshHeight(element);synchronizeHeaderWidths(element);});}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('null-string')){element.nullString=element.getAttribute('null-string')||'';}else{element.nullString='NULL';}
prepareElement(element);bindElement(element);getData(element,'','',true);}}}
xtag.register('gs-datasheet',{lifecycle:{created:function(){},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==='suspend-created'&&newValue===null){elementInserted(element);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(strAttrName==='value'&&this.root){this.refresh();}}}},events:{},accessors:{selectedCells:{/*
                    function synchronize(element, bolScroll) {
                        var arrRecords = xtag.query(element, 'tr'), selectCells = [], i, len,
                            arrParts, arrTextareas, focusedElement, recordIndex, cellIndex;
                        
                        // selection
                        if (element.savedSelection) {
                            // loop through savedSelection
                            for (i = 0, len = element.savedSelection.length; i < len; i += 1) {
                                // any cell position that is in saved selection gets added to the selectCells
                                arrParts = element.savedSelection[i].split(',');
                                recordIndex = parseInt(arrParts[0], 10);
                                cellIndex = parseInt(arrParts[1], 10);
                                
                                if (recordIndex < arrRecords.length && cellIndex < arrRecords[0].children.length) {
                                    selectCells.push(arrRecords[recordIndex].children[cellIndex]);
                                }
                            }
                            
                            // select cells
                            element.selectedCells = selectCells;
                        }
                        
                        // focus
                        if (element.lastFocusedControl) {
                            element.lastFocusedControl.focus();
                            focusedElement = element.lastFocusedControl;
                        } else {
                            focusedElement = element.copyControl;
                            focusedElement.focus();
                        }
                        
                        // if there was no control to focus and
                        //      there is a selection and
                        //      bolScroll is true: scroll to selected
                        if (!element.lastFocusedControl && element.selectedCells.length > 0 && bolScroll) {
                            GS.scrollIntoView(element.selectedCells[0].parentNode);
                        }
                        
                        // if there was a control and bolScroll is true: scroll to focused record
                        if (focusedElement && bolScroll) {
                            GS.scrollIntoView(GS.findParentElement(document.activeElement, 'tr'));
                        }
                        
                        if (focusedElement && element.lastTextSelection) {
                            GS.setInputSelection(focusedElement, element.lastTextSelection.start, element.lastTextSelection.end);
                        }
                    }
                    function clearSelection(element) {
                        element.savedSelection = [];
                        element.savedSelectionCopy = [];
                        element.dragOrigin = null;
                        element.dragCurrentCell = null;
                        element.selectionPreviousOrigin = null;
                        element.numberOfSelections = 0;
                        element.selectedCells = [];
                    }
                */
get:function(){return xtag.query(this.scrollContainer,'[selected]');},set:function(newValue){var i,len,intIdIndex,arrCells=xtag.query(this,'[selected]'),cell_i,cell_len,arrRowIndexes=[],arrHeaderIndexes=[],arrRecordSelectors,arrHeaders;for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');}
arrCells=xtag.query(this,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue==='object'&&newValue.length===undefined){arrCells=[newValue];}else{arrCells=newValue;}
if(!this.dragAllowed&&arrCells.length>0){this.dragOrigin=arrCells[0];this.dragCurrentCell=arrCells[arrCells.length-1];}
if(!this.savedSelection){this.savedSelection=[];}
for(i=0,len=arrCells.length;i<len;i+=1){GS.listAdd(arrRowIndexes,arrCells[i].parentNode.rowIndex);GS.listAdd(arrHeaderIndexes,arrCells[i].cellIndex);this.savedSelection.push(arrCells[i].parentNode.rowIndex+','+arrCells[i].cellIndex);arrCells[i].setAttribute('selected','');}
arrRecordSelectors=xtag.query(this,'tbody th, thead th:first-child');for(i=0,len=arrRecordSelectors.length;i<len;i+=1){if(arrRowIndexes.indexOf(i)!==-1&&!arrRecordSelectors[i].hasAttribute('selected')){arrRecordSelectors[i].setAttribute('selected-secondary','');}}
arrHeaders=xtag.query(this,'thead th');for(i=0,len=arrHeaders.length;i<len;i+=1){if(arrHeaderIndexes.indexOf(i)!==-1&&!arrHeaders[i].hasAttribute('selected')){arrHeaders[i].setAttribute('selected-secondary','');}}
GS.triggerEvent(this,'after_selection');}},selectedRecords:{get:function(){var i,len,intRecordIndex=-1,arrRecord=[],selected=this.selectedCells;for(i=0,len=selected.length;i<len;i+=1){if(selected[i].parentNode.rowIndex>intRecordIndex&&selected[i].parentNode.parentNode.nodeName!=='THEAD'){intRecordIndex=selected[i].parentNode.rowIndex;arrRecord.push(selected[i].parentNode);}}
return arrRecord;},set:function(newValue){var i,len,cell_i,cell_len,intIdIndex,arrCells=this.selectedCells,arrRecords,arrCellChildren;for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');}
arrCells=xtag.query(this,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue==='object'&&newValue.length===undefined){arrRecords=[newValue];}else{arrRecords=newValue;}
for(i=0,len=arrRecords.length,arrCells=[];i<len;i+=1){arrCellChildren=arrRecords[i].children;for(cell_i=0,cell_len=arrCellChildren.length;cell_i<cell_len;cell_i+=1){arrCells.push(arrCellChildren[cell_i]);}}
this.selectedCells=arrCells;}},value:{get:function(){return this.getAttribute('value');},set:function(newValue){return this.setAttribute('value',newValue);}}},methods:{'refresh':function(){getData(this);},'refreshFixedHeader':function(){synchronizeHeaderScroll(this);synchronizeHeaderWidths(this);},'refreshReflow':function(){refreshReflow(this);}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-date>','<gs-date>','gs-date column="${1:name}"></gs-date>');registerDesignSnippet('<gs-date> With Label','<gs-date>','label for="${1:date-insert-start_date}">${2:Start Date}:</label>\n'+'<gs-date id="${1:date-insert-start_date}" column="${3:start_date}"></gs-date>');designRegisterElement('gs-date','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-date.html');window.designElementProperty_GSDATE=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'placeholder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Date Picker',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-picker'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-picker',(this.value==='true'),false);});addProp('Format',true,'<gs-combo class="target" value="'+encodeHTML(selectedElement.getAttribute('format')||'')+'" mini>'+
ml(function(){/*<template>
                                            <table>
                                                <tbody>
                                                    <tr value="">
                                                        <td hidden>Default</td>
                                                        <td><center>Default<br /> (01/01/2015)</center></td>
                                                    </tr>
                                                    <tr value="shortdate">
                                                        <td hidden>shortdate</td>
                                                        <td><center>shortdate<br /> (1/1/15)</center></td>
                                                    </tr>
                                                    <tr value="mediumdate">
                                                        <td hidden>mediumdate</td>
                                                        <td><center>mediumdate<br /> (Jan 1, 2015)</center></td>
                                                    </tr>
                                                    <tr value="longdate">
                                                        <td hidden>longdate</td>
                                                        <td><center>longdate<br /> (January 1, 2015)</center></td>
                                                    </tr>
                                                    <tr value="fulldate">
                                                        <td hidden>fulldate</td>
                                                        <td><center>fulldate<br /> (Thursday, January 1, 2015)</center></td>
                                                    </tr>
                                                    <tr value="isodate">
                                                        <td hidden>isodate</td>
                                                        <td><center>isodate<br /> (2015-01-01)</center></td>
                                                    </tr>
                                                    <tr value="isodatetime">
                                                        <td hidden>isodatetime</td>
                                                        <td><center>isodatetime<br /> (2015-01-01T00:00:00)</center></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </template>
                                    </gs-combo>
                                */}),function(){return setOrRemoveTextAttribute(selectedElement,'format',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';var singleLineTemplateElement=document.createElement('template'),singleLineTemplate;singleLineTemplateElement.innerHTML='<input class="control" gs-dynamic type="text" />'+'<gs-button class="date-picker-button" gs-dynamic inline icononly icon="calendar" no-focus></gs-button>';singleLineTemplate=singleLineTemplateElement.content;function changeFunction(event){event.preventDefault();event.stopPropagation();GS.triggerEvent(event.target.parentNode,'change');handleFormat(event.target.parentNode,event);}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function buttonClickFunction(event){openDatePicker(event.target.parentNode);}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function syncView(element){if(element.control){element.setAttribute('value',element.control.value);}}
function openDatePicker(element,dteDate){var divElement=document.createElement('div'),jsnOffset=GS.getElementOffset(element.datePickerButton),jsnControlOffset=GS.getElementOffset(element),datePickerContainer,datePicker,strHTML='',intTop,bolSelectOrigin,i,len,dateClickHandler,arrDateButtons,dteCurrent,strInputValue=element.control.value;if(strInputValue.match(/monday|tuesday|wednesday|thursday|friday|saturday|sunday/gim)){strInputValue=strInputValue.replace(/monday|tuesday|wednesday|thursday|friday|saturday|sunday/gim,'').replace(/  /gim,' ').trim();}
strInputValue=strInputValue.replace(/-/,'/').replace(/-/,'/');dteCurrent=new Date(strInputValue);if(isNaN(dteCurrent.getTime())){dteCurrent=new Date();}
element.datePickerButton.setAttribute('selected','');if(!dteDate){if(element.control.value){dteDate=dteCurrent;bolSelectOrigin=true;}else{dteDate=new Date();}}
if(dteDate.getMonth()===dteCurrent.getMonth()&&dteDate.getFullYear()===dteCurrent.getFullYear()){bolSelectOrigin=true;}
strHTML=getContentForDatePicker(dteDate,bolSelectOrigin);divElement.innerHTML='<div class="gs-date-date-picker-container" gs-dynamic>'+'<div class="gs-date-date-picker" gs-dynamic>'+strHTML+'</div>'+'</div>';datePickerContainer=divElement.children[0];element.datePickerContainer=datePickerContainer;datePicker=datePickerContainer.children[0];document.body.appendChild(datePickerContainer);intTop=jsnOffset.top+element.offsetHeight;if(intTop+datePicker.offsetHeight>window.innerHeight){intTop-=datePicker.offsetHeight;intTop-=element.offsetHeight;if(intTop<0){intTop=0;}}
datePicker.style.top=intTop+'px';if(window.innerWidth>450&&jsnOffset.left>450){datePicker.style.width='450px';datePicker.style.right=window.innerWidth-(jsnOffset.left+element.datePickerButton.offsetWidth)+'px';}else if(window.innerWidth>450&&jsnOffset.left<=450){datePicker.style.width='450px';datePicker.style.left=jsnControlOffset.left+'px';}else{datePicker.style.width='96%';datePicker.style.right='2%';}
datePickerContainer.getElementsByClassName('prev-month')[0].addEventListener('click',function(){dteDate.setMonth((dteDate.getMonth()-1<0?11:dteDate.getMonth()-1));closeDatePicker(element);openDatePicker(element,dteDate);});datePickerContainer.getElementsByClassName('next-month')[0].addEventListener('click',function(){var i,oldMonth;oldMonth=dteDate.getMonth();dteDate.setMonth((oldMonth+1>11?0:oldMonth+1));if(dteDate.getMonth()===oldMonth+2){i=0;while(dteDate.getMonth()===oldMonth+2&&i<20){dteDate.setDate(dteDate.getDate()-1);i+=1;}}
closeDatePicker(element);openDatePicker(element,dteDate);});datePickerContainer.getElementsByClassName('prev-year')[0].addEventListener('click',function(){dteDate.setFullYear(dteDate.getFullYear()-1);closeDatePicker(element);openDatePicker(element,dteDate);});datePickerContainer.getElementsByClassName('next-year')[0].addEventListener('click',function(){dteDate.setFullYear(dteDate.getFullYear()+1);closeDatePicker(element);openDatePicker(element,dteDate);});datePickerContainer.addEventListener('click',function(event){if(event.target.classList.contains('gs-date-date-picker-container')){closeDatePicker(element);}});dateClickHandler=function(){var dteNewDate=new Date(this.getAttribute('data-date'));closeDatePicker(element);element.value=(dteNewDate.getMonth()+1)+'/'+dteNewDate.getDate()+'/'+dteNewDate.getFullYear();handleFormat(element);xtag.fireEvent(element,'change',{bubbles:true,cancelable:true});};arrDateButtons=datePickerContainer.getElementsByClassName('day-marker');for(i=0,len=arrDateButtons.length;i<len;i+=1){arrDateButtons[i].addEventListener('click',dateClickHandler);}}
function closeDatePicker(element){element.datePickerButton.removeAttribute('selected');document.body.removeChild(element.datePickerContainer);}
function getContentForDatePicker(originDate,bolSelectOrigin){var strHTML='',i,looperDate,lookaheadDate,intFirstDayOfWeek=0,dteToday=new Date(),arrDays=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],arrShortDays=['S','M','T','W','T','F','S'],arrMonths=['January','February','March','April','May','June','July','August','September','October','November','December'];looperDate=new Date(originDate);looperDate.setDate(1);strHTML='<div class="month-marker" flex-horizontal gs-dynamic>'+'<gs-button class="prev-month" inline icononly icon="arrow-left" gs-dynamic>Prev</gs-button>'+'<span flex gs-dynamic>'+arrMonths[originDate.getMonth()]+'</span>'+'<gs-button class="next-month" inline icononly icon="arrow-right" gs-dynamic>Next</gs-button>'+'</div>'+'<div class="year-marker" flex-horizontal gs-dynamic>'+'<gs-button class="prev-year" inline icononly icon="arrow-left" gs-dynamic>Prev</gs-button>'+'<span flex gs-dynamic>'+originDate.getFullYear()+'</span>'+'<gs-button class="next-year" inline icononly icon="arrow-right" gs-dynamic>Next</gs-button>'+'</div>';if(!isNaN(looperDate.getTime())){i=0;while(looperDate.getDay()!==intFirstDayOfWeek&&i<20){looperDate.setDate(looperDate.getDate()-1);i+=1;}
strHTML+='<div class="date-picker-divider" gs-dynamic></div><div class="day-of-week-markers-container" gs-dynamic>';for(i=0;i<7;i+=1){strHTML+='<div class="day-of-week-marker" gs-dynamic>'+arrShortDays[i]+'</div>';}
strHTML+='</div>';i=0;lookaheadDate=new Date(looperDate);lookaheadDate.setDate(lookaheadDate.getDate()+1);while(!(looperDate.getDay()===intFirstDayOfWeek&&(looperDate.getMonth()!==originDate.getMonth()&&i>0)&&lookaheadDate.getFullYear()>=originDate.getFullYear())&&i<50){strHTML+='<gs-button inline class="day-marker';if(looperDate.getMonth()!==originDate.getMonth()){strHTML+=' other-month';}
if(looperDate.getFullYear()===dteToday.getFullYear()&&looperDate.getMonth()===dteToday.getMonth()&&looperDate.getDate()===dteToday.getDate()){strHTML+=' today';}
strHTML+='"';if(looperDate.getTime()===originDate.getTime()&&bolSelectOrigin){strHTML+=' selected ';}
strHTML+='data-date="'+looperDate+'" gs-dynamic>';if(looperDate.getFullYear()===dteToday.getFullYear()&&looperDate.getMonth()===dteToday.getMonth()&&looperDate.getDate()===dteToday.getDate()){strHTML+='T';}else{strHTML+=looperDate.getDate();}
strHTML+='</gs-button>';lookaheadDate.setDate(lookaheadDate.getDate()+1);looperDate.setDate(looperDate.getDate()+1);i+=1;}}
return strHTML;}
function handleFormat(element,event,bolAlertOnError){if(element.value){var dteValue,strValueToFormat=element.value,tempSelection=GS.getInputSelection(element.control);if(strValueToFormat.match(/monday|tuesday|wednesday|thursday|friday|saturday|sunday/gim)){strValueToFormat=strValueToFormat.replace(/monday|tuesday|wednesday|thursday|friday|saturday|sunday/gim,'').replace(/  /gim,' ').trim();}
if(strValueToFormat.indexOf(':')!==-1){strValueToFormat=strValueToFormat.substring(0,strValueToFormat.indexOf(':'));strValueToFormat=strValueToFormat.substring(0,strValueToFormat.lastIndexOf(' '));}
if(strValueToFormat.length===6&&strValueToFormat.match(/[0-9]/g).join('')===element.value){dteValue=new Date(strValueToFormat.substring(0,2)+'/'+
strValueToFormat.substring(2,4)+'/'+
strValueToFormat.substring(4,6));}else{dteValue=new Date(strValueToFormat.replace(/-/,'/').replace(/-/,'/').replace(/-.*/,''));}
if(isNaN(dteValue.getTime())){if(bolAlertOnError!==undefined&&bolAlertOnError!==false){alert('Invalid Date: '+element.value);}
if(document.activeElement===element.control){GS.setInputSelection(element.control,tempSelection.start,tempSelection.end);if(event){if(event.keyCode===GS.keyCode('backspace')){GS.setInputSelection(element.control,tempSelection.start-1,tempSelection.start-1);}else if(event.keyCode===GS.keyCode('delete')){GS.setInputSelection(element.control,tempSelection.start,tempSelection.start);}
event.stopPropagation();event.preventDefault();}}}else{if(element.control){element.control.value=formatDate(dteValue,getFormatString(element));if(document.activeElement===element.control){GS.setInputSelection(element.control,tempSelection.start,tempSelection.end);}}else{element.innerHTML=formatDate(dteValue,getFormatString(element));}}}else{return'NULL';}}
function getFormatString(element){var strFormat;if(element.hasAttribute('format')){strFormat=element.getAttribute('format');}
if(!strFormat){strFormat='MM/dd/yyyy';}else if(strFormat.toLowerCase()==='shortdate'){strFormat='M/d/yy';}else if(strFormat.toLowerCase()==='mediumdate'){strFormat='MMM d, yyyy';}else if(strFormat.toLowerCase()==='longdate'){strFormat='MMMM d, yyyy';}else if(strFormat.toLowerCase()==='fulldate'){strFormat='EEEE, MMMM d, yyyy';}else if(strFormat.toLowerCase()==='shorttime'){strFormat='h:mm a';}else if(strFormat.toLowerCase()==='mediumtime'){strFormat='h:mm:ss a';}else if(strFormat.toLowerCase()==='isodate'){strFormat='yyyy-MM-dd';}else if(strFormat.toLowerCase()==='isotime'){strFormat='HH:mm:ss';}else if(strFormat.toLowerCase()==='isodatetime'){strFormat='yyyy-MM-dd\'T\'HH:mm:ss';}
return strFormat;}
function formatDate(dteValue,strFormat){/* (this function contains a (modified) substantial portion of code from another source
            here is the copyright for sake of legality) (Uses code by Matt Kruse)
        Copyright (c) 2006-2009 Rostislav Hristov, Asual DZZD
        
        Permission is hereby granted, free of charge, to any person obtaining a 
        copy of this software and associated documentation files 
        (the "Software"), to deal in the Software without restriction, 
        including without limitation the rights to use, copy, modify, merge, 
        publish, distribute, sublicense, and/or sell copies of the Software, 
        and to permit persons to whom the Software is furnished to do so, 
        subject to the following conditions:
        
        The above copyright notice and this permission notice shall be included 
        in all copies or substantial portions of the Software.
        
        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS 
        OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF 
        MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
        IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
        CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
        TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
        SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.*/
var i=0,j=0,l=0,c='',token='',x,y,yearLen,formatNumber=function(n,s){if(typeof s=='undefined'||s==2){return(n>=0&&n<10?'0':'')+n;}else{if(n>=0&&n<10){return'00'+n;}
if(n>=10&&n<100){return'0'+n;}
return n;}},locale={monthsFull:['January','February','March','April','May','June','July','August','September','October','November','December'],monthsShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],daysFull:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],daysShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],shortDateFormat:'M/d/yyyy h:mm a',longDateFormat:'EEEE, MMMM dd, yyyy h:mm:ss a'};y=dteValue.getFullYear();/*if (y < 1000) {
            y = String(y + 1900);
        }*/
var M=dteValue.getMonth()+1,d=dteValue.getDate(),E=dteValue.getDay(),H=dteValue.getHours(),m=dteValue.getMinutes(),s=dteValue.getSeconds(),S=dteValue.getMilliseconds();yearLen=String(y).length;dteValue={y:y,yyyy:y,yy:String(y).substring(yearLen-2,yearLen),M:M,MM:formatNumber(M),MMM:locale.monthsShort[M-1],MMMM:locale.monthsFull[M-1],d:d,dd:formatNumber(d),EEE:locale.daysShort[E],EEEE:locale.daysFull[E],H:H,HH:formatNumber(H)};if(H===0){dteValue.h=12;}else if(H>12){dteValue.h=H-12;}else{dteValue.h=H;}
dteValue.hh=formatNumber(dteValue.h);dteValue.k=H!==0?H:24;dteValue.kk=formatNumber(dteValue.k);if(H>11){dteValue.K=H-12;}else{dteValue.K=H;}
dteValue.KK=formatNumber(dteValue.K);if(H>11){dteValue.a='PM';}else{dteValue.a='AM';}
dteValue.m=m;dteValue.mm=formatNumber(m);dteValue.s=s;dteValue.ss=formatNumber(s);dteValue.S=S;dteValue.SS=formatNumber(S);dteValue.SSS=formatNumber(S,3);var result='';i=0;c='';token='';s=false;while(i<strFormat.length){token='';c=strFormat.charAt(i);if(c=='\''){i++;if(strFormat.charAt(i)==c){result=result+c;i++;}else{s=!s;}}else{while(strFormat.charAt(i)==c){token+=strFormat.charAt(i++);}
if(token.indexOf('MMMM')!=-1&&token.length>4){token='MMMM';}
if(token.indexOf('EEEE')!=-1&&token.length>4){token='EEEE';}
if(typeof dteValue[token]!='undefined'&&!s){result=result+dteValue[token];}else{result=result+token;}}}
return result;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value&&new Date(element.value).getTime()){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){var today,strQSValue;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element)
/*
                element.addEventListener(evt.mouseout, function (event) {
                    element.classList.remove('hover');
                });
                
                element.addEventListener(evt.mouseover, function (event) {
                    element.classList.add('hover');
                });
                */
if(element.hasAttribute('tabindex')){element.oldTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
if(element.hasAttribute('value')&&element.getAttribute('value').trim().toLowerCase()==='today'){today=new Date();element.setAttribute('value',GS.leftPad(today.getFullYear(),'0',4)+'/'+GS.leftPad(today.getMonth()+1,'0',2)+'/'+GS.leftPad(today.getDate(),'0',2));}
if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
if(!element.hasAttribute('disabled')){element.innerHTML='';element.appendChild(singleLineTemplate.cloneNode(true));if(element.oldTabIndex){xtag.query(element,'.control')[0].setAttribute('tabindex',element.oldTabIndex);}}
element.refresh();}}}
function getControlState(element){var jsnTextSelection,intStart,intEnd,strFormat=getFormatString(element),strValue=element.control.value,delimiter1index,delimiter2index,intCurrentSection,strCurrentSection,arrParts,intCurrentSectionSize;jsnTextSelection=GS.getInputSelection(element.control);intStart=jsnTextSelection.start;intEnd=jsnTextSelection.end;delimiter1index=(strValue.indexOf('-')===-1?strValue.indexOf('/'):strValue.indexOf('-'));delimiter2index=(strValue.lastIndexOf('-')===-1?strValue.lastIndexOf('/'):strValue.lastIndexOf('-'));arrParts=strFormat.split(/[-|/]/g);if(intStart>delimiter2index){intCurrentSection=2;}else if(intStart>delimiter1index&&intStart<=delimiter2index){intCurrentSection=1;}else{intCurrentSection=0;}
if(arrParts[intCurrentSection].indexOf('y')!==-1){strCurrentSection='year';}else if(arrParts[intCurrentSection].indexOf('M')!==-1){strCurrentSection='month';}else{strCurrentSection='day';}
if(intCurrentSection===2){intCurrentSectionSize=(strValue.length)-(delimiter2index+1);}else if(intCurrentSection===1){intCurrentSectionSize=delimiter2index-(delimiter1index+1);}else{intCurrentSectionSize=delimiter1index;}
return{'jsnTextSelection':jsnTextSelection,'intStart':intStart,'intEnd':intEnd,'strFormat':strFormat,'strValue':strValue,'delimiter1index':delimiter1index,'delimiter2index':delimiter2index,'intCurrentSection':intCurrentSection,'strCurrentSection':strCurrentSection,'arrParts':arrParts,'intCurrentSectionSize':intCurrentSectionSize};}
xtag.register('gs-date',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='disabled'&&newValue!==null){this.innerHTML=this.getAttribute('value')||this.getAttribute('placeholder');}else if(strAttrName==='disabled'&&newValue===null){this.innerHTML='';this.appendChild(singleLineTemplate.cloneNode(true));if(this.oldTabIndex){xtag.query(this,'.control')[0].setAttribute('tabindex',this.oldTabIndex);}
this.refresh();}else if(strAttrName==='value'){this.value=newValue;}}}},events:{focus:function(event){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}},click:function(event){var jsnTextSelection,intStart,strFormat,strValue,delimiter1index,delimiter2index;if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){jsnTextSelection=GS.getInputSelection(this.control);strFormat=getFormatString(this);strValue=this.control.value;if((/^[M|y]{1,}[/|-]{1}[M|d]{1,}[/|-]{1}[d|y]{1,}$/).test(strFormat)&&(strValue.substring(jsnTextSelection.start,jsnTextSelection.end).match(/[-|/]/g)||[]).length===0&&!evt.touchDevice){if((/^[0-9]{1,}[-]{1}[0-9]{1,}[-]{1}[0-9]{1,}$/).test(strValue)||(/^[0-9]{1,}[/]{1}[0-9]{1,}[/]{1}[0-9]{1,}$/).test(strValue)){intStart=jsnTextSelection.start;delimiter1index=(strValue.indexOf('-')===-1?strValue.indexOf('/'):strValue.indexOf('-'));delimiter2index=(strValue.lastIndexOf('-')===-1?strValue.lastIndexOf('/'):strValue.lastIndexOf('-'));if(intStart>delimiter2index){GS.setInputSelection(this.control,delimiter2index+1,strValue.length);}else if(intStart>delimiter1index&&intStart<=delimiter2index){GS.setInputSelection(this.control,delimiter1index+1,delimiter2index);}else{GS.setInputSelection(this.control,0,delimiter1index);}}}}},keydown:function(event){var jsnTextSelection,intStart,intEnd,strFormat,strValue,intKeyCode=(event.keyCode||event.which),delimiter1index,delimiter2index,intCurrentSection,strCurrentSection,arrParts,dteDate,intCurrentSectionSize,jsnState;if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){jsnTextSelection=GS.getInputSelection(this.control);strValue=this.control.value;strFormat=getFormatString(this);if((/^[M|y]{1,}[/|-]{1}[M|d]{1,}[/|-]{1}[d|y]{1,}$/).test(strFormat)&&(strValue.substring(jsnTextSelection.start,jsnTextSelection.end).match(/[-|/]/g)||[]).length===0&&!evt.touchDevice){if((/^[0-9]{1,}[-]{1}[0-9]{1,}[-]{1}[0-9]{1,}$/).test(strValue)||(/^[0-9]{1,}[/]{1}[0-9]{1,}[/]{1}[0-9]{1,}$/).test(strValue)){if(!event.shiftKey&&!event.metaKey&&!event.ctrlKey){event.stopPropagation();jsnState=getControlState(this)
jsnTextSelection=jsnState.jsnTextSelection
intStart=jsnState.intStart
intEnd=jsnState.intEnd
strFormat=jsnState.strFormat
strValue=jsnState.strValue
delimiter1index=jsnState.delimiter1index
delimiter2index=jsnState.delimiter2index
intCurrentSection=jsnState.intCurrentSection
strCurrentSection=jsnState.strCurrentSection
arrParts=jsnState.arrParts
intCurrentSectionSize=jsnState.intCurrentSectionSize
if((intKeyCode>=96&&intKeyCode<=105)||(intKeyCode>=48&&intKeyCode<=57)){this.keyupHandle=true;}else if(intKeyCode===111||intKeyCode===191||intKeyCode===109||intKeyCode===189){if(intCurrentSection===0){intCurrentSection=1;}else if(intCurrentSection===1){intCurrentSection=2;}}else if(intKeyCode===37||intKeyCode===39){if(intCurrentSection===2&&intKeyCode===37){intCurrentSection=1;}else if(intCurrentSection===1){if(intKeyCode===37){intCurrentSection=0;}else{intCurrentSection=2;}}else if(intCurrentSection===0&&intKeyCode===39){intCurrentSection=1;}}else if(intKeyCode===38||intKeyCode===40){dteDate=new Date(strValue+' 00:00:00');if(strCurrentSection==='year'){dteDate.setFullYear(dteDate.getFullYear()+(intKeyCode===38?1:-1));}else if(strCurrentSection==='month'){dteDate.setMonth(dteDate.getMonth()+(intKeyCode===38?1:-1));}else if(strCurrentSection==='day'){dteDate.setDate(dteDate.getDate()+(intKeyCode===38?1:-1));}
strValue=formatDate(dteDate,strFormat);this.control.value=strValue;this.triggerChangeManually=true;}
if(this.keyupHandle!==true){if(intCurrentSection===2){GS.setInputSelection(this.control,delimiter2index+1,strValue.length);}else if(intCurrentSection===1){GS.setInputSelection(this.control,delimiter1index+1,delimiter2index);}else{GS.setInputSelection(this.control,0,delimiter1index);}}
if(!(intKeyCode>=96&&intKeyCode<=105)&&!(intKeyCode>=48&&intKeyCode<=57)&&intKeyCode!==13&&intKeyCode!==9){event.preventDefault();}}}}}},keyup:function(event){var jsnTextSelection,intStart,intEnd,strFormat,strValue,intKeyCode=(event.keyCode||event.which),delimiter1index,delimiter2index,intCurrentSection,strCurrentSection,arrParts,dteDate,intCurrentSectionSize,jsnState;if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){strFormat=getFormatString(this);if((/^[M|y]{1,}[/|-]{1}[M|d]{1,}[/|-]{1}[d|y]{1,}$/).test(strFormat)&&this.keyupHandle&&!evt.touchDevice){if(!event.shiftKey&&!event.metaKey&&!event.ctrlKey){jsnState=getControlState(this)
jsnTextSelection=jsnState.jsnTextSelection
intStart=jsnState.intStart
intEnd=jsnState.intEnd
strFormat=jsnState.strFormat
strValue=jsnState.strValue
delimiter1index=jsnState.delimiter1index
delimiter2index=jsnState.delimiter2index
intCurrentSection=jsnState.intCurrentSection
strCurrentSection=jsnState.strCurrentSection
arrParts=jsnState.arrParts
intCurrentSectionSize=jsnState.intCurrentSectionSize
if((strCurrentSection==='day'&&intCurrentSectionSize===2)||(strCurrentSection==='month'&&intCurrentSectionSize===2)||(strCurrentSection==='year'&&intCurrentSectionSize===strFormat.match(/y/g).length)){if(intCurrentSection===2){GS.setInputSelection(this.control,delimiter2index+1,strValue.length);}else if(intCurrentSection===1){GS.setInputSelection(this.control,delimiter1index+1,delimiter2index);}else{GS.setInputSelection(this.control,0,delimiter1index);}}}}
this.keyupHandle=false;if(intKeyCode===13&&this.triggerChangeManually){this.triggerChangeManually=false;GS.triggerEvent(this,'change');}}},focusout:function(){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(this.triggerChangeManually){this.triggerChangeManually=false;GS.triggerEvent(this,'change');}}}
/*// on keydown and keyup sync the value attribute and the control value
            keydown: function (event) {
                var element = this, currentDate, currentSelectionRange, currentSelectionText, currentSelectionNumber, currentSelectionFormatText,
                    currentValue, newValue, strDateFormat, formatDivider, arrMatch, currentFieldRange, newCursorPos, newFieldValue,
                    daysOfTheWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
                    monthsOfTheYear = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                    strKeyCode = event.keyCode.toString();
                
                currentSelectionRange = GS.getInputSelection(element.control);
                
                if (!element.hasAttribute('suspend-created') && !element.hasAttribute('suspend-inserted')) {
                    if (element.getAttribute('disabled') !== null && event.keyCode !== 9) {
                        event.preventDefault();
                        event.stopPropagation();
                    } else {
                        //console.log(strKeyCode === GS.keyCode('left arrow')  , GS.keyCode('left arrow') );
                        //console.log(strKeyCode === GS.keyCode('up arrow')    , GS.keyCode('up arrow'));
                        //console.log(strKeyCode === GS.keyCode('right arrow') , GS.keyCode('right arrow'));
                        //console.log(strKeyCode === GS.keyCode('down arrow')  , GS.keyCode('down arrow'));
                        
                        // When the user presses an arrow key:
                        // It finds the current number that the user has selected
                        //     If they pressed up or down
                        //         (inc/dec)rement the current number (handling day and month names of course)
                        //     If they pressed left or right
                        //         Move their selection to the left or right depending on what they pressed
                        // Then moves the selection to the current number (handling day/month name length differences)
                        
                        // Fix date format
                        strDateFormat = element.getAttribute('format');
                        //console.log(strDateFormat);
                        if (!strDateFormat) {
                            strDateFormat = 'MM/dd/yyyy';
                        } else if (strDateFormat.toLowerCase() === 'shortdate') {
                            strDateFormat = 'M/d/yy';
                        } else if (strDateFormat.toLowerCase() === 'mediumdate') {
                            strDateFormat = 'MMM d, yyyy';
                        } else if (strDateFormat.toLowerCase() === 'longdate') {
                            strDateFormat = 'MMMM d, yyyy';
                        } else if (strDateFormat.toLowerCase() === 'fulldate') {
                            strDateFormat = 'EEEE, MMMM d, yyyy';
                        } else if (strDateFormat.toLowerCase() === 'shorttime') {
                            strDateFormat = 'h:mm a';
                        } else if (strDateFormat.toLowerCase() === 'mediumtime') {
                            strDateFormat = 'h:mm:ss a';
                        } else if (strDateFormat.toLowerCase() === 'isodate') {
                            strDateFormat = 'yyyy-MM-dd';
                        } else if (strDateFormat.toLowerCase() === 'isotime') {
                            strDateFormat = 'HH:mm:ss';
                        } else if (strDateFormat.toLowerCase() === 'isodatetime') {
                            strDateFormat = 'yyyy-MM-dd\'T\'HH:mm:ss';
                        }
                        
                        formatDivider = strDateFormat.match(/[^mdyehmsa]/gi).join('');
                        
                        currentValue = element.control.value;
                        currentDate = new Date(currentValue.replace('\'T\'', ' ').replace(/-/g, '/'));
                        
                        if (strDateFormat.indexOf('M') === -1) {
                            currentDate = new Date('2015/6/15 ' + currentValue);
                        }
                        
                        arrMatch = strDateFormat.match(/(M|E)+/g);
                        if (arrMatch && arrMatch[0].length > 3) {
                            strDateFormat = strDateFormat.replace(/E+/g, new Array(daysOfTheWeek[currentDate.getDay()].length + 1).join('E'));
                            strDateFormat = strDateFormat.replace(/M+/g, new Array(monthsOfTheYear[currentDate.getDay()].length + 1).join('M'));
                        }
                        
                        // If it was an arrow that was pressed
                        if (strKeyCode === GS.keyCode('left arrow') ||
                            strKeyCode === GS.keyCode('up arrow') ||
                            strKeyCode === GS.keyCode('right arrow') ||
                            strKeyCode === GS.keyCode('down arrow')) {
                            
                            //console.log('test');
                            
                            // Prevent the browser from moving the cursor and prevent envelope from using arrows
                            event.preventDefault();
                            event.stopPropagation();
                            
                            //console.log(currentValue, formatDivider, currentSelectionRange.start, currentSelectionRange.end);
                            
                            // Encompass the field in which the cursor is inside
                            while (currentSelectionRange.start >= 0 && formatDivider.indexOf(currentValue[currentSelectionRange.start - 1]) < 0) {
                                currentSelectionRange.start -= 1;
                            }
                            
                            currentSelectionRange.end = currentSelectionRange.start;
                            while ( currentSelectionRange.end < currentValue.length &&
                                    formatDivider.indexOf(currentValue[currentSelectionRange.end]) < 0) {
                                currentSelectionRange.end += 1;
                            }
                            
                            //console.log(currentValue, currentSelectionRange.start, currentSelectionRange.end);
                            
                            GS.setInputSelection(element.control, currentSelectionRange.start, currentSelectionRange.end);
                            
                            currentSelectionText = currentValue.substring(currentSelectionRange.start, currentSelectionRange.end);
                            currentSelectionFormatText = strDateFormat.substring(currentSelectionRange.start, currentSelectionRange.end);
                            
                            // If it is up or down
                            if (strKeyCode === GS.keyCode('up arrow') ||
                                strKeyCode === GS.keyCode('down arrow')) {
                                var increment = strKeyCode === GS.keyCode('up arrow') ? 1 : -1;
                                
                                if (currentSelectionFormatText[0] === 'M') {
                                    currentDate.setMonth(currentDate.getMonth() +       increment);
                                    if ((currentSelectionRange.end - currentSelectionRange.start) > 2) {
                                        currentSelectionRange.end = currentSelectionRange.start + currentSelectionText.indexOf(' ');
                                    } else {
                                        currentSelectionRange.end = currentSelectionRange.start + currentDate.getMonth().toString().length;
                                    }
                                    
                                } else if (currentSelectionFormatText[0] === 'd') {
                                    currentDate.setDate(currentDate.getDate() + increment);
                                    currentSelectionRange.end = currentSelectionRange.start + currentDate.getDate().toString().length;
                                    
                                } else if (currentSelectionFormatText[0] === 'y') {
                                    currentDate.setFullYear(currentDate.getFullYear() + increment);
                                    currentSelectionRange.end = currentSelectionRange.start + currentDate.getFullYear().toString().length;
                                    
                                } else if (currentSelectionFormatText[0] === 'E') {
                                    currentDate.setDate(currentDate.getDate() + increment);
                                    currentSelectionRange.start = 0;
                                    currentSelectionRange.end = daysOfTheWeek[currentDate.getDay()].length;
                                    
                                } else if (currentSelectionFormatText[0] === 'h' || currentSelectionFormatText[0] === 'H') {
                                    currentDate.setHours(currentDate.getHours() + increment);
                                    currentSelectionRange.end = currentSelectionRange.start + currentDate.getHours().toString().length;
                                    
                                } else if (currentSelectionFormatText[0] === 'm') {
                                    currentDate.setMinutes(currentDate.getMinutes() + increment);
                                    currentSelectionRange.end = currentSelectionRange.start + currentDate.getMinutes().toString().length;
                                    
                                } else if (currentSelectionFormatText[0] === 's') {
                                    currentDate.setSeconds(currentDate.getSeconds() + increment);
                                    currentSelectionRange.end = currentSelectionRange.start + currentDate.getSeconds().toString().length;
                                    
                                } else if (currentSelectionFormatText[0] === 'a') {
                                    currentDate.setHours(currentDate.getHours() + 12);
                                }
                                
                                newValue = formatDate(currentDate, strDateFormat);
                                this.control.value = newValue;
                                currentValue = newValue;
                            } else if (strKeyCode === GS.keyCode('left arrow')) {
                                currentSelectionRange.end = currentSelectionRange.start - 2;
                                currentSelectionRange.start = currentSelectionRange.end;
                            } else if (strKeyCode === GS.keyCode('right arrow')) {
                                currentSelectionRange.end = currentSelectionRange.end + 2;
                                currentSelectionRange.start = currentSelectionRange.end;
                            }
                            
                            // Copied from above
                            arrMatch = strDateFormat.match(/(M|E)+/g);
                            if (arrMatch && arrMatch[0].length > 3) {
                                strDateFormat = strDateFormat.replace(/E+/g, new Array(daysOfTheWeek[currentDate.getDay()].length + 1).join('E'));
                                strDateFormat = strDateFormat.replace(/M+/g, new Array(monthsOfTheYear[currentDate.getDay()].length + 1).join('M'));
                            }
                            while (currentSelectionRange.start >= 0 && formatDivider.indexOf(currentValue[currentSelectionRange.start - 1]) < 0) {
                                currentSelectionRange.start -= 1;
                            }
                            currentSelectionRange.end = currentSelectionRange.start;
                            while ( currentSelectionRange.end < currentValue.length &&
                                    formatDivider.indexOf(currentValue[currentSelectionRange.end]) < 0) {
                                currentSelectionRange.end += 1;
                            }
                            
                            GS.setInputSelection(element.control, currentSelectionRange.start, currentSelectionRange.end);
                            
                        // All number keys
                        } else if (event.keyCode >= 96 && event.keyCode <= 105) {
                            //// HARK YE ONLOOKER:
                            //// This code caps the number that is inputed by the user to the length that the format allows,
                            //// this will dissallow anyone form entering a year that is > 4 characters unless the
                            //// page's developer allows it in a custom format.
                            //// 
                            //// This should be fixed around the year 9998 to have all default formats have 5 character years
                            
                            currentSelectionText = currentValue.substring(currentSelectionRange.start, currentSelectionRange.end);
                            currentSelectionFormatText = strDateFormat.substring(currentSelectionRange.start, currentSelectionRange.end);
                            
                            currentValue = element.value;
                            
                            // This is sort of copied from above
                            // There are only two differences:
                            //     the var name
                            //     the initialization on the next line
                            currentFieldRange = {
                                start: currentSelectionRange.start
                            };
                            while (currentFieldRange.start >= 0 && formatDivider.indexOf(currentValue[currentFieldRange.start - 1]) < 0) {
                                currentFieldRange.start -= 1;
                            }
                            currentFieldRange.end = currentFieldRange.start;
                            while ( currentFieldRange.end < currentValue.length &&
                                    formatDivider.indexOf(currentValue[currentFieldRange.end]) < 0) {
                                currentFieldRange.end += 1;
                            }
                            
                            //console.log(currentFieldRange);
                            
                            //console.log(currentValue.substring(0, currentSelectionRange.start));
                            //console.log(GS.charFromKeyCode(event), currentSelectionText, currentSelectionFormatText, currentDate);
                            //console.log(currentValue.substring(currentSelectionRange.end));
                            
                            // This error checking is probably unneeded, but what the hey
                            currentFieldRange.start = Math.max(currentFieldRange.start, 0);
                            arrMatch = strDateFormat.match(strDateFormat[currentFieldRange.start] + '+', 'g');
                            if (arrMatch) {
                                // Prevent the browser from putting the number in for us
                                event.preventDefault();
                                
                                // Get the character that they pressed
                                newFieldValue = GS.charFromKeyCode(event);
                                console.log(newFieldValue);
                                // Cap the length to the format field's length by using
                                // all characters in the field except the first one
                                newFieldValue = currentValue.substring(currentFieldRange.start + 1, currentFieldRange.start + arrMatch[0].length) + newFieldValue;
                                console.log(newFieldValue, currentValue);
                                
                                console.log(currentFieldRange.start + 1, currentFieldRange.start + arrMatch[0].length);
                                
                                // Build the value using the current field range and the new field value we built above
                                element.value = 
                                    currentValue.substring(0, currentFieldRange.start) +
                                    newFieldValue +
                                    currentValue.substring(currentFieldRange.end);
                                
                                
                                console.log(currentValue.substring(0, currentFieldRange.start), newFieldValue, currentValue.substring(currentFieldRange.end));
                            
                                // This is copied from above
                                currentFieldRange = {
                                    start: currentSelectionRange.start
                                };
                                while (currentFieldRange.start >= 0 && formatDivider.indexOf(currentValue[currentFieldRange.start - 1]) < 0) {
                                    currentFieldRange.start -= 1;
                                }
                                currentFieldRange.end = currentFieldRange.start;
                                while ( currentFieldRange.end < currentValue.length &&
                                        formatDivider.indexOf(currentValue[currentFieldRange.end]) < 0) {
                                    currentFieldRange.end += 1;
                                }
                                
                                //                                                                          This indexOf does not need to be checked for -1
                                //                                                                          Because we know for a fact that the match is in
                                //                                                                          the string we are searching
                                newCursorPos = Math.min(currentFieldRange.start + arrMatch[0].length, strDateFormat.indexOf(arrMatch[0]) + arrMatch[0].length);
                                newCursorPos = Math.max(newCursorPos, currentFieldRange.end);
                                //console.log(arrMatch[0].length, strDateFormat.indexOf(arrMatch[0]), newCursorPos, arrMatch[0]);
                                GS.setInputSelection(element.control, newCursorPos, newCursorPos);
                            }
                            
                        }
                        
                        //// All visible keys
                        //} else if ( event.keyCode >= 48 && event.keyCode <= 90 ||
                        //            event.keyCode >= 96 && event.keyCode <= 109 ||
                        //            event.keyCode >= 186 && event.keyCode <= 222 ||
                        //            event.keyCode === 32) {
                        //    //console.log('test');
                        //    
                        //    //GS.triggerEvent(element, 'change');
                        //    
                        //    if ((currentSelectionRange.end - currentSelectionRange.start) > 0) {
                        //        element.control.addEventListener('keyup', function ______self() {
                        //            GS.setInputSelection(this, currentSelectionRange.start + 1, currentSelectionRange.start) + 1;
                        //            this.removeEventListener('keyup', ______self);
                        //        });
                        //    }
                        //}
                        
                        //console.log(event.keyCode);
                        
                        syncView(element);
                    }
                }
            },
            keyup: function () {
                var element = this;
                if (!element.hasAttribute('suspend-created') && !element.hasAttribute('suspend-inserted')) {
                    syncView(element);
                }
            },
            click: function () {
                var element = this, currentSelectionRange = GS.getInputSelection(element.control),
                    daysOfTheWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
                    monthsOfTheYear = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                    arrMatch, strDateFormat, formatDivider, currentValue, currentDate;
                //console.log(currentSelectionRange.start, currentSelectionRange.end);
                
                ////// Copied from above until otherwise noted
                
                // Fix date format
                strDateFormat = element.getAttribute('format');
                //console.log(strDateFormat);
                if (!strDateFormat) {
                    strDateFormat = 'MM/dd/yyyy';
                } else if (strDateFormat.toLowerCase() === 'shortdate') {
                    strDateFormat = 'M/d/yy';
                } else if (strDateFormat.toLowerCase() === 'mediumdate') {
                    strDateFormat = 'MMM d, yyyy';
                } else if (strDateFormat.toLowerCase() === 'longdate') {
                    strDateFormat = 'MMMM d, yyyy';
                } else if (strDateFormat.toLowerCase() === 'fulldate') {
                    strDateFormat = 'EEEE, MMMM d, yyyy';
                } else if (strDateFormat.toLowerCase() === 'shorttime') {
                    strDateFormat = 'h:mm a';
                } else if (strDateFormat.toLowerCase() === 'mediumtime') {
                    strDateFormat = 'h:mm:ss a';
                } else if (strDateFormat.toLowerCase() === 'isodate') {
                    strDateFormat = 'yyyy-MM-dd';
                } else if (strDateFormat.toLowerCase() === 'isotime') {
                    strDateFormat = 'HH:mm:ss';
                } else if (strDateFormat.toLowerCase() === 'isodatetime') {
                    strDateFormat = 'yyyy-MM-dd\'T\'HH:mm:ss';
                }
                
                formatDivider = strDateFormat.match(/[^mdyehmsa]/gi).join('');
                
                currentValue = element.control.value;
                currentDate = new Date(currentValue.replace('\'T\'', ' ').replace(/-/g, '/'));
                
                if (strDateFormat.indexOf('M') === -1) {
                    currentDate = new Date('2015/6/15 ' + currentValue);
                }
                
                arrMatch = strDateFormat.match(/(M|E)+/g);
                if (arrMatch && arrMatch[0].length > 3) {
                    strDateFormat = strDateFormat.replace(/E+/g, new Array(daysOfTheWeek[currentDate.getDay()].length + 1).join('E'));
                    strDateFormat = strDateFormat.replace(/M+/g, new Array(monthsOfTheYear[currentDate.getDay()].length + 1).join('M'));
                }
                
                while (currentSelectionRange.start >= 0 && formatDivider.indexOf(currentValue[currentSelectionRange.start - 1]) < 0) {
                    currentSelectionRange.start -= 1;
                }
                currentSelectionRange.end = currentSelectionRange.start;
                while ( currentSelectionRange.end < currentValue.length &&
                        formatDivider.indexOf(currentValue[currentSelectionRange.end]) < 0) {
                    currentSelectionRange.end += 1;
                }
                //console.log(currentSelectionRange.start, currentSelectionRange.end);
                
                ////// Not copied
                element.ignoreSelect = true;
                GS.setInputSelection(element.control, currentSelectionRange.start, currentSelectionRange.end);
                
                //console.log('CLICK EVENT FIRED');
            },
            focus: function () {
                GS.triggerEvent(this, 'click');
            },
            select: function () {
                //if (!this.ignoreSelect) {
                //    GS.triggerEvent(this, 'click');
                //    this.ignoreSelect = false;
                //}
                //console.log('SELECT EVENT FIRED', GS.getInputSelection(this.control));
                
                // Copied from click handler until otherwise noted
                var element = this, currentSelectionRange = GS.getInputSelection(element.control),
                    daysOfTheWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
                    monthsOfTheYear = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                    arrMatch, strDateFormat, formatDivider, currentValue, currentDate;
                //console.log(currentSelectionRange.start, currentSelectionRange.end);
                
                ////// Copied from above until otherwise noted
                
                // Fix date format
                strDateFormat = element.getAttribute('format');
                //console.log(strDateFormat);
                if (!strDateFormat) {
                    strDateFormat = 'MM/dd/yyyy';
                } else if (strDateFormat.toLowerCase() === 'shortdate') {
                    strDateFormat = 'M/d/yy';
                } else if (strDateFormat.toLowerCase() === 'mediumdate') {
                    strDateFormat = 'MMM d, yyyy';
                } else if (strDateFormat.toLowerCase() === 'longdate') {
                    strDateFormat = 'MMMM d, yyyy';
                } else if (strDateFormat.toLowerCase() === 'fulldate') {
                    strDateFormat = 'EEEE, MMMM d, yyyy';
                } else if (strDateFormat.toLowerCase() === 'shorttime') {
                    strDateFormat = 'h:mm a';
                } else if (strDateFormat.toLowerCase() === 'mediumtime') {
                    strDateFormat = 'h:mm:ss a';
                } else if (strDateFormat.toLowerCase() === 'isodate') {
                    strDateFormat = 'yyyy-MM-dd';
                } else if (strDateFormat.toLowerCase() === 'isotime') {
                    strDateFormat = 'HH:mm:ss';
                } else if (strDateFormat.toLowerCase() === 'isodatetime') {
                    strDateFormat = 'yyyy-MM-dd\'T\'HH:mm:ss';
                }
                
                formatDivider = strDateFormat.match(/[^mdyehmsa]/gi).join('');
                
                currentValue = element.control.value;
                currentDate = new Date(currentValue.replace('\'T\'', ' ').replace(/-/g, '/'));
                
                if (strDateFormat.indexOf('M') === -1) {
                    currentDate = new Date('2015/6/15 ' + currentValue);
                }
                
                arrMatch = strDateFormat.match(/(M|E)+/g);
                if (arrMatch && arrMatch[0].length > 3) {
                    strDateFormat = strDateFormat.replace(/E+/g, new Array(daysOfTheWeek[currentDate.getDay()].length + 1).join('E'));
                    strDateFormat = strDateFormat.replace(/M+/g, new Array(monthsOfTheYear[currentDate.getDay()].length + 1).join('M'));
                }
                
                // Condition copied only
                if ((currentSelectionRange.start >= 0 && formatDivider.indexOf(currentValue[currentSelectionRange.start - 1]) < 0) ||
                    (currentSelectionRange.end < currentValue.length && formatDivider.indexOf(currentValue[currentSelectionRange.end]) < 0)) {
                    GS.triggerEvent(this, 'click');
                    this.ignoreSelect = false;
                }
            }*/},accessors:{value:{get:function(){if(this.control){if(this.control.value.trim()===''){return'NULL';}else{return this.control.value;}}else if(this.hasAttribute('disabled')){return this.innerHTML;}
return undefined;},set:function(newValue){var tempSelection=this.control?GS.getInputSelection(this.control):null;if(this.control){if(newValue&&typeof newValue==='object'){this.control.value=newValue.toLocaleDateString();}else{this.control.value=newValue||'';}
if(document.activeElement===this.control){GS.setInputSelection(this.control,tempSelection.start,tempSelection.end);}}else if(this.hasAttribute('disabled')){if(newValue&&typeof newValue==='object'){this.innerHTML=formatDate(newValue,getFormatString(this));}else{this.innerHTML=newValue||'';}}else{this.setAttribute('value',newValue);}
if(this.control){handleFormat(this);}
syncView(this);}}},methods:{refresh:function(){var element=this,arrPassThroughAttributes,i,len;element.control=xtag.query(element,'.control')[0];element.datePickerButton=xtag.query(element,'.date-picker-button')[0];if(element.control){element.control.removeEventListener('change',changeFunction);element.control.addEventListener('change',changeFunction);element.control.removeEventListener('focus',focusFunction);element.control.addEventListener('focus',focusFunction);element.control.removeEventListener('blur',blurFunction);element.control.addEventListener('blur',blurFunction);element.control.removeEventListener(evt.mouseout,mouseoutFunction);element.control.addEventListener(evt.mouseout,mouseoutFunction);element.control.removeEventListener(evt.mouseout,mouseoverFunction);element.control.addEventListener(evt.mouseover,mouseoverFunction);}
if(element.datePickerButton){element.datePickerButton.addEventListener('click',buttonClickFunction);}
if(element.control&&element.hasAttribute('value')){element.control.value=element.getAttribute('value');handleFormat(element,undefined,false);}
if(element.control){arrPassThroughAttributes=['placeholder','name','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','spellcheck','readonly'];for(i=0,len=arrPassThroughAttributes.length;i<len;i+=1){if(element.hasAttribute(arrPassThroughAttributes[i])){element.control.setAttribute(arrPassThroughAttributes[i],element.getAttribute(arrPassThroughAttributes[i])||'');}}}},focus:function(){GS.triggerEvent(this,'focus');this.control.focus();}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('Dialog From Template','Dialog From Template','GS.openDialog(\'${1:templateID}\', function () {\n'+'    // after dialog open \n'+'}, function (event, strAnswer) {\n'+'    if (strAnswer === \'${2:Ok}\') {\n'+'        // before dialog close\n'+'        $0\n'+'    }\n'+'});');registerDesignSnippet('GS.openDialog','GS.openDialog','GS.openDialog(\'${1:templateID}\', function () {\n'+'    // after dialog open \n'+'}, function (event, strAnswer) {\n'+'    if (strAnswer === \'${2:Ok}\') {\n'+'        // beforedialog close\n'+'        $0\n'+'    }\n'+'});');registerDesignSnippet('GS.closeDialog','GS.closeDialog','GS.closeDialog(${1:dialog}, ${2:\'Ok\'});');registerDesignSnippet('Close Dialog','Close Dialog','GS.closeDialog(${1:dialog}, ${2:\'Ok\'});');registerDesignSnippet('GS.msgbox','GS.msgbox','GS.msgbox(${1:\'Are you sure...\'}, ${2:\'Are you sure you want to do this?\'}, '+'${3:[\'Cancel\', \'Ok\']}, function (strAnswer) {\n'+'    if (strAnswer === ${4:\'Ok\'}) {\n'+'        // before dialog close\n'+'        $0\n'+'    }\n'+'});');registerDesignSnippet('Message Box','Message Box','GS.msgbox(${1:\'Are you sure...\'}, ${2:\'Are you sure you want to do this?\'}, '+'${3:[\'Cancel\', \'Ok\']}, function (strAnswer) {\n'+'    if (strAnswer === ${4:\'Ok\'}) {\n'+'        // before dialog close\n'+'        $0\n'+'    }\n'+'});');registerDesignSnippet('GS.inputbox','GS.inputbox','GS.inputbox(${1:\'Are you sure...\'}, ${2:\'Are you sure you want to do this?\'}, '+'function (strInputValue) {\n'+'    // before dialog close\n'+'    $0\n'+'});');registerDesignSnippet('Input Box','Input Box','GS.inputbox(${1:\'Are you sure...\'}, ${2:\'Are you sure you want to do this?\'}, '+'function (strInputValue) {\n'+'    // before dialog close\n'+'    $0\n'+'});');registerDesignSnippet('GS.openDialogToElement','GS.openDialogToElement','GS.openDialogToElement(${1:document.getElementById(\'target\')}, \'${2:templateID}\', '+'\'${3:right}\', function () {\n'+'    // after dialog open \n'+'}, function (event, strAnswer) {\n'+'    if (strAnswer === \'${4:Ok}\') {\n'+'        // beforedialog close\n'+'        $0\n'+'    }\n'+'});');registerDesignSnippet('Dialog For Element','Dialog For Element','GS.openDialogToElement(${1:document.getElementById(\'target\')}, \'${2:templateID}\', '+'\'${3:right}\', function () {\n'+'    // after dialog open \n'+'}, function (event, strAnswer) {\n'+'    if (strAnswer === \'${4:Ok}\') {\n'+'        // beforedialog close\n'+'        $0\n'+'    }\n'+'});');});(function(){'use strict';function buttonHTML(buttons){var strHTML,i,len;buttons=buttons||['Ok'];if(typeof buttons==='string'){if(buttons==='okcancel'||buttons==='cancelok'){buttons=['Cancel','Ok'];}else if(buttons==='ok'||buttons==='okonly'){buttons=['Ok'];}else if(buttons==='cancel'||buttons==='cancelonly'){buttons=['Cancel'];}else if(buttons==='yesno'||buttons==='noyes'){buttons=['No','Yes'];}else if(buttons==='Yes'||buttons==='yesonly'){buttons=['Yes'];}else if(buttons==='No'||buttons==='noonly'){buttons=['No'];}}
if(typeof buttons==='object'){if(buttons.length>0){strHTML='<gs-grid gs-dynamic>';for(i=0,len=buttons.length;i<len;i+=1){strHTML+='<gs-block gs-dynamic>'+'<gs-button dialogclose '+(i===len-1?'bg-primary listen-for-return':'')+' gs-dynamic>'+
encodeHTML(buttons[i])+'</gs-button>'+'</gs-block>';}
strHTML+='</gs-grid>';}else{strHTML='<gs-button dialogclose>Done</gs-button>';}}else{strHTML=buttons;}
return strHTML;}
GS.msgbox=function(strTitle,strMessage,buttons,callback){var templateElement=document.createElement('template');templateElement.innerHTML='<gs-page>'+'    <gs-header><center><h3>'+strTitle+'</h3></center></gs-header>'+'    <gs-body padded>'+'        '+strMessage+'    </gs-body>'+'    <gs-footer>'+buttonHTML(buttons)+'</gs-footer>'+'</gs-page>';GS.openDialog(templateElement,'',function(event,strAnswer){if(typeof callback==='function'){callback(strAnswer);}});};GS.inputbox=function(strTitle,strMessage,callback){var templateElement=document.createElement('template');templateElement.innerHTML='<gs-page>'+'    <gs-header><center><h3>'+strTitle+'</h3></center></gs-header>'+'    <gs-body padded>'+'        '+strMessage+'        <gs-text id="dialog-inputbox-control"></gs-text>'+'    </gs-body>'+'    <gs-footer>'+buttonHTML(['Cancel','Ok'])+'</gs-footer>'+'</gs-page>';GS.openDialog(templateElement,'',function(event,strAnswer){if(strAnswer==='Ok'){callback(document.getElementById('dialog-inputbox-control').value);}else{callback('');}});};})();GS.dialogClose=function(dialog,strAnswer){'use strict';console.warn('Please use "GS.closeDialog" instead of "GS.dialogClose".');dialog.destroy(strAnswer);};GS.closeDialog=function(dialog,strAnswer){'use strict';if(typeof dialog==='string'){dialog=document.getElementById('dialog-from-'+dialog);}
if(dialog){dialog.destroy(strAnswer);}else{console.warn('GS.closeDialog Warning: Dialog not found.');}};(function(){'use strict';document.addEventListener('focus',function(event){var arrDialog=xtag.queryChildren(document.body,'gs-dialog[focus-lock]');var frontDialog;var parentFind;var arrElements;var i;var len;if(arrDialog.length>0){frontDialog=arrDialog[arrDialog.length-1];parentFind=GS.findParentElement(document.activeElement,frontDialog);if(parentFind!==frontDialog){arrElements=xtag.query(frontDialog,'input, textarea, select, button, iframe, [tabindex], a');for(i=0,len=arrElements.length;i<len;i+=1){if(GS.isElementFocusable(arrElements[i])){arrElements[i].focus();break;}}}}},true);GS.dialog=function(options){var strHTML,dialogOverlay,dialog,strContent='',strButtons='',i,len,gridEach,arrElements,tapHandler,strHeader,sizingFunction,observer,returnTarget;if(typeof options.buttons==='string'){if(options.buttons==='okcancel'||options.buttons==='cancelok'){options.buttons=['Cancel','Ok'];}else if(options.buttons==='ok'||options.buttons==='okonly'){options.buttons=['Ok'];}else if(options.buttons==='cancel'||options.buttons==='cancelonly'){options.buttons=['Cancel'];}else if(options.buttons==='yesno'||options.buttons==='noyes'){options.buttons=['No','Yes'];}else if(options.buttons==='Yes'||options.buttons==='yesonly'){options.buttons=['Yes'];}else if(options.buttons==='No'||options.buttons==='noonly'){options.buttons=['No'];}}
options.theme=options.theme||'regular';options.type=options.type||'html';options.header=options.header||'';options.content=options.content||'';options.buttons=options.buttons||['Ok'];options.max_width=options.max_width||'700px';options.max_height=options.max_height||'700px';options.mode=options.mode||'detect';options.padded=options.padded||false;options.autofocus=(options.autofocus===undefined?true:false);if(options.type==='html'){strContent=options.content;strHeader=options.header;}else if(options.type==='formatted-html'){strContent='<pre gs-dynamic>'+options.content+'</pre>';strHeader='<pre gs-dynamic>'+options.header+'</pre>';}else if(options.type==='text'){strContent=encodeHTML(options.content);strHeader=encodeHTML(options.header);}else if(options.type==='formatted-text'){strContent='<pre gs-dynamic>'+encodeHTML(options.content)+'</pre>';strHeader='<pre gs-dynamic>'+encodeHTML(options.header)+'</pre>';}else{console.warn('Dialog type not recognized... Defaulting to \'html\'.');strContent=options.content;strHeader=options.header;}
if(typeof options.buttons==='object'){if(options.buttons.length>0){strButtons='<gs-grid gs-dynamic>';for(i=0,len=options.buttons.length;i<len;i+=1){strButtons+='<gs-block gs-dynamic>'+'<gs-button dialogclose '+(i===len-1?'bg-primary listen-for-return':'')+' gs-dynamic>'+
encodeHTML(options.buttons[i])+'</gs-button>'+'</gs-block>';}
strButtons+='</gs-grid>';}else{strButtons='';}}else{strButtons=options.buttons;}
dialogOverlay=GS.stringToElement('<gs-dialog-overlay gs-dynamic></gs-dialog-overlay>');document.body.appendChild(dialogOverlay);dialogOverlay.addEventListener(evt.mousedown,function(event){event.preventDefault();});dialogOverlay.addEventListener(evt.mousemove,function(event){event.preventDefault();});strHTML='<gs-dialog class="'+encodeHTML(options.theme)+'" gs-dynamic focus-lock ';if((options.mode==='touch'&&!evt.touchDevice)||(options.mode==='phone'&&evt.deviceType!=='phone')){options.mode='detect';}
if((options.mode==='touch'&&evt.touchDevice)||(options.mode==='phone'&&evt.deviceType==='phone')||options.mode==='full'){strHTML+='style="width: 100%; height: 100%; top: 0;">';}else if(options.mode==='constrained'){strHTML+='style="max-width: '+options.max_width+'; max-height: '+options.max_height+'; width: 94%; height: 90%;">';}else{strHTML+='style="max-width: '+options.max_width+'; width: 94%;">';}
strHTML+='<gs-page gs-dynamic>'+
(options.header?'<gs-header gs-dynamic>'+strHeader+'</gs-header>':'')+'<gs-body'+(options.padded?' padded':'')+' gs-dynamic>'+strContent+'</gs-body>'+
(strButtons?'<gs-footer gs-dynamic>'+strButtons+'</gs-footer>':'')+'</gs-page>'+'</gs-dialog>';dialog=GS.stringToElement(strHTML);document.body.appendChild(dialog);document.body.parentNode.classList.add('no-scroll-except-for-dialog');dialog.addEventListener('beforeclose',function(event){if(typeof options.before_close==='function'){options.before_close.apply(dialog,[event.originalEvent,event.data]);}});dialog.addEventListener('afterclose',function(event){if(typeof options.after_close==='function'){options.after_close.apply(dialog,[event.originalEvent,event.data]);}});if(!template.hasAttribute('no-focus-lock')){arrElements=xtag.query(dialog,'[autofocus]');if(arrElements.length>0){arrElements[0].focus();}else{arrElements=xtag.query(dialog,'[listen-for-return]');if(arrElements.length>0){arrElements[0].focus();}}}
arrElements=xtag.query(dialog,'[listen-for-return]');if(arrElements.length>0){returnTarget=arrElements[0];dialog.addEventListener('keydown',function(event){if(event.target!==returnTarget&&(event.keyCode===13||event.which===13)){GS.triggerEvent(returnTarget,'click');}});if(arrElements.length>1){console.warn('dialog Warning: Too many [listen-for-return] elements, defaulting to the first one. Please have only one [listen-for-return] element per dialog.');}}
if(options.mode==='detect'){sizingFunction=function(){if(dialog.parentNode!==document.body){window.removeEventListener('resize',sizingFunction);window.removeEventListener('orientationchange',sizingFunction);observer.disconnect();return;}
if(dialog.offsetHeight>((window.innerHeight/100)*98)){dialog.style.height='98%';dialog.style.maxHeight=options.max_height;}};sizingFunction();window.addEventListener('resize',sizingFunction);window.addEventListener('orientationchange',sizingFunction);observer=new MutationObserver(sizingFunction);observer.observe(dialog,{childList:true,subtree:true,attributes:true});}
if(typeof options.after_open==='function'){options.after_open.apply(dialog,[]);}
return dialog;};GS.openDialog=function(templateLink,afterOpenFunction,beforeCloseFunction,afterCloseFunction){var template,templateID,strHTML,dialogOverlay,dialog,i,len,arrCloseButtons,clickHandler,sizingFunction,observer,arrElements,strTag,returnTarget,strTheme,strMaxWidth,strMaxHeight,strMode,refocusElement,scrollTarget,jsnInitalMousePos,scrollProtectorTouchStart,scrollProtectorTouchMove,scrollProtectorMouseWheel,strTag,xtagSelector,intervalID,intervalI;if(typeof templateLink==='string'){template=document.getElementById(templateLink);}else{template=templateLink;}
refocusElement=document.activeElement;if(!template.hasAttribute('no-focus-lock')){refocusElement.blur();}
templateID=template.getAttribute('id');if(templateID&&document.getElementById('dialog-from-'+templateID)){console.warn('GS.openDialog Warning: A dialog using the ID "'+templateID+'" is already open.');}
arrElements=xtag.query(template.content,'[autofocus]');if(arrElements.length===0){arrElements=xtag.query(template.content,'*');if(arrElements.length>0){for(i=0,len=arrElements.length;i<len;i+=1){strTag=arrElements[i].nodeName.toLowerCase();if(GS.isElementFocusable(arrElements[i])||(xtag.tags[strTag]&&xtag.tags[strTag].methods&&xtag.tags[strTag].methods.focus)){arrElements[i].setAttribute('autofocus','');break;}}}}else if(arrElements.length>1){for(i=1,len=arrElements.length;i<len;i+=1){arrElements[i].removeAttribute('autofocus');}
console.warn('dialog Warning: Too many [autofocus] elements, defaulting to the first one. Please have only one [autofocus] element per dialog.');}
strTheme=(template.getAttribute('data-theme')==='error'?'error':'regular');strMaxWidth=template.getAttribute('data-max-width')||'700px';strMaxHeight=template.getAttribute('data-max-height')||'700px';strMode=template.getAttribute('data-mode')||'detect';strHTML='<gs-dialog '+(templateID?'id="dialog-from-'+templateID+'" ':'')+'class="'+strTheme+'" gs-dynamic ';if(!template.hasAttribute('no-focus-lock')){strHTML+='focus-lock ';}
if((strMode==='touch'&&!evt.touchDevice)||(strMode==='phone'&&evt.deviceType!=='phone')){strMode='detect';}
if((strMode==='touch'&&evt.touchDevice)||(strMode==='phone'&&evt.deviceType==='phone')||strMode==='full'){strHTML+='style="width: 100%; height: 100%; top: 0;">';}else if(strMode==='constrained'){strHTML+='style="max-width: '+strMaxWidth+'; max-height: '+strMaxHeight+'; width: 94%; height: 90%;">';}else{strHTML+='style="max-width: '+strMaxWidth+'; width: 94%;">';}
strHTML+='<gs-page gs-dynamic>'+
template.innerHTML+'</gs-page>'+'</gs-dialog>';dialogOverlay=GS.stringToElement('<gs-dialog-overlay gs-dynamic'+
(template.hasAttribute('no-background')?' no-background ':'')+'></gs-dialog-overlay>');dialog=GS.stringToElement(strHTML);document.body.appendChild(dialogOverlay);if(template.hasAttribute('data-overlay-close')){dialogOverlay.addEventListener(evt.mousedown,function(event){GS.closeDialog(dialog,'overlay');});}
dialogOverlay.addEventListener(evt.mousedown,function(event){event.preventDefault();});dialogOverlay.addEventListener(evt.mousemove,function(event){event.preventDefault();});dialogOverlay.addEventListener('mousewheel',function(event){event.preventDefault();});document.body.appendChild(dialog);scrollProtectorTouchStart=function(event){if(dialog.parentNode!==document.body){dialog.removeEventListener('touchstart',scrollProtectorTouchStart);return true;}
scrollTarget=GS.scrollParent(event.target);if(!scrollTarget||!GS.findParentTag(scrollTarget,'gs-dialog')){scrollTarget=dialog;}
jsnInitalMousePos=GS.mousePosition(event);};scrollProtectorTouchMove=function(event){var jsnMousePos=GS.mousePosition(event),bolVertical,bolHorizontal;if(dialog.parentNode!==document.body){dialog.removeEventListener('touchmove',scrollProtectorTouchMove);return true;}
if(Math.abs(jsnInitalMousePos.top-jsnMousePos.top)>Math.abs(jsnInitalMousePos.left-jsnMousePos.left)){bolVertical=true;}else{bolHorizontal=true;}
if((bolVertical&&((jsnInitalMousePos.top<jsnMousePos.top&&scrollTarget.scrollTop<=0)||(jsnInitalMousePos.top>jsnMousePos.top&&(scrollTarget.scrollTop+scrollTarget.clientHeight)>=scrollTarget.scrollHeight)))||(bolHorizontal&&((jsnInitalMousePos.left<jsnMousePos.left&&scrollTarget.scrollLeft<=0)||(jsnInitalMousePos.left>jsnMousePos.left&&(scrollTarget.scrollLeft+scrollTarget.clientWidth)>=scrollTarget.scrollWidth)))){event.preventDefault();event.stopPropagation();}};scrollProtectorMouseWheel=function(event){var target=GS.scrollParent(event.target);if(dialog.parentNode!==document.body){dialog.removeEventListener('mousewheel',scrollProtectorMouseWheel);return true;}
if((event.deltaY<0&&target.scrollTop<=0)||(event.deltaY>0&&(target.scrollTop+target.clientHeight)>=target.scrollHeight)||(event.deltaX<0&&target.scrollLeft<=0)||(event.deltaX>0&&(target.scrollLeft+target.clientWidth)>=target.scrollWidth)){event.preventDefault();event.stopPropagation();}};if(evt.touchDevice){window.addEventListener('touchstart',scrollProtectorTouchStart);window.addEventListener('touchmove',scrollProtectorTouchMove);}
dialog.addEventListener('mousewheel',scrollProtectorMouseWheel);dialog.addEventListener('beforeclose',function(event){if(typeof beforeCloseFunction==='function'){beforeCloseFunction.apply(dialog,[event.originalEvent,event.data]);}});dialog.addEventListener('afterclose',function(event){refocusElement.focus();if(typeof afterCloseFunction==='function'){afterCloseFunction.apply(dialog,[event.originalEvent,event.data]);}});if(strMode==='detect'){sizingFunction=function(){if(dialog.parentNode!==document.body){window.removeEventListener('resize',sizingFunction);window.removeEventListener('orientationchange',sizingFunction);observer.disconnect();return;}
if(dialog.offsetHeight>((window.innerHeight/100)*98)){dialog.style.height='98%';dialog.style.maxHeight=strMaxHeight;}};sizingFunction();window.addEventListener('resize',sizingFunction);window.addEventListener('orientationchange',sizingFunction);observer=new MutationObserver(sizingFunction);observer.observe(dialog,{childList:true,subtree:true,attributes:true});}
var elementReadyCallback=function(){if(!template.hasAttribute('no-focus-lock')){arrElements=xtag.query(dialog,'[autofocus]');if(arrElements.length>0){arrElements[0].focus();}else{arrElements=xtag.query(dialog,'[listen-for-return]');if(arrElements.length>0){arrElements[0].focus();}}}
arrElements=xtag.query(dialog,'[listen-for-return]');if(arrElements.length>0){returnTarget=arrElements[0];dialog.addEventListener('keydown',function(event){if(event.target!==returnTarget&&(event.keyCode===13||event.which===13)){GS.triggerEvent(returnTarget,'click');}});if(arrElements.length>1){console.warn('dialog Warning: Too many [listen-for-return] elements, defaulting to the first one. Please have only one [listen-for-return] element per dialog.');}}
if(typeof afterOpenFunction==='function'){afterOpenFunction.apply(dialog,[]);}};if(shimmed.registerElement===true){xtagSelector='';for(strTag in xtag.tags){xtagSelector+=(xtagSelector?',':'');xtagSelector+=strTag;}
var elem_wait=xtag.query(dialog,xtagSelector);var elem_i;var elem_len;intervalI=0;intervalID=setInterval(function(){if(elem_wait.length===0||intervalI>=30){clearInterval(intervalID);elementReadyCallback();}else{elem_i=0;elem_len=elem_wait.length;while(elem_i<elem_len){if(elem_wait[elem_i].__upgraded__===true){elem_wait.splice(elem_i,1);elem_i-=1;elem_len-=1;}
elem_i+=1;}}
intervalI+=1;},30);}else{elementReadyCallback();}
return dialog;};GS.openDialogToElement=function(elementTarget,templateLink,strDirectionRequest,afterOpenFunction,beforeCloseFunction,afterCloseFunction){'use strict';var positionHandlingFunction,jsnPositionData,divElement=document.createElement('div'),dialogElement,observer,intDialogResolvedWidth,intDialogResolvedHeight,strResolvedDirection,intMargin=5,intElementMidPoint,intDialogMidPoint,i,len,arrTests,arrCloseButtons,clickHandler,arrElements,template,strTheme,strMaxWidth,strMaxHeight,strTag,dialogOverlay,refocusElement,jsnInitalMousePos,scrollTarget,returnTarget,scrollProtectorTouchStart,scrollProtectorTouchMove,scrollProtectorMouseWheel,templateID,strTag,xtagSelector,intervalID,intervalI;if(typeof templateLink==='string'){template=document.getElementById(templateLink);}else{template=templateLink;}
refocusElement=document.activeElement;if(!template.hasAttribute('no-focus-lock')){refocusElement.blur();}
templateID=template.getAttribute('id');if(templateID&&document.getElementById('dialog-from-'+templateID)){console.warn('GS.openDialog Warning: A dialog using the ID "'+templateID+'" is already open.');}
arrElements=xtag.query(template.content,'[autofocus]');if(arrElements.length===0){arrElements=xtag.query(template.content,'*');if(arrElements.length>0){for(i=0,len=arrElements.length;i<len;i+=1){strTag=arrElements[i].nodeName.toLowerCase();if(GS.isElementFocusable(arrElements[i])||(xtag.tags[strTag]&&xtag.tags[strTag].methods&&xtag.tags[strTag].methods.focus)){arrElements[i].setAttribute('autofocus','');break;}}}}else if(arrElements.length>1){for(i=1,len=arrElements.length;i<len;i+=1){arrElements[i].removeAttribute('autofocus');}
console.warn('dialog Warning: Too many [autofocus] elements, defaulting to the first one. Please have only one [autofocus] element per dialog.');}
strTheme=(template.getAttribute('data-theme')==='error'?'error':'regular');strMaxWidth=template.getAttribute('data-max-width')||'700px';strMaxHeight=template.getAttribute('data-max-height')||'700px';divElement.innerHTML='<gs-dialog '+
(templateID?'id="dialog-from-'+templateID+'" ':'')+'class="'+strTheme+'" '+'style="width: 94%; max-width: '+strMaxWidth+';" '+'no-window-listen '+
(template.hasAttribute('no-focus-lock')?'':'focus-lock ')+'gs-dynamic>'+'<gs-page gs-dynamic>'+
template.innerHTML+'</gs-page>'+'</gs-dialog>';dialogElement=divElement.children[0];dialogOverlay=GS.stringToElement('<gs-dialog-overlay gs-dynamic'+
(template.hasAttribute('no-background')?' no-background ':'')+'></gs-dialog-overlay>');document.body.appendChild(dialogOverlay);if(template.hasAttribute('data-overlay-close')){dialogOverlay.addEventListener('click',function(event){GS.closeDialog(dialogElement,'overlay');});}
dialogOverlay.addEventListener('mousewheel',function(event){event.preventDefault();});document.body.appendChild(dialogElement);scrollProtectorTouchStart=function(event){if(dialogElement.parentNode!==document.body){dialogElement.removeEventListener('touchstart',scrollProtectorTouchStart);return true;}
scrollTarget=GS.scrollParent(event.target);if(!scrollTarget||!GS.findParentTag(scrollTarget,'gs-dialog')){scrollTarget=dialogElement;}
jsnInitalMousePos=GS.mousePosition(event);};scrollProtectorTouchMove=function(event){var jsnMousePos=GS.mousePosition(event),bolVertical,bolHorizontal;if(dialogElement.parentNode!==document.body){dialogElement.removeEventListener('touchmove',scrollProtectorTouchMove);return true;}
if(Math.abs(jsnInitalMousePos.top-jsnMousePos.top)>Math.abs(jsnInitalMousePos.left-jsnMousePos.left)){bolVertical=true;}else{bolHorizontal=true;}
if((bolVertical&&((jsnInitalMousePos.top<jsnMousePos.top&&scrollTarget.scrollTop<=0)||(jsnInitalMousePos.top>jsnMousePos.top&&(scrollTarget.scrollTop+scrollTarget.clientHeight)>=scrollTarget.scrollHeight)))||(bolHorizontal&&((jsnInitalMousePos.left<jsnMousePos.left&&scrollTarget.scrollLeft<=0)||(jsnInitalMousePos.left>jsnMousePos.left&&(scrollTarget.scrollLeft+scrollTarget.clientWidth)>=scrollTarget.scrollWidth)))){event.preventDefault();event.stopPropagation();}};scrollProtectorMouseWheel=function(event){var target=GS.scrollParent(event.target);if(dialogElement.parentNode!==document.body){dialogElement.removeEventListener('mousewheel',scrollProtectorMouseWheel);return true;}
if((event.deltaY<0&&target.scrollTop<=0)||(event.deltaY>0&&(target.scrollTop+target.clientHeight)>=target.scrollHeight)||(event.deltaX<0&&target.scrollLeft<=0)||(event.deltaX>0&&(target.scrollLeft+target.clientWidth)>=target.scrollWidth)){event.preventDefault();event.stopPropagation();}};if(evt.touchDevice){window.addEventListener('touchstart',scrollProtectorTouchStart);window.addEventListener('touchmove',scrollProtectorTouchMove);}
dialogElement.addEventListener('mousewheel',scrollProtectorMouseWheel);dialogElement.addEventListener('beforeclose',function(event){if(typeof beforeCloseFunction==='function'){beforeCloseFunction.apply(dialogElement,[event.originalEvent,event.data]);}});dialogElement.addEventListener('afterclose',function(event){refocusElement.focus();if(typeof afterCloseFunction==='function'){afterCloseFunction.apply(dialogElement,[event.originalEvent,event.data]);}});if(!template.hasAttribute('no-focus-lock')){arrElements=xtag.query(dialogElement,'[autofocus]');if(arrElements.length>0){arrElements[0].focus();}else{arrElements=xtag.query(dialogElement,'[listen-for-return]');if(arrElements.length>0){arrElements[0].focus();}}}
arrElements=xtag.query(dialogElement,'[listen-for-return]');if(arrElements.length>0){returnTarget=arrElements[0];dialogElement.addEventListener('keydown',function(event){if(event.target!==returnTarget&&(event.keyCode===13||event.which===13)){GS.triggerEvent(returnTarget,'click');}});if(arrElements.length>1){console.warn('dialog Warning: Too many [listen-for-return] elements, defaulting to the first one. Please have only one [listen-for-return] element per dialog.');}}
strDirectionRequest=strDirectionRequest||'down';strDirectionRequest.toLowerCase();if(!strDirectionRequest.match(/^up$|^down$|^left$|^right$|^full$/)){console.warn('GS.openDialogToElement Error: '+'Direction \''+strDirectionRequest+'\' not recognized. '+'Please use \'up\', \'down\', \'left\', \'right\' or \'full\'.');strDirectionRequest='down';}
positionHandlingFunction=function(){var intDialogTop='',intDialogLeft='',intDialogMarginTop='',intDialogMarginLeft='',strOldStyle,arrElements,arrScrollingElements,i,len,strOverflow;if(dialogElement.parentNode!==document.body){window.removeEventListener('resize',positionHandlingFunction);window.removeEventListener('orientationchange',positionHandlingFunction);observer.disconnect();return;}
strOldStyle=dialogElement.getAttribute('style');arrElements=xtag.query(dialogElement,'*');arrScrollingElements=[];for(i=0,len=arrElements.length;i<len;i+=1){strOverflow=GS.getStyle(arrElements[i],'overflow');if(strOverflow==='scroll'||(strOverflow==='auto'&&arrElements[i].clientHeight<arrElements[i].scrollHeight)){arrScrollingElements.push(arrElements[i]);}}
for(i=0,len=arrScrollingElements.length;i<len;i+=1){arrScrollingElements[i].oldScrollTop=arrScrollingElements[i].scrollTop;arrScrollingElements[i].oldScrollLeft=arrScrollingElements[i].scrollLeft;}
dialogElement.style.top='';dialogElement.style.left='';dialogElement.style.marginTop='';dialogElement.style.marginLeft='';dialogElement.style.width='94%';dialogElement.style.height='';dialogElement.style.maxHeight='';if(dialogElement.oldHeight===dialogElement.offsetHeight){dialogElement.setAttribute('style',strOldStyle);for(i=0,len=arrScrollingElements.length;i<len;i+=1){arrScrollingElements[i].scrollTop=arrScrollingElements[i].oldScrollTop;arrScrollingElements[i].scrollLeft=arrScrollingElements[i].oldScrollLeft;}}else{dialogElement.oldHeight=dialogElement.offsetHeight;if(dialogElement.clientHeight>((window.innerHeight/100)*94)){dialogElement.style.height='94%';dialogElement.style.maxHeight=strMaxHeight;}
intDialogResolvedWidth=dialogElement.offsetWidth;intDialogResolvedHeight=dialogElement.offsetHeight+1;dialogElement.style.width=intDialogResolvedWidth+'px';dialogElement.style.height=intDialogResolvedHeight+'px';jsnPositionData=GS.getElementPositionData(elementTarget);if(strDirectionRequest==='up'){arrTests=['up','down','left','right'];}else if(strDirectionRequest==='down'){arrTests=['down','up','left','right'];}else if(strDirectionRequest==='left'){arrTests=['left','right','down','up'];}else if(strDirectionRequest==='right'){arrTests=['right','left','down','up'];}else{arrTests=[];}
for(i=0,len=arrTests.length;i<len;i+=1){if((arrTests[i]==='up'&&(intDialogResolvedHeight+intMargin)<=jsnPositionData.intRoomAbove)||(arrTests[i]==='down'&&(intDialogResolvedHeight+intMargin)<=jsnPositionData.intRoomBelow)||(arrTests[i]==='left'&&(intDialogResolvedWidth+intMargin)<=jsnPositionData.intRoomLeft)||(arrTests[i]==='right'&&(intDialogResolvedWidth+intMargin)<=jsnPositionData.intRoomRight)){strResolvedDirection=arrTests[i];break;}}
strResolvedDirection=strResolvedDirection||'full';if(strResolvedDirection==='up'||strResolvedDirection==='down'){intElementMidPoint=(jsnPositionData.intElementLeft+(jsnPositionData.intElementWidth/2));intDialogMidPoint=(intDialogResolvedWidth/2);if(intElementMidPoint-intDialogMidPoint<intMargin){intDialogLeft=intMargin;}else if(intElementMidPoint+intDialogMidPoint>window.innerWidth-intMargin){intDialogLeft=((window.innerWidth-intDialogResolvedWidth)-intMargin);}else{intDialogLeft=(intElementMidPoint-intDialogMidPoint);}}else if(strResolvedDirection==='left'||strResolvedDirection==='right'){intElementMidPoint=(jsnPositionData.intElementTop+(jsnPositionData.intElementHeight/2));intDialogMidPoint=(intDialogResolvedHeight/2);if(intElementMidPoint-intDialogMidPoint<intMargin){intDialogTop=intMargin;}else if(intElementMidPoint+intDialogMidPoint>window.innerHeight-intMargin){intDialogTop=((window.innerHeight-intDialogResolvedHeight)-intMargin);}else{intDialogTop=(intElementMidPoint-intDialogMidPoint);}}else{intDialogTop='50%';intDialogLeft='50%';intDialogMarginTop='-'+(intDialogResolvedHeight/2)+'px';intDialogMarginLeft='-'+(intDialogResolvedWidth/2)+'px';}
if(strResolvedDirection==='up'){intDialogTop=(jsnPositionData.intElementTop-intDialogResolvedHeight);}else if(strResolvedDirection==='down'){intDialogTop=(jsnPositionData.intElementTop+jsnPositionData.intElementHeight);}else if(strResolvedDirection==='left'){intDialogLeft=(jsnPositionData.intElementLeft-intDialogResolvedWidth);}else if(strResolvedDirection==='right'){intDialogLeft=(jsnPositionData.intElementLeft+jsnPositionData.intElementWidth);}
if(intDialogTop+intDialogResolvedHeight>window.innerHeight){intDialogTop-=(intDialogTop+intDialogResolvedHeight)-window.innerHeight;}
if(intDialogLeft+intDialogResolvedWidth>window.innerWidth){intDialogLeft-=(intDialogLeft+intDialogResolvedWidth)-window.innerWidth;}
dialogElement.style.top=intDialogTop+'px';dialogElement.style.left=intDialogLeft+'px';dialogElement.style.marginTop=intDialogMarginTop+'px';dialogElement.style.marginLeft=intDialogMarginLeft+'px';}};positionHandlingFunction();window.addEventListener('resize',positionHandlingFunction);window.addEventListener('orientationchange',positionHandlingFunction);observer=new MutationObserver(positionHandlingFunction);observer.observe(dialogElement.children[0],{childList:true,subtree:true,attributes:true});var elementReadyCallback=function(){if(!template.hasAttribute('no-focus-lock')){arrElements=xtag.query(dialogElement,'[autofocus]');if(arrElements.length>0){arrElements[0].focus();}else{arrElements=xtag.query(dialogElement,'[listen-for-return]');if(arrElements.length>0){arrElements[0].focus();}}}
arrElements=xtag.query(dialogElement,'[listen-for-return]');if(arrElements.length>0){returnTarget=arrElements[0];dialogElement.addEventListener('keydown',function(event){if(event.target!==returnTarget&&(event.keyCode===13||event.which===13)){GS.triggerEvent(returnTarget,'click');}});if(arrElements.length>1){console.warn('dialog Warning: Too many [listen-for-return] elements, defaulting to the first one. Please have only one [listen-for-return] element per dialog.');}}
if(typeof afterOpenFunction==='function'){afterOpenFunction.apply(dialogElement,[]);}};if(shimmed.registerElement===true){xtagSelector='';for(strTag in xtag.tags){xtagSelector+=(xtagSelector?',':'');xtagSelector+=strTag;}
var elem_wait=xtag.query(dialogElement,xtagSelector);var elem_i;var elem_len;intervalI=0;intervalID=setInterval(function(){if(elem_wait.length===0||intervalI>=30){clearInterval(intervalID);elementReadyCallback();}else{elem_i=0;elem_len=elem_wait.length;while(elem_i<elem_len){if(elem_wait[elem_i].__upgraded__===true){elem_wait.splice(elem_i,1);elem_i-=1;elem_len-=1;}
elem_i+=1;}}
intervalI+=1;},30);}else{elementReadyCallback();}
return dialogElement;};})();(function(){'use strict';xtag.register('gs-dialog',{lifecycle:{created:function(){if(this.hasAttribute('focus-lock')){document.body.focus();}},inserted:function(){if(this.inserted!==true){this.inserted=true;if(!this.hasAttribute('no-window-listen')){this.bind();this.windowResizeHandler();}
GS.triggerEvent(this,'dialog-inserted');}},removed:function(){this.unbind();}},events:{'click:delegate([dialogclose])':function(event){var dialogcloseElement=GS.findParentElement(event.target,'[dialogclose]');GS.findParentTag(event.target,'gs-dialog').destroy(dialogcloseElement.textContent,event);}},accessors:{},methods:{bind:function(){var element=this;if(!element.hasAttribute('no-window-listen')){element.windowResizeHandler=function(){element.style.left=(window.innerWidth/2)-(element.offsetWidth/2)+'px';};window.addEventListener('resize',element.windowResizeHandler);window.addEventListener('orientationchange',element.windowResizeHandler);}},unbind:function(){window.removeEventListener('resize',this.windowResizeHandler);window.removeEventListener('orientationchange',this.windowResizeHandler);GS.triggerEvent(window,'resize');},destroy:function(strAnswer,originalEvent){var beforeCloseEvent;if(this.parentNode===document.body){beforeCloseEvent=GS.triggerEvent(this,'beforeclose',{'data':strAnswer,'originalEvent':originalEvent});if(!beforeCloseEvent.defaultPrevented&&(!originalEvent||!originalEvent.defaultPrevented)){document.body.removeChild(this.previousElementSibling);document.body.removeChild(this);GS.triggerEvent(this,'afterclose',{'data':strAnswer,'originalEvent':originalEvent});if(document.getElementsByTagName('gs-dialog').length===0){document.body.parentNode.classList.remove('no-scroll-except-for-dialog');}}}}}});xtag.register('gs-dialog-overlay',{lifecycle:{},events:{},accessors:{},methods:{}});})();window.addEventListener('design-register-element',function(event){'use strict';registerDesignSnippet('<gs-envelope>','<gs-envelope>','gs-envelope src="${1:test.tpeople}">\n'+'    <template for="hud"></template>\n'+'    <template for="table">\n'+'        <table>\n'+'            <tbody>\n'+'                <tr>\n'+'                    <th heading="#"><gs-static column="row_number"></gs-static></th>\n'+'                    <td heading="">$0</td>\n'+'                </tr>\n'+'            </tbody>\n'+'        </table>\n'+'    </template>\n'+'    <template for="insert"></template>\n'+'</gs-envelope>');designRegisterElement('gs-envelope','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-envelope.html');window.designElementProperty_GSENVELOPE=function(selectedElement){var intIdNumber=(Math.floor(Math.random()*1000))+(Math.floor(new Date().getTime()/(Math.random()*100000)));addProp('Source',true,'<gs-memo class="target" autoresize rows="1" value="'+encodeHTML(decodeURIComponent(selectedElement.getAttribute('src')||selectedElement.getAttribute('source')||''))+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'src',encodeURIComponent(this.value));});addProp('Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('cols')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'cols',this.value);});addProp('Where',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('where')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'where',this.value);});addProp('Order By',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('ord')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'ord',this.value);});addProp('Limit',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('limit')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'limit',this.value);});addProp('Offset',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('offset')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'offset',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Parent&nbsp;Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Line Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('child-column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'child-column',this.value);});addProp('Reflow At',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('reflow-at')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'reflow-at',this.value);});addProp('Scroll To Bottom',true,'<gs-checkbox class="target" value="'+encodeHTML(selectedElement.hasAttribute('scroll-to-bottom')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'scroll-to-bottom',(this.value==='true'),true);});addProp('HUD Orderby',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-hudorderby'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-hudorderby',(this.value==='true'),false);});addProp('HUD Limit',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-hudlimit'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-hudlimit',(this.value==='true'),false);});addProp('HUD Refresh',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-hudrefresh'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-hudrefresh',(this.value==='true'),false);});addProp('HUD Delete',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-huddelete'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-huddelete',(this.value==='true'),false);});addProp('Expand&nbsp;To&nbsp;Content',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('expand-to-content'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'expand-to-content',(this.value==='true'),true);});addProp('Primary Keys',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('primary-keys')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'primary-keys',this.value);});addProp('Select Action',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('action-select')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'action-select',this.value);});addProp('Insert Action',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('action-insert')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'action-insert',this.value);});addProp('Update Action',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('action-update')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'action-update',this.value);});addProp('Delete Action',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('action-delete')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'action-delete',this.value);});addProp('Disable Insert',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-insert')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-insert',this.value==='true',true);});addProp('Disable Update',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-update')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-update',this.value==='true',true);});addProp('Record Template',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('template')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'template',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Refresh On Querystring Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('refresh-on-querystring-values')||'')+'" mini></gs-text>',function(){this.removeAttribute('refresh-on-querystring-change');return setOrRemoveTextAttribute(selectedElement,'refresh-on-querystring-values',this.value);});addProp('Refresh On Querystring Change',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('refresh-on-querystring-change'))+'" mini></gs-checkbox>',function(){this.removeAttribute('refresh-on-querystring-values');return setOrRemoveBooleanAttribute(selectedElement,'refresh-on-querystring-change',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function addLoader(element,strText){element.loaderContainer=GS.stringToElement('<div class="loader-container" style="top: '+element.scrollContainerElement.scrollTop+'px;"></div>');element.scrollContainerElement.appendChild(element.loaderContainer);GS.addLoader(element.loaderContainer,strText);}
function removeLoader(element){if(element.loaderContainer&&element.loaderContainer.parentNode===element.scrollContainerElement){element.scrollContainerElement.removeChild(element.loaderContainer);}
GS.removeLoader(element.loaderContainer);}
function selectHandler(element,dragOrigin,dragCurrentCell,dragMode){var bolThead,bolFirstTh,arrRecords,arrCells,arrRecordsToAffect=[],arrCellsToAffect=[],arrNewSelection=[],arrCellsToRemoveFromSelection=[],i,len,intFrom,intTo;arrRecords=xtag.query(element.scrollContainerElement,'tr');arrCells=xtag.query(element.scrollContainerElement,'td, th');if(arrRecords.length>0){bolThead=Boolean(element.theadElement);if((bolThead&&arrRecords.length>1)||(!bolThead&&arrRecords>0)){if(bolThead){bolFirstTh=arrRecords[1].children[0].nodeName==='TH';}else{bolFirstTh=arrRecords[0].children[0].nodeName==='TH';}}
if(bolThead&&bolFirstTh&&dragOrigin.parentNode.rowIndex===0&&dragCurrentCell.parentNode.rowIndex===0&&dragOrigin.cellIndex===0&&dragCurrentCell.cellIndex===0){arrCellsToAffect=arrCells;}else if(bolFirstTh&&dragOrigin.cellIndex===0&&dragCurrentCell.cellIndex===0){arrRecordsToAffect=arrRecords.slice(Math.min(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex),Math.max(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex)+1);for(i=0,len=arrRecordsToAffect.length;i<len;i+=1){Array.prototype.push.apply(arrCellsToAffect,xtag.toArray(arrRecordsToAffect[i].children));}}else if(bolThead&&dragOrigin.parentNode.rowIndex===0&&dragCurrentCell.parentNode.rowIndex===0){intFrom=Math.min(dragOrigin.cellIndex,dragCurrentCell.cellIndex);intTo=Math.max(dragOrigin.cellIndex,dragCurrentCell.cellIndex)+1;for(i=0,len=arrRecords.length;i<len;i+=1){Array.prototype.push.apply(arrCellsToAffect,xtag.toArray(arrRecords[i].children).slice(intFrom,intTo));}}else{arrRecordsToAffect=arrRecords.slice(Math.min(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex),Math.max(dragOrigin.parentNode.rowIndex,dragCurrentCell.parentNode.rowIndex)+1);intFrom=Math.min(dragOrigin.cellIndex,dragCurrentCell.cellIndex);intTo=Math.max(dragOrigin.cellIndex,dragCurrentCell.cellIndex)+1;for(i=0,len=arrRecordsToAffect.length;i<len;i+=1){Array.prototype.push.apply(arrCellsToAffect,xtag.toArray(arrRecordsToAffect[i].children).slice(intFrom,intTo));}}
if(dragOrigin!==dragCurrentCell){element.scrollContainerElement.removeAttribute('allow-text-selection');element.copyFocusTargetElement.focus();GS.setInputSelection(element.copyFocusTargetElement,0,'firefox...'.length);}else{element.scrollContainerElement.setAttribute('allow-text-selection','');}
if(dragMode==='select'){for(i=0,len=element.selectionSelectedCells.length;i<len;i+=1){if(arrCellsToAffect.indexOf(element.selectionSelectedCells[i])===-1){arrCellsToRemoveFromSelection.push(element.selectionSelectedCells[i]);}}
element.selectionSelectedCells=arrCellsToAffect;arrNewSelection=element.selectedCells;for(i=0,len=arrCellsToAffect.length;i<len;i+=1){GS.listAdd(arrNewSelection,arrCellsToAffect[i]);}
for(i=0,len=arrCellsToRemoveFromSelection.length;i<len;i+=1){arrNewSelection.splice(arrNewSelection.indexOf(arrCellsToRemoveFromSelection[i]),1);}
element.selectedCells=arrNewSelection;}else{arrNewSelection=element.selectedCells;for(i=0,len=arrCellsToAffect.length;i<len;i+=1){if(arrNewSelection.indexOf(arrCellsToAffect[i])>-1){arrNewSelection.splice(arrNewSelection.indexOf(arrCellsToAffect[i]),1);}}
element.selectedCells=arrNewSelection;}}}
function getData(element){element.refreshing=true;var strSrc=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('src')||element.getAttribute('source')||'')),srcParts=strSrc[0]==='('?[strSrc,'']:strSrc.split('.'),strSchema=srcParts[0],strObject=srcParts[1],strWhere=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('where')||'')),strOrd=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('ord')||'')),strLimit=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('limit')||'')),strOffset=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('offset')||'')),response_i=0,response_len=0,arrTotalRecords=[],strWhereColumn,i,len;if((element.getAttribute('column')||element.getAttribute('qs'))&&element.value){strWhereColumn=element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs');if(isNaN(element.value)){strWhere='CAST('+strWhereColumn+' AS '+GS.database.type.text+') = '+'CAST($WhereQUOTE$'+(element.value)+'$WhereQUOTE$ AS '+GS.database.type.text+')'+
(strWhere!==''?' AND ('+strWhere+')':'');}else{strWhere=strWhereColumn+'='+(element.value)+(strWhere!==''?' AND ('+strWhere+')':'');}}
if(element.user_order_bys&&element.user_order_bys.columns.length>0){for(i=0,len=element.user_order_bys.columns.length,strOrd='';i<len;i+=1){strOrd+=(strOrd!==''?', ':'')+element.user_order_bys.columns[i]+' '+element.user_order_bys.directions[i].toUpperCase();}}
element.oldScrollTop=element.scrollContainerElement.scrollTop;addLoader(element,'Loading...');GS.requestCachingSelect(GS.envSocket,strSchema,strObject,'*',strWhere,strOrd,strLimit,strOffset,function(data,error){element.refreshing=false;var arrRecords,arrCells,envData,i,len,cell_i,cell_len;if(!error){if(data.strMessage!=='TRANSACTION COMPLETED'){arrRecords=GS.trim(data.strMessage,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}else{removeLoader(element);element.arrColumnNames=data.arrColumnNames;envData={'arr_column':element.arrColumnNames,'dat':arrTotalRecords};handleData(element,envData);}}else{handleData(element,data,error);}},true);}
function handleData(element,data,error){var strHeaderHTML,strFixedHeaderHTML,tableElement,theadElement,tbodyElement,strBodyHTML,tableTemplateElement,arrCells,i,len,bolHeaderTextFound=false,strCurrentHeadingText,bolInitalSuccess;if(!error){bolInitalSuccess=!element.lastSuccessData;element.classList.remove('error');element.lastSuccessData=data;tableTemplateElement=document.createElement('template');tableTemplateElement.innerHTML=element.tableTemplate;tableElement=xtag.query(tableTemplateElement.content,'table')[0];theadElement=xtag.queryChildren(tableElement,'thead')[0];tbodyElement=xtag.queryChildren(tableElement,'tbody')[0];if(element.limitButtonElement){element.limitButtonElement.textContent=data.dat.length+' records';element.limitButtonElement.setAttribute('class','row_count_btn');}
if(!theadElement){arrCells=tbodyElement.getElementsByTagName('tr')[0].children;for(i=0,len=arrCells.length,strHeaderHTML='',strFixedHeaderHTML='';i<len;i+=1){strCurrentHeadingText=encodeHTML(GS.templateWithQuerystring(arrCells[i].getAttribute('heading')||''));if(strCurrentHeadingText){bolHeaderTextFound=true;}
strHeaderHTML+='<th gs-dynamic>'+strCurrentHeadingText+'</th>';strFixedHeaderHTML+='<div class="fixed-header-cell" gs-dynamic>'+strCurrentHeadingText+'</div>';}
if(bolHeaderTextFound){strHeaderHTML='<thead gs-dynamic><tr gs-dynamic>'+strHeaderHTML+'</tr></thead>';}else{strHeaderHTML='';strFixedHeaderHTML='';}}else{strHeaderHTML=theadElement.outerHTML;arrCells=theadElement.getElementsByTagName('tr')[0].children;for(i=0,len=arrCells.length,strFixedHeaderHTML='';i<len;i+=1){strFixedHeaderHTML+='<div class="fixed-header-cell" gs-dynamic>'+encodeHTML(arrCells[i].textContent||'')+'</div>';}}
element.fixedHeaderContainerElement.innerHTML=strFixedHeaderHTML;strBodyHTML='<tbody gs-dynamic>'+dataTemplateRecords(element,data)+'</tbody>';if(element.headerRefreshObserver){element.headerRefreshObserver.disconnect();element.headerRefreshObserver=undefined;}
element.headerRefreshObserver=new MutationObserver(function(mutations){mutations.forEach(function(mutation){element.refreshFixedHeader();});});element.headerRefreshObserver.observe(element.scrollContainerElement,{'childList':true});element.scrollContainerElement.innerHTML='<table gs-dynamic>'+
strHeaderHTML+
strBodyHTML+'</table>';element.theadElement=xtag.query(element.scrollContainerElement,'thead')[0];element.tbodyElement=xtag.query(element.scrollContainerElement,'tbody')[0];element.refreshFixedHeader();element.refreshHeight();element.refreshReflow();element.scrollContainerElement.scrollTop=element.oldScrollTop;if(element.hasAttribute('scroll-to-bottom')){element.scrollContainerElement.scrollTop=element.scrollContainerElement.scrollHeight;}
GS.triggerEvent(element,'after_select');}else{element.classList.add('error');GS.ajaxErrorDialog(data,function(){getData(element);});}}
function updateRecord(element,record,strColumn,newValue){var srcParts=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('src')||element.getAttribute('source')||'')).split('.'),strSchema=srcParts[0],strObject=srcParts[1],strHashCols='',strHashData='',strUpdateData='pk\tset\thash\n'+'id\t'+GS.encodeForTabDelimited(strColumn)+'\thash\n'+
GS.encodeForTabDelimited(record.getAttribute('data-id'))+'\t'+GS.encodeForTabDelimited(newValue)+'\t',i,len,arrTotalRecords=[],callbackFunction;for(i=0,len=element.arrWhereColumns.length;i<len;i+=1){if(element.arrWhereColumns[i]!='id'){if(strHashCols.length>0){strHashCols+='\t';strHashData+='\t';}
strHashCols+=GS.encodeForTabDelimited(element.arrWhereColumns[i]);strHashData+=GS.encodeForTabDelimited(record.getAttribute('data-'+element.arrWhereColumns[i]));}}
strUpdateData+=CryptoJS.MD5(strHashData);addLoader(element,'Updating Record...');GS.requestUpdateFromSocket(GS.envSocket,strSchema,strObject,'*',strHashCols,strUpdateData,function(data,error,transactionID){if(error){removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){var arrRecords,arrCells,envData,i,len,cell_i,cell_len;if(!error){if(data!=='TRANSACTION COMPLETED'){arrRecords=GS.trim(data,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}else{commitFunction();}}else{removeLoader(element);rollbackFunction();GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){var arrElements,i,len;if(!error){if(strAnswer==='COMMIT'){callbackFunction({detail:{response:arrTotalRecords[0],error:error}});}}else{getData(element);GS.webSocketErrorDialog(data);}});callbackFunction=function(event){var jsnData,i,len,idIndex,tbodyElement,recordIndex,focusElement=document.activeElement,focusElementTag,focusElementRecord,focusElementCell,focusElementRecordIndex,focusElementCellIndex,focusElementIndex,focusElementCell,elementWalkResult,arrElements,arrSelection,newRecord,jsnTextSelection,newRecordData;console.log(event);removeLoader(element);focusElementCell=getCellFromTarget(focusElement);if(focusElementCell){focusElementTag=focusElement.nodeName.toLowerCase();focusElementRecord=GS.findParentTag(focusElementCell,'tr');focusElementRecordIndex=focusElementRecord.rowIndex;focusElementCellIndex=focusElementCell.cellIndex;focusElementIndex=xtag.query(focusElementRecord,focusElement.nodeName.toLowerCase()).indexOf(focusElement);}
if(!event.detail.error){GS.triggerEvent(element,'after_update');newRecordData=JSON.parse(JSON.stringify(event.detail.response));if(newRecordData.length>0){idIndex=element.lastSuccessData.arr_column.indexOf('id');for(i=0,len=element.lastSuccessData.dat.length;i<len;i+=1){if(String(element.lastSuccessData.dat[i][idIndex])===String(record.getAttribute('data-id'))){recordIndex=i;element.lastSuccessData.dat[i]=JSON.parse(JSON.stringify(event.detail.response));break;}}
if(document.activeElement.nodeName==='INPUT'||document.activeElement.nodeName==='TEXTAREA'){jsnTextSelection=GS.getInputSelection(document.activeElement);}
arrElements=xtag.query(record,'td, th');arrSelection=[];for(i=0,len=arrElements.length;i<len;i+=1){if(arrElements[i].hasAttribute('selected-secondary')){arrSelection.push('selected-secondary');}else if(arrElements[i].hasAttribute('selected')){arrSelection.push('selected');}else{arrElements.push('');}}
tbodyElement=document.createElement('tbody');tbodyElement.innerHTML=dataTemplateRecords(element,element.lastSuccessData,recordIndex,1);newRecord=xtag.queryChildren(tbodyElement,'tr')[0];record.parentNode.replaceChild(newRecord,record);arrElements=xtag.query(newRecord,'td, th');for(i=0,len=arrElements.length;i<len;i+=1){if(arrSelection[i]){arrElements[i].setAttribute(arrSelection[i],'');}}
if(focusElementCell){elementWalkResult=xtag.query(element.scrollContainerElement,'tr')[focusElementRecordIndex];if(elementWalkResult){elementWalkResult=xtag.query(elementWalkResult,focusElementTag)[focusElementIndex];if(elementWalkResult){elementWalkResult.focus();}}}
if(jsnTextSelection){GS.setInputSelection(document.activeElement,jsnTextSelection.start,jsnTextSelection.end);}}else{element.selectedCells=[];record.parentNode.removeChild(record);}
element.refreshFixedHeader();element.refreshHeight();}else{event.detail.response.error_addin='<b gs-dynamic>Your Unsaved Value:</b> "'+newValue+'"';GS.ajaxErrorDialog(event.detail.response,function(){updateRecord(element,record,strColumn,newValue);},function(){idIndex=element.lastSuccessData.arr_column.indexOf('id');for(i=0,len=element.lastSuccessData.dat.length;i<len;i+=1){if(String(element.lastSuccessData.dat[i][idIndex])===String(record.getAttribute('data-id'))){recordIndex=i;break;}}
tbodyElement=document.createElement('tbody');tbodyElement.innerHTML=dataTemplateRecords(element,element.lastSuccessData,recordIndex,1);record.parentNode.replaceChild(xtag.queryChildren(tbodyElement,'tr')[0],record);});}};}
function deleteRecords(element,arrID,arrRecord){var srcParts=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('src')||element.getAttribute('source')||'')).split('.'),strSchema=srcParts[0],strObject=srcParts[1],strHashCols='',strHashData='',strDeleteData='pk\thash\n'+'id\thash\n',i,len,j,len2,arrTotalRecords=[],callbackFunction;for(j=0,len2=element.arrWhereColumns.length;j<len2;j+=1){if(element.arrWhereColumns[j]!='id'){if(strHashCols.length>0){strHashCols+='\t';}
strHashCols+=GS.encodeForTabDelimited(element.arrWhereColumns[j]);}}
for(i=0,len=arrID.length;i<len;i+=1){for(j=0,len2=element.arrWhereColumns.length;j<len2;j+=1){if(element.arrWhereColumns[j]!='id'){if(strHashData.length>0){strHashData+='\t';}
strHashData+=GS.encodeForTabDelimited(arrRecord[i].getAttribute('data-'+element.arrWhereColumns[j]));}else{strDeleteData+=GS.encodeForTabDelimited(arrRecord[i].getAttribute('data-id'));}}
console.log(strHashData);strDeleteData+='\t'+CryptoJS.MD5(strHashData)+'\n';strHashData='';}
addLoader(element,'Creating Delete Transaction...');GS.requestDeleteFromSocket(GS.envSocket,strSchema,strObject,strHashCols,strDeleteData,function(data,error,transactionID){if(error){removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){var arrElements,i,len,templateElement;if(!error){if(data==='TRANSACTION COMPLETED'){commitFunction();}}else{rollbackFunction();GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){var i,len,idColIndex,deleteIndex;removeLoader(element);if(!error){if(strAnswer==='COMMIT'){GS.triggerEvent(element,'after_delete');for(i=0,len=arrRecord.length;i<len;i+=1){arrRecord[i].parentNode.removeChild(arrRecord[i]);}
idColIndex=element.lastSuccessData.arr_column.indexOf('id');if(element.hasAttribute('limit')||element.lastSuccessData.dat.length===arrID.length){element.refresh();}else{for(i=0,len=element.lastSuccessData.dat.length;i<len;i+=1){deleteIndex=arrID.indexOf(String(element.lastSuccessData.dat[i][idColIndex]));if(deleteIndex>-1){element.lastSuccessData.dat.splice(i,1);arrID.splice(deleteIndex,1);len-=1;i-=1;}
if(arrID.length===0){break;}}
handleData(element,element.lastSuccessData);}}}else{getData(element);GS.webSocketErrorDialog(data);}});}
function insertRecord(element,dialog,strInsertString){var srcParts=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('src')||element.getAttribute('source')||'')).split('.'),strSchema=srcParts[0],strObject=srcParts[1],arrInsertKeys,arrInsertValues,strWSInsertColumns,strWSInsertData,i,len;if(element.getAttribute('column')||element.getAttribute('qs')){strInsertString+=(strInsertString?'&':'')+(element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs'))+'='+(element.value);}
console.log(strInsertString);arrInsertKeys=GS.qryGetKeys(strInsertString);arrInsertValues=GS.qryGetVals(strInsertString);for(i=0,len=arrInsertKeys.length,strWSInsertColumns='';i<len;i+=1){strWSInsertColumns+=arrInsertKeys[i]+((i+1)===len?'\n':'\t');}
for(i=0,len=arrInsertValues.length,strWSInsertData='';i<len;i+=1){strWSInsertData+=arrInsertValues[i]+((i+1)===len?'\n':'\t');}
addLoader(element,'Inserting Record...');GS.requestInsertFromSocket(GS.envSocket,strSchema,strObject,strWSInsertColumns,'id','',strWSInsertColumns+strWSInsertData,function(data,error,transactionID){if(error){removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){var arrElements,i,len,templateElement;if(!error){if(data==='TRANSACTION COMPLETED'){commitFunction();}}else{removeLoader(element);rollbackFunction();GS.webSocketErrorDialog(data);}},function(){removeLoader(element);GS.triggerEvent(element,'after_insert');GS.closeDialog(dialog,'Ok');getData(element,true);});}
function refreshHud(element){var elementHudTopContainer,elementHudBottomContainer,divElement=document.createElement('div'),hudInsertButton,hudRefreshButton,hudDeleteButton,hudOrderbyButton,hudLimitButton,intOffset,intLimit,jsnOrderByCopy,i,len,customHudTemplate,customHudElements;elementHudTopContainer=element.hudTopElement;elementHudBottomContainer=element.hudBottomElement;elementHudTopContainer.innerHTML='';elementHudBottomContainer.innerHTML='';if(element.insertTemplate&&!element.hasAttribute('no-insert')){divElement.innerHTML='<gs-button inline icononly icon="plus" no-focus gs-dynamic>Insert</gs-button>';hudInsertButton=divElement.childNodes[0];elementHudTopContainer.appendChild(hudInsertButton);}
if(!element.hasAttribute('no-hudrefresh')){divElement.innerHTML='<gs-button inline icononly icon="refresh" no-focus gs-dynamic>Refresh</gs-button>';hudRefreshButton=divElement.childNodes[0];elementHudTopContainer.appendChild(hudRefreshButton);}
if(!element.hasAttribute('no-huddelete')){divElement.innerHTML='<gs-button inline icononly icon="times" no-focus gs-dynamic>Delete</gs-button>';hudDeleteButton=divElement.childNodes[0];elementHudTopContainer.appendChild(hudDeleteButton);}
if(element.hudTemplate&&element.hudTemplate.trim()){customHudTemplate=document.createElement('template');customHudTemplate.innerHTML=element.hudTemplate;elementHudTopContainer.appendChild(customHudTemplate.content.cloneNode(true));}
if(!element.hasAttribute('no-hudorderby')){divElement.innerHTML='<gs-button inline icononly icon="sort-amount-asc" no-focus gs-dynamic>Order By</gs-button>';hudOrderbyButton=divElement.childNodes[0];elementHudBottomContainer.appendChild(hudOrderbyButton);}
element.limitButtonElement='';if(!element.hasAttribute('no-hudlimit')){divElement.innerHTML='<span flex></span><gs-button inline no-focus>Limit</gs-button>';hudLimitButton=divElement.childNodes[1];element.limitButtonElement=hudLimitButton;elementHudBottomContainer.appendChild(divElement.childNodes[0]);elementHudBottomContainer.appendChild(divElement.childNodes[0]);}
if(elementHudTopContainer.innerHTML===''){elementHudTopContainer.style.display='none';}else{elementHudTopContainer.style.display='';}
if(elementHudBottomContainer.innerHTML===''){elementHudBottomContainer.style.display='none';}else{elementHudBottomContainer.style.display='';}
if(hudInsertButton){hudInsertButton.addEventListener('click',function(event){var templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                    <gs-page gs-dynamic>
                        <gs-header gs-dynamic><center gs-dynamic><h3 gs-dynamic>Insert</h3></center></gs-header>
                        <gs-body padded gs-dynamic>
                            <div id="insert-dialog-content-container" gs-dynamic>{{HTML}}</div>
                        </gs-body>
                        <gs-footer gs-dynamic>
                            <gs-grid gs-dynamic widths="1,1" class="width-2">
                                <gs-block gs-dynamic width="1">
                                    <gs-button dialogclose gs-dynamic>Cancel</gs-button>
                                </gs-block>
                                <gs-block gs-dynamic width="1">
                                    <gs-button class="dialog-envelope-insert" listen-for-return bg-primary gs-dynamic>Ok</gs-button>
                                </gs-block>
                            </gs-grid>
                        </gs-footer>
                    </gs-page>
                */}).replace('{{HTML}}',element.insertTemplate);GS.openDialog(templateElement,function(){var dialog=this;GS.triggerEvent(element,'insert_dialog_open');xtag.query(dialog,'.dialog-envelope-insert')[0].addEventListener('click',function(){var insertContainer=document.getElementById('insert-dialog-content-container'),controls,i,len,strInsertString,currentValue;controls=xtag.query(insertContainer,'[column]');for(i=0,len=controls.length,strInsertString='';i<len;i+=1){currentValue=controls.checked!==undefined?controls.checked:controls[i].value;if(currentValue===undefined||currentValue===null){currentValue='';}
currentValue=encodeURIComponent(currentValue);if(currentValue!==undefined&&currentValue!==null&&currentValue!==''){strInsertString+=(strInsertString===''?'':'&')+
controls[i].getAttribute('column')+'='+currentValue;}}
insertRecord(element,dialog,strInsertString);});});});}
if(hudRefreshButton){element.hudRefreshButton=hudRefreshButton;hudRefreshButton.addEventListener('click',function(event){getData(element,true);});}
if(hudDeleteButton){element.hudDeleteButton=hudDeleteButton;hudDeleteButton.addEventListener('click',function(event){var i,len,arrRecord=element.selectedRecords,arrID=[];for(i=0,len=arrRecord.length;i<len;i+=1){arrID.push(String(arrRecord[i].dataset.id));}
if(arrID.length>0){GS.msgbox('Are you sure...','<br gs-dynamic />'+'<center gs-dynamic>'+'Are you sure you want to delete '+(arrID.length>1?'these records':'this record')+'?'+'</center>'+'<br gs-dynamic />',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){deleteRecords(element,arrID,arrRecord);}});}else{GS.msgbox('Nothing Selected.','<br gs-dynamic /><center gs-dynamic>Nothing is selected. Please select something to delete.</center><br />',['Ok']);}});}
if(hudOrderbyButton){element.hudOrderbyButton=hudOrderbyButton;hudOrderbyButton.addEventListener('click',function(event){var templateElement=document.createElement('template');jsnOrderByCopy=JSON.parse(JSON.stringify(element.user_order_bys));templateElement.setAttribute('data-mode','touch');templateElement.innerHTML=ml(function(){/*
                    <gs-page gs-dynamic>
                        <gs-header gs-dynamic>
                            <center gs-dynamic><h3 gs-dynamic>Sorted Columns</h3></center>
                            <gs-button id="order-by-dialog-add-column" gs-dynamic>Add A Column To Sort</gs-button>
                        </gs-header>
                        <gs-body padded gs-dynamic>
                            <div id="order-by-dialog-ghost-container" gs-dynamic></div>
                            <div id="order-by-dialog-used-columns" gs-dynamic></div>
                        </gs-body>
                        <gs-footer gs-dynamic>
                            <gs-grid>
                                <gs-block><gs-button gs-dynamic dialogclose>Cancel</gs-button></gs-block>
                                <gs-block><gs-button gs-dynamic dialogclose>Ok</gs-button></gs-block>
                            </gs-grid>
                        </gs-footer>
                    </gs-page>
                */});GS.openDialog(templateElement,function(){document.getElementById('order-by-dialog-add-column').addEventListener('click',function(event){var dialog,dialogButtons,templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                            <gs-page gs-dynamic>
                                <gs-header gs-dynamic>
                                    <center gs-dynamic><h3 gs-dynamic>Unsorted Columns</h3></center>
                                </gs-header>
                                <gs-body padded gs-dynamic>
                                    <div id="order-by-dialog-unused-columns" gs-dynamic></div>
                                </gs-body>
                                <gs-footer gs-dynamic>
                                    <gs-button dialogclose gs-dynamic>Cancel</gs-button>
                                </gs-footer>
                            </gs-page>
                        */});dialog=GS.openDialog(templateElement,function(){var unusedColumnsContainer=document.getElementById('order-by-dialog-unused-columns'),unusedColumnTapHandler,columnElements,i,len,strHTML;for(i=0,len=element.lastSuccessData.arr_column.length,strHTML='';i<len;i+=1){if(jsnOrderByCopy.columns.indexOf(element.lastSuccessData.arr_column[i])===-1){strHTML+='<div class="order_by_column" dialogclose data-column="'+element.lastSuccessData.arr_column[i]+'" gs-dynamic>'+'<div class="column_name" gs-dynamic>'+GS.strToTitle(element.lastSuccessData.arr_column[i])+'</div>'+'</div>';}}
unusedColumnsContainer.innerHTML=strHTML;unusedColumnTapHandler=function(event){if(event.target.classList.contains('column_name')){jsnOrderByCopy.columns.push(event.target.parentNode.getAttribute('data-column'));}else{jsnOrderByCopy.columns.push(event.target.getAttribute('data-column'));}
jsnOrderByCopy.directions.push('asc');refreshOrderBys();};columnElements=unusedColumnsContainer.getElementsByClassName('order_by_column');for(i=0,len=columnElements.length;i<len;i+=1){columnElements[i].addEventListener('click',unusedColumnTapHandler);}});dialogButtons=dialog.getElementsByTagName('gs-button');});var refreshOrderBys=function(){var usedColumnsElement=document.getElementById('order-by-dialog-used-columns'),ghostContainerElement=document.getElementById('order-by-dialog-ghost-container'),strHTML,i,len,sortButtons,sortMousedownHandler,deleteButtons,deleteTapHandler,directionButtons,directionTapHandler;for(i=0,len=jsnOrderByCopy.columns.length,strHTML='';i<len;i+=1){strHTML+='<div class="order_by_column" flex-horizontal data-column="'+jsnOrderByCopy.columns[i]+'" data-direction="'+jsnOrderByCopy.directions[i]+'" gs-dynamic>'+'<gs-button inline remove-all icononly icon="bars" class="sort" gs-dynamic></gs-button>'+'<div class="column_name" flex gs-dynamic>'+GS.strToTitle(jsnOrderByCopy.columns[i])+'</div>'+'<gs-button inline remove-all icononly icon="times" class="delete" gs-dynamic></gs-button>'+'<gs-button inline remove-all icononly icon="sort-amount-'+jsnOrderByCopy.directions[i]+'" class="direction" gs-dynamic></gs-button>'+'</div>';}
usedColumnsElement.innerHTML=strHTML;sortMousedownHandler=function(){var columns=usedColumnsElement.getElementsByClassName('order_by_column'),offsetsCache=[],i,len,currentElement=this.parentNode,currentlyMarkedElement,markerElement,bolLast=false,intToIndex,currentElementClone,intCloneoffset,intFromIndex,sortMousemoveHandler,sortMouseupHandler,strColumn=currentElement.getAttribute('data-column'),strDirection=currentElement.getAttribute('data-direction');markerElement=document.createElement('div');markerElement.classList.add('drop_marker');markerElement.setAttribute('gs-dynamic','');currentElementClone=currentElement.cloneNode(true);ghostContainerElement.appendChild(currentElementClone);intCloneoffset=GS.getElementOffset(ghostContainerElement).top+(currentElementClone.offsetHeight/2);for(i=0,len=columns.length;i<len;i+=1){offsetsCache.push({'element':columns[i],'top':GS.getElementOffset(columns[i]).top,'height':columns[i].offsetHeight});if(columns[i]===currentElement){intFromIndex=i;}}
sortMousemoveHandler=function(event){var i,len,matchedElement,bolNewLast,intTop;event.preventDefault();event.stopPropagation();if(event.which===0&&!evt.touchDevice){sortMouseupHandler();}else{intTop=GS.mousePosition(event).top+usedColumnsElement.parentNode.scrollTop;currentElementClone.style.top=(intTop-intCloneoffset)+'px';if(offsetsCache[0].top>intTop){matchedElement=offsetsCache[0].element;bolNewLast=false;}else{for(i=0,len=offsetsCache.length;i<len;i+=1){if(offsetsCache[i+1]){if(offsetsCache[i].top<=intTop&&offsetsCache[i].top+((offsetsCache[i+1].top-offsetsCache[i].top)/2)>intTop){matchedElement=offsetsCache[i].element;bolNewLast=false;intToIndex=i;break;}else if(offsetsCache[i].top<=intTop&&offsetsCache[i].top+((offsetsCache[i+1].top-offsetsCache[i].top)/2)<=intTop&&offsetsCache[i+1].top>intTop){matchedElement=offsetsCache[i+1].element;bolNewLast=false;intToIndex=i+1;break;}}else{if(offsetsCache[i].top+(offsetsCache[i].height/2)>=intTop){matchedElement=offsetsCache[i].element;bolNewLast=false;intToIndex=i;break;}else if(offsetsCache[i].top+(offsetsCache[i].height/2)<=intTop){matchedElement=offsetsCache[i].element;bolNewLast=true;intToIndex=i;break;}}}}
if(matchedElement!==currentlyMarkedElement||bolNewLast!==bolLast){if(bolNewLast===true){if(markerElement){markerElement.parentNode.removeChild(markerElement);}
matchedElement.parentNode.appendChild(markerElement);}else{matchedElement.parentNode.insertBefore(markerElement,matchedElement);}
currentlyMarkedElement=matchedElement;bolLast=bolNewLast;}}};document.body.addEventListener(evt.mousemove,sortMousemoveHandler);sortMouseupHandler=function(event){intToIndex=(intToIndex>intFromIndex?intToIndex-1:intToIndex);if(intFromIndex!==intToIndex&&intToIndex!==undefined){if(intFromIndex!==undefined&&intFromIndex!==''){jsnOrderByCopy.columns.splice(intFromIndex,1);jsnOrderByCopy.directions.splice(intFromIndex,1);}
jsnOrderByCopy.columns.splice(intToIndex,0,strColumn);jsnOrderByCopy.directions.splice(intToIndex,0,strDirection);refreshOrderBys();}else{markerElement.parentNode.removeChild(markerElement);}
ghostContainerElement.innerHTML='';document.body.removeEventListener(evt.mousemove,sortMousemoveHandler);document.body.removeEventListener(evt.mouseup,sortMouseupHandler);};document.body.addEventListener(evt.mouseup,sortMouseupHandler);};sortButtons=usedColumnsElement.getElementsByClassName('sort');for(i=0,len=sortButtons.length;i<len;i+=1){sortButtons[i].addEventListener(evt.mousedown,sortMousedownHandler);}
deleteTapHandler=function(){var indexToDelete=jsnOrderByCopy.columns.indexOf(this.parentNode.getAttribute('data-column'));jsnOrderByCopy.columns.splice(indexToDelete,1);jsnOrderByCopy.directions.splice(indexToDelete,1);refreshOrderBys();};deleteButtons=usedColumnsElement.getElementsByClassName('delete');for(i=0,len=deleteButtons.length;i<len;i+=1){deleteButtons[i].addEventListener('click',deleteTapHandler);}
directionTapHandler=function(){var indexToFlip=jsnOrderByCopy.columns.indexOf(this.parentNode.getAttribute('data-column'));if(jsnOrderByCopy.directions[indexToFlip]==='asc'){jsnOrderByCopy.directions[indexToFlip]='desc';}else{jsnOrderByCopy.directions[indexToFlip]='asc';}
refreshOrderBys();};directionButtons=usedColumnsElement.getElementsByClassName('direction');for(i=0,len=directionButtons.length;i<len;i+=1){directionButtons[i].addEventListener('click',directionTapHandler);}}
refreshOrderBys();},function(event,strAnswer){if(strAnswer==='Ok'){element.user_order_bys=JSON.parse(JSON.stringify(jsnOrderByCopy));getData(element,true);}});});}
if(hudLimitButton){element.hudLimitButton=hudLimitButton;hudLimitButton.addEventListener('click',function(event){var intLimit,intOffset,bolShowAll,fromValue,toValue,templateElement=document.createElement('template');if(element.getAttribute('limit')&&element.getAttribute('offset')){intOffset=parseInt(element.getAttribute('offset'),10);intLimit=parseInt(element.getAttribute('limit'),10);fromValue=intOffset;toValue=intOffset+intLimit;bolShowAll=false;}else if(element.getAttribute('limit')){fromValue='0';toValue=element.getAttribute('limit');bolShowAll=false;}else if(element.old_offset&&element.old_limit){intOffset=parseInt(element.old_offset,10);intLimit=parseInt(element.old_limit,10);fromValue=intOffset;toValue=intOffset+intLimit;bolShowAll=true;}else if(element.old_limit){fromValue='0';toValue=element.old_limit;bolShowAll=true;}else{fromValue='0';toValue='';bolShowAll=true;}
templateElement.setAttribute('id','template-envelope-limit');templateElement.innerHTML=ml(function(){/*
                    <gs-page gs-dynamic>
                        <gs-header><center><h3>Limit</h3></center></gs-header>
                        <gs-body padded>
                            <gs-optionbox id="limit-dialog-choice" value="{{OPTION}}">
                                <gs-option value="range">
                                    Show Range:
                                    <gs-grid gutter>
                                        <gs-block>
                                            <b>From:</b>
                                            <gs-text id="limit-dialog-from" value="{{FROM}}" {{DISABLE}}></gs-text>
                                        </gs-block>
                                        <gs-block>
                                            <b>To:</b>
                                            <gs-text id="limit-dialog-to" value="{{TO}}" {{DISABLE}}></gs-text>
                                        </gs-block>
                                    </gs-grid>
                                </gs-option>
                                <gs-option value="all">Show All</gs-option>
                            </gs-optionbox>
                        </gs-body>
                        <gs-footer>
                            <gs-grid>
                                <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                                <gs-block><gs-button dialogclose listen-for-return bg-primary>Ok</gs-button></gs-block>
                            </gs-grid>
                        </gs-footer>
                    </gs-page>
                */}).replace('{{OPTION}}',(bolShowAll===true?'all':'range')).replace(/\{\{DISABLE\}\}/gim,(bolShowAll===true?'disabled':'')).replace('{{FROM}}',fromValue).replace('{{TO}}',toValue);GS.openDialog(templateElement,function(){var choiceElement,showAllElement,fromElement,toElement,intLimit,intOffset,bolShowAll,fromValue,toValue;choiceElement=document.getElementById('limit-dialog-choice');fromElement=document.getElementById('limit-dialog-from');toElement=document.getElementById('limit-dialog-to');choiceElement.addEventListener('change',function(event){if(this.value==='all'){fromElement.setAttribute('disabled','');toElement.setAttribute('disabled','');GS.closeDialog('template-envelope-limit','Ok');}else{fromElement.removeAttribute('disabled');toElement.removeAttribute('disabled');}});},function(event,strAnswer){var dialog=this,choiceElement,showAllElement,fromElement,toElement,intLimit,intOffset;if(strAnswer==='Ok'){choiceElement=document.getElementById('limit-dialog-choice');showAllElement=document.getElementById('limit-dialog-show-all');fromElement=document.getElementById('limit-dialog-from');toElement=document.getElementById('limit-dialog-to');if(choiceElement.value==='all'){if(element.getAttribute('limit')){element.old_limit=element.getAttribute('limit');element.removeAttribute('limit');}
if(element.getAttribute('offset')){element.old_offset=element.getAttribute('offset');element.removeAttribute('offset');}}else{if(fromElement.value){element.setAttribute('offset',fromElement.value);}
if(toElement.value){element.setAttribute('limit',parseInt(toElement.value,10)-parseInt(fromElement.value,10));}}
getData(element);}});});}}
function handleClipboardData(event,strCopyString){var clipboardData=event.clipboardData||window.clipboardData,strMime;if(!clipboardData){return;}
if(!clipboardData.setData){return;}
if(window.clipboardData&&window.clipboardData.getData){strMime='Text';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/plain';}
if(strCopyString){return clipboardData.setData(strMime,strCopyString)!==false;}else{return clipboardData.getData(strMime);}}
function dataTemplateRecords(element,data,intStartRecordNumber,intNumberOfRecords){var tableTemplateElement=document.createElement('template'),jsnTemplate,strRet,strStart,strEnd;tableTemplateElement.innerHTML=element.tableTemplate;jsnTemplate=GS.templateHideSubTemplates(xtag.query(tableTemplateElement.content,'tbody')[0].innerHTML,true);strRet=GS.templateWithEnvelopeData(jsnTemplate.templateHTML,data,intStartRecordNumber,intStartRecordNumber+intNumberOfRecords);strRet=GS.templateShowSubTemplates(strRet,jsnTemplate);return strRet;}
function getCellFromTarget(element){var currentElement=element;while(currentElement.nodeName!=='TD'&&currentElement.nodeName!=='TH'&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}
if(currentElement.nodeName!=='TD'&&currentElement.nodeName!=='TH'){return undefined;}
return currentElement;}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var arrPopKeys;var currentValue;var bolRefresh;var strOperator;if(strQSCol){if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}}
if(element.internal.bolQSFirstRun===true){if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){currentValue=GS.qryGetVal(strQS,arrPopKeys[i]);if(element.popValues[arrPopKeys[i]]!==currentValue){bolRefresh=true;}
element.popValues[arrPopKeys[i]]=currentValue;}}else if(element.hasAttribute('refresh-on-querystring-change')){bolRefresh=true;}
if(bolRefresh&&element.hasAttribute('src')){console.log('pushReplacePopHandler: getData',element);getData(element);}else if(bolRefresh&&!element.hasAttribute('src')){console.warn('gs-combo Warning: element has "refresh-on-querystring-values" or "refresh-on-querystring-change", but no "src".',element);}}else{if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){element.popValues[arrPopKeys[i]]=GS.qryGetVal(strQS,arrPopKeys[i]);}}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var hudTemplateElement,tableTemplateElement,tableTemplateElementCopy,insertTemplateElement,recordElement,divElement,oldRootElement,i,len,arrElement,arrColumnElement,arrTemplates,arrWhereColumns,strQueryString=GS.getQueryString(),currentElement,strQSValue;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);GS.addBeforeUnloadEvent(function(){document.activeElement.blur();});if(element.getAttribute('qs')||element.getAttribute('refresh-on-querystring-values')||element.hasAttribute('refresh-on-querystring-change')){element.popValues={};pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
if(element.getAttribute('primary-keys')){arrWhereColumns=element.getAttribute('primary-keys').split(/\s*,\s*/gim);if(arrWhereColumns.length===0){arrWhereColumns=['id','change_stamp'];}}else{arrWhereColumns=['id','change_stamp'];}
element.arrWhereColumns=arrWhereColumns;element.user_order_bys={'columns':[],'directions':[]};oldRootElement=xtag.queryChildren(element,'.root');if(oldRootElement.length>0){for(i=0,len=oldRootElement.length;i<len;i+=1){element.removeChild(oldRootElement[i]);}}
hudTemplateElement=xtag.queryChildren(element,'template[for="hud"]')[0];tableTemplateElement=xtag.queryChildren(element,'template[for="table"]'+(element.hasAttribute('template')?'[id="'+element.getAttribute('template')+'"':''))[0];if(!tableTemplateElement&&element.hasAttribute('template')){console.warn('ENVELOPE WARNING: Hey! You used the name of a non-existant record template!');tableTemplateElement=xtag.queryChildren(element,'template[for="table"]')[0];}
insertTemplateElement=xtag.queryChildren(element,'template[for="insert"]')[0];element.templates={};xtag.queryChildren(element,'template[for="table"]').forEach(function(cur,i){if(i===0){element.templates['default']=cur;}
if(cur.hasAttribute('id')){element.templates[cur.getAttribute('id')]=cur;}});if(hudTemplateElement){element.hudTemplate=hudTemplateElement.innerHTML;}
if(tableTemplateElement){tableTemplateElementCopy=document.createElement('template');tableTemplateElementCopy.innerHTML=tableTemplateElement.innerHTML;recordElement=xtag.query(xtag.query(tableTemplateElementCopy.content,'tbody')[0],'tr')[0];if(recordElement){for(i=0,len=element.arrWhereColumns.length;i<len;i+=1){recordElement.setAttribute('data-'+element.arrWhereColumns[i],'{{! row.'+element.arrWhereColumns[i]+' }}');}
element.tableTemplate=GS.templateColumnToValue(tableTemplateElementCopy.innerHTML);}}else{throw'Envelope error: table template is required.';}
if(insertTemplateElement){element.insertTemplate=insertTemplateElement.innerHTML;}
element.innerHTML='';divElement=document.createElement('div');divElement.classList.add('root');divElement.setAttribute('flex-fill','');divElement.setAttribute('flex-vertical','');divElement.setAttribute('gs-dynamic','');element.appendChild(divElement);element.root=divElement;element.root.innerHTML='<div class="hud-container-top" gs-dynamic></div>'+'<div class="fixed-header-container" gs-dynamic></div>'+'<div class="scroll-container" flex gs-dynamic></div>'+'<div class="hud-container-bottom" flex-horizontal gs-dynamic></div>'+'<input class="gs-envelope-copy-focus-target" value="Firefox compatibility input" gs-dynamic />';element.hudTopElement=xtag.queryChildren(element.root,'.hud-container-top')[0];element.fixedHeaderContainerElement=xtag.queryChildren(element.root,'.fixed-header-container')[0];element.scrollContainerElement=xtag.queryChildren(element.root,'.scroll-container')[0];element.hudBottomElement=xtag.queryChildren(element.root,'.hud-container-bottom')[0];element.copyFocusTargetElement=xtag.queryChildren(element.root,'.gs-envelope-copy-focus-target')[0];element.scrollContainerElement.setAttribute('allow-text-selection','');element.scrollContainerElement.addEventListener('change',function(event){var newValue,parentTr;if(event.target.getAttribute('column')){if(event.target.value!==null){newValue=event.target.value;}else{newValue=event.target.checked;}
parentTr=GS.findParentTag(event.target,'tr');if(parentTr.parentNode.parentNode.parentNode===element.scrollContainerElement&&!element.hasAttribute('no-update')){updateRecord(element,parentTr,event.target.getAttribute('column'),newValue);}}});if(!evt.touchDevice){element.addEventListener('click',function(event){var templateElement;if(event.metaKey&&event.shiftKey){templateElement=document.createElement('template');var strOrderBy='',strRelWhere='',strElemWhere,strWhereColumn,strUserOrderBy='',strLimit,strOffset,strSource=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('src')||'')),strCols=GS.templateWithQuerystring(element.getAttribute('cols')||''),strElemOrderBy;if((element.getAttribute('column')||element.getAttribute('qs'))&&element.value){strWhereColumn=element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs');if(isNaN(element.value)){strRelWhere='CAST('+strWhereColumn+' AS '+GS.database.type.text+') = '+'CAST($WhereQUOTE$'+(element.value)+'$WhereQUOTE$ AS '+GS.database.type.text+')';}else{strRelWhere=strWhereColumn+'='+(element.value);}}
strElemWhere=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('where')||''));strLimit=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('limit')||''));strOffset=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('offset')||''));if(element.user_order_bys&&element.user_order_bys.columns.length>0){for(i=0,len=element.user_order_bys.columns.length,strUserOrderBy;i<len;i+=1){strUserOrderBy+=(strUserOrderBy!==''?', ':'')+element.user_order_bys.columns[i]+' '+element.user_order_bys.directions[i].toUpperCase();}}
strElemOrderBy=GS.templateWithQuerystring(decodeURIComponent(element.getAttribute('ord')||''));templateElement.innerHTML=ml(function(){/*
                                <gs-page>
                                    <gs-header><h3>GS-Envelope Details</h3></gs-header>
                                    <gs-body padded>
                                        <b>Source: </b>{{SOURCE}}<br />
                                        <b>Columns: </b>{{COLS}}<br />
                                        <b>Element Where: </b>{{ELEMWHERE}}<br />
                                        <b>Relationship Where: </b>{{RELWHERE}}<br />
                                        <b>Limit: </b>{{LIMIT}}<br />
                                        <b>Offset: </b>{{OFFSET}}<br />
                                        <b>Element Order By: </b>{{ELEMORD}}<br />
                                        <b>User Order By: </b>{{USERORD}}
                                    </gs-body>
                                    <gs-footer>
                                        <gs-button dialogclose>Done</gs-button>
                                    </gs-footer>
                                </gs-page>
                            */}).replace(/\{\{SOURCE\}\}/gi,strSource).replace(/\{\{COLS\}\}/gi,strCols).replace(/\{\{ELEMWHERE\}\}/gi,strElemWhere).replace(/\{\{RELWHERE\}\}/gi,strRelWhere).replace(/\{\{LIMIT\}\}/gi,strLimit).replace(/\{\{OFFSET\}\}/gi,strOffset).replace(/\{\{ELEMORD\}\}/gi,strElemOrderBy).replace(/\{\{USERORD\}\}/gi,strUserOrderBy);GS.openDialog(templateElement);}});}
if(!evt.touchDevice){element.addEventListener(evt.mousedown,function(event){var target=event.target,cellFromTarget=getCellFromTarget(target),closestCell,arrSelectedCells,i,len;if(GS.findParentTag(event.target,'table')||target.classList.contains('fixed-header-cell')){if(cellFromTarget){closestCell=cellFromTarget;}else if(target.classList.contains('fixed-header-cell')){closestCell=element.theadElement.children[0].children[xtag.toArray(target.parentNode.children).indexOf(target)];}
if(closestCell){element.dragAllowed=true;element.dragCurrentCell=closestCell;element.selectionSelectedCells=[];if(event.shiftKey&&element.selectionPreviousOrigin){if(element.selectionPreviousSelectedCells){arrSelectedCells=element.selectedCells;for(i=0,len=element.selectionPreviousSelectedCells.length;i<len;i+=1){arrSelectedCells.splice(arrSelectedCells.indexOf(element.selectionPreviousSelectedCells[i]),1);}
element.selectedCells=arrSelectedCells;}
element.dragOrigin=element.selectionPreviousOrigin;element.dragMode='select';}else if(!event.shiftKey&&(event.metaKey||event.ctrlKey)&&!closestCell.hasAttribute('selected')){element.dragOrigin=closestCell;element.dragMode='select';}else if(!event.shiftKey&&(event.metaKey||event.ctrlKey)&&closestCell.hasAttribute('selected')){element.dragOrigin=closestCell;element.dragMode='deselect';}else{element.selectedCells=[];element.dragOrigin=closestCell;element.dragMode='select';}
selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);}}});element.addEventListener(evt.mousemove,function(event){var target,closestCell,cellFromTarget;if(event.which!==0){target=event.target;cellFromTarget=getCellFromTarget(target);if(cellFromTarget){closestCell=cellFromTarget;}else if(target.classList.contains('fixed-header-cell')){closestCell=element.theadElement.children[0].children[xtag.toArray(target.parentNode.children).indexOf(target)];}
if(closestCell&&element.dragAllowed&&element.dragCurrentCell!==closestCell){element.dragCurrentCell=getCellFromTarget(closestCell);selectHandler(element,element.dragOrigin,element.dragCurrentCell,element.dragMode);}}else{element.dragAllowed=false;element.selectionPreviousOrigin=element.dragOrigin;element.selectionPreviousSelectedCells=element.selectionSelectedCells;}});element.addEventListener(evt.mouseup,function(event){element.dragAllowed=false;if(element.dragMode==='select'){element.selectionPreviousOrigin=element.dragOrigin;element.selectionPreviousSelectedCells=element.selectionSelectedCells;}});}else{element.root.addEventListener(evt.mousedown,function(event){if(event.target.nodeName==='TD'||event.target.nodeName==='TH'||getCellFromTarget(event.target)){element.selectedCells=[];if(GS.findParentTag(event.target,'tr')){element.selectedCells=GS.findParentTag(event.target,'tr').children;}}});}
window.addEventListener('resize',function(){element.refreshFixedHeader();element.refreshHeight();element.refreshReflow();});window.addEventListener('orientationchange',function(){element.refreshFixedHeader();element.refreshHeight();element.refreshReflow();});element.addEventListener('size-changed',function(event){element.refreshFixedHeader();element.refreshHeight();});element.addEventListener('keydown',function(event){var target=event.target,intKeyCode=event.which||event.keyCode,jsnSelection,bolCursorElement,i,len,focusElement,tbodyElement,recordElement,cellElement,cellElements,tempElement;if(target!==element){bolCursorElement=target.nodeName==='INPUT'||target.nodeName==='TEXTAREA';if(bolCursorElement){jsnSelection=GS.getInputSelection(target);}else{jsnSelection={};}
if(intKeyCode===38){cellElement=getCellFromTarget(target);recordElement=cellElement.parentNode;tbodyElement=recordElement.parentNode;if(recordElement.rowIndex>1){recordElement=tbodyElement.children[recordElement.rowIndex-2];focusElement=xtag.query(recordElement.children[cellElement.cellIndex],'[column]')[0];}}else if(intKeyCode===40){cellElement=getCellFromTarget(target);recordElement=cellElement.parentNode;tbodyElement=recordElement.parentNode;if(recordElement.rowIndex<tbodyElement.children.length){recordElement=tbodyElement.children[recordElement.rowIndex];focusElement=xtag.query(recordElement.children[cellElement.cellIndex],'[column]')[0];}}else if(intKeyCode===37||intKeyCode===39){if(intKeyCode===37&&(bolCursorElement===false||jsnSelection.start===0)){cellElement=getCellFromTarget(target);recordElement=cellElement.parentNode;tbodyElement=recordElement.parentNode;cellElements=xtag.query(tbodyElement,'tr > td, tr > th');for(i=cellElements.indexOf(cellElement)-1;i>-1;i-=1){tempElement=xtag.query(cellElements[i],'[column]')[0];if(tempElement&&GS.isElementFocusable(tempElement)){focusElement=tempElement;break;}}}else if(intKeyCode===39&&(bolCursorElement===false||jsnSelection.end===target.value.length)){cellElement=getCellFromTarget(target);recordElement=cellElement.parentNode;tbodyElement=recordElement.parentNode;cellElements=xtag.query(tbodyElement,'tr > td, tr > th');for(i=cellElements.indexOf(cellElement)+1,len=cellElements.length;i<len;i+=1){tempElement=xtag.query(cellElements[i],'[column]')[0];if(tempElement&&GS.isElementFocusable(tempElement)){focusElement=tempElement;break;}}}}
if(focusElement&&GS.isElementFocusable(focusElement)){event.preventDefault();focusElement.focus();if(document.activeElement.nodeName==='INPUT'||document.activeElement.nodeName==='TEXTAREA'){GS.setInputSelection(document.activeElement,0,document.activeElement.value.length);}
element.selectedRecords=GS.findParentTag(focusElement,'TR');}}});element.tabIndex=0;document.body.addEventListener('copy',function(event){var elementClosestEnvelope=GS.findParentTag(document.activeElement,'gs-envelope'),strCopyString,i,len,cell_i,cell_len,arrSelected,intFromRecord=9999999,intFromCell=9999999,intToRecord=0,intToCell=0,strCellText,arrRecords,arrCells,strRecordString;if(elementClosestEnvelope===element&&(document.activeElement.classList.contains('gs-envelope-copy-focus-target')||document.activeElement.selectionStart===document.activeElement.selectionEnd)){arrSelected=element.selectedCells;if(arrSelected.length>0){for(i=0,len=arrSelected.length;i<len;i+=1){if(arrSelected[i].parentNode.rowIndex<intFromRecord){intFromRecord=arrSelected[i].parentNode.rowIndex;}
if(arrSelected[i].cellIndex<intFromCell){intFromCell=arrSelected[i].cellIndex;}
if(arrSelected[i].parentNode.rowIndex+1>intToRecord){intToRecord=arrSelected[i].parentNode.rowIndex+1;}
if(arrSelected[i].cellIndex+1>intToCell){intToCell=arrSelected[i].cellIndex+1;}}
arrRecords=xtag.query(element.scrollContainerElement,'tr');strCopyString='';for(i=intFromRecord,len=intToRecord;i<len;i+=1){arrCells=arrRecords[i].children;for(cell_i=intFromCell,cell_len=intToCell,strRecordString='';cell_i<cell_len;cell_i+=1){if(arrCells[cell_i].hasAttribute('selected')){if(arrCells[cell_i].lastElementChild){strCellText=arrCells[cell_i].lastElementChild.textValue||arrCells[cell_i].lastElementChild.value||(arrCells[cell_i].lastElementChild.checked||'').toString();}else{strCellText=arrCells[cell_i].textContent.trim();}}else{strCellText='';}
strRecordString+=(cell_i!==intFromCell?'\t':'')+(strCellText||'');}
if(strRecordString.trim()){strCopyString+=strRecordString;}
if(i+1!==len&&strRecordString.trim()){strCopyString+='\n';}}}
if(strCopyString){if(handleClipboardData(event,strCopyString)){event.preventDefault(event);}}}});refreshHud(element);getData(element);}}}
xtag.register('gs-envelope',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(strAttrName==='template'){var tableTemplateElement,tableTemplateElementCopy,recordElement,element=this,i,len;tableTemplateElement=element.templates[element.getAttribute('template')||'default'];console.log(tableTemplateElement);if(!tableTemplateElement&&element.hasAttribute('template')){console.warn('ENVELOPE WARNING: Hey! You used the name of a non-existant record template!');tableTemplateElement=element.templates['default'];}
console.log(tableTemplateElement);if(tableTemplateElement){console.log(tableTemplateElement);tableTemplateElementCopy=document.createElement('template');tableTemplateElementCopy.innerHTML=tableTemplateElement.innerHTML;recordElement=xtag.query(xtag.query(tableTemplateElementCopy.content,'tbody')[0],'tr')[0];if(recordElement){for(i=0,len=element.arrWhereColumns.length;i<len;i+=1){recordElement.setAttribute('data-'+element.arrWhereColumns[i],'{{! row.'+element.arrWhereColumns[i]+' }}');}
element.tableTemplate=GS.templateColumnToValue(tableTemplateElementCopy.innerHTML);}}else{throw'Envelope error: table template is required.';}}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='no-hudlimit'||strAttrName==='no-hudorderby'||strAttrName==='no-huddelete'||strAttrName==='no-hudrefresh'){refreshHud(this);}else if(strAttrName==='value'&&this.root){this.refresh();}}}},events:{},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(newValue){this.setAttribute('value',newValue);getData(this);}},selectedCells:{get:function(){return xtag.query(this.scrollContainerElement,'[selected]');},set:function(newValue){var i,len,intIdIndex,arrCells=xtag.query(this.scrollContainerElement,'[selected]'),arrRecords,cell_i,cell_len,fixedHeaderCells=xtag.queryChildren(this.fixedHeaderContainerElement,'.fixed-header-cell');for(i=0,len=fixedHeaderCells.length;i<len;i+=1){fixedHeaderCells[i].removeAttribute('selected');}
for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');}
arrCells=xtag.query(this.scrollContainerElement,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue==='object'&&newValue.length===undefined){arrCells=[newValue];}else{arrCells=newValue;}
for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].setAttribute('selected','');if(arrCells[i].parentNode.parentNode.nodeName==='THEAD'){fixedHeaderCells[arrCells[i].cellIndex].setAttribute('selected','');}}
arrRecords=this.selectedRecords;for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].children;for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){if(!arrCells[cell_i].hasAttribute('selected')){arrCells[cell_i].setAttribute('selected-secondary','');}}}
GS.triggerEvent(this,'after_selection');}},selectedRecords:{get:function(){var i,len,intRecordIndex=-1,arrRecord=[],selected=this.selectedCells;for(i=0,len=selected.length;i<len;i+=1){if(selected[i].parentNode.rowIndex>intRecordIndex&&selected[i].parentNode.parentNode.nodeName!=='THEAD'){intRecordIndex=selected[i].parentNode.rowIndex;arrRecord.push(selected[i].parentNode);}}
return arrRecord;},set:function(newValue){var i,len,cell_i,cell_len,intIdIndex,arrCells=this.selectedCells,arrRecords,arrCellChildren,fixedHeaderCells=xtag.queryChildren(this.fixedHeaderContainerElement,'.fixed-header-cell');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');if(arrCells[i].parentNode.parentNode.nodeName==='THEAD'){fixedHeaderCells[arrCells[i].cellIndex].removeAttribute('selected','');}}
arrCells=xtag.query(this.scrollContainerElement,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue==='object'&&newValue.length===undefined){arrRecords=[newValue];}else{arrRecords=newValue;}
for(i=0,len=arrRecords.length,arrCells=[];i<len;i+=1){arrCellChildren=arrRecords[i].children;for(cell_i=0,cell_len=arrCellChildren.length;cell_i<cell_len;cell_i+=1){arrCells.push(arrCellChildren[cell_i]);}}
this.selectedCells=arrCells;GS.triggerEvent(this,'after_selection');}},selectedIds:{get:function(){var i,len,arrID=[],selected=this.selectedRecords;for(i=0,len=selected.length;i<len;i+=1){arrID.push(String(selected[i].dataset.id));}
return arrID;},set:function(newValue){var i,len,cell_i,cell_len,arrCells=this.selectedCells,arrRecords=xtag.query(this.scrollContainerElement,'tbody > tr');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected');}
arrCells=xtag.query(this.scrollContainerElement,'[selected-secondary]');for(i=0,len=arrCells.length;i<len;i+=1){arrCells[i].removeAttribute('selected-secondary');}
if(typeof newValue!=='object'){newValue=[String(newValue)];}else{for(i=0,len=newValue.length;i<len;i+=1){newValue[i]=String(newValue[i]);}}
for(i=0,len=arrRecords.length;i<len;i+=1){if(newValue.indexOf(arrRecords[i].getAttribute('data-id'))>-1){arrCells=arrRecords[i].children;for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i].setAttribute('selected','');}}}
GS.triggerEvent(this,'after_selection');}}},methods:{refresh:function(){getData(this);},refreshReflow:function(){var intEnvelopeWidth=this.scrollContainerElement.clientWidth+1,bolCurrentlyReflowed,intWindowWidth=window.innerWidth,intReflowAt=parseInt(this.getAttribute('reflow-at'),10);if(this.reflowBreakPoint===undefined){this.reflowBreakPoint=0;}
bolCurrentlyReflowed=this.classList.contains('reflow');this.classList.remove('reflow');if((intEnvelopeWidth<this.scrollContainerElement.scrollWidth&&!this.hasAttribute('reflow-at'))||(!isNaN(intReflowAt)&&intEnvelopeWidth<intReflowAt)){if(!bolCurrentlyReflowed){this.selectedCells=[];}
this.reflowBreakPoint=intWindowWidth;this.classList.add('reflow');}else{if(bolCurrentlyReflowed){this.selectedCells=[];}
this.reflowBreakPoint=0;this.classList.remove('reflow');}},refreshFixedHeader:function(){var elementFixedHeaderCells=xtag.queryChildren(this.fixedHeaderContainerElement,'.fixed-header-cell'),theadCellElements,i,len,intLeft;if(this.theadElement&&GS.getStyle(this.theadElement,'display')!=='none'){this.fixedHeaderContainerElement.removeAttribute('hidden');theadCellElements=xtag.query(this.theadElement,'th, td');for(i=0,len=theadCellElements.length,intLeft=0;i<len;i+=1){elementFixedHeaderCells[i].style.height=(theadCellElements[i].offsetHeight+1)+'px';elementFixedHeaderCells[i].style.width=theadCellElements[i].offsetWidth+'px';elementFixedHeaderCells[i].style.left=(intLeft-this.scrollContainerElement.scrollLeft)+'px';intLeft+=theadCellElements[i].offsetWidth;}}else{this.fixedHeaderContainerElement.setAttribute('hidden','');}},refreshHeight:function(){var intHeight=0;if(this.clientHeight===0){this.setAttribute('expand-to-content','');}
if(this.hasAttribute('expand-to-content')){this.style.height='';intHeight+=this.hudTopElement.scrollHeight;intHeight+=this.scrollContainerElement.scrollHeight;intHeight+=this.hudBottomElement.scrollHeight;this.style.height=(intHeight+5)+'px';}}}});});window.addEventListener('design-register-element',function(){window.designElementProperty_GSFILEMANAGER=function(selectedElement){addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Path',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('path')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'path',this.value);});addProp('Folder',true,'<gs-select class="target" value="'+(selectedElement.getAttribute('folder')||'')+'" mini>'+'<option value="role">Role (user files)</option>'+'<option value="web_root">Public (developer editable files)</option>'+'<option value="dev">App/Dev (developer editable files)</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'folder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});};registerDesignSnippet('<gs-file-manager>','<gs-file-manager>','gs-file-manager path="${0:/}" folder="${1:role}"></gs-file-manager>');designRegisterElement('gs-file-manager','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-file-manager.html');});document.addEventListener('DOMContentLoaded',function(){'use strict';function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){if(element.internal.bolQSFirstRun===true){if(element.getAttribute('folder')==='dev'){element.innerPath='app/'+GS.templateWithQuerystring(GS.trim(element.getAttribute('path'),'/')+'/');}else{element.innerPath=element.getAttribute('folder')+'/'+
GS.templateWithQuerystring(GS.trim(element.getAttribute('path'),'/')+'/');}
element.getFiles();}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var styleElement;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.getAttribute('folder')!=='dev'&&element.getAttribute('folder')!=='role'&&element.getAttribute('folder')!=='web_root'){throw'gs-file-manager Error: Invalid Folder. Please set the folder attribute to "dev", "role" or "web_root".';}
if(!element.getAttribute('path')){throw'gs-file-manager Error: Invalid Path. Please set the path attribute.';}
if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
if(element.getAttribute('folder')==='dev'){element.innerPath='app/'+GS.templateWithQuerystring(GS.trim(element.getAttribute('path'),'/')+'/');}else{element.innerPath=element.getAttribute('folder')+'/'+GS.templateWithQuerystring(GS.trim(element.getAttribute('path'),'/')+'/');}
element.getFiles();element.innerHTML='<div class="root" gs-dynamic flex-vertical flex-fill>'+'<div class="file-manager-list" gs-dynamic flex></div>'+
(element.hasAttribute('no-upload')?'':'<gs-button class="file-manager-upload" gs-dynamic>New File</gs-button>')+'<iframe class="file-manager-upload-response-iframe" name="upload_response_'+
(document.getElementsByClassName('file-manager-upload-response-iframe').length+1)+'" hidden></iframe>'+'</div>';element.fileListElement=xtag.query(element,'.file-manager-list')[0];element.uploadButtonElement=xtag.query(element,'.file-manager-upload')[0];element.responseIframeElement=xtag.query(element,'.file-manager-upload-response-iframe')[0];element.fileListElement.addEventListener('click',function(event){if(event.target.classList.contains('edit-file')){element.editFile(event.target.parentNode.getAttribute('data-link'));}else if(event.target.classList.contains('delete-file')){element.deleteFile(event.target.parentNode.getAttribute('data-link'));}});element.uploadButtonElement.addEventListener('click',function(){element.newFile();});element.responseIframeElement.addEventListener('load',function(event){var strResponseText=element.responseIframeElement.contentWindow.document.body.textContent,jsnResponse,strResponse,bolError,strError;if(element.responseIframeElement.loadListen===true){try{jsnResponse=JSON.parse(strResponseText);}catch(err){strResponse=strResponseText;}
if(jsnResponse){if(jsnResponse.stat===true){bolError=false;}else{bolError=true;if(jsnResponse.dat&&jsnResponse.dat.error){strError=jsnResponse.dat.error;}else{strError=jsnResponse.dat;}}}else{bolError=true;strError=strResponse;}
if(!bolError){GS.closeDialog(element.currentUploadDialog,'cancel');}else{GS.msgbox('Error',strError,'okonly');}
element.getFiles(true);GS.removeLoader('file-upload');}});}}}
xtag.register('gs-file-manager',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='path'||strAttrName==='folder'){if(this.getAttribute('folder')==='dev'){this.innerPath='app/'+GS.templateWithQuerystring(GS.trim(this.getAttribute('path'),'/')+'/');}else{this.innerPath=this.getAttribute('folder')+'/'+GS.templateWithQuerystring(GS.trim(this.getAttribute('path'),'/')+'/');}
this.getFiles();}}}},events:{},accessors:{'value':{get:function(){return this.arrFileLinks||[];}}},methods:{newFile:function(){var element=this,templateElement=document.createElement('template');templateElement.innerHTML=ml(function(){/*
                    <gs-page>
                        <gs-header><center><h3>Upload a File</h3></center></gs-header>
                        <gs-body padded>
                            <form class="upload-form" action="/env/action_upload" method="POST" target="{{TARGETNAME}}"
                                        enctype="multipart/form-data">
                                <label>File:</label>
                                <gs-text class="upload-file" name="file_content" type="file"></gs-text>
                                <br />
                                <label>File Name:</label>
                                <gs-text class="upload-name"></gs-text><br />
                                
                                <input class="upload-path" name="file_name" hidden />
                            </form>
                        </gs-body>
                        <gs-footer>
                            <gs-grid>
                                <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                                <gs-block><gs-button class="upload-button">Upload File</gs-button></gs-block>
                            </gs-grid>
                        </gs-footer>
                    </gs-page>
                */}).replace(/\{\{TARGETNAME\}\}/gim,this.responseIframeElement.getAttribute('name'));GS.openDialog(templateElement,function(){var formElement=xtag.query(this,'.upload-form')[0],fileControl=xtag.query(this,'.upload-file')[0],nameControl=xtag.query(this,'.upload-name')[0],pathControl=xtag.query(this,'.upload-path')[0],uploadButton=xtag.query(this,'.upload-button')[0];element.currentUploadDialog=this;uploadButton.addEventListener('click',function(event){var strFile=fileControl.value,strName=nameControl.value;pathControl.setAttribute('value',element.innerPath+nameControl.value);if(strName===''&&strFile===''){GS.msgbox('Error','No values in form. Please fill in the form.','okonly');}else if(strFile===''){GS.msgbox('Error','No file selected. Please select a file using the file input.','okonly');}else if(strName===''){GS.msgbox('Error','No value in file path textbox. Please fill in file name textbox.','okonly');}else{element.responseIframeElement.loadListen=true;formElement.submit();GS.addLoader('file-upload','Uploading file...');}});fileControl.addEventListener('change',function(event){var strValue=this.value;nameControl.value=strValue.substring(strValue.lastIndexOf('\\')+1);nameControl.focus();});nameControl.addEventListener('keydown',function(event){if(event.keyCode===13){GS.triggerEvent('click',uploadButton);}});});},editFile:function(strPath){var element=this,strFolder=this.getAttribute('folder'),strLink;/*
                //console.log('editFile: ', strPath);
                if (strFolder === 'dev') {
                    strLink = '/v1/dev/developer_g/greyspots-' + GS.version() + '/tools/file_manager/file_edit.html';
                    
                } else if (strFolder === 'role') {
                    strLink = '/env/app/all/file_manager/file_edit.html';
                    
                } else {
                    strLink = '/v1/dev/developer_g/greyspots-' + GS.version() + '/tools/file_manager/file_edit.html';
                }
                */
strLink='/env/app/all/file_manager/file_edit.html';GS.msgbox('Update File','<gs-button jumbo dialogclose>Rename File</gs-button>'+'<gs-button jumbo dialogclose href="'+strLink+'?folder='+strFolder+'&link='+encodeURIComponent(strPath)+'">'+'Edit File'+'</gs-button>',['Cancel'],function(strAnswer){if(strAnswer==='Rename File'){element.renameFile(strPath);}});},renameFile:function(strPath){var element=this,templateElement=document.createElement('template'),strFolder=this.getAttribute('folder');templateElement.innerHTML=ml(function(){/*
                    <gs-page>
                        <gs-header><center><h3>Rename File</h3></center></gs-header>
                        <gs-body padded>
                            <label>File Name:</label>
                            <gs-text class="text-update-name" value="{{FILENAME}}"></gs-text>
                        </gs-body>
                        <gs-footer>
                            <gs-grid>
                                <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                                <gs-block><gs-button dialogclose listen-for-return bg-primary>Rename</gs-button></gs-block>
                            </gs-grid>
                        </gs-footer>
                    </gs-page>
                */}).replace('{{FILENAME}}',strPath.substring(strPath.lastIndexOf('/')+1));GS.openDialog(templateElement,'',function(event,strAnswer){var strNewFileName;if(strAnswer==='Rename'){strNewFileName=xtag.query(this,'.text-update-name')[0].value;GS.addLoader('file-rename','Renaming File...');GS.ajaxJSON('/env/action_file','action=mv_file&folder='+strFolder+'&paths_from='+encodeURIComponent('["'+strPath+'"]')+'&paths_to='+encodeURIComponent('["'+strPath.substring(0,strPath.lastIndexOf('/')+1)+strNewFileName+'"]'),function(data,error){GS.removeLoader('file-rename');if(!error){element.getFiles(true);}else{GS.ajaxErrorDialog(data,function(){updateFile(strFileName);});}});}});},deleteFile:function(strPath){var element=this,strFolder=this.getAttribute('folder');GS.msgbox('Are you sure...','Are you sure you want to delete this file?',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){GS.addLoader('file-delete','Deleting File...');GS.ajaxJSON('/env/action_file','action=rm&folder='+strFolder+'&paths='+encodeURIComponent('["'+strPath+'"]'),function(data,error){GS.removeLoader('file-delete');if(!error){element.getFiles(true);}else{GS.ajaxErrorDialog(data,function(){deleteFile(strFileName);});}});}});},getFiles:function(bolChange){var element=this,strFolder=this.getAttribute('folder');GS.ajaxJSON('/env/action_file','action=list&folder='+strFolder+'&path='+encodeURIComponent(this.innerPath),function(response,error){var i,len,strHTML='',data,strFileName,strCurrentPath,strAnchorPath;if(!error&&response.dat.files.length>0){data=response.dat;data.files=data.files||[];data.files.sort();element.arrFileLinks=data.files;for(i=0,len=data.files.length;i<len;i+=1){strFileName=encodeHTML(data.files[i]);strCurrentPath=GS.trim(element.innerPath,'/')+'/'+strFileName;if(strFolder==='web_root'){strAnchorPath=encodeHTML('/'+strCurrentPath);}else{strAnchorPath=encodeHTML('/v1/'+strCurrentPath);}
strHTML+='<div flex-horizontal flex-fill data-link="'+strCurrentPath+'">'+'<gs-button class="goto-file" href="'+strAnchorPath+'" remove-all flex>'+strFileName+'</gs-button>'+'<gs-button class="edit-file" icononly icon="pencil" remove-all></gs-button>'+'<gs-button class="delete-file" icononly icon="times" remove-all></gs-button>'+'</div>';}}else{element.arrFileLinks=[];strHTML='<center><span class="h1 hint">No Files</span></center>';}
if(bolChange){GS.triggerEvent(element,'change');}
element.fileListElement.innerHTML=strHTML;});},refresh:function(){this.getFiles();}}});});window.addEventListener('design-register-element',function(){window.designElementProperty_GSFOLDER=function(selectedElement){addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Path',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('path')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'path',this.value);});addProp('Hide Folders',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-folders'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-folders',(this.value==='true'),true);});addProp('Hide Files',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-files'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-files',(this.value==='true'),true);});addProp('Side-By-Side',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('horizontal'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'horizontal',(this.value==='true'),true);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',(this.value==='true'),true);});};registerDesignSnippet('<gs-folder>','<gs-folder>','gs-folder path="${0:/}" folder="${1:role}"></gs-folder>');designRegisterElement('gs-folder','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-folder.html');});(function(){'use strict';function getPath(element){var strAttributePath=GS.trim(GS.templateWithQuerystring(element.getAttribute('path')||''),'/'),strInnerPath=element.arrPath.join('/'),strRet;if(strAttributePath&&strInnerPath){strRet='/'+strAttributePath+'/'+strInnerPath+'/';}else if(strAttributePath){strRet='/'+strAttributePath+'/';}else if(strInnerPath){strRet='/'+strInnerPath+'/';}
return strRet||'/';}
function getRealPath(element){var strAttributePath=GS.trim(GS.templateWithQuerystring(element.getAttribute('path')||''),'/'),arrPath=element.arrPath,strInnerPath,strRet,strPrefix;if(element.arrPath[0]==='app'||strAttributePath.indexOf('app')===0){strPrefix='/env';}else if(element.arrPath[0]==='role'||strAttributePath.indexOf('role')===0){strPrefix='/env';}else if(element.arrPath[0]==='web_root'||strAttributePath.indexOf('web_root')===0){strPrefix='';arrPath.splice(0,1);}
strInnerPath=arrPath.join('/');if(strAttributePath&&strInnerPath){strRet='/'+strAttributePath+'/'+strInnerPath+'/';}else if(strAttributePath){strRet='/'+strAttributePath+'/';}else if(strInnerPath){strRet='/'+strInnerPath+'/';}
return(strPrefix||'')+(strRet||'/');}
function getData(element){var strPath=getPath(element),bolFolders=!element.hasAttribute('no-folders'),bolFiles=!element.hasAttribute('no-files'),strHeader,intResponseNumber;element.folderList.innerHTML='';element.fileList.innerHTML='';strHeader=GS.trim('/'+element.arrPath.join('/'),'/');if(strHeader){strHeader='/'+strHeader+'/';}
element.pathTitle.textContent=strHeader;if(element.arrPath.length>0){element.backButton.removeAttribute('disabled');}else{element.backButton.setAttribute('disabled','');}
element.arrFile=[];element.arrFolder=[];intResponseNumber=0;GS.requestFromSocket(GS.envSocket,'FILE\tLIST\t'+GS.encodeForTabDelimited(strPath),function(data,error,errorData){var arrPaths,strName,strType,arrCells,i,len,divElement,arrFiles=[],arrFolders=[];if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data!=='TRANSACTION COMPLETED'){arrPaths=GS.trim(data,'\n').split('\n');if(intResponseNumber===0){element.folderList.innerHTML='';element.fileList.innerHTML='';}
for(i=0,len=arrPaths.length;i<len;i+=1){arrCells=arrPaths[i].split('\t');strType=GS.decodeFromTabDelimited(arrCells[1]);strName=GS.trim(GS.decodeFromTabDelimited(arrCells[0]),'/');if((strType==='folder'&&bolFolders)||(strType==='file'&&bolFiles)){divElement=document.createElement('div');divElement.setAttribute('flex-horizontal','');divElement.setAttribute('flex-fill','');divElement.setAttribute('class',strType+'-line');divElement.setAttribute('data-name',strName);if(strType==='file'){arrFiles.push(element.arrPath.join('/')+'/'+strName);divElement.innerHTML='<gs-button class="more-file" icononly icon="bars" remove-right></gs-button>'
+'<gs-button class="open-file" flex remove-left>'+encodeHTML(strName)+'</gs-button>';element.fileList.appendChild(divElement);}
if(strType==='folder'){arrFolders.push(element.arrPath.join('/')+'/'+strName);divElement.innerHTML='<gs-button class="more-folder" icononly icon="bars" remove-right></gs-button>'
+'<gs-button class="open-folder" flex remove-left>'+encodeHTML(strName)+'</gs-button>';element.folderList.appendChild(divElement);}}}
element.arrFile=arrFiles;element.arrFolder=arrFolders;GS.triggerEvent(element,'change');}else{if(element.folderList.innerHTML===''){element.folderList.innerHTML='<center prevent-text-selection><h4><small>No Folders.</small></h4></center>';}
if(element.fileList.innerHTML===''){element.fileList.innerHTML='<center prevent-text-selection><h4><small>No Files.</small></h4></center>';}}}else if(error){if(!element.hasAttribute('no-list-error')){GS.webSocketErrorDialog(errorData);}}
intResponseNumber+=1;});}
function prepareElement(element){var bolFolders=!element.hasAttribute('no-folders'),bolFiles=!element.hasAttribute('no-files');element.innerHTML=ml(function(){/*
            <div class="root" flex-vertical flex-fill gs-dynamic>
                <span class="path-title"></span>
                <div class="list-container" flex-fill>
                    <div class="folder-list-container" flex-vertical flex-fill flex>
                        <div class="folder-list-header" flex-horizontal>
                            <b flex prevent-text-selection>Folders:</b>
                            <gs-button class="button-back-folder" icon="long-arrow-left" icononly remove-bottom disabled no-focus></gs-button>
                            <gs-button class="button-new-folder" icon="plus" icononly remove-bottom no-focus></gs-button>
                        </div>
                        <div class="folder-list" flex></div>
                    </div>
                    <div class="file-list-container" flex-vertical flex-fill flex>
                        <div class="file-list-header" flex-horizontal>
                            <b flex prevent-text-selection>Files:</b>
                            <gs-button class="button-new-file" icon="plus" icononly remove-bottom no-focus></gs-button>
                            <gs-button class="button-upload-file" icon="upload" icononly remove-bottom no-focus></gs-button>
                        </div>
                        <div class="file-list" flex></div>
                    </div>
                </div>
            </div>
        */});element.root=xtag.queryChildren(element,'.root')[0];element.folderListHeader=xtag.query(element.root,'.folder-list-header')[0];element.fileListHeader=xtag.query(element.root,'.file-list-header')[0];element.folderList=xtag.query(element.root,'.folder-list')[0];element.fileList=xtag.query(element.root,'.file-list')[0];element.newFolderButton=xtag.query(element.root,'.button-new-folder')[0];element.newFileButton=xtag.query(element.root,'.button-new-file')[0];element.uploadFileButton=xtag.query(element.root,'.button-upload-file')[0];element.backButton=xtag.query(element.root,'.button-back-folder')[0];element.pathTitle=xtag.query(element.root,'.path-title')[0];element.arrPath=[];}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol&&strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else{strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun===true&&GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){getData(element);}}
element.internal.bolQSFirstRun=true;}
function bindElement(element){if(element.hasAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
element.addEventListener('click',function(event){var target=event.target;if(target.classList.contains('button-new-folder')){newFolder(element,target);}else if(target.classList.contains('button-new-file')){newFile(element,target);}else if(target.classList.contains('open-file')){fileOpen(element,target);}else if(target.classList.contains('open-folder')){folderOpen(element,target);}else if(target.classList.contains('button-back-folder')){backFolder(element,target);}else if(target.classList.contains('more-folder')){folderMenu(element,target);}else if(target.classList.contains('more-file')){fileMenu(element,target);}else if(target.classList.contains('button-upload-file')){fileUpload(element,target);}});}
function folderMenu(element,target){'use strict';var lineElement=GS.findParentElement(target,'.folder-line'),strFolderName=lineElement.getAttribute('data-name'),strPath=(getPath(element)+strFolderName),templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                <gs-button dialogclose remove-bottom style="border-bottom: 0 none;">Rename Folder</gs-button>
                <gs-button dialogclose remove-top>Delete Folder</gs-button>
                <hr />
                <gs-button dialogclose>Cancel</gs-button>
            </gs-body>
        */});GS.openDialogToElement(target,templateElement,'right','',function(event,strAnswer){if(strAnswer==='Rename Folder'){folderRename(element,target,strPath,strFolderName);}else if(strAnswer==='Delete Folder'){folderDelete(element,target,strPath,strFolderName);}});}
function folderRename(element,target,strOldPath,strFolderName){'use strict';var templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                <label for="gs-file-manager-text-folder-name">Folder Name:</label>
                <gs-text id="gs-file-manager-text-folder-name"></gs-text>
                <hr />
                <gs-grid>
                    <gs-block><gs-button dialogclose style="border-right: 0 none;" remove-right>Cancel</gs-button></gs-block>
                    <gs-block><gs-button dialogclose remove-left>Rename</gs-button></gs-block>
                </gs-grid>
            </gs-body>
        */});GS.openDialogToElement(target,templateElement,'right',function(){document.getElementById('gs-file-manager-text-folder-name').value=strFolderName;},function(event,strAnswer){var strNewPath;if(strAnswer==='Rename'){strNewPath=getPath(element)+document.getElementById('gs-file-manager-text-folder-name').value;GS.requestFromSocket(GS.envSocket,'FILE\tMOVE\t'+GS.encodeForTabDelimited(strOldPath)+'\t'+
GS.encodeForTabDelimited(strNewPath)+'\n',function(data,error,errorData){if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data==='TRANSACTION COMPLETED'){getData(element);}}else if(error){GS.webSocketErrorDialog(errorData);}});}});}
function folderDelete(element,target,strPath,strFolderName){'use strict';var templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                Are you sure you want to delete the folder: "<b>{{STRPATH}}</b>"?
                <hr />
                <gs-grid>
                    <gs-block><gs-button dialogclose remove-right style="border-right: 0 none;">No</gs-button></gs-block>
                    <gs-block><gs-button dialogclose remove-left>Yes</gs-button></gs-block>
                </gs-grid>
            </gs-body>
        */}).replace(/\{\{STRPATH\}\}/gi,strFolderName);GS.openDialogToElement(target,templateElement,'right','',function(event,strAnswer){if(strAnswer==='Yes'){GS.requestFromSocket(GS.envSocket,'FILE\tDELETE\t'+GS.encodeForTabDelimited(strPath)+'\n',function(data,error,errorData){if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data==='TRANSACTION COMPLETED'){getData(element);}}else if(error){GS.webSocketErrorDialog(errorData);}});}});}
function newFolder(element,target){'use strict';var templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                <label for="gs-file-manager-text-folder-name">New Folder Name:</label>
                <gs-text id="gs-file-manager-text-folder-name"></gs-text>
                <hr />
                <gs-grid>
                    <gs-block><gs-button dialogclose style="border-right: 0 none;" remove-right>Cancel</gs-button></gs-block>
                    <gs-block><gs-button dialogclose remove-left>Create</gs-button></gs-block>
                </gs-grid>
            </gs-body>
        */});GS.openDialogToElement(target,templateElement,'down','',function(event,strAnswer){var strPath;if(strAnswer==='Create'){strPath=getPath(element)+document.getElementById('gs-file-manager-text-folder-name').value;GS.requestFromSocket(GS.envSocket,'FILE\tCREATE_FOLDER\t'+GS.encodeForTabDelimited(strPath)+'\n',function(data,error,errorData){if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data==='TRANSACTION COMPLETED'){getData(element);}}else if(error){GS.webSocketErrorDialog(errorData);}});}});}
function folderOpen(element,target){'use strict';var lineElement=GS.findParentElement(target,'.folder-line');element.arrPath.push(lineElement.getAttribute('data-name'));getData(element);}
function backFolder(element,target){'use strict';element.arrPath.pop();getData(element);}
function fileMenu(element,target){'use strict';var lineElement=GS.findParentElement(target,'.file-line'),strFileName=lineElement.getAttribute('data-name'),strPath=getPath(element)+strFileName,templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                <gs-button dialogclose remove-bottom style="border-bottom: 0 none;">Rename File</gs-button>
                <gs-button dialogclose remove-all style="border-bottom: 0 none;">Delete File</gs-button>
                <gs-button dialogclose remove-top>Edit File</gs-button>
                <hr />
                <gs-button dialogclose>Cancel</gs-button>
            </gs-body>
        */});GS.openDialogToElement(target,templateElement,'right','',function(event,strAnswer){if(strAnswer==='Rename File'){fileRename(element,target,strPath,strFileName);}else if(strAnswer==='Delete File'){fileDelete(element,target,strPath,strFileName);}else if(strAnswer==='Edit File'){fileEdit(element,target,strPath,strFileName);}});}
function fileRename(element,target,strOldPath,strFileName){'use strict';var templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                <label for="gs-file-manager-text-file-name">File Name:</label>
                <gs-text id="gs-file-manager-text-file-name"></gs-text>
                <hr />
                <gs-grid>
                    <gs-block><gs-button dialogclose style="border-right: 0 none;" remove-right>Cancel</gs-button></gs-block>
                    <gs-block><gs-button dialogclose remove-left>Rename</gs-button></gs-block>
                </gs-grid>
            </gs-body>
        */});GS.openDialogToElement(target,templateElement,'right',function(){document.getElementById('gs-file-manager-text-file-name').value=strFileName;},function(event,strAnswer){var strNewPath;if(strAnswer==='Rename'){strNewPath=getPath(element)+document.getElementById('gs-file-manager-text-file-name').value;GS.requestFromSocket(GS.envSocket,'FILE\tMOVE\t'+GS.encodeForTabDelimited(strOldPath)+'\t'+
GS.encodeForTabDelimited(strNewPath)+'\n',function(data,error,errorData){if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data==='TRANSACTION COMPLETED'){getData(element);}}else if(error){GS.webSocketErrorDialog(errorData);}});}});}
function fileDelete(element,target,strPath,strFileName){'use strict';var templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                Are you sure you want to delete the file: "<b>{{STRPATH}}</b>"?
                <hr />
                <gs-grid>
                    <gs-block><gs-button dialogclose style="border-right: 0 none;" remove-right>No</gs-button></gs-block>
                    <gs-block><gs-button dialogclose remove-left>Yes</gs-button></gs-block>
                </gs-grid>
            </gs-body>
        */}).replace(/\{\{STRPATH\}\}/gi,strFileName);GS.openDialogToElement(target,templateElement,'right','',function(event,strAnswer){if(strAnswer==='Yes'){GS.requestFromSocket(GS.envSocket,'FILE\tDELETE\t'+GS.encodeForTabDelimited(strPath)+'\n',function(data,error,errorData){if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data==='TRANSACTION COMPLETED'){getData(element);}}else if(error){GS.webSocketErrorDialog(errorData);}});}});}
function fileEdit(element,target,strPath,strFileName){'use strict';window.open('/env/app/all/file_manager/file_edit.html?socket=true&link='+encodeURIComponent(strPath));}
function newFile(element,target){'use strict';var templateElement=document.createElement('template');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('data-max-width','250px');templateElement.innerHTML=ml(function(){/*
            <gs-body padded>
                <label for="gs-file-manager-text-file-name">New File Name:</label>
                <gs-text id="gs-file-manager-text-file-name"></gs-text>
                <hr />
                <gs-grid>
                    <gs-block><gs-button dialogclose style="border-right: 0 none;" remove-right>Cancel</gs-button></gs-block>
                    <gs-block><gs-button dialogclose remove-left>Create</gs-button></gs-block>
                </gs-grid>
            </gs-body>
        */});GS.openDialogToElement(target,templateElement,'down','',function(event,strAnswer){var strPath;var strName=document.getElementById('gs-file-manager-text-file-name').value||'';if(strAnswer==='Create'&&strName){strPath=getPath(element)+strName;if(document.getElementById('gs-file-manager-text-file-name').value.trim()){GS.requestFromSocket(GS.envSocket,'FILE\tCREATE_FILE\t'+GS.encodeForTabDelimited(strPath)+'\n',function(data,error,errorData){if(!error&&data.trim()&&data.indexOf('Failed to get canonical path')===-1){if(data==='TRANSACTION COMPLETED'){getData(element);}}else if(error){GS.webSocketErrorDialog(errorData);}});}}});}
function fileOpen(element,target){'use strict';var lineElement=GS.findParentElement(target,'.file-line');window.open(location.protocol+'//'+location.host+getRealPath(element)+''+lineElement.getAttribute('data-name'));}
function fileUpload(element,target){var templateElement=document.createElement('template');var strHTML;strHTML=ml(function(){/*
            <gs-page>
                <gs-header><center><h3>Upload a File</h3></center></gs-header>
                <gs-body padded>
                    <form class="upload-form" action="/env/upload" method="POST" target="upload_response_gs_folder"
                                enctype="multipart/form-data">
                        <label>File:</label>
                        <gs-text class="upload-file" name="file_content" type="file"></gs-text>
                    */});if(element.hasAttribute('upload-choose-file-name')){strHTML+=ml(function(){/*
                        <br />
                        <label>File Name:</label>
                        <gs-text class="upload-name" disabled autocorrect="off" autocapitalize="off" autocomplete="off" spellcheck="false"></gs-text>
            */});}else{strHTML+=ml(function(){/*
                        <gs-text class="upload-name" hidden></gs-text>
            */});}
strHTML+=ml(function(){/*
                        <input class="upload-path" name="file_name" hidden />
                    </form>
                    <iframe class="upload-frame" name="upload_response_gs_folder" hidden></iframe>
                </gs-body>
                <gs-footer>
                    <gs-grid>
                        <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                        <gs-block><gs-button class="upload-button">Upload File</gs-button></gs-block>
                    </gs-grid>
                </gs-footer>
            </gs-page>
        */});templateElement.innerHTML=strHTML;GS.openDialog(templateElement,function(){var dialog=this,formElement=xtag.query(dialog,'.upload-form')[0],fileControl=xtag.query(dialog,'.upload-file')[0],nameControl=xtag.query(dialog,'.upload-name')[0],pathControl=xtag.query(dialog,'.upload-path')[0],uploadButton=xtag.query(dialog,'.upload-button')[0],responseFrame=xtag.query(dialog,'.upload-frame')[0],strFileExtension;uploadButton.addEventListener('click',function(event){var strFile=fileControl.value,strName=nameControl.value;pathControl.setAttribute('value',getPath(element)+nameControl.value+'.'+strFileExtension);if(strName===''&&strFile===''){GS.msgbox('Error','No values in form. Please fill in the form.','okonly');}else if(strFile===''){GS.msgbox('Error','No file selected. Please select a file using the file input.','okonly');}else if(strName===''){GS.msgbox('Error','No value in file path textbox. Please fill in file name textbox.','okonly');}else{responseFrame.loadListen=true;formElement.submit();GS.addLoader('file-upload','Uploading file...');}});fileControl.addEventListener('change',function(event){var strValue=this.value;strFileExtension=strValue.substring(strValue.lastIndexOf('.')+1);nameControl.removeAttribute('disabled');nameControl.value=strValue.substring(strValue.lastIndexOf('\\')+1,strValue.lastIndexOf('.'))||'filename';nameControl.focus();});nameControl.addEventListener('keydown',function(event){if(event.keyCode===13){GS.triggerEvent('click',uploadButton);}});responseFrame.addEventListener('load',function(event){var strResponseText=responseFrame.contentWindow.document.body.textContent,jsnResponse,strResponse,bolError,strError;if(responseFrame.loadListen===true){try{jsnResponse=JSON.parse(strResponseText);}catch(err){strResponse=strResponseText;}
if(strResponse.trim()==='Upload Succeeded'){GS.closeDialog(dialog,'cancel');}else{if(jsnResponse){if(jsnResponse.stat===true){bolError=false;}else{bolError=true;if(jsnResponse.dat&&jsnResponse.dat.error){strError=jsnResponse.dat.error;}else{strError=jsnResponse.dat;}}}else{bolError=true;strError=strResponse;}
if(!bolError){GS.closeDialog(dialog,'cancel');}else{GS.msgbox('Error',strError,'okonly');}}
getData(element);GS.removeLoader('file-upload');}});});}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);prepareElement(element);bindElement(element);getData(element);}}}
xtag.register('gs-folder',{lifecycle:{inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{},accessors:{},methods:{}});}());window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-font>','<gs-font>','gs-font min-width="${1}">\n'+'    ${0}\n'+'</gs-font>');designRegisterElement('gs-font','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-font.html');window.designElementProperty_GSFONT=function(selectedElement){addProp('Min-Width Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('min-width')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'min-width',this.value);});addProp('Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('media')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'media',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var arrTakenFonts=[];function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var styleElement;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;if(!document.getElementById('gs-dynamic-css')){styleElement=document.createElement('style');styleElement.setAttribute('id','gs-dynamic-css');styleElement.setAttribute('gs-dynamic','');document.head.appendChild(styleElement);}
if(element.getAttribute('min-width')){element.handleMinWidthCSS();}else if(element.getAttribute('media')){element.handleMediaCSS();}}}}
xtag.register('gs-font',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='min-width'){this.handleMinWidthCSS();}else if(strAttrName==='media'){this.handleMediaCSS();}}}},events:{},accessors:{},methods:{handleMinWidthCSS:function(){var strMinWidth=this.getAttribute('min-width'),arrMinWidths,strCSS,i,len,arrClassesToRemove,intContainerID,arrParts,strMedia,strResult;arrClassesToRemove=String(this.classList).match(/font-id-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
strMinWidth=GS.trim(strMinWidth.replace(/\}/g,'').replace(/\s+/g,'').toLowerCase(),';');strMinWidth=strMinWidth.replace(/all/g,'0px').replace(/small|sml/g,'768px').replace(/medium|med/g,'992px').replace(/large|lrg/g,'1200px');arrMinWidths=strMinWidth.split(';');if(arrTakenFonts.indexOf(strMinWidth)===-1){arrTakenFonts.push(strMinWidth);intContainerID=arrTakenFonts.length-1;strCSS='';for(i=0,len=arrMinWidths.length;i<len;i+=1){arrParts=arrMinWidths[i].split('{');strMedia=arrParts[0];strResult=arrParts[1];strCSS+='\n@media (min-width:'+strMedia+') {\n'+'    gs-font.font-id-'+intContainerID+' { font-size:'+strResult+'; }\n'+'}\n';}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* font #'+intContainerID+' */\n'+strCSS;}else{intContainerID=arrTakenFonts.indexOf(strMinWidth);}
this.classList.add('font-id-'+intContainerID);},handleMediaCSS:function(){var strMedia=this.getAttribute('media'),arrMedias,strCSS,i,len,arrClassesToRemove,arrParts,strCurrentMedia,strWidth,intContainerID;arrClassesToRemove=String(this.classList).match(/font-id-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
strMedia=GS.trim(strMedia.trim().replace(/\}/g,'').toLowerCase(),';');strMedia=strMedia.replace(/all/g,'0px').replace(/small|sml/g,'768px').replace(/medium|med/g,'992px').replace(/large|lrg/g,'1200px');arrMedias=strMedia.split(';');if(arrTakenFonts.indexOf(strMedia)===-1){arrTakenFonts.push(strMedia);intContainerID=arrTakenFonts.length-1;strCSS='';for(i=0,len=arrMedias.length;i<len;i+=1){arrParts=arrMedias[i].split('{');strCurrentMedia=arrParts[0].trim()||'all';strWidth=arrParts[1].trim()||'900px';strCSS+='\n@media '+strCurrentMedia+' {\n'+'    gs-font.font-id-'+intContainerID+' '+'{ font-size: '+strWidth+'; }\n'+'}\n';}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* font #'+intContainerID+' */\n'+strCSS;}else{intContainerID=arrTakenFonts.indexOf(strMinWidth);}
this.classList.add('font-id-'+intContainerID);}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-footer>','<gs-footer>','gs-footer>$0</gs-footer>');designRegisterElement('gs-footer','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-page.html');window.designElementProperty_GSFOOTER=function(selectedElement){var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'    <option value="">Visible</option>'+'    <option value="hidden">Invisible</option>'+'    <option value="hide-on-desktop">Invisible at desktop size</option>'+'    <option value="hide-on-tablet">Invisible at tablet size</option>'+'    <option value="hide-on-phone">Invisible at phone size</option>'+'    <option value="show-on-desktop">Visible at desktop size</option>'+'    <option value="show-on-tablet">Visible at tablet size</option>'+'    <option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexContainerProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';xtag.register('gs-footer',{lifecycle:{},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-form>','<gs-form>','gs-form src="${1:test.tpeople}">\n'+'    <template>\n'+'        ${2}\n'+'    </template>\n'+'</gs-form>');designRegisterElement('gs-form','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-form.html');window.designElementProperty_GSFORM=function(selectedElement){addProp('Source',true,'<gs-memo class="target" value="'+encodeHTML(decodeURIComponent(selectedElement.getAttribute('src')||selectedElement.getAttribute('source')||''))+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'src',encodeURIComponent(this.value));});addProp('Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('cols')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'cols',this.value);});addProp('Where',true,'<gs-text class="target" value="'+encodeHTML(decodeURIComponent(selectedElement.getAttribute('where')||''))+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'where',encodeURIComponent(this.value));});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Lock',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('lock')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'lock',this.value);});addProp('Order By',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('ord')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'ord',this.value);});addProp('Limit',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('limit')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'limit',this.value);});addProp('Offset',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('offset')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'offset',this.value);});addProp('Save&nbsp;While&nbsp;Typing',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('save-while-typing'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'save-while-typing',(this.value==='true'),true);});addProp('Suppress<br />"No&nbsp;Record&nbsp;Found"<br />Error',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suppress-no-record-found'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suppress-no-record-found',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Refresh On Querystring Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('refresh-on-querystring-values')||'')+'" mini></gs-text>',function(){this.removeAttribute('refresh-on-querystring-change');return setOrRemoveTextAttribute(selectedElement,'refresh-on-querystring-values',this.value);});addProp('Refresh On Querystring Change',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('refresh-on-querystring-change'))+'" mini></gs-checkbox>',function(){this.removeAttribute('refresh-on-querystring-values');return setOrRemoveBooleanAttribute(selectedElement,'refresh-on-querystring-change',this.value==='true',true);});addFlexContainerProps(selectedElement);addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function triggerAfterUpdate(element){GS.triggerEvent(element,'after_update');if(element.hasAttribute('afterupdate')){new Function(element.getAttribute('afterupdate')).apply(element);}}
function emergencyUpdate(element){if(element.currentSaveAjax){element.currentSaveAjax.abort();}
element.bolCurrentlySaving=false;updateDataWithoutTemplate(element,false);}
function updateData(element,updateElement,strColumn,newValue){var data,parentRecord,strID,strHash,srcParts=GS.templateWithQuerystring(element.getAttribute('src')).split('.'),strSchema=srcParts[0],strObject=srcParts[1],strReturnCols=element.arrColumns.join('\t'),strHashCols=element.lockColumn,updateFrameData,strRoles,strColumns,arrTotalRecords=[];parentRecord=GS.findParentElement(updateElement,'.form-record');strID=parentRecord.getAttribute('data-id');strHash=CryptoJS.MD5(parentRecord.getAttribute('data-'+element.lockColumn)).toString();strRoles='pk\thash\tset';strColumns='id\thash\t'+GS.encodeForTabDelimited(strColumn);updateFrameData=strID+'\t'+strHash+'\t'+GS.encodeForTabDelimited(newValue);updateFrameData=(strRoles+'\n'+strColumns+'\n'+updateFrameData);GS.triggerEvent(element,'before_update');GS.requestUpdateFromSocket(GS.envSocket,strSchema,strObject,strReturnCols,strHashCols,updateFrameData,function(data,error,transactionID){if(error){getData(element);GS.removeLoader(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){GS.removeLoader(element);if(!error){if(data==='TRANSACTION COMPLETED'){commitFunction();}else{var arrRecords,arrCells,i,len,cell_i,cell_len;arrRecords=GS.trim(data,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}}else{rollbackFunction();getData(element);GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){var idIndex,i,len;idIndex=element.lastSuccessData.arr_column.indexOf('id');for(i=0,len=element.lastSuccessData.dat.length;i<len;i+=1){if(String(element.lastSuccessData.dat[i][idIndex])===strID){element.lastSuccessData.dat[i]=arrTotalRecords[0];break;}}
triggerAfterUpdate(element);handleData(element,element.lastSuccessData);GS.triggerEvent(element,'after_update');}else{getData(element);}}else{getData(element);GS.webSocketErrorDialog(data);}});}
function updateDataWithoutTemplate(element,bolErrorHandling){if(element.bolCurrentlySaving===false&&!element.bolErrorOpen){var data,parentRecord,strID,strHash,srcParts=GS.templateWithQuerystring(element.getAttribute('src')).split('.'),strSchema=srcParts[0],strObject=srcParts[1],strReturnCols=element.arrColumns.join('\t'),strHashCols=element.lockColumn,updateFrameData,strRoles,strColumns,arrTotalRecords=[],functionUpdateRecord,col_key,key,strColumn,newValue,idIndex,i,len;functionUpdateRecord=function(strID,strColumn,recordIndex,strParameters){var strWhere,strChangeStamp,strValue;element.bolCurrentlySaving=true;element.jsnUpdate[strID][strColumn]=undefined;removeMessage(element,'waiting');addMessage(element,'saving');element.state='saving';strWhere=GS.qryGetVal(strParameters,'where');strColumn=GS.qryGetVal(strParameters,'column');strValue=GS.qryGetVal(strParameters,'value');strID=GS.qryGetVal(strWhere,'id');strChangeStamp=GS.qryGetVal(strWhere,element.lockColumn);strHash=CryptoJS.MD5(strChangeStamp).toString();strRoles='pk\thash\tset';strColumns='id\thash\t'+GS.encodeForTabDelimited(strColumn);updateFrameData=strID+'\t'+strHash+'\t'+GS.encodeForTabDelimited(strValue);updateFrameData=(strRoles+'\n'+strColumns+'\n'+updateFrameData);console.log(strParameters);console.log(updateFrameData);console.log(strSchema,strObject,strReturnCols,strHashCols);GS.requestUpdateFromSocket(GS.envSocket,strSchema,strObject,strReturnCols,strHashCols,updateFrameData,function(data,error,transactionID){if(error){getData(element);GS.webSocketErrorDialog(data);}},function(data,error,transactionID,commitFunction,rollbackFunction){if(!error){if(data==='TRANSACTION COMPLETED'){commitFunction();}else{var arrRecords,arrCells,i,len,cell_i,cell_len;arrRecords=GS.trim(data,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}}else{rollbackFunction();getData(element);GS.webSocketErrorDialog(data);}},function(strAnswer,data,error){var col_key,key,bolSaveWaiting;removeMessage(element,'saving');element.state='saved';GS.removeLoader(element);if(!error){if(strAnswer==='COMMIT'){element.lastSuccessData.dat[recordIndex]=arrTotalRecords[0];element.bolCurrentlySaving=false;for(key in element.jsnUpdate){for(col_key in element.jsnUpdate[key]){if(element.jsnUpdate[key][col_key]!==undefined){bolSaveWaiting=true;break;}}}
if(bolSaveWaiting){updateDataWithoutTemplate(element);}else{triggerAfterUpdate(element);}}else{getData(element);}}else{GS.webSocketErrorDialog(data);}});};console.log(JSON.stringify(element.jsnUpdate));for(key in element.jsnUpdate){for(col_key in element.jsnUpdate[key]){if(element.jsnUpdate[key][col_key]!==undefined){strID=key;strColumn=col_key;newValue=element.jsnUpdate[key][col_key];idIndex=element.lastSuccessData.arr_column.indexOf('id');for(i=0,len=element.lastSuccessData.dat.length;i<len;i+=1){if(String(element.lastSuccessData.dat[i][idIndex])===strID){functionUpdateRecord(strID,strColumn,i,'where='+encodeURIComponent('id='+strID+'&'+element.lockColumn+'='+GS.envGetCell(element.lastSuccessData,i,element.lockColumn))+'&column='+strColumn+'&value='+encodeURIComponent(newValue));break;}}
break;}}}}}
function getData(element){var strSrc=GS.templateWithQuerystring(element.getAttribute('src')),srcParts=strSrc[0]==='('?[strSrc,'']:strSrc.split('.'),strSchema=srcParts[0],strObject=srcParts[1],strColumns=GS.templateWithQuerystring(element.getAttribute('cols')||'*').split(',').join('\t'),strWhere=GS.templateWithQuerystring(element.getAttribute('where')||''),strOrd=GS.templateWithQuerystring(element.getAttribute('ord')||''),strLimit=GS.templateWithQuerystring(element.getAttribute('limit')||'1'),strOffset=GS.templateWithQuerystring(element.getAttribute('offset')||''),response_i=0,response_len=0,arrTotalRecords=[];GS.triggerEvent(element,'before_select');GS.requestSelectFromSocket(GS.envSocket,strSchema,strObject,strColumns,strWhere,strOrd,strLimit,strOffset,function(data,error){var arrRecords,arrCells,i,len,cell_i,cell_len;if(!error){if(data.strMessage!=='TRANSACTION COMPLETED'){arrRecords=GS.trim(data.strMessage,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}else{element.arrColumns=data.arrColumnNames;handleData(element,{"arr_column":data.arrColumnNames,"dat":arrTotalRecords,"row_count":arrTotalRecords.length},'','load');}}else{GS.webSocketErrorDialog(data);}});}
function handleData(element,data,error,strAction,failCallback){var arrElements,i,len,arrHeaders=[],intColumnElementFocusNumber,jsnSelection,matchElement,templateElement=document.createElement('template'),focusTimerID,focusToElement,timer_i;element.classList.remove('error');if(!error&&data.dat.length===0&&!element.hasAttribute('limit')&&!element.hasAttribute('suppress-no-record-found')){templateElement.setAttribute('data-theme','error');templateElement.innerHTML=ml(function(){/*
                <gs-page>
                    <gs-header><center><h3>Error</h3></center></gs-header>
                    <gs-body padded>
                        <center>No record found</center>
                    </gs-body>
                    <gs-footer>
                        <gs-grid>
                            <gs-block><gs-button dialogclose>Cancel</gs-button></gs-block>
                            <gs-block><gs-button dialogclose listen-for-return bg-primary>Try Again</gs-button></gs-block>
                        </gs-grid>
                    </gs-footer>
                </gs-page>
            */});GS.openDialog(templateElement,'',function(event,strAnswer){if(strAnswer==='Try Again'){element.refresh();}});}
if(!error){element.error=false;element.lastSuccessData=data;if(GS.findParentElement(document.activeElement,'gs-form')===element){arrElements=xtag.query(element,'[column]');matchElement=GS.findParentElement(document.activeElement,'[column]');if(document.activeElement.nodeName==='INPUT'||document.activeElement.nodeName==='TEXTAREA'){jsnSelection=GS.getInputSelection(document.activeElement);}
if(matchElement){for(i=0,len=arrElements.length;i<len;i+=1){if(arrElements[i]===matchElement){intColumnElementFocusNumber=i;break;}}}}
element.innerHTML=dataTemplateRecords(element,data);if(shimmed.HTMLTemplateElement){HTMLTemplateElement.bootstrap(element);}
arrElements=xtag.query(element,'[autofocus]');if(arrElements.length>0&&!evt.touchDevice){arrElements[0].focus();if(arrElements.length>1){console.warn('dialog Warning: Too many [autofocus] elements, defaulting to the first one. Please have only one [autofocus] element per form.');}}
if(intColumnElementFocusNumber){arrElements=xtag.query(element,'[column]');if(arrElements.length>intColumnElementFocusNumber){focusToElement=arrElements[intColumnElementFocusNumber];if(shimmed.registerElement===false){focusToElement.focus();if(jsnSelection){GS.setInputSelection(document.activeElement,jsnSelection.start,jsnSelection.end);}}else{timer_i=0;focusTimerID=setInterval(function(){if(focusToElement.__upgraded__||timer_i>=10){clearTimeout(focusTimerID);}
if(focusToElement.__upgraded__){focusToElement.focus();if(jsnSelection){GS.setInputSelection(document.activeElement,jsnSelection.start,jsnSelection.end);}}
timer_i+=1;},5);}}}
GS.triggerEvent(element,'after_select');}else{element.error=true;element.classList.add('error');element.innerHTML='This form encountered an error.'
GS.ajaxErrorDialog(data);}}
function dataTemplateRecords(element,data){var jsnTemplate,strRet;jsnTemplate=GS.templateHideSubTemplates(element.templateHTML);strRet=GS.templateWithEnvelopeData('<div class="form-record" '+(data.dat.length===1?'style="height: 100%;" ':'')+'data-id="{{! row.id }}" data-'+element.lockColumn+'="{{! row.'+element.lockColumn+' }}" gs-dynamic>'+
jsnTemplate.templateHTML+'</div>',data);strRet=GS.templateShowSubTemplates(strRet,jsnTemplate);return strRet;}
function addMessage(element,strMessageName){if(strMessageName==='saving'){if(element.savingMessage){removeMessage(element,'saving');}
element.savingMessage=document.createElement('div');element.savingMessage.classList.add('message');element.savingMessage.innerHTML='Saving...';element.appendChild(element.savingMessage);}else if(strMessageName==='waiting'){if(element.waitingMessage){removeMessage(element,'waiting');}
element.waitingMessage=document.createElement('div');element.waitingMessage.classList.add('message');element.waitingMessage.innerHTML='Waiting<br />to save...';element.appendChild(element.waitingMessage);}}
function removeMessage(element,strMessageName){if(strMessageName==='saving'&&element.savingMessage){element.removeChild(element.savingMessage);element.savingMessage=undefined;}else if(strMessageName==='waiting'&&element.waitingMessage){element.removeChild(element.waitingMessage);element.waitingMessage=undefined;}}
function columnParentsUntilForm(form,element){var intColumnParents=0,currentElement=element,maxLoops=50,i=0;while(currentElement.parentNode!==form&&currentElement.parentNode&&i<maxLoops){if(currentElement.parentNode.hasAttribute('column')===true){intColumnParents+=1;}
currentElement=currentElement.parentNode;i+=1;}
return intColumnParents;}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var arrPopKeys;var currentValue;var bolRefresh;var strOperator;if(strQSCol){if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){console.log(element.getAttribute('value'));if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('where','id='+(isNaN(strQSValue)?'$WHEREQuoTE$'+strQSValue+'$WHEREQuoTE$':strQSValue));bolRefresh=true;}}else{element.setAttribute('where','id='+(isNaN(strQSValue)?'$WHEREQuoTE$'+strQSValue+'$WHEREQuoTE$':strQSValue));bolRefresh=true;}}}
if(element.internal.bolQSFirstRun===true){if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){currentValue=GS.qryGetVal(strQS,arrPopKeys[i]);if(element.popValues[arrPopKeys[i]]!==currentValue){bolRefresh=true;}
element.popValues[arrPopKeys[i]]=currentValue;}}else if(element.hasAttribute('refresh-on-querystring-change')){bolRefresh=true;}}else{if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){element.popValues[arrPopKeys[i]]=GS.qryGetVal(strQS,arrPopKeys[i]);}}
if(GS.getQueryString()||element.hasAttribute('refresh-on-querystring-change')||element.hasAttribute('src')){bolRefresh=true;}}
if(bolRefresh&&element.hasAttribute('src')){getData(element);}else if(bolRefresh&&!element.hasAttribute('src')){console.warn('gs-combo Warning: element has "refresh-on-querystring-values" or "refresh-on-querystring-change", but no "src".',element);}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);var
firstChildElement=element.children[0],strQueryString=GS.getQueryString(),changeHandler;if(element.hasAttribute('save-while-typing')){GS.addBeforeUnloadEvent(function(){if(element.bolCurrentlySaving||element.saveTimerID){return'The page has not finished saving.';}});}else{GS.addBeforeUnloadEvent(function(){document.activeElement.blur();});}
element.lockColumn=element.getAttribute('lock')||'change_stamp';if(firstChildElement.nodeName==='TEMPLATE'){element.templateHTML=firstChildElement.innerHTML;}else{console.warn('Warning: gs-form is now built to use a template element. '+'Please use a template element to contain the template for this form. '+'A fix has been included so that it is not necessary to use the template element, but that code may be removed at a future date.');element.templateHTML=element.innerHTML;}
if(!element.templateHTML.trim()){throw'GS-FORM error: no template HTML.';}
element.templateHTML=GS.templateColumnToValue(element.templateHTML);if(element.getAttribute('qs')||element.getAttribute('refresh-on-querystring-values')||element.hasAttribute('refresh-on-querystring-change')){element.popValues={};pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}else{getData(element);}
element.addEventListener('keydown',function(event){var intKeyCode=event.which||event.keyCode,jsnSelection;if(document.activeElement.nodeName==='INPUT'||document.activeElement.nodeName==='TEXTAREA'){jsnSelection=GS.getInputSelection(event.target);}
if((intKeyCode===37&&(!jsnSelection||jsnSelection.start===0))||(intKeyCode===39&&(!jsnSelection||jsnSelection.end===event.target.value.length))){var focusToElement,i,len,arrElementsFocusable,currentElement;if(intKeyCode===37&&(!jsnSelection||jsnSelection.start===0)){arrElementsFocusable=xtag.query(document,'input:not([disabled]), '+'select:not([disabled]), memo:not([disabled]), button:not([disabled]), '+'[tabindex]:not([disabled]), [column]');for(i=0,len=arrElementsFocusable.length;i<len;i++){currentElement=arrElementsFocusable[i];if(currentElement===event.target||((event.target.nodeName==='INPUT'||event.target.nodeName==='TEXTAREA')&&currentElement===event.target.parentNode)){if(i===0){focusToElement=currentElement;}else{focusToElement=arrElementsFocusable[i-1];}
break;}}}else if(intKeyCode===39&&(!jsnSelection||jsnSelection.end===event.target.value.length)){arrElementsFocusable=xtag.query(document,'input:not([disabled]), '+'select:not([disabled]), memo:not([disabled]), button:not([disabled]), '+'[tabindex]:not([disabled]), [column]');for(i=0,len=arrElementsFocusable.length;i<len;i++){currentElement=arrElementsFocusable[i];if(currentElement===event.target){if(i===len){focusToElement=currentElement;}else{focusToElement=arrElementsFocusable[i+1];}
break;}}}
if(focusToElement&&GS.isElementFocusable(focusToElement)){event.preventDefault();focusToElement.focus();if(document.activeElement.nodeName==='INPUT'||document.activeElement.nodeName==='TEXTAREA'){GS.setInputSelection(document.activeElement,0,document.activeElement.value.length);}}}});if(element.hasAttribute('save-while-typing')){element.bolCurrentlySaving=false;element.jsnUpdate={};element.state='saved';changeHandler=function(event){var intKeyCode=event.which||event.keyCode,newValue,targetColumnParent=GS.findParentElement(event.target,'[column]'),parentRecordElement,strID;if(targetColumnParent.getAttribute('column')&&columnParentsUntilForm(element,targetColumnParent)===0&&element.column(targetColumnParent.getAttribute('column'))!==targetColumnParent.value){if(element.saveTimerID){clearTimeout(element.saveTimerID);element.saveTimerID=undefined;}
addMessage(element,'waiting');element.state='waiting to save';if(targetColumnParent.value!==null&&targetColumnParent.value!==null){newValue=targetColumnParent.value;}else{newValue=targetColumnParent.checked;}
parentRecordElement=GS.findParentElement(targetColumnParent,'.form-record[data-id]');strID=parentRecordElement.getAttribute('data-id');if(!element.jsnUpdate[strID]){element.jsnUpdate[strID]=element.jsnUpdate[strID]={};}
element.jsnUpdate[strID][targetColumnParent.getAttribute('column')]=newValue;element.saveTimerID=setTimeout(function(){updateDataWithoutTemplate(element);element.saveTimerID=undefined;},300);}};element.addEventListener('keydown',changeHandler);element.addEventListener('keyup',changeHandler);element.addEventListener('change',changeHandler);}else{element.addEventListener('change',function(event){var newValue;if(event.target.getAttribute('column')&&columnParentsUntilForm(element,event.target)===0&&GS.findParentTag(event.target,'gs-form')===element){if(event.target.value!==null){newValue=event.target.value;}else{newValue=event.target.checked;}
updateData(element,event.target,event.target.getAttribute('column'),newValue);}});}}}}
xtag.register('gs-form',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}},removed:function(){if(this.hasAttribute('save-while-typing')&&this.saveTimerID){clearTimeout(this.saveTimerID);emergencyUpdate(this);}}},events:{},accessors:{},methods:{refresh:function(){getData(this);},column:function(strColumn){return GS.envGetCell(this.lastSuccessData,0,strColumn);},addMessage:function(strMessageName){return addMessage(this,strMessageName);},removeMessage:function(strMessageName){return removeMessage(this,strMessageName);}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-grid>','<gs-grid>','gs-grid widths="${1}">\n'+'    <gs-block>${2}</gs-block>\n'+'</gs-grid>');designRegisterElement('gs-grid','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-grid.html');window.designElementProperty_GSGRID=function(selectedElement){addProp('Min-Width Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('min-width')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'min-width',this.value);});addProp('Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('media')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'media',this.value);});addProp('Widths',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('widths')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'widths',this.value);});addProp('Padded',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('padded'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'padded',(this.value==='true'),true);});addProp('Gutters',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('gutter'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'gutter',(this.value==='true'),true);});addProp('Reflow At',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('reflow-at')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'reflow-at',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-block>','<gs-block>','gs-block>${2}</gs-block>');designRegisterElement('gs-block','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-grid.html');window.designElementProperty_GSBLOCK=function(selectedElement){addProp('Width:',true,'<gs-text class="target" value="'+(selectedElement.getAttribute('width')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'width',this.value);});addProp('Title',true,'<gs-text class="target" value="'+(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexContainerProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var arrTakenGrids=[];function handleObserver(element){var observer=new MutationObserver(function(mutations){element.handleBlocks();});observer.observe(element,{childList:true});}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){handleObserver(element);}}
function elementInserted(element){var styleElement;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;if(!document.getElementById('gs-dynamic-css')){styleElement=document.createElement('style');styleElement.setAttribute('id','gs-dynamic-css');styleElement.setAttribute('gs-dynamic','');document.head.appendChild(styleElement);}
if(!element.getAttribute('widths')&&!element.getAttribute('min-width')&&!element.getAttribute('media')){element.bolIgnoreAttribute=true;element.setAttribute('widths',new Array(xtag.queryChildren(element,'gs-block').length+1).join('1').split('').join(','));element.bolIgnoreAttribute=false;}
element.handleCSS();element.handleBlocks();}}}
xtag.register('gs-grid',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='widths'&&this.bolIgnoreAttribute!==true){this.handleCSS();this.handleBlocks();}else if(strAttrName==='reflow-at'){this.handleCSS();}else if(strAttrName==='min-width'){this.handleCSS();this.handleBlocks();}else if(strAttrName==='media'){this.handleCSS();this.handleBlocks();}}}},events:{},accessors:{},methods:{getWidthsParameters:function(strWidths){var arrWidths,intGridWidth,i,len;arrWidths=strWidths.replace(/[^0-9,]/gim,'').replace(/,{1,}/gim,',').replace(/^,|,$/gim,'').split(',');if(arrWidths.length===0){throw'gs-grid Error: no valid widths found. Please put a comma seperated list of widths in the "widths" attribute.';}
for(i=0,len=arrWidths.length;i<len;i+=1){arrWidths[i]=parseInt(arrWidths[i],10);}
for(i=0,len=arrWidths.length,intGridWidth=0;i<len;i+=1){intGridWidth+=arrWidths[i];}
return{'arrWidths':arrWidths,'intGridWidth':intGridWidth};},handleCSS:function(){var jsnWidthsParameters;if(this.getAttribute('widths')){jsnWidthsParameters=this.getWidthsParameters(this.getAttribute('widths'));this.handleWidthsCSS(jsnWidthsParameters.arrWidths,jsnWidthsParameters.intGridWidth);}else if(this.getAttribute('min-width')){this.handleMinWidthCSS();}else if(this.getAttribute('media')){this.handleMediaCSS();}},handleBlocks:function(){var jsnWidthsParameters;if(this.getAttribute('widths')){jsnWidthsParameters=this.getWidthsParameters(this.getAttribute('widths'));this.handleWidthsBlocks(jsnWidthsParameters.arrWidths,jsnWidthsParameters.intGridWidth);}else if(this.getAttribute('min-width')){this.handleMinWidthBlocks();}else if(this.getAttribute('media')){this.handleMediaBlocks();}},handleWidthsCSS:function(arrWidths,intGridWidth){var styleElement=document.getElementById('gs-dynamic-css'),i,len,strCurrentWidth,intCurrentWidth,widthIncreaseAmount,strCSS,strReflowAt=this.getAttribute('reflow-at')||'',arrClassesToRemove;strReflowAt=strReflowAt.replace(/small|sml/g,'992px');strReflowAt=strReflowAt.replace(/medium|med/g,'1200px');strReflowAt=strReflowAt.replace(/large|lrg/g,'10000px');arrClassesToRemove=String(this.classList).match(/width-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
if(!styleElement.classList.contains('col-'+intGridWidth)){widthIncreaseAmount=100/intGridWidth;for(i=0,len=intGridWidth,intCurrentWidth=0,strCSS='';i<len;i+=1){intCurrentWidth+=widthIncreaseAmount;strCurrentWidth=String(parseFloat(intCurrentWidth.toFixed(5).toString(),10));strCSS+='gs-grid.width-'+intGridWidth+' > gs-block[width="'+(i+1)+'"] { width: '+strCurrentWidth+'%; }\n';}
styleElement.classList.add('col-'+intGridWidth);styleElement.innerHTML+='\n/* grid width: '+intGridWidth+' */\n'+
strCSS+'gs-grid.width-'+intGridWidth+' > gs-block.first-of-row { padding-left: 0; }\n'+'gs-grid.width-'+intGridWidth+' > gs-block.last-of-row { padding-right: 0; }\n';}
this.classList.remove('reflow-'+this.strReflowAt);strReflowAt=strReflowAt.replace(/[^0-9a-z]/gi,'');if(strReflowAt){if(strReflowAt.replace(/[0-9]/gi,'')===''){strReflowAt+='px';}
this.strReflowAt=strReflowAt;this.classList.add('reflow-'+strReflowAt);if(!styleElement.classList.contains('reflow-'+strReflowAt)){styleElement.classList.add('reflow-'+strReflowAt);styleElement.innerHTML+='\n/* grid reflow width: '+strReflowAt+' */\n'+'@media only all and (max-width: '+strReflowAt+') {\n'+'    gs-grid.reflow-'+strReflowAt+'            { width: 100%; }\n'+'    gs-grid.reflow-'+strReflowAt+' > gs-block { width: auto !important; float: none; }\n'+'    gs-grid.reflow-'+strReflowAt+' > gs-block { padding-left: 0 !important; padding-right: 0 !important; }\n'+'}\n';}}
this.classList.add('width-'+intGridWidth);},handleMinWidthCSS:function(){var strMinWidth=this.getAttribute('min-width'),arrMinWidths,strCSS,strCurrentCSS,i,len,arrParts,strWidth,strResult,intCurrentGridID,bolMedia,intCurrentWidth,strCurrentWidth,intGridWidth,widthIncreaseAmount,grid_i,grid_len,intLayout,arrArrGridWidths,column_i,column_len,arrWidths=[],width_i,strNextWidth;strMinWidth=strMinWidth.replace(/\s+/g,'');strMinWidth=strMinWidth.replace(/\}/g,'');strMinWidth=strMinWidth.toLowerCase();strMinWidth=GS.trim(strMinWidth,';');strMinWidth=strMinWidth.replace(/all/g,'0px');strMinWidth=strMinWidth.replace(/small|sml/g,'768px');strMinWidth=strMinWidth.replace(/medium|med/g,'992px');strMinWidth=strMinWidth.replace(/large|lrg/g,'1200px');arrMinWidths=strMinWidth.split(';');if(arrTakenGrids.indexOf(strMinWidth)===-1){arrTakenGrids.push(strMinWidth);intCurrentGridID=arrTakenGrids.length-1;strCSS='';arrArrGridWidths=[];for(i=0,len=arrMinWidths.length,intLayout=0;i<len;i+=1){arrParts=arrMinWidths[i].split('{');strWidth=arrParts[0]||'0px';strResult=arrParts[1]||new Array(xtag.queryChildren(element,'gs-block').length+1).join('1').split('').join(',');bolMedia=parseInt(strWidth)>0;strCurrentCSS='';if(strResult==='reflow'){intLayout+=1;arrArrGridWidths.push('reflow');strCurrentCSS+='    gs-grid.grid-id-'+intCurrentGridID+'            { width: 100%; }\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.reflow-layout-'+intLayout+' { width: auto; float: none; }\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.reflow-layout-'+intLayout+' { padding-left: 0; padding-right: 0; }\n';}else{intLayout+=1;arrArrGridWidths.push(strResult.split(','));intGridWidth=this.getWidthsParameters(strResult).intGridWidth;widthIncreaseAmount=100/intGridWidth;for(grid_i=0,grid_len=intGridWidth,intCurrentWidth=0;grid_i<grid_len;grid_i+=1){intCurrentWidth+=widthIncreaseAmount;strCurrentWidth=String(parseFloat(intCurrentWidth.toFixed(5).toString(),10));strCurrentCSS+='    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.width-'+(grid_i+1)+'-layout-'+intLayout+' { '+'width: '+strCurrentWidth+'%; float: left; '+'}\n';}
strCurrentCSS='    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.clearfix-layout-'+intLayout+' { clear: left; }\n\n'+'    gs-grid.grid-id-'+intCurrentGridID+'[gutter] > gs-block { padding-left: 0.5em; padding-right: 0.5em; }\n\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.first-of-row-layout-'+intLayout+' { padding-left: 0; }\n\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.last-of-row-layout-'+intLayout+' { padding-right: 0; }\n\n'+
strCurrentCSS;}
strNextWidth='';if(arrMinWidths[i+1]){strNextWidth=arrMinWidths[i+1].split('{')[0];strNextWidth=(parseInt(strNextWidth)-1)+strNextWidth.replace(/[0-9]/g,'');}
strCurrentCSS='\n@media (min-width:'+strWidth+')'+(strNextWidth?' and (max-width:'+strNextWidth+')':'')+' {\n'+
strCurrentCSS+'}\n';strCSS+=strCurrentCSS;}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* grid #'+intCurrentGridID+' */\n'+strCSS;}else{intCurrentGridID=arrTakenGrids.indexOf(strMinWidth);arrArrGridWidths=[];for(i=0,len=arrMinWidths.length,intLayout=0;i<len;i+=1){arrParts=arrMinWidths[i].split('{');strWidth=arrParts[0]||'0px';strResult=arrParts[1]||new Array(xtag.queryChildren(element,'gs-block').length+1).join('1').split('').join(',');intLayout+=1;if(strResult!=='reflow'){arrArrGridWidths.push(strResult.split(','));}else{arrArrGridWidths.push('reflow');}}}
this.intLayouts=intLayout;this.arrArrWidths=arrArrGridWidths;for(i=0,len=this.arrArrWidths.length;i<len;i+=1){if(this.arrArrWidths[i]!=='reflow'){arrWidths.push(0);width_i=arrWidths.length-1;for(column_i=0,column_len=this.arrArrWidths[i].length;column_i<column_len;column_i+=1){this.arrArrWidths[i][column_i]=parseInt(this.arrArrWidths[i][column_i],10);arrWidths[width_i]+=1;}}else{arrWidths.push('reflow');}}
this.arrWidths=arrWidths;this.classList.add('grid-id-'+intCurrentGridID);},handleMediaCSS:function(){var strMinWidth=this.getAttribute('media'),arrMinWidths,strCSS,strCurrentCSS,i,len,arrParts,strMedia,strResult,intCurrentGridID,bolMedia,intCurrentWidth,strCurrentWidth,intGridWidth,widthIncreaseAmount,grid_i,grid_len,intLayout,arrArrGridWidths,column_i,column_len,arrWidths=[],width_i;strMinWidth=strMinWidth.trim().replace(/\}/g,'');strMinWidth=strMinWidth.toLowerCase();strMinWidth=GS.trim(strMinWidth,';');strMinWidth=strMinWidth.replace(/small|sml/g,'768px');strMinWidth=strMinWidth.replace(/medium|med/g,'992px');strMinWidth=strMinWidth.replace(/large|lrg/g,'1200px');arrMinWidths=strMinWidth.split(';');if(arrTakenGrids.indexOf(strMinWidth)===-1){arrTakenGrids.push(strMinWidth);intCurrentGridID=arrTakenGrids.length-1;strCSS='';arrArrGridWidths=[];for(i=0,len=arrMinWidths.length,intLayout=0;i<len;i+=1){arrParts=arrMinWidths[i].split('{');strMedia=arrParts[0].trim()||'all';strResult=arrParts[1].trim()||new Array(xtag.queryChildren(element,'gs-block').length+1).join('1').split('').join(',');strCurrentCSS='';if(strResult==='reflow'){intLayout+=1;arrArrGridWidths.push('reflow');strCurrentCSS+='    gs-grid.grid-id-'+intCurrentGridID+'            { width: 100%; }\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.reflow-layout-'+intLayout+' { width: auto; float: none; }\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.reflow-layout-'+intLayout+' { padding-left: 0; padding-right: 0; }\n';}else{intLayout+=1;arrArrGridWidths.push(strResult.split(','));intGridWidth=this.getWidthsParameters(strResult).intGridWidth;widthIncreaseAmount=100/intGridWidth;for(grid_i=0,grid_len=intGridWidth,intCurrentWidth=0;grid_i<grid_len;grid_i+=1){intCurrentWidth+=widthIncreaseAmount;strCurrentWidth=String(parseFloat(intCurrentWidth.toFixed(5).toString(),10));strCurrentCSS+='    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.width-'+(grid_i+1)+'-layout-'+intLayout+' { '+'width: '+strCurrentWidth+'%; float: left; '+'}\n';}
strCurrentCSS='    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.clearfix-layout-'+intLayout+' { clear: left; }\n\n'+'    gs-grid.grid-id-'+intCurrentGridID+'[gutter] > gs-block { padding-left: 0.5em; padding-right: 0.5em; }\n\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.first-of-row-layout-'+intLayout+' { padding-left: 0; }\n\n'+'    gs-grid.grid-id-'+intCurrentGridID+' > gs-block.last-of-row-layout-'+intLayout+' { padding-right: 0; }\n\n'+
strCurrentCSS;}
strCurrentCSS='\n@media '+strMedia+' {\n'+
strCurrentCSS+'}\n';strCSS+=strCurrentCSS;}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* grid #'+intCurrentGridID+' */\n'+strCSS;}else{intCurrentGridID=arrTakenGrids.indexOf(strMinWidth);arrArrGridWidths=[];for(i=0,len=arrMinWidths.length,intLayout=0;i<len;i+=1){arrParts=arrMinWidths[i].split('{');strWidth=arrParts[0]||'0px';strResult=arrParts[1]||new Array(xtag.queryChildren(element,'gs-block').length+1).join('1').split('').join(',');intLayout+=1;if(strResult!=='reflow'){arrArrGridWidths.push(strResult.split(','));}else{arrArrGridWidths.push('reflow');}}}
this.intLayouts=intLayout;this.arrArrWidths=arrArrGridWidths;for(i=0,len=this.arrArrWidths.length;i<len;i+=1){if(this.arrArrWidths[i]!=='reflow'){arrWidths.push(0);width_i=arrWidths.length-1;for(column_i=0,column_len=this.arrArrWidths[i].length;column_i<column_len;column_i+=1){this.arrArrWidths[i][column_i]=parseInt(this.arrArrWidths[i][column_i],10);arrWidths[width_i]+=1;}}else{arrWidths.push('reflow');}}
this.arrWidths=arrWidths;this.classList.add('grid-id-'+intCurrentGridID);},handleWidthsBlocks:function(arrWidths,intGridWidth){var i,len,unset_i,arrElements,intNumberOfWidths=arrWidths.length,intCurrentRowWidth=0,intNextToAdd;arrElements=xtag.queryChildren(this,'gs-block[width]');for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].initallySet=true;}
arrElements=xtag.queryChildren(this,'gs-block');for(i=0,unset_i=0,len=arrElements.length;i<len;i+=1){intNextToAdd=parseInt(arrElements[i].getAttribute('width'),10)||arrWidths[unset_i%intNumberOfWidths];if(!arrElements[i].initallySet){arrElements[i].removeAttribute('width');}
arrElements[i].classList.remove('first-of-row');arrElements[i].classList.remove('last-of-row');arrElements[i].style.clear='';if(intCurrentRowWidth===0){arrElements[i].style.clear='left';arrElements[i].classList.add('first-of-row');}
if((intCurrentRowWidth+intNextToAdd)===intGridWidth){arrElements[i].classList.add('last-of-row');}
if(!arrElements[i].hasAttribute('width')){arrElements[i].setAttribute('width',arrWidths[unset_i%intNumberOfWidths]);unset_i+=1;}
intCurrentRowWidth+=intNextToAdd;intCurrentRowWidth=intCurrentRowWidth%intGridWidth;}},iterateBlocks:function(intLayouts,arrArrWidths,arrIntGridWidth){var arrBlocks=xtag.queryChildren(this,'gs-block'),i,len,block_i,block_len,width_i;for(i=0,len=intLayouts;i<len;i+=1){width_i=0;if(arrArrWidths[i]!=='reflow'){for(block_i=0,block_len=arrBlocks.length;block_i<block_len;block_i+=1){if(width_i===0){arrBlocks[block_i].classList.add('clearfix-layout-'+(i+1));arrBlocks[block_i].classList.add('first-of-row-layout-'+(i+1));}else if((width_i+1)===arrIntGridWidth[i]){arrBlocks[block_i].classList.add('last-of-row-layout-'+(i+1));}
arrBlocks[block_i].classList.add('width-'+arrArrWidths[i][width_i]+'-layout-'+(i+1));width_i+=1;width_i=width_i%arrIntGridWidth[i];}}else{for(block_i=0,block_len=arrBlocks.length;block_i<block_len;block_i+=1){arrBlocks[block_i].classList.add('reflow-layout-'+(i+1));}}}},handleMinWidthBlocks:function(){this.iterateBlocks(this.intLayouts,this.arrArrWidths,this.arrWidths);},handleMediaBlocks:function(){this.iterateBlocks(this.intLayouts,this.arrArrWidths,this.arrWidths);}}});xtag.register('gs-block',{lifecycle:{},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){window.designElementProperty_GSGROUP=function(selectedElement){addProp('Padded',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('padded')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'padded',this.value==='true',true);});};});document.addEventListener("DOMContentLoaded",function(){"use strict";function buildElement(element){var rootBox=document.createElement("div");var innerBox=document.createElement("gs-groupborder");var titleBox=document.createElement("gs-grouptitle");var arrElements=xtag.toArray(element.childNodes);var i=0;var len=arrElements.length;while(i<len){innerBox.appendChild(arrElements[i]);i+=1;}
titleBox.textContent=element.getAttribute("name");rootBox.classList.add("root");rootBox.setAttribute("flex-vertical","");rootBox.setAttribute("flex-fill","");innerBox.setAttribute("flex","");innerBox.setAttribute("gs-dynamic","");titleBox.setAttribute("gs-dynamic","");rootBox.appendChild(innerBox);rootBox.appendChild(titleBox);element.appendChild(rootBox);}
function elementInserted(element){if(!element.hasAttribute("suspend-created")&&!element.hasAttribute("suspend-inserted")){if(!element.inserted){element.inserted=true;if(!element.children[0].classList.contains('root')){buildElement(element);}}}}
xtag.register("gs-groupborder",{});xtag.register("gs-grouptitle",{});xtag.register("gs-group",{lifecycle:{inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==="suspend-created"&&newValue===null){elementInserted(element);}else if(strAttrName==="suspend-inserted"&&newValue===null){elementInserted(element);}}},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('Centered Header','<gs-header>','<gs-header><center><h3>$0</h3></center></gs-header>');registerDesignSnippet('Header','<gs-header>','<gs-header><h3>$0</h3></gs-header>');registerDesignSnippet('<gs-header>','<gs-header>','gs-header><h3>$0</h3></gs-header>');designRegisterElement('gs-header','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-page.html');window.designElementProperty_GSHEADER=function(selectedElement){addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexContainerProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){xtag.register('gs-header',{lifecycle:{/*inserted: function () {
                if (this.border_line) {
                    this.removeChild(this.border_line);
                }
                
                this.border_line = document.createElement('div');
                this.border_line.classList.add('border-line');
                this.border_line.setAttribute('gs-dynamic', '');
                
                this.appendChild(this.border_line);
            },
            removed: function () {
                if (this.border_line.parentNode === this) {
                    this.removeChild(this.border_line);
                }
            }*/},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-img>','<gs-img>','gs-img src="${1}"></gs-img>');designRegisterElement('gs-img','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-image.html');window.designElementProperty_GSIMG=function(selectedElement){addProp('Min-Width Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('min-width')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'min-width',this.value);});addProp('Media',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('media')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'media',this.value);});addProp('Source',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('src')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'src',this.value);});addProp('Alignment',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('align')||'')+'" mini>'+'    <option value="left">Left</option>'+'    <option value="">Center</option>'+'    <option value="right">Right</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'align',this.value);});addProp('Image Cover',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('image-cover')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'image-cover',this.value==='true',true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var arrTakenlayouts=[];function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var styleElement;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;if(!document.getElementById('gs-dynamic-css')){styleElement=document.createElement('style');styleElement.setAttribute('id','gs-dynamic-css');styleElement.setAttribute('gs-dynamic','');document.head.appendChild(styleElement);}
element.handleSrc();if(element.getAttribute('min-width')){element.handleMinWidthCSS();}else if(element.getAttribute('media')){element.handleMediaCSS();}}}}
xtag.register('gs-img',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='min-width'){this.handleMinWidthCSS();}else if(strAttrName==='media'){this.handleMediaCSS();}else if(strAttrName==='src'){this.handleSrc();}}}},events:{},accessors:{},methods:{handleSrc:function(){var strSrc=this.getAttribute('src');if(strSrc){this.style.backgroundImage='url("'+strSrc+'")';}else{this.style.backgroundImage='';}},handleMinWidthCSS:function(){var strMinWidth=this.getAttribute('min-width'),arrLayouts,strCSS,strCurrentMinWidth,i,len,arrClassesToRemove,intImageID,arrParts,strDimensions,strWidth,strHeight;arrClassesToRemove=String(this.classList).match(/image-id-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
strMinWidth=GS.trim(strMinWidth.replace(/\s+/g,'').replace(/\}/g,'').toLowerCase(),';');strMinWidth=strMinWidth.replace(/all/g,'0px').replace(/small|sml/g,'768px').replace(/medium|med/g,'992px').replace(/large|lrg/g,'1200px');arrLayouts=strMinWidth.split(';');if(arrTakenlayouts.indexOf(strMinWidth)===-1){arrTakenlayouts.push(strMinWidth);intImageID=arrTakenlayouts.length-1;strCSS='';for(i=0,len=arrLayouts.length;i<len;i+=1){arrParts=arrLayouts[i].split('{');strCurrentMinWidth=arrParts[0]||'0px';strDimensions=arrParts[1];if(strDimensions.indexOf(',')===-1){strWidth=strDimensions;strHeight=strDimensions;}else{arrParts=strDimensions.split(',');strWidth=arrParts[0];strHeight=arrParts[1];}
strCSS+='\n@media (min-width:'+strCurrentMinWidth+') {\n'+'    gs-img.image-id-'+intImageID+' { width:'+strWidth+'; height: '+strHeight+'; }\n'+'}\n';}
document.getElementById('gs-dynamic-css').innerHTML+='\n/* image #'+intImageID+' */\n'+strCSS;}else{intImageID=arrTakenlayouts.indexOf(strMinWidth);}
this.classList.add('image-id-'+intImageID);},handleMediaCSS:function(){var strMedia=this.getAttribute('media'),arrLayouts,strCSS,i,len,arrClassesToRemove,arrParts,strCurrentMedia,strWidth,intImageID,arrParts,strCurrentMedia,strDimensions,strWidth,strHeight;arrClassesToRemove=String(this.classList).match(/image-id-[0-9]*/g)||[];for(i=0,len=arrClassesToRemove.length;i<len;i+=1){this.classList.remove(arrClassesToRemove[i]);}
strMedia=GS.trim(strMedia.trim().replace(/\}/g,'').toLowerCase(),';');strMedia=strMedia.replace(/small|sml/g,'768px').replace(/medium|med/g,'992px').replace(/large|lrg/g,'1200px');arrLayouts=strMedia.split(';');if(arrTakenlayouts.indexOf(strMedia)===-1){arrTakenlayouts.push(strMedia);intImageID=arrTakenlayouts.length-1;strCSS='';for(i=0,len=arrLayouts.length;i<len;i+=1){arrParts=arrLayouts[i].split('{');strCurrentMedia=arrParts[0].trim()||'all';strDimensions=arrParts[1].trim();if(strDimensions.indexOf(',')===-1){strWidth=strDimensions;strHeight=strDimensions;}else{arrParts=strDimensions.split(',');strWidth=arrParts[0];strHeight=arrParts[1];}
strCSS+='\n@media '+strCurrentMedia+' {\n'+'    gs-img.image-id-'+intImageID+' { width:'+strWidth+'; height: '+strHeight+'; }\n'+'}\n';}
console.log(strCSS);document.getElementById('gs-dynamic-css').innerHTML+='\n/* image #'+intImageID+' */\n'+strCSS;}else{intImageID=arrTakenlayouts.indexOf(strMinWidth);}
this.classList.add('image-id-'+intImageID);}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-insert>','<gs-insert>','gs-insert src="${1:test.tpeople}">\n'+'    ${2}\n'+'</gs-insert>');designRegisterElement('gs-insert','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-insert.html');window.designElementProperty_GSINSERT=function(selectedElement){addProp('Source&nbsp;Query',true,'<gs-memo rows="1" autoresize class="target" value="'+encodeHTML(selectedElement.getAttribute('src')||selectedElement.getAttribute('source')||'')+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'src',this.value);});addProp('Additional&nbsp;Values',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('addin')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'addin',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Primary Keys',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('pk')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'pk',this.value);});addProp('Sequences',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('seq')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'seq',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexContainerProps(selectedElement);addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';xtag.register('gs-insert',{lifecycle:{},events:{},accessors:{},methods:{submit:function(callback){var element=this,srcParts=GS.templateWithQuerystring(element.getAttribute('src')||'').split('.'),strSchema=srcParts[0],strObject=srcParts[1],strSeqCols,strPkCols,strAddIn,strColumns='',strResponseColumns,strInsertRecord='',strInsertData,arrElement,arrKey,arrValue,i,len,strResponse,parentSrcElement;strAddIn=GS.templateWithQuerystring(element.getAttribute('addin'));if(strAddIn){arrKey=GS.qryGetKeys(strAddIn);arrValue=GS.qryGetKeys(strAddIn);for(i=0,len=arrKey.length;i<len;i+=1){strColumns+=(strColumns?'\t':'')+GS.encodeForTabDelimited(arrKey[i]);strInsertRecord+=(strInsertRecord?'\t':'')+GS.encodeForTabDelimited(arrValue[i]);}}
arrElement=xtag.query(element,'[column]');for(i=0,len=arrElement.length;i<len;i+=1){parentSrcElement=GS.findParentElement(arrElement[i].parentNode,'[src]');if(parentSrcElement===element&&(arrElement[i].value!==undefined&&arrElement[i].value!==null&&arrElement[i].value!=='')){strColumns+=(strColumns?'\t':'')+GS.encodeForTabDelimited(arrElement[i].getAttribute('column'));strInsertRecord+=(strInsertRecord?'\t':'')+GS.encodeForTabDelimited(arrElement[i].value);}}
strPkCols=GS.templateWithQuerystring(element.getAttribute('pk')||'id');strSeqCols=GS.templateWithQuerystring(element.getAttribute('seq')||'');strInsertData=(strColumns+'\n'+strInsertRecord);strResponseColumns=(strPkCols+(strPkCols?'\t':'')+strColumns);GS.requestInsertFromSocket(GS.envSocket,strSchema,strObject,strResponseColumns,strPkCols,strSeqCols,strInsertData,function(){},function(data,error,transactionID,commitFunction,rollbackFunction){var arrCells,i,len,arrElements,jsnSelection,focusElement,focusColumnParent,focusColumnParentIndex;if(data!=='TRANSACTION COMPLETED'){if(!error){strResponse=data;commitFunction();}else{GS.webSocketErrorDialog(data);rollbackFunction();}}else{commitFunction();}},function(strType,data,error){var arrColumns,arrCells,jsnRow={},i,len;if(strType==='COMMIT'){arrColumns=strResponseColumns.split('\t');arrCells=(strResponse||'').split('\n')[0].split('\t');if(arrColumns.length!==arrCells.length){throw'gs-insert Error: Insert API call isn\'t returning correctly. ('+arrColumns.join(',')+') -> ('+arrCells.join(',')+')';}else{for(i=0,len=arrColumns.length;i<len;i+=1){jsnRow[GS.decodeFromTabDelimited(arrColumns[i])]=GS.decodeFromTabDelimited(arrCells[i]);}
GS.triggerEvent(element,'after_insert');if(typeof callback==='function'){callback(GS.decodeFromTabDelimited(arrCells[0]),jsnRow);}}}});}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-interval>','<gs-interval>','gs-interval column="${1:complete_time}"></gs-interval>');registerDesignSnippet('<gs-interval> With Label','<gs-interval>','label for="${1:interval-insert-complete_time}">${2:Time to complete}:</label>\n'+'<gs-interval id="${1:interval-insert-complete_time}" column="${3:complete_time}"></gs-interval>');designRegisterElement('gs-interval','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-interval.html');window.designElementProperty_GSINTERVAL=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Time Picker',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-picker'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-picker',(this.value==='true'),false);});addProp('Unit',true,'        <gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('unit')||'hours')+'" mini>'+'    <option value="hours">Hours</option>'+'    <option value="minutes">Minutes</option>'+'    <option value="seconds">Seconds</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'unit',this.value);});addProp('Hour Places',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('hour-places')||'3')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'hour-places',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'    <option value="">Visible</option>'+'    <option value="hidden">Invisible</option>'+'    <option value="hide-on-desktop">Invisible at desktop size</option>'+'    <option value="hide-on-tablet">Invisible at tablet size</option>'+'    <option value="hide-on-phone">Invisible at phone size</option>'+'    <option value="show-on-desktop">Visible at desktop size</option>'+'    <option value="show-on-tablet">Visible at tablet size</option>'+'    <option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addFlexProps(selectedElement);addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';/*
        unit:
            hours: shows hours only
            minutes: shows minutes and hours
            seconds: shows seconds, minutes and hours
        hour-places: allows the dev to choose the maximum places in the hours
    */
function handleChange(element){element.close();if(element.lastChangeValue!==element.getAttribute('value')){GS.triggerEvent(element,'change');element.lastChangeValue=element.getAttribute('value');}}
function changeFunction(event){event.preventDefault();event.stopPropagation();event.target.parentNode.setAttribute('value',event.target.value);handleChange(event.target.parentNode);}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function valueGetCurrentNumber(element){var intValue=0;if(element.internal.unit==='minutes'){intValue+=(element.internal.value.hours*60);intValue+=element.internal.value.minutes;}else if(element.internal.unit==='seconds'){intValue+=((element.internal.value.hours*60)*60);intValue+=(element.internal.value.minutes*60);intValue+=element.internal.value.seconds;}else{intValue+=element.internal.value.hours;}
return String(intValue);}
function valueGetCurrentDisplay(element){var strValue='';var intHours=element.internal.value.hours;var intMinutes=element.internal.value.minutes;var intSeconds=element.internal.value.seconds;if(element.internal.places.hours>0){strValue+=GS.leftPad(intHours||'','0',element.internal.places.hours);}
if(element.internal.places.minutes>0){strValue+=(strValue?':':'');strValue+=GS.leftPad(intMinutes||'','0',element.internal.places.minutes);}
if(element.internal.places.seconds>0){strValue+=(strValue?':':'');strValue+=GS.leftPad(intSeconds||'','0',element.internal.places.seconds);}
return String(strValue);}
function valueUpdatePicker(element){var currentValue=valueGetCurrentDisplay(element);var i;var len;var arrElements;var intColons=0;i=0;len=element.internal.places.hours;arrElements=xtag.query(element.internal.picker,'[data-hour]');while(i<len){arrElements[i].value=currentValue[i];i+=1;}
if(len>0){intColons+=1;}
i=0;len=element.internal.places.minutes;arrElements=xtag.query(element.internal.picker,'[data-minute]');while(i<len){arrElements[i].value=currentValue[element.internal.places.hours+intColons+i];i+=1;}
if(len>0){intColons+=1;}
i=0;len=element.internal.places.seconds;arrElements=xtag.query(element.internal.picker,'[data-second]');while(i<len){arrElements[i].value=currentValue[element.internal.places.hours+element.internal.places.minutes+intColons+i];i+=1;}}
function valueUpdateDisplay(element){if(element.control){element.control.value=valueGetCurrentDisplay(element);}else{element.textContent=valueGetCurrentDisplay(element);}}
function valueUpdateAttribute(element){element.setAttribute('value',valueGetCurrentNumber(element));}
function refreshControl(element){var i;var len;var arrPassThroughAttributes;var strHTML;element.innerHTML='';element.control='';element.button='';if(!element.hasAttribute('disabled')){strHTML='<input class="control" gs-dynamic type="text" '+'autocorrect="off" autocapitalize="off" '+'autocomplete="off" spellcheck="false" />';if(!element.hasAttribute('no-picker')){strHTML+='<gs-button class="time-picker-button" gs-dynamic inline icononly icon="hourglass-o" no-focus></gs-button>';}
element.innerHTML=strHTML;element.control=element.children[0];element.button=element.children[1];arrPassThroughAttributes=['name','autofocus','spellcheck','readonly'];i=0;len=arrPassThroughAttributes.length;while(i<len){if(element.hasAttribute(arrPassThroughAttributes[i])){element.control.setAttribute(arrPassThroughAttributes[i],element.getAttribute(arrPassThroughAttributes[i])||'');}
i+=1;}
if(element.hasAttribute('tabindex')){element.oldTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
if(element.oldTabIndex){element.control.tabIndex=element.oldTabIndex;}
element.control.removeEventListener('change',changeFunction);element.control.addEventListener('change',changeFunction);element.control.removeEventListener('focus',focusFunction);element.control.addEventListener('focus',focusFunction);element.control.removeEventListener('blur',blurFunction);element.control.addEventListener('blur',blurFunction);element.control.removeEventListener(evt.mouseout,mouseoutFunction);element.control.addEventListener(evt.mouseout,mouseoutFunction);element.control.removeEventListener(evt.mouseout,mouseoverFunction);element.control.addEventListener(evt.mouseover,mouseoverFunction);}
valueUpdateDisplay(element);}
function valueSiphonAttribute(element){var fltValue=parseFloat(element.getAttribute('value')||'0');var intHours;var intMinutes;var intSeconds;if(element.internal.unit==='minutes'){intHours=Math.floor(fltValue/60);fltValue=fltValue-(intHours*60);intMinutes=Math.floor(fltValue);fltValue=fltValue-Math.floor(fltValue);intSeconds=0;}else if(element.internal.unit==='seconds'){intHours=Math.floor((fltValue/60)/60);fltValue=fltValue-((intHours*60)*60);intMinutes=Math.floor(fltValue/60);fltValue=fltValue-(intMinutes*60);intSeconds=Math.round(fltValue);}else{intHours=Math.floor(fltValue);intMinutes=0;intSeconds=0;}
if(isNaN(intHours)){intHours=0;}
if(isNaN(intMinutes)){intMinutes=0;}
if(isNaN(intSeconds)){intSeconds=0;}
element.internal.value.hours=intHours;element.internal.value.minutes=intMinutes;element.internal.value.seconds=intSeconds;}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.setAttribute('value',strQSValue);}}
element.internal.bolQSFirstRun=true;}
function handleQS(element){if(!element.qsEventFunction){element.qsEventFunction=function(){pushReplacePopHandler(element);};}
window.removeEventListener('pushstate',element.qsEventFunction);window.removeEventListener('replacestate',element.qsEventFunction);window.removeEventListener('popstate',element.qsEventFunction);if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',element.qsEventFunction);window.addEventListener('replacestate',element.qsEventFunction);window.addEventListener('popstate',element.qsEventFunction);}}
function prepElement(element){element.internal={};element.internal.value={"hours":0,"minutes":0,"seconds":0};element.internal.places={"hours":0,"minutes":0,"seconds":0};element.internal.unit='';element.internal.picker='';}
function siphonElement(element){element.internal.unit=element.getAttribute('unit')||'';element.internal.unit=element.internal.unit.toLowerCase();element.internal.unit=element.internal.unit||'minutes';if(element.internal.unit!=='hours'&&element.internal.unit!=='minutes'&&element.internal.unit!=='seconds'){element.internal.unit='minutes';console.warn('gs-interval Warning: invalid "unit" attribute. '+'Please use "hours", "minutes" or "seconds".  '+'Defaulting "unit" to "minutes"',element);}
var intHourPlaces=parseInt(element.getAttribute('hour-places'),10);var intMinutePlaces=0;var intSecondPlaces=0;if(isNaN(intHourPlaces)){intHourPlaces=3;}
if(element.internal.unit==='minutes'||element.internal.unit==='seconds'){intMinutePlaces=2;}
if(element.internal.unit==='seconds'){intSecondPlaces=2;}
element.internal.places.hours=intHourPlaces;element.internal.places.minutes=intMinutePlaces;element.internal.places.seconds=intSecondPlaces;valueSiphonAttribute(element);}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.innerState='closed';prepElement(element);siphonElement(element);saveDefaultAttributes(element);refreshControl(element);if(element.getAttribute('qs')){handleQS(element);}
element.lastChangeValue=element.getAttribute('value');}}}
xtag.register('gs-interval',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==='suspend-created'&&newValue===null){elementCreated(element);elementInserted(element);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(strAttrName==='disabled'||strAttrName==='no-picker'||strAttrName==='tabindex'){siphonElement(element);refreshControl(element);}else if(strAttrName==='qs'){handleQS(element);}else if(strAttrName==='value'&&element.inserted){valueSiphonAttribute(element);valueUpdateDisplay(element);if(element.innerState==='open'){valueUpdatePicker(element);}}}}},events:{'click':function(event){var element=this;if(event.target===element.button){element.toggle();}},'mouseup':function(event){var element=this;var strValue=element.control.value;var jsnTextSelection;var intCursor;var i;var len;var arrDelimiterIndexes;var intSection;if(!element.hasAttribute('readonly')){element.numberOfCharsTyped=0;jsnTextSelection=GS.getInputSelection(element.control);i=0;len=strValue.length;arrDelimiterIndexes=[0];while(i<len){if(strValue[i]===':'){arrDelimiterIndexes.push(i);}
i+=1;}
arrDelimiterIndexes.push(strValue.length);event.preventDefault();intCursor=jsnTextSelection.start;i=1;len=arrDelimiterIndexes.length;while(i<len){if(intCursor>=arrDelimiterIndexes[i-1]&&intCursor<=arrDelimiterIndexes[i]){intSection=i;break;}
i+=1;}
if(intSection===1){GS.setInputSelection(element.control,arrDelimiterIndexes[intSection-1],arrDelimiterIndexes[intSection]);}else{GS.setInputSelection(element.control,arrDelimiterIndexes[intSection-1]+1,arrDelimiterIndexes[intSection]);}}},'keydown':function(event){var element=this;var strValue=element.control.value;var intKeyCode=(event.keyCode||event.which);var jsnTextSelection;var arrDelimiterIndexes;var i;var len;var intCursor;var intSection;var strPlace;var strChar;var strSection;if(!element.hasAttribute('readonly')){jsnTextSelection=GS.getInputSelection(element.control);i=0;len=strValue.length;arrDelimiterIndexes=[0];while(i<len){if(strValue[i]===':'){arrDelimiterIndexes.push(i);}
i+=1;}
arrDelimiterIndexes.push(strValue.length);intCursor=jsnTextSelection.start;i=1;len=arrDelimiterIndexes.length;while(i<len){if(intCursor>=arrDelimiterIndexes[i-1]&&intCursor<=arrDelimiterIndexes[i]){intSection=i;break;}
i+=1;}
if(intKeyCode>=37&&intKeyCode<=40){element.numberOfCharsTyped=0;event.preventDefault();if(intKeyCode===37){intSection-=1;intSection=Math.max(intSection,1);}else if(intKeyCode===39){intSection+=1;intSection=Math.min(intSection,arrDelimiterIndexes.length-1);}
if(intSection===1){GS.setInputSelection(element.control,arrDelimiterIndexes[intSection-1],arrDelimiterIndexes[intSection]);}else{GS.setInputSelection(element.control,arrDelimiterIndexes[intSection-1]+1,arrDelimiterIndexes[intSection]);}
if(intSection===0||intSection===1){strPlace='hours';}else if(intSection===2){strPlace='minutes';}else if(intSection===3||intSection===4){strPlace='seconds';}
jsnTextSelection=GS.getInputSelection(element.control);if(intKeyCode===38){if(strPlace==='hours'){element.internal.value.hours+=1;}else if(strPlace==='minutes'){element.internal.value.minutes+=1;}else if(strPlace==='seconds'){element.internal.value.seconds+=1;}
if(String(element.internal.value.hours).length>element.internal.places.hours){element.internal.value.hours=parseInt('999999999999999'.substring(0,element.internal.places.hours),10);}
if(element.internal.value.seconds>59){element.internal.value.minutes+=1;element.internal.value.seconds=0;}
if(element.internal.value.minutes>59){element.internal.value.hours+=1;element.internal.value.minutes=0;}}else if(intKeyCode===40){if(strPlace==='hours'){element.internal.value.hours-=1;}else if(strPlace==='minutes'){element.internal.value.minutes-=1;}else if(strPlace==='seconds'){element.internal.value.seconds-=1;}
if(element.internal.value.seconds<0){if(element.internal.value.minutes>0){element.internal.value.minutes-=1;element.internal.value.seconds=59;}else if(element.internal.value.hours>0){element.internal.value.hours-=1;element.internal.value.minutes=59;element.internal.value.seconds=59;}else{element.internal.value.seconds=0;}}
if(element.internal.value.minutes<0){if(element.internal.value.hours>0){element.internal.value.minutes=59;element.internal.value.hours-=1;}else{element.internal.value.minutes=0;}}
if(element.internal.value.hours<0){element.internal.value.hours=0;}}
if(intKeyCode===38||intKeyCode===40){valueUpdateAttribute(element);GS.setInputSelection(element.control,jsnTextSelection.start,jsnTextSelection.end);}}else if((intKeyCode>=48&&intKeyCode<=57)||(intKeyCode>=96&&intKeyCode<=105)){element.numberOfCharsTyped=element.numberOfCharsTyped||0;event.preventDefault();strChar=String.fromCharCode(intKeyCode);if(intKeyCode===96){strChar='0';}
if(intKeyCode===97){strChar='1';}
if(intKeyCode===98){strChar='2';}
if(intKeyCode===99){strChar='3';}
if(intKeyCode===100){strChar='4';}
if(intKeyCode===101){strChar='5';}
if(intKeyCode===102){strChar='6';}
if(intKeyCode===103){strChar='7';}
if(intKeyCode===104){strChar='8';}
if(intKeyCode===105){strChar='9';}
if(intSection===1){GS.setInputSelection(element.control,arrDelimiterIndexes[intSection-1],arrDelimiterIndexes[intSection]);}else{GS.setInputSelection(element.control,arrDelimiterIndexes[intSection-1]+1,arrDelimiterIndexes[intSection]);}
if(intSection===0||intSection===1){strPlace='hours';}else if(intSection===2){strPlace='minutes';}else if(intSection===3||intSection===4){strPlace='seconds';}
jsnTextSelection=GS.getInputSelection(element.control);strSection=strValue.substring(jsnTextSelection.start,jsnTextSelection.end);strSection=strSection.substring(0,element.numberOfCharsTyped)+
strChar+
strSection.substring(element.numberOfCharsTyped+1);strValue=strValue.substring(0,jsnTextSelection.start)+
strSection+
strValue.substring(jsnTextSelection.end);element.numberOfCharsTyped+=1;if(element.numberOfCharsTyped===strSection.length){element.numberOfCharsTyped=0;}
if(strPlace==='hours'){element.internal.value.hours=parseInt(strSection,10);}
if(strPlace==='minutes'){element.internal.value.minutes=parseInt(strSection,10);}
if(strPlace==='seconds'){element.internal.value.seconds=parseInt(strSection,10);}
if(strValue!==element.control.value){valueUpdateAttribute(element);GS.setInputSelection(element.control,jsnTextSelection.start,jsnTextSelection.end);}}else if(intKeyCode===13){element.numberOfCharsTyped=0;event.preventDefault();handleChange(element);}else if(intKeyCode!==9&&event.ctrlKey===false&&event.metaKey===false){element.numberOfCharsTyped=0;event.preventDefault();}}},'blur':function(){var element=this;if(element.innerState==='closed'){handleChange(element);}}},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(newValue){this.setAttribute('value',newValue);}},state:{get:function(){return this.innerState;},set:function(newValue){var element=this;if(newValue==='open'){element.open();}else{element.close();}}}},methods:{focus:function(){this.control.focus();},open:function(){var element=this;var pickerContainerElement;var overlayElement;var pickerElement;var handleLook;var strHTML;var i;var len;var arrElements;if(element.innerState==='closed'){element.innerState='open';element.lastClosedValue=element.getAttribute('value');if(!evt.touchDevice){element.control.focus();GS.setInputSelection(element.control,0,element.control.value.length);}
pickerContainerElement=document.createElement('div');pickerContainerElement.classList.add('gs-interval-time-picker-container');overlayElement=document.createElement('div');overlayElement.classList.add('gs-interval-time-picker-overlay');pickerElement=document.createElement('div');pickerElement.classList.add('gs-interval-time-picker');element.internal.picker=pickerElement;element.pickerContainerElement=pickerContainerElement;pickerContainerElement.appendChild(overlayElement);pickerContainerElement.appendChild(pickerElement);document.body.appendChild(pickerContainerElement);strHTML='';strHTML+='<div class="time-inner-container">';i=0;len=element.internal.places.hours;while(i<len){strHTML+='<select class="gs-interval-hour" data-hour="'+i+'">'+'    <option value="0">&nbsp;0</option>'+'    <option value="1">&nbsp;1</option>'+'    <option value="2">&nbsp;2</option>'+'    <option value="3">&nbsp;3</option>'+'    <option value="4">&nbsp;4</option>'+'    <option value="5">&nbsp;5</option>'+'    <option value="6">&nbsp;6</option>'+'    <option value="7">&nbsp;7</option>'+'    <option value="8">&nbsp;8</option>'+'    <option value="9">&nbsp;9</option>'+'</select>';i+=1;}
if(element.internal.places.hours>0&&element.internal.places.minutes>0){strHTML+='<span class="colon">:</span>';}
i=0;len=element.internal.places.minutes;while(i<len){strHTML+='<select class="gs-interval-minute" data-minute="'+i+'">'+'    <option value="0">&nbsp;0</option>'+'    <option value="1">&nbsp;1</option>'+'    <option value="2">&nbsp;2</option>'+'    <option value="3">&nbsp;3</option>'+'    <option value="4">&nbsp;4</option>'+'    <option value="5">&nbsp;5</option>';if(i>0){strHTML+='<option value="6">&nbsp;6</option>'+'<option value="7">&nbsp;7</option>'+'<option value="8">&nbsp;8</option>'+'<option value="9">&nbsp;9</option>';}
strHTML+='</select>';i+=1;}
if(element.internal.places.minutes>0&&element.internal.places.seconds>0){strHTML+='<span class="colon">:</span>';}
i=0;len=element.internal.places.seconds;while(i<len){strHTML+='<select class="gs-interval-second" data-second="'+i+'">'+'    <option value="0">&nbsp;0</option>'+'    <option value="1">&nbsp;1</option>'+'    <option value="2">&nbsp;2</option>'+'    <option value="3">&nbsp;3</option>'+'    <option value="4">&nbsp;4</option>'+'    <option value="5">&nbsp;5</option>';if(i>0){strHTML+='<option value="6">&nbsp;6</option>'+'<option value="7">&nbsp;7</option>'+'<option value="8">&nbsp;8</option>'+'<option value="9">&nbsp;9</option>';}
strHTML+='</select>';i+=1;}
strHTML+='</div>';pickerElement.innerHTML=strHTML;valueUpdatePicker(element);overlayElement.addEventListener('click',function(){element.close();});pickerElement.addEventListener('change',function(){var newValue=0;var strCurrentValue;if(element.internal.unit==='hours'){i=0;len=element.internal.places.hours;arrElements=xtag.query(pickerElement,'[data-hour]');strCurrentValue='';while(i<len){strCurrentValue+=arrElements[i].value;i+=1;}
if(arrElements.length>0){newValue+=parseInt(strCurrentValue,10);}}
if(element.internal.unit==='minutes'){i=0;len=element.internal.places.hours;arrElements=xtag.query(pickerElement,'[data-hour]');strCurrentValue='';while(i<len){strCurrentValue+=arrElements[i].value;i+=1;}
if(arrElements.length>0){newValue+=parseInt(strCurrentValue,10)*60;}
i=0;len=element.internal.places.minutes;arrElements=xtag.query(pickerElement,'[data-minute]');strCurrentValue='';while(i<len){strCurrentValue+=arrElements[i].value;i+=1;}
if(arrElements.length>0){newValue+=parseInt(strCurrentValue,10);}}
if(element.internal.unit==='seconds'){i=0;len=element.internal.places.hours;arrElements=xtag.query(pickerElement,'[data-hour]');strCurrentValue='';while(i<len){strCurrentValue+=arrElements[i].value;i+=1;}
if(arrElements.length>0){newValue+=((parseInt(strCurrentValue,10)*60)*60);}
i=0;len=element.internal.places.minutes;arrElements=xtag.query(pickerElement,'[data-minute]');strCurrentValue='';while(i<len){strCurrentValue+=arrElements[i].value;i+=1;}
if(arrElements.length>0){newValue+=parseInt(strCurrentValue,10)*60;}
i=0;len=element.internal.places.seconds;arrElements=xtag.query(pickerElement,'[data-second]');strCurrentValue='';while(i<len){strCurrentValue+=arrElements[i].value;i+=1;}
if(arrElements.length>0){newValue+=parseInt(strCurrentValue,10);}}
element.setAttribute('value',newValue);});handleLook=function(){var positionData;var intPopupHeight;var intPopupWidth;if(pickerContainerElement.parentNode!==document.body){window.removeEventListener('resize',handleLook);window.removeEventListener('orientationchange',handleLook);return;}
pickerElement.style.top='';pickerElement.style.left='';pickerElement.style.marginTop='';positionData=GS.getElementPositionData(element);intPopupHeight=pickerElement.offsetHeight;intPopupWidth=pickerElement.offsetWidth;if(positionData.intRoomBelow>intPopupHeight){pickerElement.style.top=(positionData.objElementOffset.top+positionData.intElementHeight)+'px';}else{pickerElement.style.top=(positionData.objElementOffset.top-intPopupHeight)+'px';}
pickerElement.style.left=(((positionData.objElementOffset.left+positionData.intElementWidth)-intPopupWidth)-4)+'px';};handleLook();window.addEventListener('resize',handleLook);window.addEventListener('orientationchange',handleLook);}},close:function(){var element=this;if(element.innerState==='open'){element.innerState='closed';if(element.pickerContainerElement){document.body.removeChild(element.pickerContainerElement);element.pickerContainerElement='';}
if(element.getAttribute('value')!==element.lastClosedValue){handleChange(element);}}},toggle:function(){var element=this;if(element.innerState==='open'){element.close();}else{element.open();}}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-jumbo>','<gs-jumbo>','gs-jumbo>\n'+'    ${0}\n'+'</gs-jumbo>');designRegisterElement('gs-jumbo','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-container-jumbo.html');window.designElementProperty_GSJUMBO=function(selectedElement){addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});};});document.addEventListener('DOMContentLoaded',function(){'use strict';xtag.register('gs-jumbo',{});});window.addEventListener('design-register-element',function(){registerDesignSnippet('Static Template <gs-listbox>','<gs-listbox>','gs-listbox>\n'+'    <template>\n'+'        <table>\n'+'            <tbody>\n'+'                <tr value="${1}">\n'+'                    <td>${0}</td>\n'+'                </tr>\n'+'            </tbody>\n'+'        </table>\n'+'    </template>\n'+'</gs-listbox>');registerDesignSnippet('Custom Template <gs-listbox>','<gs-listbox>','gs-listbox src="${1:test.tpeople}">\n'+'    <template>\n'+'        <table>\n'+'            <tbody>\n'+'                <tr value="{{! row.id }}">\n'+'                    <td>{{! row.${3:name} }}</td>\n'+'                </tr>\n'+'            </tbody>\n'+'        </table>\n'+'    </template>\n'+'</gs-listbox>');registerDesignSnippet('Dynamic Template <gs-listbox>','<gs-listbox>','gs-listbox src="${1:test.tpeople}"></gs-listbox>');registerDesignSnippet('<gs-listbox>','<gs-listbox>','gs-listbox src="${1:test.tpeople}"></gs-listbox>');designRegisterElement('gs-listbox','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-listbox.html');window.designElementProperty_GSLISTBOX=function(selectedElement){addProp('Source',true,'<gs-memo class="target" value="'+encodeHTML(decodeURIComponent(selectedElement.getAttribute('src')||selectedElement.getAttribute('source')||''))+'" mini></gs-memo>',function(){return setOrRemoveTextAttribute(selectedElement,'src',encodeURIComponent(this.value));});addProp('Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('cols')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'cols',this.value);});addProp('Hide Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('hide')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'hide',this.value);});addProp('Where',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('where')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'where',this.value);});addProp('Order By',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('ord')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'ord',this.value);});addProp('Limit',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('limit')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'limit',this.value);});addProp('Offset',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('offset')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'offset',this.value);});addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Dissallow&nbsp;Select',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-select')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-select',this.value==='true',true);});addProp('Letter&nbsp;Scrollbar',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('letter-scrollbar')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'letter-scrollbar',this.value==='true',true);});addProp('Letter Dividers',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('letter-dividers')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'letter-dividers',this.value==='true',true);});addProp('Refresh On Querystring Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('refresh-on-querystring-values')||'')+'" mini></gs-text>',function(){this.removeAttribute('refresh-on-querystring-change');return setOrRemoveTextAttribute(selectedElement,'refresh-on-querystring-values',this.value);});addProp('Refresh On Querystring Change',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('refresh-on-querystring-change'))+'" mini></gs-checkbox>',function(){this.removeAttribute('refresh-on-querystring-values');return setOrRemoveBooleanAttribute(selectedElement,'refresh-on-querystring-change',this.value==='true',true);});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function highlightRecord(element,record){var i,len,arrSelectedTrs;if(element.tableElement&&xtag.queryChildren(element.tableElement,'tbody')[0]){arrSelectedTrs=xtag.queryChildren(xtag.queryChildren(element.tableElement,'tbody')[0],'tr[selected]');for(i=0,len=arrSelectedTrs.length;i<len;i+=1){arrSelectedTrs[i].removeAttribute('selected');}}
if(record){record.setAttribute('selected','');}}
function findRecordFromValue(element,searchValue){var i,len,matchedRecord,arrTrs,strSearchString;if(element.tableElement&&xtag.queryChildren(element.tableElement,'tbody')[0]){arrTrs=xtag.queryChildren(xtag.queryChildren(element.tableElement,'tbody')[0],'tr');strSearchString=String(searchValue);for(i=0,len=arrTrs.length;i<len;i+=1){if(arrTrs[i].getAttribute('value')===strSearchString||xtag.queryChildren(arrTrs[i],'td')[0].textContent===strSearchString){matchedRecord=arrTrs[i];break;}}}
return matchedRecord;}
function selectRecord(element,handle,bolChange){var record,strRecordValue,strFirstTdText;if(!element.hasAttribute('no-select')){if(typeof handle==='string'||typeof handle==='number'){record=findRecordFromValue(element,handle);}else{record=handle;}
if(!record&&handle!==''){console.warn('Listbox warning: record not found'+(typeof handle==='string'?': "'+handle+'"':''));}else if(record){strRecordValue=record.getAttribute('value');strFirstTdText=xtag.queryChildren(record,'td')[0].textContent;if(element.value!==(strRecordValue||strFirstTdText)){element.innerValue=strRecordValue||strFirstTdText;element.innerSelectedRecord=record;if(bolChange){element.hackToPreventScroll=true;if(element.innerValue!==element.getAttribute('value')){element.setAttribute('value',element.innerValue);}
element.hackToPreventScroll=false;element.triggerChange();}}}
highlightRecord(element,record);}}
function handleKeyDown(event){var element=event.target,intKeyCode=event.keyCode||event.which,selectedTr,trs,i,len,selectedRecordIndex;if(!element.hasAttribute('disabled')){if(!element.hasAttribute('no-select')){if((intKeyCode===40||intKeyCode===38)&&!event.shiftKey&&!event.metaKey&&!event.ctrlKey&&!element.error){trs=xtag.queryChildren(xtag.queryChildren(element.tableElement,'tbody')[0],'tr:not(.divider)');for(i=0,len=trs.length;i<len;i+=1){if(trs[i].hasAttribute('selected')){selectedRecordIndex=i;selectedTr=trs[i];trs[i].removeAttribute('selected');break;}}
if(intKeyCode===40){if(!selectedTr||selectedRecordIndex===trs.length-1){highlightRecord(element,trs[0]);selectedTr=trs[0];}else{highlightRecord(element,trs[selectedRecordIndex+1]);selectedTr=trs[selectedRecordIndex+1];}}else if(intKeyCode===38){if(!selectedTr||selectedRecordIndex===0){highlightRecord(element,trs[trs.length-1]);selectedTr=trs[trs.length-1];}else{highlightRecord(element,trs[selectedRecordIndex-1]);selectedTr=trs[selectedRecordIndex-1];}}
element.scrollToSelectedRecord();event.preventDefault();event.stopPropagation();}else if(event.keyCode===13){selectedTr=xtag.queryChildren(xtag.queryChildren(element.tableElement,'tbody')[0],'tr[selected]')[0];if(element.tableElement&&selectedTr){selectRecord(element,selectedTr,true);}}}}else{if(event.keyCode!==9){event.preventDefault();event.stopPropagation();}}}
function handleFocusout(event){var element=event.target,selectedTr;if(element.tableElement){selectedTr=xtag.queryChildren(xtag.queryChildren(element.tableElement,'tbody')[0],'tr[selected]')[0];if(selectedTr){selectRecord(element,selectedTr,true);}}}
function getData(element,callback,bolInitalLoad,bolClearPrevious){var strSrc=GS.templateWithQuerystring((bolInitalLoad&&element.getAttribute('initialize')?element.getAttribute('initialize'):element.getAttribute('src'))),srcParts=strSrc[0]==='('?[strSrc,'']:strSrc.split('.'),strSchema=srcParts[0],strObject=srcParts[1],strColumns=GS.templateWithQuerystring(element.getAttribute('cols')||'*').split(',').join('\t'),strWhere=GS.templateWithQuerystring(element.getAttribute('where')||''),strOrd=GS.templateWithQuerystring(element.getAttribute('ord')||''),strLimit=GS.templateWithQuerystring(element.getAttribute('limit')||''),strOffset=GS.templateWithQuerystring(element.getAttribute('offset')||''),response_i=0,response_len=0,arrTotalRecords=[];GS.addLoader(element,'Loading...');GS.requestSelectFromSocket(GS.envSocket,strSchema,strObject,strColumns,strWhere,strOrd,strLimit,strOffset,function(data,error){var arrRecords,arrCells,envData,i,len,cell_i,cell_len;if(!error){if(data.strMessage!=='TRANSACTION COMPLETED'){arrRecords=GS.trim(data.strMessage,'\n').split('\n');for(i=0,len=arrRecords.length;i<len;i+=1){arrCells=arrRecords[i].split('\t');for(cell_i=0,cell_len=arrCells.length;cell_i<cell_len;cell_i+=1){arrCells[cell_i]=arrCells[cell_i]==='\\N'?null:GS.decodeFromTabDelimited(arrCells[cell_i]);}
arrTotalRecords.push(arrCells);}}else{GS.removeLoader(element);element.arrColumnNames=data.arrColumnNames;envData={'arr_column':element.arrColumnNames,'dat':arrTotalRecords};handleData(element,bolInitalLoad,envData);GS.triggerEvent(element,'after_select');if(typeof callback==='function'){callback();}}}else{handleData(element,bolInitalLoad,data,error);GS.removeLoader(element);}});}
function handleData(element,bolInitalLoad,data,error){var strTemplate,divElement,tableElement,theadElement,theadCellElements,tbodyElement,tbodyCellElements,lastRecordElement,recordElements,recordElement,currentCellLabelElement,template,i,len,arrHeaders=[],arrHide,intVisibleColumns,strHeaderCells,strRecordCells,jsnTemplate,strHTML;element.classList.remove('error');element.setAttribute('title','');if(!error){element.error=false;if(element.tableTemplate){strTemplate=element.tableTemplate;}else{arrHide=(element.getAttribute('hide')||'').split(/[\s]*,[\s]*/);for(i=0,len=data.arr_column.length,strHeaderCells='',strRecordCells='',intVisibleColumns=0;i<len;i+=1){if(arrHide.indexOf((i+1)+'')===-1&&arrHide.indexOf(data.arr_column[i])===-1){strHeaderCells+='<th gs-dynamic>'+encodeHTML(data.arr_column[i])+'</th> ';strRecordCells+='<td gs-dynamic>{{! row[\''+data.arr_column[i]+'\'] }}</td> ';intVisibleColumns+=1;}}
strTemplate='<table gs-dynamic>';if(intVisibleColumns>1){strTemplate+='<thead gs-dynamic>'+'<tr gs-dynamic>'+
strHeaderCells+'</tr>'+'</thead>';}
strTemplate+='<tbody gs-dynamic>'+'<tr value="{{! row[\''+data.arr_column[0]+'\'] }}" gs-dynamic>'+
strRecordCells+'</tr>'+'</tbody>'+'<table>';}
divElement=document.createElement('div');divElement.innerHTML=strTemplate;tableElement=xtag.queryChildren(divElement,'table')[0];theadElement=xtag.queryChildren(tableElement,'thead')[0];tbodyElement=xtag.queryChildren(tableElement,'tbody')[0];if(tbodyElement){recordElement=xtag.queryChildren(tbodyElement,'tr')[0];if(recordElement){if(theadElement){theadCellElements=xtag.query(theadElement,'td, th');tbodyCellElements=xtag.query(tbodyElement,'td, th');for(i=0,len=theadCellElements.length;i<len;i+=1){currentCellLabelElement=document.createElement('b');currentCellLabelElement.classList.add('cell-label');currentCellLabelElement.setAttribute('data-text',(theadCellElements[i].textContent||'')+':');if(tbodyCellElements[i].childNodes){tbodyCellElements[i].insertBefore(currentCellLabelElement,tbodyCellElements[i].childNodes[0]);}else{tbodyCellElements[i].insertChild(currentCellLabelElement);}}}
jsnTemplate=GS.templateHideSubTemplates(tbodyElement.innerHTML,true);strHTML=GS.templateWithEnvelopeData(jsnTemplate.templateHTML,data);tbodyElement.innerHTML=GS.templateShowSubTemplates(strHTML,jsnTemplate);element.tableElement=tableElement;element.syncView();}}
if(bolInitalLoad&&!element.getAttribute('value')&&element.hasAttribute('select-first')){selectRecord(element,xtag.query(element,'tbody tr')[0].getAttribute('value'),false);element.scrollToSelectedRecord();}}else{element.error=true;element.classList.add('error');element.setAttribute('title','This listbox has failed to load.');element.setAttribute('disabled','');GS.ajaxErrorDialog(data);}}
function getParentCell(element){var currentElement=element;while(currentElement.nodeName!=='TD'&&currentElement.nodeName!=='TH'&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}
if(currentElement.nodeName!=='TD'&&currentElement.nodeName!=='TH'){return undefined;}
return currentElement;}
function windowResizeHandler(){var i,len,arrElement;arrElement=document.getElementsByTagName('gs-listbox');for(i=0,len=arrElement.length;i<len;i+=1){if(GS.pxToEm(document.body,this.oldWidth)!==GS.pxToEm(document.body,this.offsetWidth)&&arrElement[i].hasAttribute('letter-scrollbar')&&arrElement[i].tableElement){if(arrElement[i].hasAttribute('letter-dividers')||arrElement[i].hasAttribute('letter-scrollbar')){arrElement[i].refreshDividingPoints();}
arrElement[i].letterScrollbarHandler();this.oldWidth=this.offsetWidth;}}}
window.addEventListener('resize',windowResizeHandler);window.addEventListener('orientationchange',windowResizeHandler);function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var arrPopKeys;var currentValue;var bolRefresh;var strOperator;if(strQSCol){if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else if(element.value!==strQSValue){element.value=strQSValue;}}}
if(element.internal.bolQSFirstRun===true){if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){currentValue=GS.qryGetVal(strQS,arrPopKeys[i]);if(element.popValues[arrPopKeys[i]]!==currentValue){bolRefresh=true;}
element.popValues[arrPopKeys[i]]=currentValue;}}else if(element.hasAttribute('refresh-on-querystring-change')){bolRefresh=true;}
if(bolRefresh&&element.hasAttribute('src')){getData(element);}else if(bolRefresh&&!element.hasAttribute('src')){console.warn('gs-combo Warning: element has "refresh-on-querystring-values" or "refresh-on-querystring-change", but no "src".',element);}}else{if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);for(i=0,len=arrPopKeys.length;i<len;i+=1){element.popValues[arrPopKeys[i]]=GS.qryGetVal(strQS,arrPopKeys[i]);}}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value&&!element.getAttribute('value')){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){var tableTemplateElement,arrElement,recordElement,tableTemplateElementCopy,strQSValue,i,len,currentElement;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.error=false;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('qs')||element.hasAttribute('refresh-on-querystring-values')||element.hasAttribute('refresh-on-querystring-change')){element.popValues={};pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
if(!element.hasAttribute('tabindex')){element.setAttribute('tabindex','0');}
tableTemplateElement=xtag.queryChildren(element,'template')[0];if(tableTemplateElement){element.tableTemplate=GS.templateColumnToValue(tableTemplateElement.innerHTML);}
if(element.getAttribute('src')||element.getAttribute('source')){getData(element,'',true);}else{if(tableTemplateElement){element.tableElement=xtag.query(tableTemplateElement.content,'table')[0];}else if(xtag.queryChildren(element,'table')[0]){element.tableElement=xtag.queryChildren(element,'table')[0];}else{element.tableElement=document.createElement('table');}
element.syncView();}}}}
xtag.register('gs-listbox',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='value'&&newValue!==oldValue){this.value=newValue;}}}},events:{},accessors:{value:{get:function(){return this.innerValue;},set:function(strNewValue){selectRecord(this,strNewValue);this.scrollToSelectedRecord();}},selectedRecord:{get:function(){return this.innerSelectedRecord;},set:function(newValue){selectRecord(this,newValue);this.scrollToSelectedRecord();}},textValue:{get:function(){if(this.innerSelectedRecord){return xtag.queryChildren(this.innerSelectedRecord,'td')[0].textContent;}
return undefined;},set:function(){selectRecord(this,strNewValue);this.scrollToSelectedRecord();}}},methods:{refresh:function(callback){getData(this,callback);},scrollToSelectedRecord:function(){var selectedTr;if(this.tableElement){selectedTr=xtag.query(this.tableElement,'tr[selected]')[0];if(selectedTr){GS.scrollIntoView(selectedTr);}}
/*var scrollingContainer, arrTrs, i, len, intScrollTop, bolFoundSelected = false;
                
                if (this.tableElement) {
                    scrollingContainer = this;
                    arrTrs = xtag.query(this.tableElement, 'tr');
                    
                    for (i = 0, intScrollTop = 0, len = arrTrs.length; i < len; i += 1) {
                        if (arrTrs[i].hasAttribute('selected')) {
                            intScrollTop += arrTrs[i].offsetHeight / 2;
                            
                            bolFoundSelected = true;
                            
                            break;
                        } else {
                            intScrollTop += arrTrs[i].offsetHeight;
                        }
                    }
                    
                    if (bolFoundSelected) {
                        intScrollTop = intScrollTop - scrollingContainer.offsetHeight / 2;
                    } else {
                        intScrollTop = 0;
                    }
                    
                    scrollingContainer.scrollTop = intScrollTop;
                }*/},letterScrollbarHandler:function(){var element=this,i,len,intTextHeight,intLettersDropped,intSkipperHeight,intElementHeight,intDistance,strHTML,arrSkippers;if(xtag.queryChildren(element,'.letter-scrollbar-container').length===0){element.letterScrollbarContainer=document.createElement('div');element.letterScrollbarContainer.classList.add('letter-scrollbar-container');element.letterScrollbarContainer.setAttribute('gs-dynamic','');element.appendChild(element.letterScrollbarContainer);}else{element.letterScrollbarContainer.innerHTML='';}
if(element.clientHeight<element.scrollContainer.scrollHeight){intTextHeight=GS.getTextHeight(element.letterScrollbarContainer);intSkipperHeight=intTextHeight*this.arrDividingPoints.length;intElementHeight=element.clientHeight/this.arrDividingPoints.length;if(intElementHeight<intTextHeight){intElementHeight=intTextHeight;}
if(intSkipperHeight>element.clientHeight){intLettersDropped=0;while(intSkipperHeight>element.clientHeight&&intLettersDropped<100){intSkipperHeight-=intTextHeight;intLettersDropped+=1;}
intDistance=Math.ceil(this.arrDividingPoints.length/intLettersDropped);}
for(i=0,len=this.arrDividingPoints.length,strHTML='';i<len;i+=1){if(intLettersDropped===undefined||(intLettersDropped>0&&i%intDistance!==0)){strHTML+='<div class="skipper" gs-dynamic '+'style="height: '+intElementHeight+'px; line-height: '+intElementHeight+'px;" '+'data-target-offset="'+this.arrDividingPoints[i].offset+'">'+'<span gs-dynamic>'+this.arrDividingPoints[i].letter+'</span>'+'</div>';}}
element.letterScrollbarContainer.innerHTML=strHTML;if(element.paddingElement&&element.paddingElement.parentNode===element.scrollContainer){element.scrollContainer.removeChild(element.paddingElement);}
element.paddingElement=document.createElement('div');element.paddingElement.setAttribute('gs-dynamic','');if(this.arrDividingPoints.length>0){element.paddingElement.style.height=(element.clientHeight-
(element.scrollContainer.scrollHeight-parseInt(this.arrDividingPoints[this.arrDividingPoints.length-1].offset,10)))+'px';}
element.scrollContainer.appendChild(element.paddingElement);arrSkippers=element.letterScrollbarContainer.children;if(element.mousedownHandler){window.removeEventListener(evt.mousedown,element.mousedownHandler);window.removeEventListener(evt.mousemove,element.mousemoveHandler);window.removeEventListener(evt.mouseup,element.mouseupHandler);}
element.clickHandler=function(){element.style.webkitOverflowScrolling='initial';element.scrollContainer.scrollTop=parseInt(this.getAttribute('data-target-offset'),10);element.style.webkitOverflowScrolling='touch';};element.mousedownHandler=function(event){window.addEventListener(evt.mousemove,element.mousemoveHandler);if(event.target.classList.contains('skipper')&&evt.touchDevice){element.style.webkitOverflowScrolling='initial';}};element.mousemoveHandler=function(event){var jsnMousePosition,targetElement;if(event.which!==0||evt.touchDevice){jsnMousePosition=GS.mousePosition(event);targetElement=document.elementFromPoint(jsnMousePosition.left,jsnMousePosition.top);if(targetElement){if(targetElement.nodeName==='SPAN'){targetElement=targetElement.parentNode;}
if(targetElement.classList.contains('skipper')){element.style.webkitOverflowScrolling='initial';event.preventDefault();element.scrollContainer.scrollTop=parseInt(targetElement.getAttribute('data-target-offset'),10);}}}else{window.removeEventListener(evt.mousemove,element.mousemoveHandler);}};element.mouseupHandler=function(){element.style.webkitOverflowScrolling='touch';window.removeEventListener(evt.mousemove,element.mousemoveHandler);};element.addEventListener(evt.mousedown,element.mousedownHandler);element.addEventListener(evt.mouseup,element.mouseupHandler);for(i=0,len=arrSkippers.length;i<len;i+=1){arrSkippers[i].addEventListener('click',element.clickHandler);}}},refreshDividingPoints:function(){var tbodyElement,arrElement,arrLetter,dividerElement,strLetter,intOffset,numColumns,theadElement,i,len;tbodyElement=xtag.queryChildren(this.tableElement,'tbody')[0];arrElement=xtag.queryChildren(tbodyElement,'tr.divider');for(i=0,len=arrElement.length;i<len;i+=1){tbodyElement.removeChild(arrElement[i]);}
this.arrDividingPoints=[];arrElement=xtag.queryChildren(tbodyElement,'tr');if(arrElement.length>0){numColumns=arrElement[0].children.length;theadElement=xtag.queryChildren(this.tableElement,'thead')[0];intOffset=(theadElement?theadElement.offsetHeight:0);for(i=0,len=arrElement.length,arrLetter=[];i<len;i+=1){strLetter=xtag.queryChildren(arrElement[i],'td')[0].textContent.substring(0,1).toUpperCase();if(arrLetter.indexOf(strLetter)===-1){this.arrDividingPoints.push({'letter':strLetter,'offset':intOffset});if(this.hasAttribute('letter-dividers')){dividerElement=document.createElement('tr');dividerElement.classList.add('divider');dividerElement.setAttribute('gs-dynamic','');dividerElement.setAttribute('data-target-offset',intOffset);dividerElement.innerHTML='<td colspan="'+numColumns+'" gs-dynamic>'+encodeHTML(strLetter)+'</td>';tbodyElement.insertBefore(dividerElement,arrElement[i]);intOffset+=dividerElement.offsetHeight;}
arrLetter.push(strLetter);}
intOffset+=arrElement[i].offsetHeight;}}},syncView:function(){var element=this,tbodyElement,i,len,arrElements,clickHandler,mousedownHandler,mouseoutHandler,mouseoverHandler;element.removeEventListener('keydown',handleKeyDown);element.addEventListener('keydown',handleKeyDown);element.removeEventListener('focusout',handleFocusout);element.addEventListener('focusout',handleFocusout);element.innerHTML='';element.scrollContainer=document.createElement('div');element.scrollContainer.setAttribute('gs-dynamic','');element.scrollContainer.classList.add('root');element.scrollContainer.classList.add('scroll-container');element.scrollContainer.appendChild(element.tableElement);element.appendChild(element.scrollContainer);tbodyElement=xtag.queryChildren(element.tableElement,'tbody')[0];if(element.hasAttribute('letter-dividers')||element.hasAttribute('letter-scrollbar')){element.refreshDividingPoints();if(element.hasAttribute('letter-scrollbar')){element.letterScrollbarHandler();}}
if(this.getAttribute('value')){selectRecord(this,this.getAttribute('value'));this.scrollToSelectedRecord();}
arrElements=xtag.toArray(tbodyElement.children);clickHandler=function(event){this.classList.remove('down');selectRecord(element,this,true);};for(i=0,len=arrElements.length;i<len;i+=1){if(!arrElements[i].classList.contains('divider')){arrElements[i].addEventListener('click',clickHandler);}}
if(!evt.touchDevice){mousedownHandler=function(){this.classList.add('down');};mouseoutHandler=function(){this.classList.remove('down');this.classList.remove('hover');};mouseoverHandler=function(){this.classList.remove('down');this.classList.add('hover');};for(i=0,len=arrElements.length;i<len;i+=1){if(!arrElements[i].classList.contains('divider')){arrElements[i].addEventListener(evt.mousedown,mousedownHandler);arrElements[i].addEventListener(evt.mouseout,mouseoutHandler);arrElements[i].addEventListener(evt.mouseover,mouseoverHandler);}}}},triggerChange:function(){xtag.fireEvent(this,'change',{bubbles:true,cancelable:true});}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-memo>','<gs-memo>','gs-memo column="${1:name}"></gs-memo>');registerDesignSnippet('<gs-memo> With Label','<gs-memo>','label for="${1:memo-insert-note}">${2:Notes}:</label>\n'+'<gs-memo id="${1:memo-insert-note}" column="${3:note}"></gs-memo>');designRegisterElement('gs-memo','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-memo.html');window.designElementProperty_GSMEMO=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Rows',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('rows')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'rows',this.value);});addProp('Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'placeholder',this.value);});addProp('Autoresize',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('autoresize'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'autoresize',(this.value==='true'),true);});addProp('Allow tab',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('allow-tab-char'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'allow-tab-char',(this.value==='true'),true);});addProp('Resize Handle',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-resize-handle'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-resize-handle',(this.value==='true'),false);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);};});window.addEventListener('resize',function(){var i,len,arrElements=document.getElementsByTagName('gs-memo');for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].handleResizeToText();}});if(!evt.touchDevice){window.gsMemo={};window.gsMemo.bolFirstMouseMoveWhileDown=true;window.gsMemo.currentMouseTarget=null;window.addEventListener('mousemove',function(event){var mousePosition,intWhich;try{intWhich=event.which;}catch(e){}
if(window.bolFirstMouseMoveWhileDown===true&&intWhich!==undefined&&intWhich!==0){mousePosition=GS.mousePosition(event);window.bolFirstMouseMoveWhileDown=false;window.gsMemo.currentMouseTarget=document.elementFromPoint(mousePosition.x,mousePosition.y);}else if(intWhich!==undefined&&intWhich===0){window.bolFirstMouseMoveWhileDown=true;}
if(window.gsMemo.currentMouseTarget&&intWhich!==undefined&&intWhich!==0&&window.gsMemo.currentMouseTarget.nodeName==='TEXTAREA'&&window.gsMemo.currentMouseTarget.parentNode.nodeName==='GS-MEMO'&&window.bolFirstMouseMoveWhileDown===false&&(window.gsMemo.currentMouseTarget.lastWidth!==window.gsMemo.currentMouseTarget.clientWidth||window.gsMemo.currentMouseTarget.lastHeight!==window.gsMemo.currentMouseTarget.clientHeight)){window.gsMemo.currentMouseTarget.style.margin='';window.gsMemo.currentMouseTarget.style.marginLeft='';window.gsMemo.currentMouseTarget.style.marginRight='';window.gsMemo.currentMouseTarget.style.marginTop='';window.gsMemo.currentMouseTarget.style.marginBottom='';window.gsMemo.currentMouseTarget.lastWidth=window.gsMemo.currentMouseTarget.clientWidth;window.gsMemo.currentMouseTarget.lastHeight=window.gsMemo.currentMouseTarget.clientHeight;GS.triggerEvent(window.gsMemo.currentMouseTarget.parentNode,'size-changed');}});window.addEventListener('mouseup',function(event){window.bolFirstMouseMoveWhileDown=true;});}
document.addEventListener('DOMContentLoaded',function(){'use strict';var multiLineTemplateElement=document.createElement('template'),multiLineTemplate;multiLineTemplateElement.innerHTML='<textarea class="control" gs-dynamic></textarea>';multiLineTemplate=multiLineTemplateElement.content;function changeFunction(event){event.preventDefault();event.stopPropagation();GS.triggerEvent(event.target.parentNode,'change');}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function keydownFunction(event){var element=event.target;if(!element.hasAttribute('readonly')){if(element.getAttribute('disabled')!==null&&!(event.keyCode===122&&event.metaKey)){event.preventDefault();event.stopPropagation();}else if(event.keyCode===9&&element.parentNode.hasAttribute('allow-tab-char')===true){event.preventDefault();event.stopPropagation();var cursor_pos_memo=parseInt(element.selectionStart,10);element.value=element.value.substring(0,cursor_pos_memo)+'\t'+element.value.substring(cursor_pos_memo,element.value.length);GS.setInputSelection(element,parseInt(cursor_pos_memo,10)+1,parseInt(cursor_pos_memo,10)+1);}else{element.parentNode.setAttribute('value',element.value);element.parentNode.handleResizeToText();}}}
function keyupFunction(event){var element=event.target;if(!element.hasAttribute('readonly')){element.parentNode.setAttribute('value',element.value);element.parentNode.handleResizeToText();}}
function insertFunction(event){var element=event.target;element.parentNode.handleResizeToText();}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function createPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.value=strQSValue;}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('tabindex')){element.setAttribute('data-tabindex',element.getAttribute('tabindex'));element.removeAttribute('tabindex');}
element.appendChild(multiLineTemplate.cloneNode(true));if(element.hasAttribute('data-tabindex')){xtag.query(element,'.control')[0].setAttribute('tabindex',element.getAttribute('data-tabindex'));}
element.control=xtag.queryChildren(element,'.control')[0];element.control.lastWidth=element.control.clientWidth;element.control.lastHeight=element.control.clientHeight;element.syncView();if(element.getAttribute('qs')){createPushReplacePopHandler(element);window.addEventListener('pushstate',function(){createPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){createPushReplacePopHandler(element);});window.addEventListener('popstate',function(){createPushReplacePopHandler(element);});}}}}
xtag.register('gs-memo',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='disabled'&&newValue!==null){this.innerHTML=this.getAttribute('value')||this.getAttribute('placeholder');}else if(strAttrName==='disabled'&&newValue===null){this.innerHTML='';this.appendChild(multiLineTemplate.cloneNode(true));if(this.hasAttribute('data-tabindex')){xtag.query(this,'.control')[0].setAttribute('tabindex',this.getAttribute('data-tabindex'));}
this.control=xtag.queryChildren(this,'.control')[0];this.control.lastWidth=this.control.clientWidth;this.control.lastHeight=this.control.clientHeight;this.syncView();}else if(strAttrName==='value'&&newValue!==oldValue){this.value=newValue;}}}},events:{},accessors:{value:{get:function(){if(this.control){return this.control.value;}else{return this.innerHTML;}},set:function(strNewValue){if(this.getAttribute('value')!==strNewValue){this.setAttribute('value',strNewValue);}
if(this.control){this.control.value=strNewValue;}else{this.innerHTML=strNewValue;}
this.syncView();}},textValue:{get:function(){if(this.control){return this.control.value;}else{return this.innerHTML;}},set:function(newValue){this.value=newValue;}}},methods:{focus:function(){if(this.control){this.control.focus();}},syncView:function(){var element=this,arrPassThroughAttributes,i,len;/*
                if (this.innerHTML === '') {
                    this.appendChild(multiLineTemplate.cloneNode(true));
                }
                */
/*
                if ((! this.hasAttribute('disabled')) && (! this.control)) {
                    this.appendChild(multiLineTemplate.cloneNode(true));
                    // set a variable with the control element for convenience and speed
                    this.control = xtag.queryChildren(this, '.control')[0];
                    
                    this.control.lastWidth = this.control.clientWidth;
                    this.control.lastHeight = this.control.clientHeight;
                }
                */
if(this.hasAttribute('rows')){if(this.control){this.control.setAttribute('rows',this.getAttribute('rows'));}}
if(this.control){this.control.removeEventListener('change',changeFunction);this.control.addEventListener('change',changeFunction);this.control.removeEventListener('focus',focusFunction);this.control.addEventListener('focus',focusFunction);this.control.removeEventListener('blur',blurFunction);this.control.addEventListener('blur',blurFunction);this.control.removeEventListener(evt.mouseout,mouseoutFunction);this.control.addEventListener(evt.mouseout,mouseoutFunction);this.control.removeEventListener(evt.mouseout,mouseoverFunction);this.control.addEventListener(evt.mouseover,mouseoverFunction);this.control.removeEventListener('keydown',keydownFunction);this.control.addEventListener('keydown',keydownFunction);this.control.removeEventListener('insert',insertFunction);this.control.addEventListener('insert',insertFunction);}
if(this.control){this.control.value=this.getAttribute('value');}else{this.innerHTML=this.getAttribute('value')||this.getAttribute('placeholder')||'';}
if(this.getAttribute('value')){this.handleResizeToText();}
if(this.control){arrPassThroughAttributes=['placeholder','name','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','rows','spellcheck','readonly'];for(i=0,len=arrPassThroughAttributes.length;i<len;i+=1){if(this.hasAttribute(arrPassThroughAttributes[i])){this.control.setAttribute(arrPassThroughAttributes[i],this.getAttribute(arrPassThroughAttributes[i])||'');}}}},handleResizeToText:function(){var element=this,intMinHeight;if(element.control){if(element.hasAttribute('autoresize')){element.control.style.height='';intMinHeight=element.control.offsetHeight;element.control.style.height='';if(element.control.scrollHeight>intMinHeight){element.control.style.height=element.control.scrollHeight+'px';}else{element.control.style.height=intMinHeight+'px';}}
if(element.control.lastWidth!==element.control.clientWidth&&element.control.lastHeight!==element.control.clientHeight){element.control.lastWidth=element.control.clientWidth;element.control.lastHeight=element.control.clientHeight;GS.triggerEvent(element,'size-changed');}}}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-scroller>','<gs-scroller>','gs-scroller>\n'+'    <gs-scroller-inner style="width: ${1:1000px}; height: ${2:1000px};">\n'+'        ${0}\n'+'    </gs-scroller-inner>\n'+'</gs-scroller>');designRegisterElement('gs-scroller','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-scroller.html');window.designElementProperty_GSSCROLLER=function(selectedElement){addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});};});Math.easeOutQuad=function(current_time,start_value,end_change,end_time){'use strict';current_time/=end_time;return-end_change*current_time*(current_time-2)+start_value;};document.addEventListener('DOMContentLoaded',function(){'use strict';function easeOutX(dragElement,target,bolRight,intXDelta,intervalEaseXID){var intFrames=Math.ceil(intXDelta/0.25),intFrame=0,intInterval=20,intTotalTime=(intFrames*intInterval);if(intXDelta>5){intervalEaseXID=setInterval(function(){var intLeft;if(intFrame<intFrames){intLeft=parseInt(dragElement.style.left,10);if(bolRight){intLeft=intLeft-Math.easeOutQuad((intFrame*intInterval),intXDelta,-intXDelta,intTotalTime);}else{intLeft=intLeft+Math.easeOutQuad((intFrame*intInterval),intXDelta,-intXDelta,intTotalTime);}
setElementLeft(dragElement,target,intLeft);}else{clearTimeout(intervalEaseXID);}
intFrame+=1;},intInterval);}
return intervalEaseXID;}
function easeOutY(dragElement,target,bolBottom,intYDelta,intervalEaseYID){var intFrames=Math.ceil(intYDelta/0.25),intFrame=0,intInterval=20,intTotalTime=(intFrames*intInterval);if(intYDelta>5){intervalEaseYID=setInterval(function(){var intTop;if(intFrame<intFrames){intTop=parseInt(dragElement.style.top,10);if(bolBottom){intTop=intTop-Math.easeOutQuad((intFrame*intInterval),intYDelta,-intYDelta,intTotalTime);}else{intTop=intTop+Math.easeOutQuad((intFrame*intInterval),intYDelta,-intYDelta,intTotalTime);}
setElementTop(dragElement,target,intTop);}else{clearTimeout(intervalEaseYID);}
intFrame+=1;},intInterval);}
return intervalEaseYID;}
function setElementLeft(dragElement,target,intLeft){var intWidth=dragElement.offsetWidth,minRight=target.offsetWidth;if((intLeft+intWidth)<minRight){intLeft=(minRight-intWidth);}
if(intLeft>0){intLeft=0;}
dragElement.style.left=intLeft+'px';}
function setElementTop(dragElement,target,intTop){var intHeight=dragElement.offsetHeight,minBottom=target.offsetHeight;if((intTop+intHeight)<minBottom){intTop=(minBottom-intHeight);}
if(intTop>0){intTop=0;}
dragElement.style.top=intTop+'px';}
function handleVerticalBoundries(dragElement,target){var intTop=parseFloat(dragElement.style.top),intHeight=dragElement.offsetHeight,minBottom=target.offsetHeight;if((intTop+intHeight)<minBottom){intTop=(minBottom-intHeight);}
if(intTop>0){intTop=0;}
dragElement.style.top=intTop+'px';}
function handleHorizontalBoundries(dragElement,target){var intLeft=parseFloat(dragElement.style.left),intWidth=dragElement.offsetWidth,minRight=target.offsetWidth;if((intLeft+intWidth)<minRight){intLeft=(minRight-intWidth);}
if(intLeft>0){intLeft=0;}
dragElement.style.left=intLeft+'px';}
function bindEvents(element){var target=element,dragElement=element.children[0],intervalEaseXID,intervalEaseYID,lastClearTime,intScrollDelta=0,minZoom=0.5,maxZoom=6;target.addEventListener('wheel',function(event){var intDelta=event.deltaY,intNewZoom,currentTime,jsnMousePosition=GS.mousePosition(event),mouseEMX,mouseEMY,mousePXX,mousePXY,jsnOffsets=GS.getElementOffset(dragElement),jsnTargetOffset,intCurrentZoom=(parseFloat(dragElement.style.fontSize)||1),intOldHeight=dragElement.offsetHeight,intOldWidth=dragElement.offsetWidth,intNewHeight,intNewWidth,intWidthDifference,intHeightDifference,intRelativeX,intRelativeY,intPercentX,intPercentY;event.preventDefault();event.stopPropagation();mousePXY=(jsnMousePosition.y-jsnOffsets.top);mousePXX=(jsnMousePosition.x-jsnOffsets.left);mouseEMY=GS.pxToEm(dragElement,mousePXY);mouseEMX=GS.pxToEm(dragElement,mousePXX);if(lastClearTime){currentTime=new Date().getTime();if((currentTime-lastClearTime)>200){intScrollDelta=0;lastClearTime=new Date().getTime();}}
lastClearTime=new Date().getTime();if(intDelta<0){intScrollDelta=(intScrollDelta>0?intScrollDelta:0);intScrollDelta=0.05;if(intCurrentZoom<maxZoom){intScrollDelta+=0.05;}else{intScrollDelta=0;}}else{intScrollDelta=(intScrollDelta<0?intScrollDelta:0);intScrollDelta=-0.05;if(intCurrentZoom>minZoom){intScrollDelta-=0.05;}else{intScrollDelta=0;}}
intNewZoom=(intCurrentZoom+intScrollDelta);intNewZoom=(intNewZoom>maxZoom?maxZoom:intNewZoom);intNewZoom=(intNewZoom<minZoom?minZoom:intNewZoom);dragElement.style.fontSize=intNewZoom+'em';if(intCurrentZoom!==intNewZoom){intNewWidth=dragElement.offsetWidth;intNewHeight=dragElement.offsetHeight;intWidthDifference=(intNewWidth-intOldWidth);intHeightDifference=(intNewHeight-intOldHeight);jsnTargetOffset=GS.getElementOffset(dragElement);intRelativeX=(jsnMousePosition.x-jsnTargetOffset.left);intRelativeY=(jsnMousePosition.y-jsnTargetOffset.top);intPercentX=((intRelativeX/intOldWidth)*100);intPercentY=((intRelativeY/intOldHeight)*100);dragElement.style.left=(parseFloat(dragElement.style.left||'0')-((intWidthDifference/100)*intPercentX))+'px';dragElement.style.top=(parseFloat(dragElement.style.top||'0')-((intHeightDifference/100)*intPercentY))+'px';}
handleVerticalBoundries(dragElement,target);handleHorizontalBoundries(dragElement,target);});target.addEventListener(evt.mousedown,function(event){var jsnMousePosition=GS.mousePosition(event),jsnTargetOffsets=GS.getElementOffset(target),jsnOffsets=GS.getElementOffset(dragElement),startX=jsnMousePosition.x,startY=jsnMousePosition.y,offsetX=jsnOffsets.left-jsnTargetOffsets.left,offsetY=jsnOffsets.top-jsnTargetOffsets.top,lastX=0,lastY=0,currentX=0,currentY=0,deltaX,deltaY,mousemoveHandler,mouseupHandler;event.preventDefault();clearTimeout(intervalEaseXID);clearTimeout(intervalEaseYID);dragElement.classList.add('down');mousemoveHandler=function(event){var jsnMousePosition;if(event.which===0&&!evt.touchDevice){mouseupHandler(event);}else{jsnMousePosition=GS.mousePosition(event);lastX=currentX;lastY=currentY;currentX=jsnMousePosition.x;currentY=jsnMousePosition.y;setElementLeft(dragElement,target,(offsetX+(currentX-startX)));setElementTop(dragElement,target,(offsetY+(currentY-startY)));event.preventDefault();}};mouseupHandler=function(event){deltaX=lastX-currentX;deltaY=lastY-currentY;intervalEaseXID=easeOutX(dragElement,target,(deltaX>0),Math.abs(deltaX),intervalEaseXID);intervalEaseYID=easeOutY(dragElement,target,(deltaY>0),Math.abs(deltaY),intervalEaseYID);dragElement.classList.remove('down');document.body.removeEventListener(evt.mousemove,mousemoveHandler);document.body.removeEventListener(evt.mouseup,mouseupHandler);};document.body.addEventListener(evt.mousemove,mousemoveHandler);document.body.addEventListener(evt.mouseup,mouseupHandler);});}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;if(element.children.length>1){throw'gs-scroller Error: Too many children. gs-scroller elements must have one child and it must be a <gs-scroller-inner> element.';}else if(element.children.length===0){throw'gs-scroller Error: No children. gs-scroller elements must have one child and it must be a <gs-scroller-inner> element.';}else if(element.children[0].nodeName!=='GS-SCROLLER-INNER'){throw'gs-scroller Error: Invalid child. gs-scroller elements must have one child and it must be a <gs-scroller-inner> element.';}
if(!evt.touchDevice){bindEvents(element);element.children[0].setAttribute('title','Click and drag to move around, scroll to zoom.');}else{element.classList.add('scrollable');}}}}
xtag.register('gs-scroller-inner',{});xtag.register('gs-scroller',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-number>','<gs-number>','gs-number column="${1:name}"></gs-number>');registerDesignSnippet('<gs-number> With Label','<gs-number>','label for="${1:number-insert-qty}">${2:Quantity}:</label>\n'+'<gs-number id="${1:number-insert-qty}" column="${3:qty}"></gs-number>');designRegisterElement('gs-number','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-number.html');window.designElementProperty_GSNUMBER=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'placeholder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var singleLineTemplateElement=document.createElement('template'),singleLineTemplate;singleLineTemplateElement.innerHTML='<input class="control" gs-dynamic type="text" />';singleLineTemplate=singleLineTemplateElement.content;function changeFunction(event){event.preventDefault();event.stopPropagation();GS.triggerEvent(event.target.parentNode,'change');handleFormat(event.target.parentNode,event);}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function createPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function syncView(element){if(element.control){if(element.getAttribute('value')!==element.control.value){element.setAttribute('value',element.control.value);}}else{if(element.getAttribute('value')!==element.innerHTML){element.setAttribute('value',element.innerHTML);}}}
function handleFormat(element,event,bolAlertOnError){var strFormat,intValue;if(element.hasAttribute('format')){strFormat=element.getAttribute('format');intValue=element.value;if(isNaN(intValue)){if(bolAlertOnError!==undefined&&bolAlertOnError!==false){alert('Invalid Number: '+element.value);}
if(element.control){GS.setInputSelection(element.control,0,element.value.length);}
if(event){event.stopPropagation();event.preventDefault();}}else{if(element.control){element.control.value=formatNumber(intValue,strFormat);}else{element.innerHTML=formatNumber(intValue,strFormat);}}}}
function formatNumber(intValue,strFormat){/* (this function contains a (modified) substantial portion of code from another source
            here is the copyright for sake of legality) (Uses code by Matt Kruse)
        Copyright (c) 2006-2009 Rostislav Hristov, Asual DZZD

        Permission is hereby granted, free of charge, to any person obtaining a
        copy of this software and associated documentation files
        (the "Software"), to deal in the Software without restriction,
        including without limitation the rights to use, copy, modify, merge,
        publish, distribute, sublicense, and/or sell copies of the Software,
        and to permit persons to whom the Software is furnished to do so,
        subject to the following conditions:

        The above copyright notice and this permission notice shall be included
        in all copies or substantial portions of the Software.

        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
        OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
        MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
        IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
        CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
        TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
        SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.*/
var groupingSeparator,groupingIndex,decimalSeparator,decimalIndex,roundFactor,result,i,locale={groupingSeparator:',',decimalSeparator:'.',currencySymbol:'$',percentSymbol:'%'};if(strFormat.toLowerCase()==='currency'){strFormat=locale.currencySymbol+'0.00';}else if(strFormat.toLowerCase()==='percent'){intValue=intValue*100;strFormat=locale.percentSymbol+'0.00';}
var integer='',fraction='',negative,minFraction,maxFraction,powFraction,bolCurrencySymbol=strFormat[0]===locale.currencySymbol,bolPercentSymbol=strFormat[0]===locale.percentSymbol;if(bolCurrencySymbol||bolPercentSymbol){strFormat=strFormat.substring(1);}
groupingSeparator=',';groupingIndex=strFormat.lastIndexOf(groupingSeparator);decimalSeparator='.';decimalIndex=strFormat.indexOf(decimalSeparator);negative=intValue<0;minFraction=strFormat.substr(decimalIndex+1).replace(/#/g,'').length;maxFraction=strFormat.substr(decimalIndex+1).length;powFraction=10;intValue=Math.abs(intValue);if(decimalIndex!=-1){fraction=locale.decimalSeparator;if(maxFraction>0){roundFactor=1000;powFraction=Math.pow(powFraction,maxFraction);var tempRound=Math.round(parseInt(intValue*powFraction*roundFactor-
Math.round(intValue)*powFraction*roundFactor,10)/roundFactor),tempFraction=String(tempRound<0?Math.round(parseInt(intValue*powFraction*roundFactor-
parseInt(intValue,10)*powFraction*roundFactor,10)/roundFactor):tempRound),parts=intValue.toString().split('.');if(typeof parts[1]!='undefined'){for(i=0;i<maxFraction;i++){if(parts[1].substr(i,1)=='0'&&i<maxFraction-1&&tempFraction.length!=maxFraction){tempFraction='0'+tempFraction;}else{break;}}}
for(i=0;i<(maxFraction-fraction.length);i++){tempFraction+='0';}
var symbol,formattedFraction='';for(i=0;i<tempFraction.length;i++){symbol=tempFraction.substr(i,1);if(i>=minFraction&&symbol=='0'&&(/^0*$/).test(tempFraction.substr(i+1))){break;}
formattedFraction+=symbol;}
fraction+=formattedFraction;}
if(fraction==locale.decimalSeparator){fraction='';}}
if(decimalIndex!==0){if(fraction!==''){integer=String(parseInt(Math.round(intValue*powFraction)/powFraction,10));}else{integer=String(Math.round(intValue));}
var grouping=locale.groupingSeparator,groupingSize=0;if(groupingIndex!=-1){if(decimalIndex!=-1){groupingSize=decimalIndex-groupingIndex;}else{groupingSize=strFormat.length-groupingIndex;}
groupingSize--;}
if(groupingSize>0){var count=0,formattedInteger='';i=integer.length;while(i--){if(count!==0&&count%groupingSize===0){formattedInteger=grouping+formattedInteger;}
formattedInteger=integer.substr(i,1)+formattedInteger;count++;}
integer=formattedInteger;}
var maxInteger,maxRegExp=/#|,/g;if(decimalIndex!=-1){maxInteger=strFormat.substr(0,decimalIndex).replace(maxRegExp,'').length;}else{maxInteger=strFormat.replace(maxRegExp,'').length;}
var tempInteger=integer.length;for(i=tempInteger;i<maxInteger;i++){integer='0'+integer;}}
result=integer+fraction;return(bolPercentSymbol?locale.percentSymbol:'')+
(bolCurrencySymbol?locale.currencySymbol:'')+
(negative?'-':'')+result;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('tabindex')){element.setAttribute('data-tabindex',element.getAttribute('tabindex'));element.removeAttribute('tabindex');}
if(element.hasAttribute('disabled')){element.innerHTML=element.getAttribute('value')||element.getAttribute('placeholder');}else{element.innerHTML='';element.appendChild(singleLineTemplate.cloneNode(true));if(element.hasAttribute('data-tabindex')){xtag.query(element,'.control')[0].setAttribute('tabindex',element.getAttribute('data-tabindex'));}}
if(element.getAttribute('qs')){createPushReplacePopHandler(element);window.addEventListener('pushstate',function(){createPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){createPushReplacePopHandler(element);});window.addEventListener('popstate',function(){createPushReplacePopHandler(element);});}
if(element.innerHTML===''){element.appendChild(singleLineTemplate.cloneNode(true));if(element.hasAttribute('data-tabindex')){xtag.query(element,'.control')[0].setAttribute('tabindex',element.getAttribute('data-tabindex'));}}
element.refresh();}}}
xtag.register('gs-number',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='disabled'){if(this.hasAttribute('tabindex')){this.setAttribute('data-tabindex',this.getAttribute('tabindex'));this.removeAttribute('tabindex');}
if(this.hasAttribute('disabled')){this.innerHTML=this.getAttribute('value')||this.getAttribute('placeholder');}else{this.innerHTML='';this.appendChild(singleLineTemplate.cloneNode(true));if(this.hasAttribute('data-tabindex')){xtag.query(this,'.control')[0].setAttribute('tabindex',this.getAttribute('data-tabindex'));}}
this.refresh();}else if(strAttrName==='value'&&newValue!==oldValue){this.value=newValue;}}}},events:{keydown:function(event){if(window.bolDesignMode!==true){if(this.getAttribute('disabled')!==null&&event.keyCode!==9){event.preventDefault();event.stopPropagation();}else{syncView(this);}}},keyup:function(){if(window.bolDesignMode!==true){syncView(this);}}},accessors:{value:{get:function(){if(this.control){return parseFloat(this.control.value.replace(/[^-0-9.]*/g,''),10);}else{return parseFloat(this.innerHTML.replace(/[^-0-9.]*/g,''),10);}},set:function(strNewValue){var selection;if(this.control){selection=GS.getInputSelection(this.control);this.control.value=strNewValue;}else{this.innerHTML=strNewValue;}
handleFormat(this);syncView(this);if(selection){GS.setInputSelection(this.control,selection.start,selection.end);}}}},methods:{focus:function(){this.control.focus();},refresh:function(){var arrPassThroughAttributes,i,len;this.control=xtag.query(this,'.control')[0];if(this.control){this.control.removeEventListener('change',changeFunction);this.control.addEventListener('change',changeFunction);this.control.removeEventListener('focus',focusFunction);this.control.addEventListener('focus',focusFunction);this.control.removeEventListener('blur',blurFunction);this.control.addEventListener('blur',blurFunction);this.control.removeEventListener(evt.mouseout,mouseoutFunction);this.control.addEventListener(evt.mouseout,mouseoutFunction);this.control.removeEventListener(evt.mouseover,mouseoverFunction);this.control.addEventListener(evt.mouseover,mouseoverFunction);}
if(this.hasAttribute('value')){if(this.control){this.control.value=this.getAttribute('value')||this.getAttribute('placeholder');}else{this.innerHTML=this.getAttribute('value')||this.getAttribute('placeholder');}
handleFormat(this,undefined,false);}
if(this.control){arrPassThroughAttributes=['placeholder','name','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','spellcheck','readonly'];for(i=0,len=arrPassThroughAttributes.length;i<len;i+=1){if(this.hasAttribute(arrPassThroughAttributes[i])){this.control.setAttribute(arrPassThroughAttributes[i],this.getAttribute(arrPassThroughAttributes[i])||'');}}}}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-optionbox>','<gs-optionbox>','gs-optionbox column="${1}">\n'+'    <gs-option value="${2}">${3}</gs-option>\n'+'</gs-optionbox>');designRegisterElement('gs-optionbox','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-optionbox.html');window.designElementProperty_GSOPTIONBOX=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Clearable',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('clearable')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'clearable',this.value==='true',true);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',this.value==='true',true);});addProp('No Targets',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('no-target')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-target',this.value==='true',true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);};/*
    window.designElementProperty_GSOPTION = function(selectedElement) {
        addProp('Hidden Value:', true, '<gs-text class="target" value="' + (selectedElement.getAttribute('value') || '') + '" mini></gs-text>', function () {
            return setOrRemoveTextAttribute(selectedElement, 'value', this.value);
        });
        
        // TITLE attribute
        addProp('Title', true, '<gs-text class="target" value="' + (selectedElement.getAttribute('title') || '') + '" mini></gs-text>', function () {
            return setOrRemoveTextAttribute(selectedElement, 'title', this.value);
        });
        
        addFlexContainerProps(selectedElement);
        //addFlexProps(selectedElement);
    };*/});document.addEventListener('DOMContentLoaded',function(){'use strict';function highlightOption(element,option){var i,len,arrSelectedOptions,arrTempSelectedOptions;arrSelectedOptions=xtag.query(element,'gs-option[selected]');arrTempSelectedOptions=xtag.query(element,'gs-option[tempselect]');for(i=0,len=arrSelectedOptions.length;i<len;i+=1){arrSelectedOptions[i].removeAttribute('selected');}
for(i=0,len=arrTempSelectedOptions.length;i<len;i+=1){arrTempSelectedOptions[i].removeAttribute('tempselect');}
if(option){option.setAttribute('selected','');}}
function findOptionFromString(element,strSearchString){var i,len,matchedOption,arrOptions=xtag.query(element,'gs-option');for(i=0,len=arrOptions.length;i<len;i+=1){if(arrOptions[i].getAttribute('value')===strSearchString||arrOptions[i].textContent===strSearchString){matchedOption=arrOptions[i];break;}}
return matchedOption;}
function selectOption(element,handle,bolChange){var option,strOptionValue,strOptionText;if(typeof handle==='string'){option=findOptionFromString(element,handle);if(!option){throw'gs-optionbox Error: value: \''+handle+'\' not found.';}}else{option=handle;}
highlightOption(element,option);if(option){strOptionValue=option.getAttribute('value');strOptionText=option.textContent;}else{strOptionValue='';strOptionText='';}
if(element.value!==(strOptionValue||strOptionText)){element.innerValue=strOptionValue||strOptionText;element.innerSelectedOption=option;if(bolChange){xtag.fireEvent(element,'change',{bubbles:true,cancelable:true});}}}
/*
    // handle behaviours on keydown
    function handleKeyDown(event) {
        var element = event.target, intKeyCode = event.keyCode || event.which,
            selectedOption, selectedOptionIndex,
            tempSelectedOption, tempSelectedOptionIndex, arrOptions, i, len;

        if (!element.hasAttribute('disabled')) {
            if ((intKeyCode === 40 || intKeyCode === 38) && !event.shiftKey && !event.metaKey && !event.ctrlKey && !element.error) {
                arrOptions = xtag.query(element, 'gs-option');

                for (i = 0, len = arrOptions.length; i < len; i += 1) {
                    if (arrOptions[i].hasAttribute('tempselect')) {
                        tempSelectedOptionIndex = i;
                        tempSelectedOption = arrOptions[i];
                        arrOptions[i].removeAttribute('tempselect');
                    }

                    if (arrOptions[i].hasAttribute('selected')) {
                        selectedOptionIndex = i;
                        selectedOption = arrOptions[i];
                    }

                    if (selectedOption && tempSelectedOption) {
                        break;
                    }
                }

                //console.log(selectedOption, selectedOptionIndex, tempSelectedOption, tempSelectedOptionIndex, arrOptions.length);

                if (tempSelectedOption && tempSelectedOptionIndex !== arrOptions.length - 1 && intKeyCode === 40) {
                    if (!arrOptions[tempSelectedOptionIndex + 1].hasAttribute('selected')) {
                        arrOptions[tempSelectedOptionIndex + 1].setAttribute('tempselect', '');
                    }
                } else if (tempSelectedOption && tempSelectedOptionIndex !== 0 && intKeyCode === 38) {
                    if (!arrOptions[tempSelectedOptionIndex - 1].hasAttribute('selected')) {
                        arrOptions[tempSelectedOptionIndex - 1].setAttribute('tempselect', '');
                    }
                } else if (!tempSelectedOption && selectedOption && selectedOptionIndex !== arrOptions.length - 1 && intKeyCode === 40) {
                    if (!arrOptions[selectedOptionIndex + 1].hasAttribute('selected')) {
                        arrOptions[selectedOptionIndex + 1].setAttribute('tempselect', '');
                    }
                } else if (!tempSelectedOption && selectedOption && selectedOptionIndex !== 0 && intKeyCode === 38) {
                    if (!arrOptions[selectedOptionIndex - 1].hasAttribute('selected')) {
                        arrOptions[selectedOptionIndex - 1].setAttribute('tempselect', '');
                    }
                // tempselect first record
                } else if (intKeyCode === 40) {
                    if (!arrOptions[0].hasAttribute('selected')) {
                        arrOptions[0].setAttribute('tempselect', '');
                    }
                // tempselect last record
                } else if (intKeyCode === 38) {
                    if (!arrOptions[arrOptions.length - 1].hasAttribute('selected')) {
                        arrOptions[arrOptions.length - 1].setAttribute('tempselect', '');
                    }
                }
                event.preventDefault();
                event.stopPropagation();

            } else if (event.keyCode === 13 || event.keyCode === 32) {
                selectedOption = xtag.query(element, 'gs-option[selected]')[0];
                tempSelectedOption = xtag.query(element, 'gs-option[tempselect]')[0];

                if (tempSelectedOption) {
                    selectOption(element, tempSelectedOption, true);
                } else if (selectedOption) {
                    selectOption(element, selectedOption, true);
                }
            }
        } else {
            if (event.keyCode !== 9) {
                event.preventDefault();
                event.stopPropagation();
            }
        }

        //console.log('handleKeyDown', intKeyCode, event);
    }*/
function getParentOption(element){var currentElement=element;while(currentElement.nodeName!=='GS-OPTION'&&currentElement.nodeName!=='HTML'){currentElement=currentElement.parentNode;}
if(currentElement.nodeName!=='GS-OPTION'){return undefined;}
return currentElement;}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function createPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function enhanceChildren(element){var arrElement,i,len;arrElement=xtag.query(element,'gs-option');for(i=0,len=arrElement.length;i<len;i+=1){if(!arrElement[i].hasAttribute('icontop')&&!arrElement[i].hasAttribute('iconleft')&&!arrElement[i].hasAttribute('iconbottom')&&!arrElement[i].hasAttribute('iconright')){arrElement[i].setAttribute('iconleft','');}
arrElement[i].setAttribute('icon','');}}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){var strQSValue,observer;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.getAttribute('value')){selectOption(element,element.getAttribute('value'),false);}
if(element.getAttribute('qs')){createPushReplacePopHandler(element);window.addEventListener('pushstate',function(){createPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){createPushReplacePopHandler(element);});window.addEventListener('popstate',function(){createPushReplacePopHandler(element);});}
if(!element.hasAttribute('no-target')){enhanceChildren(element);observer=new MutationObserver(function(mutations){var bolRefreshOptionList=true;mutations.forEach(function(mutation){var i,len;for(i=0,len=mutation.addedNodes.length;i<len;i+=1){if(mutation.addedNodes[i].nodeName!=='GS-OPTION'){bolRefreshOptionList=false;}}});if(bolRefreshOptionList){enhanceChildren(element);}});observer.observe(element,{childList:true});}}}}
xtag.register('gs-optionbox',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='value'&&newValue!==oldValue){selectOption(this,newValue);}}}},events:{'click':function(event){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')&&!this.hasAttribute('readonly')){var parentOption=getParentOption(event.target);if(parentOption&&!parentOption.hasAttribute('selected')){selectOption(this,parentOption,true);}else if(this.hasAttribute('clearable')){selectOption(this,undefined);}}}},accessors:{value:{get:function(){return this.innerValue;},set:function(strNewValue){selectOption(this,strNewValue);}},selectedOption:{get:function(){return this.innerSelectedOption;},set:function(newValue){selectOption(this,newValue);}},textValue:{get:function(){return this.innerSelectedOption.textContent;},set:function(newValue){selectOption(this,newValue);}}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('Empty <gs-page>','<gs-page>','gs-page>\n'+'    $0\n'+'</gs-page>');registerDesignSnippet('<gs-page> With Header','<gs-page>','gs-page>\n'+'    <gs-header>\n'+'        <center><h3>${1}</h3></center>\n'+'    </gs-header>\n'+'    <gs-body>\n'+'        $0\n'+'    </gs-body>\n'+'</gs-page>');registerDesignSnippet('Full <gs-page>','<gs-page>','gs-page>\n'+'    <gs-header>\n'+'        <center><h3>${1}</h3></center>\n'+'    </gs-header>\n'+'    <gs-body>\n'+'        $0\n'+'    </gs-body>\n'+'    <gs-footer>${2}</gs-footer>\n'+'</gs-page>');designRegisterElement('gs-page','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-page.html');window.designElementProperty_GSPAGE=function(selectedElement){addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function elementCreated(element){if(!element.hasAttribute('suspend-created')){var observer,headerElement=xtag.queryChildren(element,'gs-header')[0],footerElement=xtag.queryChildren(element,'gs-footer')[0];observer=new MutationObserver(function(mutations){element.recalculatePadding();});if(headerElement){observer.observe(headerElement,{childList:true,subtree:true});}
if(footerElement){observer.observe(footerElement,{childList:true,subtree:true});}}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.recalculatePadding();window.addEventListener('load',function(){element.recalculatePadding();});window.addEventListener('resize',function(){element.recalculatePadding();});element.recalculatePadding();}}}
xtag.register('gs-page',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{},accessors:{},methods:{recalculatePadding:function(){var headerElement=xtag.queryChildren(this,'gs-header')[0],footerElement=xtag.queryChildren(this,'gs-footer')[0];if(headerElement){this.style.paddingTop=headerElement.offsetHeight+'px';}else{this.style.paddingTop='';}
if(footerElement){this.style.paddingBottom=footerElement.offsetHeight+'px';}else{this.style.paddingBottom='';}}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-panel>','<gs-panel>','gs-panel id="panel">\n'+'    <gs-page id="${1:left-bar}" style="width: 17em;">\n'+'        \n'+'    </gs-page>\n'+'    <gs-page>\n'+'        \n'+'    </gs-page>\n'+'</gs-panel>');designRegisterElement('gs-panel','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-panel.html');window.designElementProperty_GSPANEL=function(selectedElement){addProp('Dismissible By Clicking The Shadow',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-shadow-dismiss'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-shadow-dismiss',this.value==='true',false);});addProp('Dismissible On Desktop',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('dismissible')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'dismissible',this.value==='true',true);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function pushReplacePopHandler(element){var query=GS.getQueryString(),arrQueryKeys=GS.qryGetKeys(query),strID=element.getAttribute('id'),strAttributeName,i,len,strNewValue;for(i=0,len=arrQueryKeys.length;i<len;i+=1){if(arrQueryKeys[i].indexOf(strID+'.')===0&&element.panelIDs.indexOf(arrQueryKeys[i].split('.')[1])>-1){strAttributeName=arrQueryKeys[i].split('.')[1];strNewValue=GS.qryGetVal(query,arrQueryKeys[i]);if(element.getAttribute(strAttributeName)!==strNewValue){element.setAttribute(strAttributeName,strNewValue);}}}
for(i=0,len=element.arrQueryStringAttributes.length;i<len;i+=1){if(arrQueryKeys.indexOf(element.arrQueryStringAttributes[i])===-1){element.removeAttribute(element.arrQueryStringAttributes[i].split('.')[1]);}}}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;var arrElement,i,len,blockerElement,blockerClickHandler;element.arrQueryStringAttributes=[];element.panelIDs=[];blockerClickHandler=function(event){var target=event.target;if(target.classList.contains('gs-panel-page-blocker')){element.hide(target.getAttribute('blocking'));}};arrElement=xtag.queryChildren(element,'*');for(i=0,len=arrElement.length;i<len;i+=1){if(arrElement[i].style.width===''){arrElement[i].setAttribute('flex','');}else{if(!arrElement[i].hasAttribute('id')){console.warn('gs-panel Warning: No ID attribute on side-page element:',GS.cloneElement(arrElement[i]),', please set ID the attribute');arrElement[i].setAttribute('id','side-'+GS.GUID().substring(0,8));}
element.panelIDs.push(arrElement[i].getAttribute('id'));blockerElement=document.createElement('div');blockerElement.classList.add('gs-panel-page-blocker');blockerElement.setAttribute('gs-dynamic','');blockerElement.setAttribute('blocking',arrElement[i].getAttribute('id'));blockerElement.setAttribute('id',arrElement[i].getAttribute('id')+'-blocker');element.insertBefore(blockerElement,arrElement[i]);arrElement[i].setAttribute('panel-set-width','');if(arrElement[i].hasAttribute('hidden')){arrElement[i].removeAttribute('hidden');element.hide(arrElement[i].getAttribute('id'));}else{if(element.getAttribute(arrElement[i].getAttribute('id'))==='hide'){element.hide(arrElement[i].getAttribute('id'));}}
if(!element.hasAttribute('no-shadow-dismiss')){blockerElement.addEventListener('click',blockerClickHandler);}}}
window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});if(element.hasAttribute('id')){pushReplacePopHandler(element);}}}}
xtag.register('gs-panel',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(document.getElementById(strAttrName)&&document.getElementById(strAttrName).parentNode===this){if(newValue==='hide'||newValue==='show'){this[newValue](strAttrName);}
/*if (newValue === 'hide') {
                            this.hide(strAttrName);
                        } else if (newValue === 'show') {
                            this.show(strAttrName);
                        }*/}}}},events:{},accessors:{},methods:{'show':function(strID){var strQueryString=GS.getQueryString(),strElementID=this.getAttribute('id');if((strElementID&&GS.qryGetKeys(strQueryString).indexOf(strElementID+'.'+strID)>-1)&&GS.qryGetVal(strQueryString,strElementID+'.'+strID)==='hide'){GS.pushQueryString(strElementID+'.'+strID+'=show');}else if(this.getAttribute(strID)==='show'){document.getElementById(strID).removeAttribute('panel-hide');document.getElementById(strID+'-blocker').removeAttribute('panel-hide');GS.triggerEvent(document.getElementById(strID),'show');GS.triggerEvent(window,'resize');}else{this.setAttribute(strID,'show');}},'hide':function(strID){var strQueryString=GS.getQueryString(),strElementID=this.getAttribute('id');if((strElementID&&GS.qryGetKeys(strQueryString).indexOf(strElementID+'.'+strID)>-1)&&GS.qryGetVal(strQueryString,strElementID+'.'+strID)==='show'){GS.pushQueryString(strElementID+'.'+strID+'=hide');}else if(this.getAttribute(strID)==='hide'){document.getElementById(strID).setAttribute('panel-hide','');document.getElementById(strID+'-blocker').setAttribute('panel-hide','');GS.triggerEvent(document.getElementById(strID),'hide');GS.triggerEvent(window,'resize');}else{this.setAttribute(strID,'hide');}},'toggle':function(strID){var element=document.getElementById(strID);if(element.hasAttribute('shown')||!element.hasAttribute('panel-hide')){this.hide(strID);}else{this.show(strID);}}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('Push Message','GS.pushMessage','pushMessage(\'${1:HTML}\', ${2:1500}, function () {${3}});');});GS.pushMessage=function(strHTML,intTime,callback){var pushMessageElement,containerElement;if(strHTML===undefined){throw'GS.pushMessage Error: no HTML to display.';}
if(document.getElementsByTagName('gs-pushmessage-container').length===0){containerElement=document.createElement('gs-pushmessage-container');containerElement.setAttribute('gs-dynamic','');document.body.appendChild(containerElement);}else{containerElement=document.getElementsByTagName('gs-pushmessage-container')[0];}
pushMessageElement=document.createElement('gs-pushmessage');pushMessageElement.setAttribute('gs-dynamic','');pushMessageElement.innerHTML=strHTML;containerElement.appendChild(pushMessageElement);if(typeof callback==='function'){callback.apply(pushMessageElement);}
if(intTime){setTimeout(function(){GS.closePushMessage(pushMessageElement);},intTime);}
return pushMessageElement;};window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('GS.closePushMessage','GS.closePushMessage','GS.closePushMessage(${0:pushMessageElement});');registerDesignSnippet('Close Push Message','Close Push Message','GS.closePushMessage(${0:pushMessageElement});');});GS.closePushMessage=function(pushMessageElement){var containerElement=document.getElementsByTagName('gs-pushmessage-container')[0];GS.animateStyle(pushMessageElement,'opacity','1','0',function(){if(document.getElementsByTagName('gs-pushmessage').length===1){document.body.removeChild(containerElement);}else{containerElement.removeChild(pushMessageElement);}},250,100);};document.addEventListener('DOMContentLoaded',function(){xtag.register('gs-pushmessage',{lifecycle:{},events:{},accessors:{},methods:{}});xtag.register('gs-pushmessage-container',{lifecycle:{},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-search>','<gs-search>','gs-search id="${1}"></gs-search>');designRegisterElement('gs-search','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-search.html');window.designElementProperty_GSSEARCH=function(selectedElement){addProp('Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'placeholder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var singleLineTemplateElement=document.createElement('template');var singleLineTemplate;singleLineTemplateElement.innerHTML='<input class="control" gs-dynamic type="text" placeholder="Search..." />';singleLineTemplate=singleLineTemplateElement.content;function changeFunction(event){event.preventDefault();event.stopPropagation();GS.triggerEvent(event.target.parentNode,'change');}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function loadPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol&&strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==element.getAttribute('value')&&(strQSValue!==''||!element.getAttribute('value'))){element.setAttribute('value',strQSValue);}}else{if(strQSValue!==element.getAttribute('value')){element.value=strQSValue;}}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('tabindex')){element.oldTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
element.refresh();loadPushReplacePopHandler(element);window.addEventListener('pushstate',function(){loadPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){loadPushReplacePopHandler(element);});window.addEventListener('popstate',function(){loadPushReplacePopHandler(element);});}}}
xtag.register('gs-search',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==='suspend-created'&&newValue===null){elementCreated(element);elementInserted(element);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(strAttrName==='disabled'){element.refresh();}else if(strAttrName==='value'&&newValue!==oldValue){element.value=newValue;}}}},events:{keydown:function(event){if(!this.hasAttribute('readonly')){if(this.hasAttribute('disabled')&&event.keyCode!==9){event.preventDefault();event.stopPropagation();}else{this.syncView();}}},keyup:function(){if(!this.hasAttribute('readonly')){this.syncView();}},change:function(){var strQueryString=GS.getQueryString(),strColumn=(this.getAttribute('qs')||this.getAttribute('id'));if((GS.qryGetVal(strQueryString,strColumn)||'')!==(this.control.value||'')){GS.pushQueryString(strColumn+'='+encodeURIComponent(this.control.value));}}},accessors:{value:{get:function(){if(this.control){return this.control.value;}else{return this.innerHTML;}},set:function(strNewValue){var element=this;if(element.control){if(element.control.value!==strNewValue){element.control.value=strNewValue;}}else{element.innerHTML=strNewValue;}
element.syncView();}}},methods:{focus:function(){if(this.control){this.control.focus();}},refresh:function(){var element=this;var arrPassThroughAttributes;var i;var len;element.innerHTML='';element.appendChild(singleLineTemplate.cloneNode(true));if(element.oldTabIndex){xtag.query(element,'.control')[0].setAttribute('tabindex',element.oldTabIndex);}
element.control=xtag.query(element,'.control')[0];element.control.removeEventListener('change',changeFunction);element.control.addEventListener('change',changeFunction);element.control.removeEventListener('focus',focusFunction);element.control.addEventListener('focus',focusFunction);element.control.removeEventListener('blur',blurFunction);element.control.addEventListener('blur',blurFunction);element.control.removeEventListener(evt.mouseout,mouseoutFunction);element.control.addEventListener(evt.mouseout,mouseoutFunction);element.control.removeEventListener(evt.mouseout,mouseoverFunction);element.control.addEventListener(evt.mouseover,mouseoverFunction);if(element.hasAttribute('value')){element.control.value=element.getAttribute('value');}
arrPassThroughAttributes=['placeholder','name','type','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','spellcheck','readonly'];for(i=0,len=arrPassThroughAttributes.length;i<len;i+=1){if(element.hasAttribute(arrPassThroughAttributes[i])){element.control.setAttribute(arrPassThroughAttributes[i],element.getAttribute(arrPassThroughAttributes[i])||'');}}},syncView:function(){if(this.control){if(this.getAttribute('value')!==this.control.value){this.setAttribute('value',this.control.value);}}else{this.innerHTML=this.control.value;}}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-select>','<gs-select>','gs-select>\n'+'    <option>${0}</option>\n'+'</gs-select>');designRegisterElement('gs-select','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-select.html');window.designElementProperty_GSSELECT=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';var templateElement=document.createElement('template'),template;templateElement.innerHTML='<select class="control" gs-dynamic></select>';template=templateElement.content;function changeFunction(event){event.preventDefault();event.stopPropagation();GS.triggerEvent(event.target.parentNode,'change');}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function createPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.value=strQSValue;}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){var strValue=element.value,observer;if(strValue){element.setAttribute('value',strValue);delete element.value;}
observer=new MutationObserver(function(mutations){var bolRefreshOptionList=true;mutations.forEach(function(mutation){var i,len;for(i=0,len=mutation.addedNodes.length;i<len;i+=1){if(mutation.addedNodes[i].nodeName!=='OPTION'&&mutation.addedNodes[i].nodeName!=='OPTGROUP'){bolRefreshOptionList=false;}}});if(bolRefreshOptionList){element.refreshOptionList();}});observer.observe(element,{childList:true});}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('tabindex')){element.oldTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
element.refreshOptionList();element.control.addEventListener('change',changeFunction);element.control.addEventListener('focus',focusFunction);element.control.addEventListener('blur',blurFunction);element.control.addEventListener(evt.mouseout,mouseoutFunction);element.control.addEventListener(evt.mouseover,mouseoverFunction);if(element.getAttribute('value')){element.value=element.getAttribute('value');}
if(element.getAttribute('qs')){createPushReplacePopHandler(element);window.addEventListener('pushstate',function(){createPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){createPushReplacePopHandler(element);});window.addEventListener('popstate',function(){createPushReplacePopHandler(element);});}}}}
xtag.register('gs-select',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='value'&&newValue!==oldValue){this.value=newValue;}}}},events:{'keydown':function(event){var intKeyCode=(event.keyCode||event.which);if(this.hasAttribute('readonly')&&((intKeyCode!==9&&!event.metaKey&&!event.ctrlKey&&!event.shiftKey)||intKeyCode===32)){event.preventDefault();}},'keyup':function(event){var intKeyCode=(event.keyCode||event.which);if(this.hasAttribute('readonly')&&((intKeyCode!==9&&!event.metaKey&&!event.ctrlKey&&!event.shiftKey)||intKeyCode===32)){event.preventDefault();}},'mousedown':function(event){if(this.hasAttribute('readonly')){if(evt.touchDevice===false){this.control.focus();}
event.preventDefault();}},'mouseup':function(event){if(this.hasAttribute('readonly')){event.preventDefault();}}},accessors:{value:{get:function(){if(this.control){return this.control.value;}else if(this.getAttribute('value')){return this.getAttribute('value');}
return undefined;},set:function(newValue){if(this.getAttribute('value')!==newValue){this.setAttribute('value',newValue);}
this.control.value=newValue;}},textValue:{get:function(){return this.control.options[this.control.selectedIndex].text;},set:function(newValue){this.setAttribute('value',newValue);this.control.value=newValue;}}},methods:{focus:function(){this.control.focus();},refreshOptionList:function(){var i,len,elementsToMove,oldvalue,arrChildren,controlElement;arrChildren=this.children;for(i=arrChildren.length-1;i>-1;i-=1){if(arrChildren[i].nodeName!=='OPTION'&&arrChildren[i].nodeName!=='OPTGROUP'&&arrChildren[i].nodeName!=='SELECT'&&arrChildren[i].classList.contains('control')){this.removeChild(arrChildren[i]);}}
controlElement=xtag.queryChildren(this,'.control')[0];if(controlElement){oldvalue=controlElement.value;this.oldcontrol=controlElement;controlElement.classList.remove('control');}
this.appendChild(template.cloneNode(true));this.control=xtag.query(this,'.control')[0];if(this.oldcontrol){elementsToMove=xtag.queryChildren(this.oldcontrol,'option, optgroup');for(i=0,len=elementsToMove.length;i<len;i+=1){elementsToMove[i].setAttribute('gs-hidden','');this.control.appendChild(elementsToMove[i]);}}
elementsToMove=xtag.queryChildren(this,'option, optgroup');for(i=0,len=elementsToMove.length;i<len;i+=1){this.control.appendChild(elementsToMove[i]);}
if(this.oldcontrol){if(this.oldcontrol.parentNode===this){this.removeChild(this.oldcontrol);}
this.oldcontrol=undefined;this.control.value=this.getAttribute('value')||oldvalue;}else if(this.hasAttribute('value')){this.control.value=this.getAttribute('value');}
if(this.oldTabIndex){this.control.setAttribute('tabindex',this.oldTabIndex);}}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-static>','<gs-static>','gs-static column="${1:name}"></gs-static>');designRegisterElement('gs-static','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-static.html');window.designElementProperty_GSSTATIC=function(selectedElement){addProp('Formatted&nbsp;Text',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('pre'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'pre',(this.value==='true'),true);});addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Inline',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('inline'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'inline',(this.value==='true'),true);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'    <option value="">Visible</option>'+'    <option value="hidden">Invisible</option>'+'    <option value="hide-on-desktop">Invisible at desktop size</option>'+'    <option value="hide-on-tablet">Invisible at tablet size</option>'+'    <option value="hide-on-phone">Invisible at phone size</option>'+'    <option value="show-on-desktop">Visible at desktop size</option>'+'    <option value="show-on-tablet">Visible at tablet size</option>'+'    <option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function createPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value&&!element.hasAttribute('value')){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);element.refresh();if(element.getAttribute('qs')){createPushReplacePopHandler(element);window.addEventListener('pushstate',function(){createPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){createPushReplacePopHandler(element);});window.addEventListener('popstate',function(){createPushReplacePopHandler(element);});}}}}
xtag.register('gs-static',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){this.refresh();}}},events:{},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(strNewValue){this.setAttribute('value',strNewValue);}}},methods:{refresh:function(){this.innerHTML=this.getAttribute('value');}}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-sticky>','<gs-sticky>','gs-sticky>\n'+'    <gs-sticky-inner>\n'+'        ${0}\n'+'    </gs-sticky-inner>\n'+'</gs-sticky>');designRegisterElement('gs-sticky','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-sticky.html');window.designElementProperty_GSSTICKY=function(selectedElement){addProp('Direction',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('direction')||'')+'" mini>'+'<option value="">Up</option>'+'<option value="down">Down</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'direction',this.value);});addProp('Always Stuck',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('stuck')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'stuck',this.value==='true',true);});addProp('Touch Devices Allowed',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('touch-device-allowed')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'touch-device-allowed',this.value==='true',true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function stickHandler(element){var bolTop=(element.getAttribute('direction')!=='down'),intScrollPosition=document.body.scrollTop,jsnElementPositionData=GS.getElementPositionData(element),bolShouldBeStuck=(bolTop&&jsnElementPositionData.intRoomAbove<0)||(!bolTop&&jsnElementPositionData.intRoomBelow<0);if(bolShouldBeStuck&&!element.hasAttribute('stuck')){element.style.height=element.offsetHeight+'px';element.setAttribute('stuck','');}else if(!bolShouldBeStuck&&element.hasAttribute('stuck')){element.style.height='';element.removeAttribute('stuck');}}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){var currentParent;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;if(element.children.length>1){throw'gs-sticky Error: Too many children. gs-sticky elements must have one child and it must be a <gs-sticky-inner> element.';}else if(element.children.length===0){throw'gs-sticky Error: No children. gs-sticky elements must have one child and it must be a <gs-sticky-inner> element.';}else if(element.children[0].nodeName!=='GS-STICKY-INNER'){throw'gs-sticky Error: Invalid child. gs-sticky elements must have one child and it must be a <gs-sticky-inner> element.';}
element.parentNode.style.height='auto';if(element.hasAttribute('stuck')){if(element.getAttribute('direction')!=='down'){element.parentNode.style.paddingTop=element.children[0].offsetHeight+'px';}else{element.parentNode.style.paddingBottom=element.children[0].offsetHeight+'px';}}
if(!element.hasAttribute('stuck')&&(!evt.touchDevice||element.hasAttribute('touch-device-allowed'))){stickHandler(element);currentParent=element.parentNode;if(currentParent.nodeName!=='BODY'){console.warn('gs-sticky Warning: Element not immediate child of BODY. This element was designed for being an immediate child of the BODY, doing otherwise may give unexpected results.');}
window.addEventListener('resize',function(){if(element.parentNode===currentParent){stickHandler(element);}});window.addEventListener('scroll',function(){if(element.parentNode===currentParent){stickHandler(element);}});window.addEventListener('orientationchange',function(){if(element.parentNode===currentParent){stickHandler(element);}});}}}}
xtag.register('gs-sticky-inner',{});xtag.register('gs-sticky',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{},accessors:{},methods:{}});});window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-switch>','<gs-switch>','gs-switch>\n'+'    <template for="${1:none}"></template>\n'+'    <template for="${2:detail}"></template>\n'+'</gs-switch>');designRegisterElement('gs-switch','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-switch.html');window.designElementProperty_GSSWITCH=function(selectedElement){addProp('Template',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'template',this.value);});addProp('Refresh On Querystring Columns',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('refresh-on-querystring-values')||'')+'" mini></gs-text>',function(){this.removeAttribute('refresh-on-querystring-change');return setOrRemoveTextAttribute(selectedElement,'refresh-on-querystring-values',this.value);});addProp('Refresh On Querystring Change',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('refresh-on-querystring-change'))+'" mini></gs-checkbox>',function(){this.removeAttribute('refresh-on-querystring-values');return setOrRemoveBooleanAttribute(selectedElement,'refresh-on-querystring-change',this.value==='true',true);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addFlexContainerProps(selectedElement);addFlexProps(selectedElement);addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function subsafeTemplate(strTemplate){var templateElement=document.createElement('template');var strID;var arrTemplates;var i;var len;var jsnTemplates;var strRet;var arrTemplateNames;templateElement.innerHTML=strTemplate;i=0;arrTemplates=xtag.query(templateElement.content,'template');jsnTemplates={};arrTemplateNames=[];while(arrTemplates.length>0&&i<100){if(arrTemplates[0].parentNode&&arrTemplates[0].parentNode.hasAttribute&&(arrTemplates[0].parentNode.hasAttribute('src')||arrTemplates[0].parentNode.hasAttribute('source'))){strID='UNIqUE_PLaCEhOLDER-'+GS.GUID()+'-UNiQUE_PLaCEhOLdER';jsnTemplates[strID]=arrTemplates[0].outerHTML;arrTemplates[0].outerHTML=strID;arrTemplateNames.push(strID);}else if(arrTemplates[0].content){arrTemplates.push.apply(arrTemplates,xtag.query(arrTemplates[0].content,'template'));}
arrTemplates.splice(0,1);i+=1;}
strRet=doT.template('{{##def.snippet:\n'+'    {{ var qs = GS.qryToJSON(GS.getQueryString()); }} {{# def.template }}\n'+'#}}\n'+'{{#def.snippet}}',null,{"template":templateElement.innerHTML})();i=0;len=arrTemplateNames.length;while(i<len){strRet=strRet.replace(new RegExp(arrTemplateNames[i],'g'),jsnTemplates[arrTemplateNames[i]].replace(/\$/g,'$$$$'));i+=1;}
return strRet;}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var arrPopKeys;var currentValue;var bolRefresh=false;var strOperator;if(strQSCol&&strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}
if(element.internal.bolQSFirstRun===true){if(element.hasAttribute('refresh-on-querystring-values')||element.hasAttribute('qs')){if(element.getAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);}else{arrPopKeys=[];}
if(strQSCol){GS.listAdd(arrPopKeys,strQSCol);}
i=0;len=arrPopKeys.length;while(i<len){currentValue=GS.qryGetVal(strQS,arrPopKeys[i]);if(element.popValues[arrPopKeys[i]]!==currentValue){bolRefresh=true;}
element.popValues[arrPopKeys[i]]=currentValue;i+=1;}}else if(element.hasAttribute('refresh-on-querystring-change')){bolRefresh=true;}else if(element.hasAttribute('template')||element.hasAttribute('value')){bolRefresh=true;}
if(bolRefresh){element.refresh();}}else{if(element.hasAttribute('refresh-on-querystring-values')){arrPopKeys=element.getAttribute('refresh-on-querystring-values').split(/\s*,\s*/gim);i=0;len=arrPopKeys.length;while(i<len){element.popValues[arrPopKeys[i]]=GS.qryGetVal(strQS,arrPopKeys[i]);i+=1;}}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){if(element.hasAttribute('value')){element.setAttribute('template',element.getAttribute('value'));console.warn('gs-switch Warning: "value" attribute is deprecated. Please use the "template" attribute to replace the "value" attribute.',element);}
element.inserted=true;element.internal={};saveDefaultAttributes(element);var arrTemplate=xtag.queryChildren(element,'template');var i;var len;var attr_i;var attr_len;var arrAttrNames;var arrAttrValues;var strAttrName;var root;var template;var arrPopKeys;var strQueryString;var strQSCol;element.attributesFromTemplate=[];element.templates={};i=0;len=arrTemplate.length;while(i<len){if(i===0){element.firstTemplate=arrTemplate[i].getAttribute('for')||arrTemplate[i].getAttribute('id');}
arrAttrNames=[];arrAttrValues=[];attr_i=0;attr_len=arrTemplate[i].attributes.length;while(attr_i<attr_len){strAttrName=arrTemplate[i].attributes[attr_i].nodeName;if(strAttrName!=='for'&&strAttrName!=='id'){arrAttrNames.push(strAttrName);arrAttrValues.push(arrTemplate[i].attributes[attr_i].value);}
attr_i+=1;}
template=arrTemplate[i];element.templates[template.getAttribute('for')||template.getAttribute('id')]={'content':template.innerHTML,'arrAttrNames':arrAttrNames,'arrAttrValues':arrAttrValues,'templated':!(element.hasAttribute('static')||template.hasAttribute('static'))};i+=1;}
element.innerHTML='';element.arrQueryStringAttributes=[];element.popValues={};if((element.hasAttribute('template')&&element.getAttribute('template').indexOf('{{')>-1)||element.hasAttribute('qs')||element.hasAttribute('refresh-on-querystring-values')||element.hasAttribute('refresh-on-querystring-change')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}
element.refresh();}}}
xtag.register('gs-switch',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==='suspend-created'&&newValue===null){elementCreated(element);elementInserted(element);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(strAttrName==='value'){element.setAttribute('template',newValue);console.warn('gs-switch Warning: "value" attribute is deprecated. Please use the "template" attribute to replace the "value" attribute.',element);}else if(strAttrName==='template'&&element.inserted===true){element.refresh();}}}},events:{},accessors:{value:{get:function(){var element=this;console.warn('gs-switch Warning: \'.value\' accessor is deprecated. Please use the \'.template\' accessor to replace the \'.value\' accessor.',element);return element.getAttribute('template');},set:function(newValue){var element=this;console.warn('gs-switch Warning: \'.value\' accessor is deprecated. Please use the \'.template\' accessor to replace the \'.value\' accessor.',element);element.setAttribute('template',newValue);}},template:{get:function(){return this.getAttribute('template');},set:function(newValue){this.setAttribute('template',newValue);}}},methods:{refresh:function(){var element=this;var strQueryString=GS.getQueryString();var strQSAttribute=element.getAttribute('qs');var strValueAttribute=element.getAttribute('template')||element.getAttribute('value');var templateName;var i;var len;if(strQSAttribute&&GS.qryGetVal(strQueryString,strQSAttribute)){templateName=GS.qryGetVal(strQueryString,strQSAttribute);}else if(strValueAttribute){templateName=GS.templateWithQuerystring(strValueAttribute);}
templateName=templateName||element.firstTemplate;if(element.templates[templateName]&&element.templates[templateName].content){if(element.attributesFromTemplate.length>0){i=0;len=element.attributesFromTemplate.length;while(i<len){if(element.attributesFromTemplate[i].initallySet){element.setAttribute(element.attributesFromTemplate[i].name,element.attributesFromTemplate[i].initalValue);}else{element.removeAttribute(element.attributesFromTemplate[i].name);}
i+=1;}}
element.attributesFromTemplate=[];if(element.templates[templateName].arrAttrNames.length>0){i=0;len=element.templates[templateName].arrAttrNames.length;while(i<len){element.attributesFromTemplate.push({'name':element.templates[templateName].arrAttrNames[i],'initallySet':element.hasAttribute(element.templates[templateName].arrAttrNames[i]),'initalValue':element.getAttribute(element.templates[templateName].arrAttrNames[i])});element.setAttribute(element.templates[templateName].arrAttrNames[i],GS.templateWithQuerystring(this.templates[templateName].arrAttrValues[i]));i+=1;}}
if(element.templates[templateName].templated){element.innerHTML=subsafeTemplate(element.templates[templateName].content);}else{element.innerHTML=element.templates[templateName].content;}
if(shimmed.HTMLTemplateElement){window.HTMLTemplateElement.bootstrap(element);}
GS.triggerEvent(element,'templatechange',{'templateName':templateName});GS.triggerEvent(element,'template_change',{'templateName':templateName});}else{element.innerHTML='';}}}});});/*
new datasheet
    select, insert, update,
        delete, copy, paste and selection events (prevent default)
    programatic select, insert, update,
        delete, copy, paste and selection (events marked as programatic)

    fixed headers/record selectors
    ace scrolling
    insert record

    data source is not required (column list is required if no data source)

    header, record, insert record templating (dot.js)

    placeholder for null values
    value to set value as null

    headers, record selectors, insert record are all optional

    copy settings (
        headers always|never|whenselected
        record selectors always|never|whenselected
        quote char
        quote when never|strings|always
        record delim char
        cell delim char
        null value string
    )
    no more table element

    selection is stored as ranges
    backwards compatible attributes (transfer to new names and warn)


element name:
    <gs-table></gs-table>

helper elements:
    <gs-cell></gs-cell>

attributes:
    pk
    lock
    seq
    cols (required if no src)
    src
    where
    session-filter (where clause that can be overridden by the user)
    ord
    limit
    offset
    column
    child-column
    qs
    refresh-on-querystring-values
    refresh-on-querystring-change

    reflow-at (future)
    scroll-past-bottom
        (allows you to scroll until only the bottom record is seen)
    scroll-to-bottom (scrolls all the way down on initial load)
    expand-to-content

    no-hudpaginate
    no-hudrefresh
    no-huddelete
    no-filter

    suspend-created
    suspend-inserted

    no-header
    no-record-selector
    no-selection

    null-string (defaults to "")
    null-set-string (defaults to null-string attribute)

    no-resize-column
    no-resize-record

    default-record-height (pixels, defaults if not present)
    default-column-width (pixels, defaults if not present)
    column-border-width (pixels, defaults if not present)
    record-border-height (pixels, defaults if not present)

    socket (name of a property stored on the GS object, needs to be a socket)

    copy-header           always|never|selected
    copy-selectors        always|never|selected
    copy-quote-char       text
    copy-escape-char      text
    copy-quote-when       never|strings|always|delimiter-in-content
    copy-delimiter-record text
    copy-delimiter-cell   text
    copy-null-cell        text

templates: (all are dot.js templated before use)
    for="hud" (snippet contains default
                    insert/update/delete/refresh/filter/paginate elements)
    for="header-record"
        <gs-cell>HEADERTEXT</gs-cell>
    for="data-record"
        <gs-cell header="HEADERTEXT">
            <gs-text mini column="COLUMNNAME"></gs-text>
        </gs-cell>
    for="insert-record"
        <gs-cell header="HEADERTEXT" target="COLUMNNAME"></gs-cell>
    for="insert-dialog"

accessors:
    selection (contains JS array of selection ranges)
    data (contains TSV of all data)
    value (value attribute)

events:
    before_select (contains TSV of selection under "records" key)
    before_insert (contains TSV of insert under "records" key)
    before_update (contains TSV of old/new under "records" key ("old", "new"))
    before_delete (contains TSV of delete under "records" key)
    before_selection (contains TSV of selection ranges under "selection" key)

    after_select (contains TSV of selection under "records" key)
    after_insert (contains TSV of insert under "records" key)
    after_update (contains TSV of old/new under "records" key ("old", "new"))
    after_delete (contains TSV of delete under "records" key)
    after_selection (contains TSV of selection ranges under "selection" key)

    insert_dialog_open (event.relatedTarget = insert dialog)
    copy
    paste

methods:
    refresh
    render
    scrollToIndex(cell_number, record_number)
    clearSelection()
    addSelectionRange(
        fromCell_number,
        fromRecord_number,
        toCell_number,
        toRecord_number,
        bolNegate (default false)
    )
    getCopyString(
        strMimeType text|html
    )
    paste(paste_string)
    filter(
        filterColumn,
        filterType contains|starts|ends|equals|greaterthan|lessthan,
        showIfMatch true|false,
        filterValue
    )
    selectData
    insertData
    updateData
    deleteData

click behavior:
    if click results in focused input/textarea
            and start/end locations are in the same place:
        select all control contents
    if not no-filter and click results in focused control: filter popup tooltip

mousedown-drag:
    if shift:
        move latest selection range's endpoint
    if no shift:
        clear all selections
        start new selection
    if command/control:
        start new selection
        if selection started on an already selected cell:
            selection is a negator selection

selection behavior:
    if selection origin and end is on a record selector:
        select entire records
    if selection origin and end is on a header selector:
        select entire columns
    if selection origin starts and ends on the top-left selector:
        select all cells
    if selection endpoint is off-screen:
        scroll it to middle

focus behavior:
    cell/record focus location is saved
        (if cell is visible after a render, focus into it)
        (removed on blur)
    on selection with no focused control: focus hidden control
    on mousedown inside the element (on unfocusable element):
        focus hidden control
    on blur after cell change: cause update
    on focus of single cell: set selection to focused cell

copy behavior:
    never copy insert record
    on copy event and hidden focus control is focused:
        copy to html mime type (using applicable copy attributes)
        copy to text mime type (using applicable copy attributes)
    if a record is not selected: no space is made for it in the copy
    if a column is not selected: no space is made for it in the copy

key behavior:
    arrowing around selects the cell, doesn't focus the control
    return on selection focuses selection origin cell control
    "delete"/"forward delete" when no control is focused causes record delete
    on return after cell change: cause update

    if arrow:
        if shift:
            "selection" means selection end of latest selection range
        if no shift:
            clear all selection ranges
            "selection" means selection origin/end of new selection range

        if all contents selected because of arrow
            or
        if cursor is at boundary in the direction of the arrow:
            if there is a cell in the direction of the arrow:
                move selection in direction of arrow
            else:
                if right at last cell of record: first cell of next record
                if right at last cell of table: first cell of table
                if left at first cell of record: last cell of previous record
                if left at first cell of table: last cell of table
                if up at first cell of column: previous column of bottom record
                if down at last cell of column: next column of first record

scrollbar behavior:
    whenever the record count is changed: the scrollbar is rerendered
    the scrollbar has a maximum range, stop growing around this height
    if scrollbar is past max height, you'll need to translate the top
        into (1px of scroll height will = >1px of motion)
    after scroll: rerender location
    phone scroll: no scrollbar, needs elastic motion
    scroll render:
        if scrollTop is >0     header shadow
        if scrollLeft is >0    record selector shadow
        if scrollBottom is >0  insert record shadow
        if scrollRight is >0   right side shadow

loader behavior:
    when enabled: a small spinner shows at the top-right of the data area

delete behavior:
    always asks if you're sure
    after success:
        remove record from internal data,
        render current location,
        clear selection range if it's now out of bounds
    during delete: enable element loader
    after delete is initiated: record is no longer clickable

insert behavior:
    asks if you're sure only when inserting multiple records (using paste)
    after success:
        append new data to the end of internal data,
        scroll to bottom,
        render current location,
        clear selection range
    during insert: enable element loader

update behavior:
    asks if you're sure only when updating multiple records (using paste)
    after success:
        update whole record in internal data,
        render current location,
        clear selection range
    during update: enable element loader
    if an update is caused while another update is still resolving: add to queue

select behavior:
    first load: if scroll-to-bottom: scroll to reveal bottom record
    reload: always returns to previous scroll/focus/textselection situation
    during load: enable element loader
*/
document.addEventListener('DOMContentLoaded',function(){'use strict';var intDefaultRecordHeight=27;var intDefaultColumnWidth=75;var globalIDSeq=0;var globalStyleElement=document.createElement("style");globalStyleElement.setAttribute("id","gs-table-style-container");document.head.appendChild(globalStyleElement);function getScrollBarWidth(){var container=document.createElement("div");var detector=document.createElement("div");var ret;document.body.appendChild(container);container.appendChild(detector);container.style.width="100px";container.style.height="100px";container.style.opacity="0.2";container.style.overflow="scroll";detector.style.display="inline-block";detector.style.width="10px";detector.style.height="100%";ret=100-detector.offsetHeight;document.body.removeChild(container);return ret;}
var intScrollbarWidth=getScrollBarWidth();function createGlobalScrollbarStyles(){var intScrollbarWidthPadded;intScrollbarWidthPadded=(intScrollbarWidth+1);if(intScrollbarWidth===0){return'gs-table > '+'        .table-root > '+'        .table-table-container > '+'        .table-data-container {\n'+'    padding-bottom: 0px;\n'+'    padding-right: 0px;\n'+'}\n'+'gs-table > '+'        .table-root > '+'        .table-table-container > '+'        .table-v-scroll-bar-container {\n'+'    width: 0px;\n'+'    padding-bottom: 0px;\n'+'    display: none;\n'+'}\n'+'gs-table > '+'        .table-root > '+'        .table-table-container > '+'        .table-h-scroll-bar-container {\n'+'    height: 0px;\n'+'    padding-right: 0px;\n'+'    display: none;\n'+'}\n'+'gs-table >\n'+'        .table-root >\n'+'        .table-table-container >\n'+'        .table-data-container >\n'+'        .table-data-viewport {\n'+'    border-right: 0 none;\n'+'    border-bottom: 0 none;\n'+'}';}
return'gs-table > '+'        .table-root > '+'        .table-table-container > '+'        .table-data-container {\n'+'    padding-bottom: '+intScrollbarWidth+'px;\n'+'    padding-right: '+intScrollbarWidth+'px;\n'+'}\n'+'gs-table > '+'        .table-root > '+'        .table-table-container > '+'        .table-v-scroll-bar-container {\n'+'    width: '+intScrollbarWidth+'px;\n'+'    padding-bottom: '+intScrollbarWidthPadded+'px;\n'+'}\n'+'gs-table > '+'        .table-root > '+'        .table-table-container > '+'        .table-h-scroll-bar-container {\n'+'    height: '+intScrollbarWidth+'px;\n'+'    padding-right: '+intScrollbarWidthPadded+'px;\n'+'}';}
globalStyleElement.innerHTML+=createGlobalScrollbarStyles();function cellDimensionDetector(element){var testDataCell=element.elems.testDataCell;var testHeader=element.elems.testHeader;var testInsert=element.elems.testInsert;var testRecordSelector=element.elems.testRecordSelector;element.internalDisplay.columnBorderWidth=parseInt((GS.getStyle(testDataCell,'border-right-width')||'0'),10);element.internalDisplay.recordBorderHeight=parseInt((GS.getStyle(testDataCell,'border-bottom-width')||'0'),10);element.internalDisplay.defaultColumnWidth=parseInt((GS.getStyle(testDataCell,'width')||'0'),10);element.internalDisplay.defaultRecordHeight=parseInt((GS.getStyle(testDataCell,'height')||'0'),10);element.internalDisplay.headerBorderHeight=parseInt((GS.getStyle(testHeader,'border-bottom-width')||'0'),10);element.internalDisplay.insertRecordBorderHeight=parseInt((GS.getStyle(testInsert,'border-bottom-width')||'0'),10);element.internalDisplay.recordSelectorBorderWidth=parseInt((GS.getStyle(testRecordSelector,'border-right-width')||'0'),10);}
function visibilityDetector(element){element.internalDisplay.headerVisible=true;element.internalDisplay.recordSelectorVisible=true;element.internalDisplay.insertRecordVisible=true;if(!element.internalTemplates.header||!element.internalTemplates.header.trim()){element.internalDisplay.headerVisible=false;}
if(element.hasAttribute('no-record-selector')){element.internalDisplay.recordSelectorVisible=false;}
if(!element.internalTemplates.insertRecord||!element.internalTemplates.insertRecord.trim()){element.internalDisplay.insertRecordVisible=false;}}
function offsetDetector(element){element.internalScrollOffsets.top=0;element.internalScrollOffsets.left=0;element.internalScrollOffsets.bottom=0;element.internalScrollOffsets.right=0;if(element.internalDisplay.headerVisible&&element.internalDisplay.headerStick==='top'){element.internalScrollOffsets.top+=(element.internalDisplay.headerHeight+
element.internalDisplay.headerBorderHeight);}
if(element.internalDisplay.recordSelectorVisible&&element.internalDisplay.selectorStick==='left'){element.internalScrollOffsets.left+=(element.internalDisplay.recordSelectorWidth+
element.internalDisplay.recordSelectorBorderWidth);}
if(element.internalDisplay.insertRecordVisible&&element.internalDisplay.insertRecordStick==='bottom'){element.internalScrollOffsets.bottom+=(element.internalDisplay.insertRecordHeight+
element.internalDisplay.insertRecordBorderHeight);}}
/*
    ORIGINAL LICENSE FOR getPlainText():

    This is free and unencumbered software released into the public domain.

    Anyone is free to copy, modify, publish, use, compile, sell, or
    distribute this software, either in source code form or as a compiled
    binary, for any purpose, commercial or non-commercial, and by any
    means.

    In jurisdictions that recognize copyright laws, the author or authors
    of this software dedicate any and all copyright interest in the
    software to the public domain. We make this dedication for the benefit
    of the public at large and to the detriment of our heirs and
    successors. We intend this dedication to be an overt act of
    relinquishment in perpetuity of all present and future rights to this
    software under copyright law.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
    OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
    ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.
    */
function getPlainText(node,bolConsumable){var plainText="";function normalize(a){if(!a){return"";}
return a.replace(/\ +/g," ").replace(/[\t]+/gm,"").replace(/[\ ]+$/gm,"").replace(/^[\ ]+/gm,"").replace(/\n+/g,"\n").replace(/\n+$/,"").replace(/^\n+/,"").replace(/\nNEWLINE\n/g,"\n\n").replace(/NEWLINE\n/g,"\n\n");}
function removeWhiteSpace(node){var ws_i;var ws_len;var ws_node;var ws=[];function findWhite(node){var i=0;var len=node.childNodes.length;var n;while(i<len){n=node.childNodes[i];if(n.nodeType===3&&!(/[^\t\n\r\ ]/).test(n.nodeValue)){ws.push(n);}else if(n.hasChildNodes()){findWhite(n);}
i+=1;}}
findWhite(node);ws_i=0;ws_len=ws.length;while(ws_i<ws_len){ws_node=ws[ws_i];ws_node.parentNode.removeChild(ws_node);ws_i+=1;}}
function sty(n,prop){var s;var bolAssumeBlock;if(n.style[prop]){return n.style[prop];}
s=(n.currentStyle||window.getComputedStyle(n,null));if(n.tagName==="SCRIPT"){return"none";}
if(!s[prop]){bolAssumeBlock="LI,P,TR".indexOf(n.tagName);if(bolAssumeBlock){return"block";}
return n.style[prop];}
if(s[prop]==="block"&&n.tagName==="TD"){return"feaux-inline";}
return s[prop];}
var blockTypeNodes="table-row,block,list-item";function isBlock(n){var s=sty(n,"display")||"feaux-inline";if(blockTypeNodes.indexOf(s)>-1){return true;}
return false;}
function recurse(n){var strCSSWhite=sty(n,"whiteSpace");var strCSSDisplay=sty(n,"display");var gap;var i;var len;var c;if(strCSSWhite.indexOf('pre')!==-1){plainText+=n.innerHTML.replace(/\t/g," ").replace(/\n/g," ");return"";}
if(strCSSDisplay==="none"){return"";}
gap=(isBlock(n)?"\n":" ");plainText+=gap;i=0;len=n.childNodes.length;while(i<len){c=n.childNodes[i];if(c.nodeType===3){plainText+=c.nodeValue;}
if(c.childNodes.length){recurse(c);}
i+=1;}
plainText+=gap;return plainText;}
if(bolConsumable!==true){node=node.cloneNode(true);}
node.innerHTML=node.innerHTML.replace(/<br>/g,"\n");removeWhiteSpace(node);return normalize(recurse(node));}
function encodeHTML(text){var encode={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"};if(text){return text.toString().replace(/&|<|>|"|'|\//g,function(letter){return encode[letter]||letter;});}
return text;}
function templateCellAddStyleToken(templateElement){var arrCell=xtag.query(templateElement.content,'gs-cell');var i=0;var len=arrCell.length;var strStyle;while(i<len){strStyle=(arrCell[i].getAttribute('style')||'');strStyle=strStyle.trim();if(strStyle&&strStyle[strStyle.length-1]!==';'){strStyle+=';';}
arrCell[i].setAttribute('style','$$CSSREPLACETOKEN$$ '+strStyle);i+=1;}}
function templateCellAddClass(templateElement,strClass){var arrCell=xtag.query(templateElement.content,'gs-cell');var i=0;var len=arrCell.length;while(i<len){arrCell[i].classList.add(strClass);i+=1;}}
function templateCellAddRowNumber(templateElement,strOverride){var arrCell=xtag.query(templateElement.content,'gs-cell');var i=0;var len=arrCell.length;while(i<len){arrCell[i].setAttribute('data-row-number',(strOverride||'{{! row_number - 1 }}'));i+=1;}}
function templateCellAddColumnNumber(templateElement){var arrCell=xtag.query(templateElement.content,'gs-cell');var i=0;var len=arrCell.length;while(i<len){arrCell[i].setAttribute('data-col-number',i);i+=1;}}
function templateExtractVisibleCellRange(element,strTemplate,fromColumn,toColumn){var jsnRange;if(fromColumn===undefined||toColumn===undefined){jsnRange=element.internalDisplay.currentRange;fromColumn=jsnRange.fromColumn;toColumn=jsnRange.toColumn;}
var templateElement=document.createElement('template');templateElement.innerHTML=strTemplate;var arrCell=xtag.query(templateElement.content,'gs-cell');var i=fromColumn;var len=toColumn;var strCells='';var arrColumnWidths=element.internalDisplay.columnWidths;while(i<len){if(arrColumnWidths[i]>0){strCells+=arrCell[i].outerHTML;}
i+=1;}
return strCells;}
function templateDetermineCopyHeaderList(element,templateElement){var arrHeading=[];var arrCell=xtag.query(templateElement.content,'gs-cell');var i=0;var len=arrCell.length;var bolHeaderFound=false;var strHeading;while(i<len){strHeading=arrCell[i].getAttribute('header')||'';arrHeading.push(strHeading);if(arrCell[i].hasAttribute('header')){bolHeaderFound=true;}
i+=1;}
if(!bolHeaderFound&&element.getAttribute('copy-header')!=='Never'){console.warn('GS-TABLE Warning: No headers found in "copy" '+'template. Please define headers for the copy by using '+'the "header" attribute on the gs-cell elements of the '+'"copy" template. If no headers are defined: when a '+'user copies they will not get any headers. To dismiss '+'this warning and prevent users from copying the '+'header: set the "copy-header" attribute to "never."');}
element.internalClip.headerList=arrHeading;}
function templateDetermineCopyColumnList(element,templateElement){var arrColumn=[];var arrCell=xtag.query(templateElement.content,'gs-cell');var i=0;var len=arrCell.length;while(i<len){arrColumn.push(arrCell[i].textContent);i+=1;}
element.internalClip.columnList=arrColumn;}
function templateGetColumnList(templateElement){var arrColumn=[];var arrElement=xtag.query(templateElement.content,'[column]');var i=0;var len=arrElement.length;var strColumn;while(i<len){strColumn=arrElement[i].getAttribute('column');if(strColumn&&arrColumn.indexOf(strColumn)===-1){arrColumn.push(strColumn);}
i+=1;}
return arrColumn;}
function getSocket(element){if(element.getAttribute('socket')){return GS[element.getAttribute('socket')];}
return GS.envSocket;}
function stringReplaceAll(str,find,replace){return str.replace(new RegExp(find.replace(/([\.\*\+\?\^\=\!\:\$\{\}\(\)\|\[\]\/\\])/g,'\\$1'),'g'),replace);}
function getCurrentCellRange(element){var scrollTop;var scrollLeft;var arrColumnWidths;var arrRecordHeights;var columnBorderWidth;var recordBorderHeight;var fromColumn;var toColumn;var fromRecord;var toRecord;var i;var len;var intTemp;var intViewportWidth;var intViewportHeight;var intCellOriginLeft;var intRecordOriginTop;var bolRecordSelector;var bolInsertRecord;var bolHeaderRecord;intViewportWidth=element.elems.dataViewport.clientWidth;intViewportHeight=element.elems.dataViewport.clientHeight;arrColumnWidths=element.internalDisplay.columnWidths;arrRecordHeights=element.internalDisplay.recordHeights;columnBorderWidth=element.internalDisplay.columnBorderWidth;recordBorderHeight=element.internalDisplay.recordBorderHeight;scrollTop=element.internalScroll.top;scrollLeft=element.internalScroll.left;intViewportHeight-=(element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom);intViewportWidth-=(element.internalScrollOffsets.left+
element.internalScrollOffsets.right);i=0;len=arrColumnWidths.length;intTemp=0;intCellOriginLeft=0;while(i<len){if(arrColumnWidths[i]>0){intTemp+=arrColumnWidths[i];intTemp+=columnBorderWidth;}
if(fromColumn===undefined&&intTemp>scrollLeft){fromColumn=i;intCellOriginLeft=(intCellOriginLeft-scrollLeft);}
if(toColumn===undefined&&intTemp>(scrollLeft+intViewportWidth)){toColumn=i;break;}
if(fromColumn===undefined){intCellOriginLeft=intTemp;}
i+=1;}
fromColumn=Math.max(0,(fromColumn||0));toColumn=(toColumn||i)+1;intCellOriginLeft=intCellOriginLeft||0;if(toColumn>arrColumnWidths.length){toColumn=arrColumnWidths.length;}
i=0;len=arrRecordHeights.length;intTemp=0;intRecordOriginTop=0;while(i<len){intTemp+=arrRecordHeights[i];intTemp+=recordBorderHeight;if(fromRecord===undefined&&intTemp>scrollTop){fromRecord=i;intRecordOriginTop=(intRecordOriginTop-scrollTop);}
if(toRecord===undefined&&intTemp>(scrollTop+intViewportHeight)){toRecord=i;break;}
if(fromRecord===undefined){intRecordOriginTop=intTemp;}
i+=1;}
toRecord=((toRecord||i)+1);intRecordOriginTop=(intRecordOriginTop||0);bolInsertRecord=false;if(toRecord>arrRecordHeights.length){bolInsertRecord=(element.internalDisplay.insertRecordVisible&&element.internalDisplay.insertRecordStick===null);if(element.internalDisplay.insertRecordVisible&&element.internalDisplay.insertRecordStick===null&&fromRecord===undefined){toRecord=(arrRecordHeights.length+1);fromRecord=toRecord;}else{toRecord=arrRecordHeights.length;}}
fromRecord=Math.max(0,(fromRecord||0));bolHeaderRecord=element.internalDisplay.headerVisible;bolRecordSelector=element.internalDisplay.recordSelectorVisible;element.internalScroll.displayTop=(scrollTop+intRecordOriginTop);element.internalScroll.displayLeft=(scrollLeft+intCellOriginLeft);intCellOriginLeft=element.internalScrollOffsets.left;intRecordOriginTop=element.internalScrollOffsets.top;return{"originTop":intRecordOriginTop,"originLeft":intCellOriginLeft,"fromRecord":fromRecord,"fromColumn":fromColumn,"toRecord":toRecord,"toColumn":toColumn,"headerRecord":bolHeaderRecord,"recordSelector":bolRecordSelector,"insertRecord":bolInsertRecord};}
function getInsertAddin(element){var jsnRet={};if(element.getAttribute('column')||element.getAttribute('qs')){jsnRet.link_column=(element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs'));jsnRet.link_value=element.value;}
return jsnRet;}
function delimitedStringToHTML(element,valueText,fieldDelimiter,recordDelimiter,quoteChar,decodeFunction){var i=0;var len=valueText.length;var col_i;var col_len;var arrRecords=[];var arrRecord=[];var bolInQuote=false;var strCell='';var strRecord;var strHTML='';var strPreviousChar;var strChar;var strNullString;if(element.hasAttribute('null-string')){strNullString=element.getAttribute('null-string')||'';}else{strNullString=undefined;}
if(valueText[0]===recordDelimiter){i+=1;}
if(valueText[len-1]!==recordDelimiter){valueText+=recordDelimiter;len=valueText.length;}
while(i<len){strChar=valueText[i];if(strChar===quoteChar&&bolInQuote===false&&(strPreviousChar===fieldDelimiter||strPreviousChar===recordDelimiter||strPreviousChar===undefined)){bolInQuote=true;}else if(strChar===quoteChar&&bolInQuote===true){bolInQuote=false;}else if(strChar===fieldDelimiter&&bolInQuote===false){arrRecord.push(decodeFunction(strCell,strNullString));strCell='';}else if(strChar===recordDelimiter&&bolInQuote===false){arrRecord.push(decodeFunction(strCell,strNullString));strCell='';arrRecords.push(arrRecord);arrRecord=[];}else{strCell+=strChar;}
strPreviousChar=strChar;i+=1;}
i=0;len=arrRecords.length;while(i<len){strRecord='';col_i=0;col_len=arrRecords[i].length;while(col_i<col_len){strRecord+=('<td>'+
encodeHTML(arrRecords[i][col_i])+'</td>');col_i+=1;}
strHTML+='<tr>'+strRecord+'</tr>';i+=1;}
return'<table>'+strHTML+'</table>';}
function getSelectionCopy(element){var jsnOriginal;var jsnCopy;var jsnRange;var i;var len;jsnOriginal=element.internalSelection;jsnCopy={"ranges":[],"insertRecord":jsnOriginal.insertRecord};i=0;len=jsnOriginal.ranges.length;while(i<len){jsnRange=jsnOriginal.ranges[i];jsnCopy.ranges.push({"start":{"row":jsnRange.start.row,"column":jsnRange.start.column},"end":{"row":jsnRange.end.row,"column":jsnRange.end.column}});i+=1;}
return jsnCopy;}
function getCell(element,strColumn,intRow,bolDecode,strNullStringOverride){var strRecord;var rec_i;var rec_len;var strChar;var strCell;var strNullString;var intCurrentColumn;var intTargetColumn;intTargetColumn=(element.internalData.columnNames.indexOf(strColumn));strRecord=element.internalData.records[intRow];intCurrentColumn=0;strCell='';rec_i=0;rec_len=strRecord.length;while(rec_i<rec_len){strChar=strRecord[rec_i];if(strChar!=='\t'){strCell+=strChar;}
if(strChar==='\t'||rec_i===(rec_len-1)){intCurrentColumn+=1;if(intCurrentColumn===(intTargetColumn+1)){break;}
strCell='';}
rec_i+=1;}
if(bolDecode!==false){if(strNullStringOverride!==undefined){strNullString=strNullStringOverride;}else if(element.hasAttribute('null-string')){strNullString=element.getAttribute('null-string')||'';}else{strNullString=undefined;}
return GS.decodeFromTabDelimited(strCell,strNullString);}
return strCell;}
function getConnectedSelectedColumns(element,intStartColumn){var arrCurrentColumns;var arrSelection;var i;arrSelection=(element.internalSelection.columns);arrCurrentColumns=[];i=intStartColumn;while(i<9999){if(arrSelection.indexOf(i)>-1){arrCurrentColumns.push(i);}else{break;}
i+=1;}
i=(intStartColumn-1);while(i>=0){if(arrSelection.indexOf(i)>-1){arrCurrentColumns.push(i);}else{break;}
i-=1;}
arrCurrentColumns.sort();return arrCurrentColumns;}
function handleHeaderTemplateTokens(element,strTemplate,fromColumn,toColumn){var col_i;var col_len;var filter_i;var filter_len;var columnIndex;var strDataColumn;var strTitle;var strClass;var arrColumnWidths;var arrColumnOrders;var arrColumnFilters;arrColumnOrders=element.internalData.columnOrders;arrColumnFilters=element.internalData.columnFilters;arrColumnWidths=element.internalDisplay.columnWidths;col_i=fromColumn;col_len=toColumn;while(col_i<col_len){if(arrColumnWidths[col_i]>0){strDataColumn=(element.internalDisplay.dataColumnName[col_i]);columnIndex=(element.internalData.columnNames.indexOf(strDataColumn));strClass='';if(arrColumnOrders[columnIndex]!=='neutral'){strClass+=(' sort-'+
arrColumnOrders[columnIndex]);}
if(arrColumnFilters[columnIndex]&&arrColumnFilters[columnIndex].length>0){strClass+=' filtered';}
strTemplate=strTemplate.replace('$$HDRBTNCLASS_'+strDataColumn+'$$',strClass);strTitle='';if(arrColumnFilters[columnIndex]){filter_i=0;filter_len=arrColumnFilters[columnIndex].length;while(filter_i<filter_len){strTitle+=(strTitle?' ':'');strTitle+=(arrColumnFilters[columnIndex][filter_i].name);filter_i+=1;}}
if(arrColumnOrders[columnIndex]==='desc'){strTitle+=(strTitle?' ':'');strTitle+='sorted descending';}else if(arrColumnOrders[columnIndex]==='asc'){strTitle+=(strTitle?' ':'');strTitle+='sorted ascending';}
strTemplate=strTemplate.replace('$$HDR_TITLE_'+strDataColumn+'$$',encodeHTML(strTitle));}
col_i+=1;}
return strTemplate;}
function directionStringBreakdown(strDirectionString){var bolTop;var bolLeft;var bolBottom;var bolRight;strDirectionString=strDirectionString.toLowerCase();bolTop=(strDirectionString.indexOf('top')!==-1);bolLeft=(strDirectionString.indexOf('left')!==-1);bolBottom=(strDirectionString.indexOf('bottom')!==-1);bolRight=(strDirectionString.indexOf('right')!==-1);if(bolTop&&bolBottom){console.warn('GS-TABLE Warning: Contradictory parameter sent'+' to directionStringBreakdown.'+' "Down" direction will be cancelled.'+' Parameter Text: "'+strDirectionString+'"');bolBottom=false;}
if(bolLeft&&bolRight){console.warn('GS-TABLE Warning: Contradictory parameter sent'+' to directionStringBreakdown.'+' the left and the right at the same time.'+' "Right" direction will be cancelled.'+' Parameter Text: "'+strDirectionString+'"');bolRight=false;}
strDirectionString='';if(bolTop){strDirectionString+='top';}
if(bolLeft){strDirectionString+='left';}
if(bolBottom){strDirectionString+='bottom';}
if(bolRight){strDirectionString+='right';}
return{"bolTop":bolTop,"bolLeft":bolLeft,"bolBottom":bolBottom,"bolRight":bolRight,"resolvedString":strDirectionString};}
function findHudElement(element,strClass){var hudElement;hudElement=xtag.query(element.elems.bottomHudContainer,'.'+strClass)[0];if(!hudElement){hudElement=xtag.query(element.elems.topHudContainer,'.'+strClass)[0];}
return hudElement;}
function getSelectedDataColumns(element){var arrSelectedColumns;var arrDataColumns;var i;var len;var index;arrSelectedColumns=(element.internalSelection.columns);arrDataColumns=[];i=0;len=arrSelectedColumns.length;while(i<len){index=arrSelectedColumns[i];if(element.internalDisplay.dataColumnName[index]){arrDataColumns.push(element.internalData.columnNames.indexOf(element.internalDisplay.dataColumnName[index]));}
i+=1;}
return arrDataColumns;}
function focusHiddenControl(element){element.elems.hiddenFocusControl.focus();GS.triggerEvent(element.elems.hiddenFocusControl,'focus');}
function getCellFromMouseEvent(element,event){var jsnMousePos;var jsnElementPos;var intMouseX;var intMouseY;var row;var column;var jsnRange;var arrColumnWidths;var arrRecordHeights;var i;var len;var intLeft;var intTop;var intColBorderWidth;var intRowBorderHeight;var intRowSelectorWidth;var intHeaderHeight;var bolHeader;var bolInsertRecord;var bolRecordSelector;jsnRange=element.internalDisplay.currentRange;bolHeader=element.internalDisplay.headerVisible;bolInsertRecord=(element.internalDisplay.insertRecordVisible&&jsnRange.insertRecord);bolRecordSelector=element.internalDisplay.recordSelectorVisible;arrColumnWidths=element.internalDisplay.columnWidths;arrRecordHeights=element.internalDisplay.recordHeights;intColBorderWidth=element.internalDisplay.columnBorderWidth;intRowBorderHeight=element.internalDisplay.recordBorderHeight;intRowSelectorWidth=(bolRecordSelector?(element.internalDisplay.recordSelectorWidth+
element.internalDisplay.recordSelectorBorderWidth):0);intHeaderHeight=(bolHeader?(element.internalDisplay.headerHeight+
element.internalDisplay.headerBorderHeight):0);jsnMousePos=GS.mousePosition(event);jsnElementPos=GS.getElementOffset(element.elems.dataViewport);intMouseX=(jsnMousePos.left-jsnElementPos.left);intMouseY=(jsnMousePos.top-jsnElementPos.top);if(bolRecordSelector&&intMouseX<=intRowSelectorWidth){column='selector';}else{intLeft=intRowSelectorWidth;i=jsnRange.fromColumn;len=jsnRange.toColumn;while(i<len){if(intMouseX>=intLeft){column=i;}else{break;}
intLeft+=arrColumnWidths[i];intLeft+=intColBorderWidth;i+=1;}}
if(bolHeader&&intMouseY<=intHeaderHeight){row='header';}else{intTop=intHeaderHeight;i=jsnRange.fromRecord;len=jsnRange.toRecord;while(i<len){if(intMouseY>=intTop){row=i;}else{break;}
intTop+=arrRecordHeights[i];intTop+=intRowBorderHeight;i+=1;}
if(bolInsertRecord&&intMouseY>=intTop){row='insert';}}
return{"row":row,"column":column};}
function resolveElementAttributes(element){var arrParts;if(element.getAttribute('src')){arrParts=GS.templateWithQuerystring(element.getAttribute('src')).split('.');element.setAttribute('schema',arrParts[0]);element.setAttribute('object',arrParts[1]);element.setAttribute('pk',(element.getAttribute('pk')||'id'));element.setAttribute('lock',(element.getAttribute('lock')||'change_stamp'));}
element.setAttribute('null-string',(element.getAttribute('null-string')||''));}
function prepareElement(element){var rootElement;var i;if(!element.getAttribute('id')){globalIDSeq+=1;i=0;while(i<500&&document.getElementById('table-dynamic-id-'+globalIDSeq)){globalIDSeq+=1;i+=1;}
element.setAttribute('id','table-dynamic-id-'+globalIDSeq);console.warn('GS-TABLE Warning: All gs-table elements must have'+' an ID. Adding dynamic ID:'+' "table-dynamic-id-'+globalIDSeq+'". Do not use'+' this ID for anything. Do not use it for HTML, CSS or'+' JS or anything else as it can change between page'+' loads.');}
rootElement=document.createElement('div');rootElement.classList.add('table-root');element.appendChild(rootElement);rootElement.innerHTML='<div class="table-hud-container hud-top"></div>'+'<div class="table-table-container">'+'    <div class="table-data-container">'+'        <div class="table-data-viewport"></div>'+'    </div>'+'    <div class="table-v-scroll-bar-container">'+'        <div class="table-v-scroll-bar">'+'            <div class="table-scroll-causer"></div>'+'        </div>'+'    </div>'+'    <div class="table-h-scroll-bar-container">'+'        <div class="table-h-scroll-bar">'+'            <div class="table-scroll-causer"></div>'+'        </div>'+'    </div>'+'</div>'+'<textarea class="hidden-focus-control"'+'    value="text makes this textarea Firefox worthy">'+'</textarea>'+'<div class="table-loader-container"></div>'+'<div class="table-cell-test-container">'+'    <gs-cell class="table-cell"></gs-cell>'+'    <gs-cell class="table-header"></gs-cell>'+'    <gs-cell class="table-insert"></gs-cell>'+'    <gs-cell class="table-record-selector"></gs-cell>'+'</div>'+'<div class="table-hud-container hud-bottom"></div>'+'<style class="cell-position" style="display:none;"></style>';element.elems={};element.elems.root=rootElement;element.elems.topHudContainer=element.elems.root.children[0];element.elems.tableViewport=element.elems.root.children[1];element.elems.hiddenFocusControl=element.elems.root.children[2];element.elems.loaderContainer=element.elems.root.children[3];element.elems.cellTestContainer=element.elems.root.children[4];element.elems.bottomHudContainer=element.elems.root.children[5];element.elems.cellPositionStyle=element.elems.root.children[6];element.elems.dataContainer=element.elems.tableViewport.children[0];element.elems.yScrollContainer=element.elems.tableViewport.children[1];element.elems.xScrollContainer=element.elems.tableViewport.children[2];element.elems.dataViewport=element.elems.dataContainer.children[0];element.elems.yScrollBar=element.elems.yScrollContainer.children[0];element.elems.xScrollBar=element.elems.xScrollContainer.children[0];element.elems.yScrollBarCauser=element.elems.yScrollBar.children[0];element.elems.xScrollBarCauser=element.elems.xScrollBar.children[0];element.elems.testDataCell=(element.elems.cellTestContainer.children[0]);element.elems.testHeader=(element.elems.cellTestContainer.children[1]);element.elems.testInsert=(element.elems.cellTestContainer.children[2]);element.elems.testRecordSelector=(element.elems.cellTestContainer.children[3]);element.elems.handleColumn=document.createElement('div');element.elems.handleColumn.classList.add('resize-column-handle');element.elems.handleRecord=document.createElement('div');element.elems.handleRecord.classList.add('resize-record-handle');element.elems.handleReorder=document.createElement('div');element.elems.handleReorder.classList.add('reorder-column-handle');element.elems.pixel=document.createElement('div');element.elems.pixel.classList.add('pixel-element');element.elems.root.appendChild(element.elems.pixel);element.internalData={"records":[],"columnFilterStatuses":[],"columnFilters":[],"columnListFilters":[],"columnOrders":[],"columnNames":[],"columnTypes":[],"insertRecord":{},"insertRecordRetainedColumns":[],"bolFirstLoadFinished":false};element.internalScrollOffsets={"top":0,"bottom":0,"left":0,"right":0};element.internalEvents={};element.internalEventCancelled={"scrollbarY":false,"scrollbarX":false};element.internalScroll={"top":0,"left":0,"maxTop":0,"maxLeft":0,"displayTop":0,"displayLeft":0,"prevTop":0,"prevLeft":0};element.internalTimerIDs={"scrollIntervalID":null,"visibilityIntervalID":null};element.internalTemplates={"topHUD":"","bottomHUD":"","header":"","originalRecord":"","record":{},"insertRecord":"","insertDialog":""};element.internalDisplay={"columnPlainTextNames":[],"dataColumnName":[],"columnWidths":[],"minColumnWidths":[],"maxColumnWidth":999,"recordHeights":[],"maxRecordHeight":999,"columnHandles":[],"recordHandles":[],"currentRange":{},"prevRange":{},"headerStick":"top","headerVisible":false,"headerHeight":undefined,"headerBorderHeight":0,"selectorStick":"left","recordSelectorVisible":false,"recordSelectorWidth":0,"recordSelectorBorderWidth":0,"insertRecordStick":null,"insertRecordVisible":false,"insertRecordHeight":undefined,"insertRecordBorderHeight":0,"fullRenderRequired":true,"defaultColumnWidths":[],"defaultColumnWidth":0,"defaultRecordHeight":0,"defaultRecordSelectorWidth":27,"defaultHeaderHeight":27,"defaultInsertRecordHeight":27,"focus":{"column":null,"row":null,"nodeName":null,"columnAttribute":null,"latest":null,"selectionRange":{}}};element.internalDisplay.recordSelectorWidth=(element.internalDisplay.defaultRecordSelectorWidth);element.internalSelection={"ranges":[],"insertRecord":false,"originRecord":null,"resolvedSelection":[],"columns":[],"rows":[],"currentlySelecting":false};element.internalClip={"columnList":[],"headerList":[]};element.internalWorker={"worker":"","ready":false};element.internalLoaders={"loaderIDs":[],"loaderElements":[]};element.internalResize={"currentlyResizing":false,"showThrottleID":null,"resizeStarted":false,"cellOriginX":0,"cellOriginY":0,"resizeColumn":false,"resizeRecord":false,"resizeColumnHandleIndex":0,"resizeRecordHandleIndex":0,"resizeColumnIndex":null,"resizeRecordIndex":null,"resizingRecordSelectors":false,"resizingHeader":false,"resizingInsert":false,"scrollOriginTop":null,"scrollOriginLeft":null,"lastX":0,"lastY":0,"lastWidth":0,"lastHeight":0};element.internalReorder={"currentlyReordering":false,"reorderStarted":false,"currentColumns":[],"dropLocation":0,"scrollIntervalID":null,"scrollDirection":null,"scrolling":false,"originColumn":null};element.internalPollingCache={"elementWidth":null,"elementHeight":null,"elementVisibility":null,"fontSize":null};cellDimensionDetector(element);}
function siphonElement(element){var topHudTemplate;var bottomHudTemplate;var headerRecordTemplate;var dataRecordTemplate;var copyTemplate;var insertRecordTemplate;var insertDialogTemplate;var strHTML;var arrColumnPlainTextNames;var arrColumnDataNames;var arrColumnElements;var columnElement;var intColumnWidth;var buttonElement;var i;var len;topHudTemplate=xtag.queryChildren(element,'[for="top-hud"]')[0];bottomHudTemplate=xtag.queryChildren(element,'[for="bottom-hud"]')[0];headerRecordTemplate=xtag.queryChildren(element,'[for="header-record"]')[0];dataRecordTemplate=xtag.queryChildren(element,'[for="data-record"]')[0];copyTemplate=xtag.queryChildren(element,'[for="copy"]')[0];insertRecordTemplate=xtag.queryChildren(element,'[for="insert-record"]')[0];insertDialogTemplate=xtag.queryChildren(element,'[for="insert-dialog"]')[0];if(!dataRecordTemplate){throw'GS-TABLE Error: no "data-record" template found. '+'The "data-record" must be a immediate child in '+'order to be found.';}
if(!copyTemplate){console.warn('GS-TABLE Warning: no "copy" template found. '+'The "copy" template enables copying a selection '+'from the gs-table. The "copy" template must be a '+'immediate child in order to be found.');}
if(headerRecordTemplate||dataRecordTemplate||insertRecordTemplate){if(headerRecordTemplate){arrColumnElements=xtag.query(headerRecordTemplate.content,'gs-cell');}else if(dataRecordTemplate){arrColumnElements=xtag.query(dataRecordTemplate.content,'gs-cell');}else if(insertRecordTemplate){arrColumnElements=xtag.query(insertRecordTemplate.content,'gs-cell');}
i=0;len=arrColumnElements.length;intColumnWidth=(parseInt(element.getAttribute('default-column-width'),10)||intDefaultColumnWidth);while(i<len){element.internalDisplay.columnWidths.push(parseInt(arrColumnElements[i].style.width,10)||intColumnWidth);element.internalDisplay.defaultColumnWidths.push(parseInt(arrColumnElements[i].style.width,10)||intColumnWidth);if(arrColumnElements[i].style.width){arrColumnElements[i].style.width='';}
i+=1;}}
if(headerRecordTemplate){arrColumnElements=xtag.query(headerRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(arrColumnElements[i].style.height){element.internalDisplay.headerHeight=(parseInt(arrColumnElements[i].style.height,10));}
i+=1;}
if(element.internalDisplay.headerHeight===undefined){element.internalDisplay.headerHeight=(element.internalDisplay.defaultHeaderHeight);}}
if(insertRecordTemplate){arrColumnElements=xtag.query(insertRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(arrColumnElements[i].style.height){element.internalDisplay.insertRecordHeight=(parseInt(arrColumnElements[i].style.height,10));}
i+=1;}
if(element.internalDisplay.insertRecordHeight===undefined){element.internalDisplay.insertRecordHeight=(element.internalDisplay.defaultInsertRecordHeight);}}
arrColumnPlainTextNames=[];if(copyTemplate&&(arrColumnPlainTextNames.length===0||arrColumnPlainTextNames.indexOf(null)!==-1)){arrColumnElements=xtag.query(copyTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(!arrColumnPlainTextNames[i]){arrColumnPlainTextNames[i]=(arrColumnElements[i].getAttribute('header'));}
i+=1;}}
if(dataRecordTemplate&&(arrColumnPlainTextNames.length===0||arrColumnPlainTextNames.indexOf(null)!==-1)){arrColumnElements=xtag.query(dataRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(!arrColumnPlainTextNames[i]){arrColumnPlainTextNames[i]=(arrColumnElements[i].getAttribute('header'));}
i+=1;}}
if(insertRecordTemplate&&(arrColumnPlainTextNames.length===0||arrColumnPlainTextNames.indexOf(null)!==-1)){arrColumnElements=xtag.query(insertRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(!arrColumnPlainTextNames[i]){arrColumnPlainTextNames[i]=(arrColumnElements[i].getAttribute('header'));}
i+=1;}}
if(headerRecordTemplate&&(arrColumnPlainTextNames.length===0||arrColumnPlainTextNames.indexOf(null)!==-1)){arrColumnElements=xtag.query(headerRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(!arrColumnPlainTextNames[i]){arrColumnPlainTextNames[i]=(arrColumnElements[i].textContent.trim()||null);}
i+=1;}}
element.internalDisplay.columnPlainTextNames=arrColumnPlainTextNames;arrColumnDataNames=[];if(insertRecordTemplate&&(arrColumnDataNames.length===0||arrColumnDataNames.indexOf(null)!==-1)){arrColumnElements=xtag.query(insertRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(!arrColumnDataNames[i]){columnElement=xtag.query(arrColumnElements[i],'[column]')[0];if(columnElement){arrColumnDataNames[i]=(columnElement.getAttribute('column'));}else{arrColumnDataNames[i]=null;}}
i+=1;}}
if(dataRecordTemplate&&(arrColumnDataNames.length===0||arrColumnDataNames.indexOf(null)!==-1)){arrColumnElements=xtag.query(dataRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(!arrColumnDataNames[i]){columnElement=xtag.query(arrColumnElements[i],'[column]')[0];if(columnElement){arrColumnDataNames[i]=(columnElement.getAttribute('column'));}else{arrColumnDataNames[i]=null;}}
i+=1;}}
element.internalDisplay.dataColumnName=arrColumnDataNames;if(topHudTemplate){element.internalTemplates.topHUD=topHudTemplate.innerHTML;}
if(bottomHudTemplate){element.internalTemplates.bottomHUD=bottomHudTemplate.innerHTML;}
if(headerRecordTemplate){buttonElement=document.createElement('div');arrColumnElements=xtag.query(headerRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(arrColumnDataNames[i]){buttonElement.setAttribute('class','header-button '+'$$HDRBTNCLASS_'+arrColumnDataNames[i]+'$$');arrColumnElements[i].classList.add('right-button');arrColumnElements[i].appendChild(buttonElement.cloneNode(true));}
i+=1;}}
if(headerRecordTemplate){arrColumnElements=xtag.query(headerRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){if(arrColumnDataNames[i]){arrColumnElements[i].setAttribute('title','$$HDR_TITLE_'+arrColumnDataNames[i]+'$$');}
i+=1;}}
if(headerRecordTemplate){arrColumnElements=xtag.query(headerRecordTemplate.content,'gs-cell');i=0;len=arrColumnElements.length;while(i<len){intColumnWidth=(GS.getTextWidth(element.elems.testHeader,arrColumnElements[i].textContent,true)+
3);if(arrColumnDataNames[i]){intColumnWidth+=(GS.emToPx(element.elems.testHeader,1.25));}
element.internalDisplay.minColumnWidths.push(intColumnWidth);if(intColumnWidth>element.internalDisplay.columnWidths[i]){element.internalDisplay.columnWidths[i]=(intColumnWidth);}
i+=1;}}
if(headerRecordTemplate){templateCellAddStyleToken(headerRecordTemplate);templateCellAddClass(headerRecordTemplate,'table-header');templateCellAddColumnNumber(headerRecordTemplate);element.internalTemplates.header=(headerRecordTemplate.innerHTML.trim());element.removeChild(headerRecordTemplate);}
if(dataRecordTemplate){templateCellAddStyleToken(dataRecordTemplate);templateCellAddClass(dataRecordTemplate,'table-cell');templateCellAddColumnNumber(dataRecordTemplate);templateCellAddRowNumber(dataRecordTemplate);strHTML=GS.templateColumnToValue(dataRecordTemplate.innerHTML.trim());element.internalTemplates.originalRecord=strHTML;element.internalTemplates.record=(GS.templateHideSubTemplates(strHTML,false));element.removeChild(dataRecordTemplate);}
if(copyTemplate){templateDetermineCopyColumnList(element,copyTemplate);templateDetermineCopyHeaderList(element,copyTemplate);element.removeChild(copyTemplate);}
if(insertRecordTemplate){templateCellAddStyleToken(insertRecordTemplate);templateCellAddClass(insertRecordTemplate,'table-insert');templateCellAddColumnNumber(insertRecordTemplate);templateCellAddRowNumber(insertRecordTemplate,'insert');element.internalTemplates.insertRecord=(insertRecordTemplate.innerHTML.trim());element.removeChild(insertRecordTemplate);}
if(insertDialogTemplate){element.internalTemplates.insertDialog=(insertDialogTemplate.innerHTML.trim());element.removeChild(insertDialogTemplate);}}
function createWebWorker(element){dataSELECT(element);}
function getCopyParameters(element){var headerMode;var selectorMode;var quoteChar;var escapeChar;var quoteMode;var recordDelimiter;var cellDelimiter;var nullString;if(element.getAttribute('copy-header')){headerMode=element.getAttribute('copy-header')||'';}else{headerMode='selected';}
if(element.getAttribute('copy-selectors')){selectorMode=element.getAttribute('copy-selectors')||'';}else{selectorMode='selected';}
if(element.getAttribute('copy-quote-char')){quoteChar=element.getAttribute('copy-quote-char')||'';}else{quoteChar='"';}
if(element.getAttribute('copy-escape-char')){escapeChar=element.getAttribute('copy-escape-char')||'';}else{escapeChar=quoteChar;}
if(element.getAttribute('copy-quote-when')){quoteMode=element.getAttribute('copy-quote-when')||'';}else{quoteMode='delimiter-in-content';}
if(element.getAttribute('copy-delimiter-record')){recordDelimiter=element.getAttribute('copy-delimiter-record')||'';}else{recordDelimiter='\n';}
if(element.getAttribute('copy-delimiter-cell')){cellDelimiter=element.getAttribute('copy-delimiter-cell')||'';}else{cellDelimiter='\t';}
if(element.getAttribute('copy-null-cell')){nullString=element.getAttribute('copy-null-cell')||'';}else{nullString='';}
return{"headerMode":headerMode,"selectorMode":selectorMode,"quoteChar":quoteChar,"escapeChar":escapeChar,"quoteMode":quoteMode,"recordDelimiter":recordDelimiter,"cellDelimiter":cellDelimiter,"nullString":nullString};}
function validateCopyParameters(element){var jsnCopyParameters;jsnCopyParameters=getCopyParameters(element);if(!(/^(always|never|selected)$/gi).test(jsnCopyParameters.headerMode)){throw'GS-TABLE Error: Copy parameter "copy-header" invalid, '+'valid values are "always", "never" or "selected" ';}
if(!(/^(always|never|selected)$/gi).test(jsnCopyParameters.selectorMode)){throw'GS-TABLE Error: Copy parameter "copy-selectors" invalid, '+'valid values are "always", "never" or "selected" ';}
if(!(/^(never|strings|always|delimiter-in-content)$/gi).test(jsnCopyParameters.quoteMode)){throw'GS-TABLE Error: Copy parameter "copy-quote-when" invalid, '+'valid values are "never", "strings", "always" or '+'"delimiter-in-content".';}
if(jsnCopyParameters.recordDelimiter.length===0){throw'GS-TABLE Error: Copy parameter "copy-delimiter-record" '+'cannot be empty.';}
if(jsnCopyParameters.cellDelimiter.length===0){throw'GS-TABLE Error: Copy parameter "copy-delimiter-cell" '+'cannot be empty.';}
return jsnCopyParameters;}
function handleClipboardData(event,strCopyString,strType){var clipboardData=event.clipboardData||window.clipboardData;var strMime;if(!clipboardData){return;}
if(!clipboardData.setData){return;}
if(strType==='text'){if(window.clipboardData&&window.clipboardData.getData){strMime='Text';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/plain';}}else if(strType==='html'){if(window.clipboardData&&window.clipboardData.getData){strMime='';}else if(event.clipboardData&&event.clipboardData.getData){strMime='text/html';}}else{throw'handleClipboardData Error: Type "'+strType+'" not '+'recognized, recognized types are "text" and "html".';}
if(strMime){if(strCopyString&&strMime){return clipboardData.setData(strMime,strCopyString)!==false;}else{return clipboardData.getData(strMime);}}}
function getCopyStrings(element){var strTextCopyString;var strHTMLCopyString;var strHTMLRecordCopyString;var row_i;var row_len;var col_i;var col_len;var cell;var row;var char;var record_i;var record_len;var cell_i;var jsnCopyParameters;var quoteChar;var escapeChar;var quoteMode;var selectorMode;var headerMode;var recordDelimiter;var cellDelimiter;var nullString;var arrColumns;var arrRows;var bolHeader;var bolSelector;var arrHeaders;var arrColumnTemplates;var arrColumnNames;var arrSelection;var intRow;var intCol;var intSel;var handleCell;var jsnQS;var jsnRow;var strRow;var strHeader;var arrSelectedStates=['B','D','F','H','J','L'];var cell_len;var delim;strTextCopyString='';strHTMLCopyString='<'+'style>'+'br { mso-data-placement:same-cell; } '+'th, td { white-space: pre-wrap; }'+'<'+'/style>'+'<'+'table border="0" cellpadding="0" cellspacing="0">';strHTMLRecordCopyString='';arrColumnTemplates=element.internalClip.columnList.slice(0);col_i=0;col_len=arrColumnTemplates.length;while(col_i<col_len){arrColumnTemplates[col_i]='{{ var qs = jo.qs'+', row = jo.row'+', i = jo.i'+', len = jo.len; }}'+
arrColumnTemplates[col_i];arrColumnTemplates[col_i]=doT.template(arrColumnTemplates[col_i]);col_i+=1;}
jsnCopyParameters=getCopyParameters(element);quoteChar=jsnCopyParameters.quoteChar;escapeChar=jsnCopyParameters.escapeChar;quoteMode=jsnCopyParameters.quoteMode;selectorMode=jsnCopyParameters.selectorMode;headerMode=jsnCopyParameters.headerMode;recordDelimiter=jsnCopyParameters.recordDelimiter;cellDelimiter=jsnCopyParameters.cellDelimiter;nullString=jsnCopyParameters.nullString;jsnQS=GS.qryToJSON(GS.getQueryString());arrColumnNames=element.internalData.columnNames;arrSelection=element.internalSelection.resolvedSelection.slice(0);arrColumns=element.internalSelection.columns.slice(0);arrRows=element.internalSelection.rows.slice(0);arrHeaders=element.internalClip.headerList.slice(0);if((headerMode==='selected'&&arrRows[0]==='header')||(headerMode==='always')){bolHeader=true;}
if(arrRows[0]==='header'){arrRows.shift();}
if(element.internalDisplay.headerVisible){strHeader=arrSelection[0];}
if((selectorMode==='selected'&&arrColumns[0]==='selector')||(selectorMode==='always')){bolSelector=true;}
if(arrColumns[0]==='selector'){arrColumns.shift();}
if(arrRows[arrRows.length-1]==='insert'){arrRows.pop();}
col_i=0;col_len=arrHeaders.length;while(col_i<col_len){arrHeaders[col_i]=doT.template('{{ var qs = jo.qs; }}'+
arrHeaders[col_i]);col_i+=1;}
if(quoteMode==='never'){handleCell=function(cellTemplate,i,len,jsnRow){var strCell=cellTemplate({'qs':jsnQS,'row':jsnRow,'i':i,'len':len});strHTMLRecordCopyString+='<'+'td rowspan="1" colspan="1">'+
strCell+'</td>';strTextCopyString+=strCell;};}else if(quoteMode==='strings'){handleCell=function(cellTemplate,i,len,jsnRow){var strCell=cellTemplate({'qs':jsnQS,'row':jsnRow,'i':i,'len':len});strHTMLRecordCopyString+='<'+'td rowspan="1" colspan="1">'+
strCell+'</td>';if(escapeChar!==quoteChar){strCell=stringReplaceAll(strCell,escapeChar,escapeChar+escapeChar);}
strCell=stringReplaceAll(strCell,quoteChar,escapeChar+quoteChar);if(isNaN(strCell)){strCell=quoteChar+strCell+quoteChar;}
strTextCopyString+=strCell;};}else if(quoteMode==='always'){handleCell=function(cellTemplate,i,len,jsnRow){var strCell=cellTemplate({'qs':jsnQS,'row':jsnRow,'i':i,'len':len});strHTMLRecordCopyString+='<'+'td rowspan="1" colspan="1">'+
strCell+'</td>';if(escapeChar!==quoteChar){strCell=stringReplaceAll(strCell,escapeChar,escapeChar+escapeChar);}
strCell=stringReplaceAll(strCell,quoteChar,escapeChar+quoteChar);strCell=quoteChar+strCell+quoteChar;strTextCopyString+=strCell;};}else if(quoteMode==='delimiter-in-content'){handleCell=function(cellTemplate,i,len,jsnRow){var strCell=cellTemplate({'qs':jsnQS,'row':jsnRow,'i':i,'len':len});strHTMLRecordCopyString+='<'+'td rowspan="1" colspan="1">'+
strCell+'</td>';if(escapeChar!==quoteChar){strCell=stringReplaceAll(strCell,escapeChar,escapeChar+escapeChar);}
if(strCell.indexOf(quoteChar)!==-1){strCell=stringReplaceAll(strCell,quoteChar,escapeChar+quoteChar);strCell=quoteChar+strCell+quoteChar;}
strTextCopyString+=strCell;};}
if(bolHeader&&headerMode!=='never'){if(bolSelector&&selectorMode!=='never'){if(quoteMode==='always'){strTextCopyString+=quoteChar+quoteChar;}
strTextCopyString+=cellDelimiter;strHTMLRecordCopyString+='<td rowspan="1" colspan="1"></td>';}
col_i=0;col_len=arrColumns.length;while(col_i<col_len){if(col_i>0){strTextCopyString+=cellDelimiter;}
intSel=arrColumns[col_i];intCol=intSel;if(element.internalDisplay.recordSelectorVisible){intSel=(arrColumns[col_i]+1);intCol=(intSel-1);}
if(headerMode==='always'||arrSelectedStates.indexOf(strHeader[intSel])>-1){handleCell(arrHeaders[intCol],0,0);}else{strHTMLRecordCopyString+=('<'+'td rowspan="1" colspan="1"></td>');if(quoteMode==='always'){strTextCopyString+=quoteChar+quoteChar;}}
col_i+=1;}
strHTMLCopyString+='<tr>'+strHTMLRecordCopyString+'</tr>';strHTMLRecordCopyString='';if(arrRows.length>0){strTextCopyString+=recordDelimiter;}}
col_len=arrColumns.length;row_i=0;row_len=arrRows.length;while(row_i<row_len){intSel=arrRows[row_i];intRow=intSel;if(element.internalDisplay.headerVisible){intSel=(arrRows[row_i]+1);intRow=(intSel-1);}
row=arrSelection[intSel];jsnRow={};strRow=element.internalData.records[intRow]+'\t';cell_i=0;cell_len=9999;while(cell_i<cell_len){delim=strRow.indexOf('\t');cell=strRow.substring(0,delim);strRow=strRow.substring(delim+1);if(cell!==''||strRow!==''){jsnRow[arrColumnNames[cell_i]]=(GS.decodeFromTabDelimited(cell,nullString));}else{break;}
cell_i+=1;}
if(bolSelector&&(selectorMode==='always'||(selectorMode==='selected'&&arrSelectedStates.indexOf(row[0])>-1))){strTextCopyString+=(intRow+1);strHTMLRecordCopyString+=('<td rowspan="1" colspan="1">'+(intRow+1)+'</td>');}
if(bolSelector&&col_len>0){strTextCopyString+=cellDelimiter;}
col_i=0;while(col_i<col_len){if(col_i>0){strTextCopyString+=cellDelimiter;}
intSel=arrColumns[col_i];intCol=intSel;if(element.internalDisplay.recordSelectorVisible){intSel=(arrColumns[col_i]+1);intCol=(intSel-1);}
if(arrSelectedStates.indexOf(row[intSel])>-1){handleCell(arrColumnTemplates[arrColumns[col_i]],row_i,row_len,jsnRow);}else{strHTMLRecordCopyString+=('<'+'td rowspan="1" colspan="1"></td>');if(quoteMode==='always'){strTextCopyString+=quoteChar+quoteChar;}}
col_i+=1;}
strHTMLCopyString+='<tr>'+strHTMLRecordCopyString+'</tr>';strHTMLRecordCopyString='';strTextCopyString+=recordDelimiter;row_i+=1;}
strHTMLCopyString+='</table>';return{"text":strTextCopyString,"html":strHTMLCopyString};}
function updateHUD(element){var arrDataColumns;var sortASCButton;var sortDESCButton;var sortClearButton;var statusElement;var intOriginRecord;GS.triggerEvent(element,'selection_change');sortASCButton=findHudElement(element,'button-sort-asc');sortDESCButton=findHudElement(element,'button-sort-desc');sortClearButton=findHudElement(element,'button-sort-clear');arrDataColumns=getSelectedDataColumns(element);if(arrDataColumns.length>0){if(sortASCButton){sortASCButton.removeAttribute('disabled');}
if(sortDESCButton){sortDESCButton.removeAttribute('disabled');}
if(sortClearButton){sortClearButton.removeAttribute('disabled');}}else{if(sortASCButton){sortASCButton.setAttribute('disabled','');}
if(sortDESCButton){sortDESCButton.setAttribute('disabled','');}
if(sortClearButton){sortClearButton.setAttribute('disabled','');}}}
function renderSelection(element){var bolHeaders;var bolSelectors;var bolInsert;var col_i;var col_len;var rec_i;var rec_len;var strRecord;var arrSelection;var range_i;var range_len;var range;var arrRanges;var arrColumnWidths;var rangeStartRow;var rangeStartColumn;var rangeEndRow;var rangeEndColumn;var intOriginRecord;var jsnSelectedToDeselected;var jsnDeselectedToSelected;var jsnTranslationMatrix;var intRecord;var intColumn;var intChar;var intHeaderIndex;var intSelectorIndex;var intInsertIndex;var arrElements;var i;var len;var cell;var strRow;var strCol;var intRow;var intCol;var arrSelectedStates;var arrColumns;var arrRows;var intMaxColumns;var arrSelectionRows;var arrSelectionCols;var pushValue;bolHeaders=(element.internalDisplay.headerVisible);bolSelectors=(!element.hasAttribute('no-record-selector'));bolInsert=(element.internalDisplay.insertRecordVisible);arrSelection=[];arrSelectedStates=['B','D','F','H','J','L'];col_len=element.internalDisplay.columnWidths.length;if(bolHeaders){strRecord='';if(bolSelectors){strRecord+='G';}
col_i=0;while(col_i<col_len){strRecord+='A';col_i+=1;}
arrSelection.push(strRecord);}
strRecord='';if(bolSelectors){strRecord='I';}
col_i=0;while(col_i<col_len){strRecord+='C';col_i+=1;}
rec_i=0;rec_len=element.internalData.records.length;while(rec_i<rec_len){arrSelection.push(strRecord);rec_i+=1;}
if(bolInsert){strRecord='';if(bolSelectors){strRecord+='K';}
col_i=0;while(col_i<col_len){strRecord+='E';col_i+=1;}
arrSelection.push(strRecord);}
jsnSelectedToDeselected={"A":"A","B":"A","C":"C","D":"C","E":"E","F":"E","G":"G","H":"G","I":"I","J":"I","K":"K","L":"K"};jsnDeselectedToSelected={"A":"B","B":"B","C":"D","D":"D","E":"F","F":"F","G":"H","H":"H","I":"J","J":"J","K":"L","L":"L"};intHeaderIndex=-1;intSelectorIndex=-1;intInsertIndex=(bolInsert?(arrSelection.length-1):null);if(bolHeaders){intInsertIndex-=1;}
arrRanges=element.internalSelection.ranges;arrColumnWidths=element.internalDisplay.columnWidths;range_i=0;range_len=arrRanges.length;while(range_i<range_len){range=arrRanges[range_i];range={"start":{"row":range.start.row,"column":range.start.column},"end":{"row":range.end.row,"column":range.end.column},"negator":range.negator};if(range.start.row==='header'){range.start.row=intHeaderIndex;}else if(range.start.row==='insert'){range.start.row=intInsertIndex;}
if(range.end.row==='header'){range.end.row=intHeaderIndex;}else if(range.end.row==='insert'){range.end.row=intInsertIndex;}
if(range.start.column==='selector'){range.start.column=intSelectorIndex;}
if(range.end.column==='selector'){range.end.column=intSelectorIndex;}
rangeStartRow=Math.min(range.start.row,range.end.row);rangeEndRow=Math.max(range.start.row,range.end.row);rangeStartColumn=Math.min(range.start.column,range.end.column);rangeEndColumn=Math.max(range.start.column,range.end.column);if(range_i===0){intOriginRecord=rangeStartRow;if(intOriginRecord===-1){intOriginRecord+=1;}
element.internalSelection.originRecord=intOriginRecord;}
if(range.negator===false){jsnTranslationMatrix=jsnDeselectedToSelected;}else{jsnTranslationMatrix=jsnSelectedToDeselected;}
rec_i=0;rec_len=arrSelection.length;while(rec_i<rec_len){strRecord=arrSelection[rec_i];intRecord=rec_i;if(bolHeaders){intRecord-=1;}
if((intRecord>=rangeStartRow&&intRecord<=rangeEndRow)||(rangeStartRow===-1&&rangeEndRow===-1)){col_i=0;col_len=strRecord.length;while(col_i<col_len){intChar=col_i;intColumn=col_i;if(bolSelectors){intColumn=(col_i-1);}
if(((intColumn>=rangeStartColumn&&intColumn<=rangeEndColumn)||(rangeStartColumn===-1&&rangeEndColumn===-1))&&(intColumn===null||intColumn===-1||arrColumnWidths[intColumn]>0)){strRecord=(strRecord.substr(0,intChar)+
jsnTranslationMatrix[strRecord[intChar]]+
strRecord.substr(intChar+1));}
col_i+=1;}
arrSelection[rec_i]=strRecord;}
rec_i+=1;}
range_i+=1;}
arrRows=[];arrSelectionRows=[];rec_i=0;rec_len=arrSelection.length;while(rec_i<rec_len){if((/[BDFHJL]/gi).test(arrSelection[rec_i])){if(bolHeaders&&rec_i===0){arrRows.push('header');}else if(bolInsert&&rec_i===(rec_len-1)){arrRows.push('insert');}else if(bolHeaders){arrRows.push(rec_i-1);}else{arrRows.push(rec_i);}
arrSelectionRows.push(rec_i);}
rec_i+=1;}
arrColumns=[];arrSelectionCols=[];intMaxColumns=element.internalClip.columnList.length;rec_i=0;rec_len=arrSelectionRows.length;while(rec_i<rec_len){strRecord=arrSelection[arrSelectionRows[rec_i]];col_i=0;col_len=strRecord.length;while(col_i<col_len){if(bolSelectors&&col_i===0){pushValue=('selector');}else if(bolSelectors){pushValue=(col_i-1);}else{pushValue=col_i;}
if(arrSelectedStates.indexOf(strRecord[col_i])!==-1&&arrColumns.indexOf(pushValue)===-1){arrColumns.push(pushValue);arrSelectionCols.push(col_i);}
col_i+=1;}
if(arrColumns.length>=intMaxColumns){break;}
rec_i+=1;}
arrElements=xtag.query(element.elems.dataViewport,'gs-cell');i=0;len=arrElements.length;while(i<len){arrElements[i].removeAttribute('selected');arrElements[i].removeAttribute('origin-record');arrElements[i].removeAttribute('auto-selected');i+=1;}
i=0;len=arrElements.length;while(i<len){cell=arrElements[i];strRow=(cell.getAttribute('data-row-number')||cell.getAttribute('data-row')||'-1');strCol=(cell.getAttribute('data-col-number')||cell.getAttribute('data-col')||'-1');intRow=parseInt(strRow,10);intCol=parseInt(strCol,10);if(bolHeaders){intRow+=1;}
if(bolSelectors){intCol+=1;}
if(strRow==='insert'){intRow=(arrSelection.length-1);}
if(strCol==='selector'){intCol=0;}
if((!bolHeaders&&intRow===intOriginRecord)||(bolHeaders&&intRow===(intOriginRecord+1))){arrElements[i].setAttribute('origin-record','');}
strRecord=arrSelection[intRow];if(strRecord){if(arrSelectedStates.indexOf(strRecord[intCol])>-1){cell.setAttribute('selected','');}else if(((cell.classList.contains('table-insert-selector')||cell.classList.contains('table-record-selector'))&&(arrSelectionRows.indexOf(intRow)>-1))||((cell.classList.contains('table-all-selector')||cell.classList.contains('table-header'))&&(arrSelectionCols.indexOf(intCol)>-1))){cell.setAttribute('auto-selected','');}}
i+=1;}
element.internalSelection.resolvedSelection=arrSelection;element.internalSelection.rows=arrRows;element.internalSelection.columns=arrColumns;if(arrRows.length===0||arrColumns.length===0){if(element.internalData.records.length>0&&(element.internalSelection.ranges&&(element.internalSelection.ranges.length!==1||element.internalSelection.ranges[0].start.row!==0||element.internalSelection.ranges[0].start.column!==0||element.internalSelection.ranges[0].end.row!==0||element.internalSelection.ranges[0].end.column!==0||element.internalSelection.ranges[0].negator!==false))){element.internalSelection.ranges=[{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"negator":false}];if(element.internalSelection.currentlySelecting){element.internalEvents.selectDragEnd();}
renderSelection(element);return;}}
updateHUD(element);}
function renderEmpty(element){element.elems.dataViewport.innerhtml='';}
function renderLocationFull(element){var arrColumnWidths;var arrRecordHeights;var columnBorderWidth;var recordBorderHeight;var jsnRange;var fromColumn;var toColumn;var fromRecord;var toRecord;var i;var len;var col_i;var col_len;var record_i;var record_len;var intCellLeft;var intCellOriginLeft;var intRecordTop;var intRecordOriginTop;var arrColumnNames;var strHeaderTemplate;var strDataTemplate;var strInsertTemplate;var arrElements;var strColumn;var strValue;var strRecord;var arrRecord;var jsnRecord;var jsnQS;var intTotalRecords;var strNullString;var strChar;var strCell;var strHTML;var strCSS;var intRecordSelectorBorderWidth;var intInsertRecordBorderHeight;var intHeaderBorderHeight;element.elems.dataViewport.setAttribute('class','table-data-viewport');arrColumnWidths=element.internalDisplay.columnWidths;arrRecordHeights=element.internalDisplay.recordHeights;columnBorderWidth=element.internalDisplay.columnBorderWidth;recordBorderHeight=element.internalDisplay.recordBorderHeight;arrColumnNames=element.internalData.columnNames;jsnQS=GS.qryToJSON(GS.getQueryString());intTotalRecords=element.internalData.records.length;strNullString=element.getAttribute('null-string');jsnRange=element.internalDisplay.currentRange;intCellOriginLeft=jsnRange.originLeft;intRecordOriginTop=jsnRange.originTop;fromColumn=jsnRange.fromColumn;toColumn=jsnRange.toColumn;fromRecord=jsnRange.fromRecord;toRecord=jsnRange.toRecord;intRecordSelectorBorderWidth=(element.internalDisplay.recordSelectorBorderWidth);intInsertRecordBorderHeight=(element.internalDisplay.insertRecordBorderHeight);intHeaderBorderHeight=(element.internalDisplay.headerBorderHeight);strHTML='';if(element.internalTemplates.header.trim()){strHeaderTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.header,fromColumn,toColumn);}
if(element.internalTemplates.record.templateHTML.trim()){strDataTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.record.templateHTML,fromColumn,toColumn);}
if(element.internalTemplates.insertRecord.trim()){strInsertTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.insertRecord,fromColumn,toColumn);}
if(strDataTemplate){var templateFunc=doT.template('{{ '+'var row_number = jo.index + 1;'+'var qs = jo.qs;'+'var row = jo.row;'+'var i = jo.index;'+'var len = jo.len;'+'}}'+
strDataTemplate);i=fromRecord;len=toRecord;intRecordTop=intRecordOriginTop;while(i<len){strRecord=element.internalData.records[i];record_i=0;record_len=strRecord.length;strCell="";arrRecord=[];while(record_i<record_len){strChar=strRecord[record_i];if(strChar==="\t"){arrRecord.push(GS.decodeFromTabDelimited(strCell,strNullString));strCell="";}else{strCell+=strChar;}
record_i+=1;}
arrRecord.push(strCell);col_i=0;col_len=arrRecord.length;jsnRecord={};while(col_i<col_len){jsnRecord[arrColumnNames[col_i]]=arrRecord[col_i];col_i+=1;}
strRecord=strDataTemplate;strRecord=templateFunc({'qs':jsnQS,'row':jsnRecord,'index':i,'len':intTotalRecords});col_i=fromColumn;col_len=toColumn;intCellLeft=intCellOriginLeft;while(col_i<col_len){if(arrColumnWidths[col_i]>0){strCSS='';strRecord=strRecord.replace('$$CSSREPLACETOKEN$$',strCSS);intCellLeft+=arrColumnWidths[col_i];intCellLeft+=columnBorderWidth;}
col_i+=1;}
strHTML+=strRecord;intRecordTop+=arrRecordHeights[i];intRecordTop+=recordBorderHeight;i+=1;}}
GS.templateShowSubTemplates(strHTML,element.internalTemplates.record);var intHeaderHeight;var intRecordSelectorWidth;var intInsertRecordHeight;intHeaderHeight=element.internalDisplay.headerHeight;intRecordSelectorWidth=element.internalDisplay.recordSelectorWidth;intInsertRecordHeight=element.internalDisplay.insertRecordHeight;if(strHeaderTemplate){strRecord=strHeaderTemplate;col_i=fromColumn;col_len=toColumn;intCellLeft=intCellOriginLeft;while(col_i<col_len){if(arrColumnWidths[col_i]>0){strCSS='';strRecord=strRecord.replace('$$CSSREPLACETOKEN$$',strCSS);intCellLeft+=arrColumnWidths[col_i];intCellLeft+=columnBorderWidth;}
col_i+=1;}
strRecord=handleHeaderTemplateTokens(element,strRecord,fromColumn,toColumn);strHTML+=strRecord;}
GS.templateShowSubTemplates(strHTML,element.internalTemplates.record);if(strInsertTemplate){strRecord=strInsertTemplate;col_i=fromColumn;col_len=toColumn;intCellLeft=intCellOriginLeft;while(col_i<col_len){if(arrColumnWidths[col_i]>0){strCSS='';strRecord=strRecord.replace('$$CSSREPLACETOKEN$$',strCSS);intCellLeft+=arrColumnWidths[col_i];intCellLeft+=columnBorderWidth;}
col_i+=1;}
strHTML+=strRecord;}
if(!element.hasAttribute('no-record-selector')){i=fromRecord;len=toRecord;intRecordTop=intRecordOriginTop;while(i<len){strCSS='';strHTML+='<gs-cell class="table-record-selector" '+'    style="'+strCSS+'" '+'    data-row-number="'+i+'" data-col="selector">'+
(i+1)+'</gs-cell>';intRecordTop+=arrRecordHeights[i];intRecordTop+=recordBorderHeight;i+=1;}}
if(strInsertTemplate&&!element.hasAttribute('no-record-selector')){strCSS='';strHTML+='<gs-cell class="table-insert-selector" '+'      style="'+strCSS+'" data-row="insert" '+'      data-col="selector">*'+'</gs-cell>';}
if(strHeaderTemplate&&!element.hasAttribute('no-record-selector')){strCSS='';strHTML+=('<gs-cell class="table-all-selector" '+'      style="'+strCSS+'" data-col="selector">#</gs-cell>');}
if(element.internalData.records.length===0){strHTML+='<div class="no-data-label">No Data</div>';}
element.elems.dataViewport.innerHTML=strHTML;arrElements=xtag.query(element.elems.dataViewport,'.table-insert [column]');col_i=0;col_len=arrElements.length;while(col_i<col_len){strColumn=arrElements[col_i].getAttribute('column');strValue=element.internalData.insertRecord[strColumn];if(strValue){arrElements[col_i].value=strValue;}
col_i+=1;}
renderSelection(element);}
function renderLocationPartial(element){var arrColumnWidths;var arrRecordHeights;var columnBorderWidth;var recordBorderHeight;var intRecordSelectorBorderWidth;var intInsertRecordBorderHeight;var intHeaderBorderHeight;var strRow;var strCol;var jsnOldRange;var jsnRange;var fromColumn;var toColumn;var fromRecord;var toRecord;var bolInsertRecord;var intCellOriginLeft;var intRecordOriginTop;var intCellLeft;var intCellTop;var arrColumnNames;var jsnQS;var intTotalRecords;var strNullString;var intRowNumber;var intColNumber;var arrColumnLeft;var arrRecordTop;var arrElements;var strColumn;var strValue;var bolUp;var bolDown;var bolInsert;var bolLeft;var bolRight;var i;var len;var arrCell;var cell;var cell_i;var cell_len;var col_i;var col_len;var row_i;var row_len;var strDownTemplate;var strUpTemplate;var strInsertTemplate;var strLeftHeaderTemplate;var strLeftRecordTemplate;var strLeftInsertTemplate;var strRightHeaderTemplate;var strRightRecordTemplate;var strRightInsertTemplate;var strHTML;var cellElement;arrColumnWidths=element.internalDisplay.columnWidths;arrRecordHeights=element.internalDisplay.recordHeights;columnBorderWidth=element.internalDisplay.columnBorderWidth;recordBorderHeight=element.internalDisplay.recordBorderHeight;intRecordSelectorBorderWidth=(element.internalDisplay.recordSelectorBorderWidth);intInsertRecordBorderHeight=(element.internalDisplay.insertRecordBorderHeight);intHeaderBorderHeight=(element.internalDisplay.headerBorderHeight);arrColumnNames=element.internalData.columnNames;jsnQS=GS.qryToJSON(GS.getQueryString());intTotalRecords=element.internalData.records.length;strNullString=element.getAttribute('null-string');var intHeaderHeight;var intRecordSelectorWidth;var intInsertRecordHeight;intHeaderHeight=element.internalDisplay.headerHeight;intRecordSelectorWidth=element.internalDisplay.recordSelectorWidth;intInsertRecordHeight=element.internalDisplay.insertRecordHeight;jsnOldRange=element.internalDisplay.prevRange;jsnRange=element.internalDisplay.currentRange;intCellOriginLeft=jsnRange.originLeft;intRecordOriginTop=jsnRange.originTop;fromColumn=jsnRange.fromColumn;toColumn=jsnRange.toColumn;fromRecord=jsnRange.fromRecord;toRecord=jsnRange.toRecord;bolInsertRecord=jsnRange.insertRecord;var createRecordSelector;if(element.hasAttribute('no-record-selector')){createRecordSelector=function(){};}else{createRecordSelector=function(index){cellElement=document.createElement('gs-cell');cellElement.setAttribute('data-row-number',index);cellElement.textContent=(index+1);cellElement.classList.add('table-record-selector');cellElement.setAttribute('data-col','selector');element.elems.dataViewport.appendChild(cellElement);};}
var createRecord=function(strTemplate,index){var strRecord;var arrRecord;var jsnRecord;var strCell;var delim;var cell_i;var cell_len;strRecord=element.internalData.records[index]+'\t';arrRecord=[];cell_i=0;cell_len=9999;while(cell_i<cell_len){delim=strRecord.indexOf('\t');strCell=strRecord.substring(0,delim);strRecord=strRecord.substring(delim+1);if(strCell!==''||strRecord!==''){arrRecord.push(GS.decodeFromTabDelimited(strCell,strNullString));}else{break;}
cell_i+=1;}
col_i=0;col_len=arrRecord.length;jsnRecord={};while(col_i<col_len){jsnRecord[arrColumnNames[col_i]]=arrRecord[col_i];col_i+=1;}
strRecord=('{{'+'var row_number = jo.index + 1;'+'var qs = jo.qs;'+'var row = jo.row;'+'var i = jo.index;'+'var len = jo.len;'+'}}'+
strTemplate);strRecord=doT.template(strRecord)({'qs':jsnQS,'row':jsnRecord,'index':index,'len':intTotalRecords});return strRecord;};var createNonDataCells=function(strTemplate){var strRecord;strRecord=strTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,'');strRecord='{{ var qs = jo.qs; }}'+strRecord;strRecord=doT.template(strRecord)({'qs':jsnQS});return strRecord;};var arrDoomed=[];arrCell=xtag.queryChildren(element.elems.dataViewport,'[data-row-number], [data-col-number], [data-row]');cell_i=0;cell_len=arrCell.length;while(cell_i<cell_len){cell=arrCell[cell_i];strRow=(cell.getAttribute('data-row-number')||cell.getAttribute('data-row'));strCol=cell.getAttribute('data-col-number');intRowNumber=parseInt(strRow,10);intColNumber=parseInt(strCol,10);if(intColNumber<fromColumn||intRowNumber<fromRecord||intColNumber>=toColumn||intRowNumber>=toRecord||(bolInsertRecord===false&&strRow==='insert')){arrDoomed.push(arrCell[cell_i]);}
cell_i+=1;}
var deleteNext=function(){cell_i=0;cell_len=arrDoomed.length;while(cell_i<cell_len){if(arrDoomed[cell_i].parentNode===element.elems.dataViewport){element.elems.dataViewport.removeChild(arrDoomed[cell_i]);}
cell_i+=1;}};if(window.requestAnimationFrame){window.requestAnimationFrame(deleteNext);}else{deleteNext();}
bolUp=(fromRecord<jsnOldRange.fromRecord);bolDown=(toRecord>jsnOldRange.toRecord);bolInsert=(bolInsertRecord===true&&bolInsertRecord!==jsnOldRange.insertRecord);bolLeft=(fromColumn<jsnOldRange.fromColumn);bolRight=(toColumn>jsnOldRange.toColumn);if(bolUp||bolDown){if(element.internalTemplates.record.templateHTML.trim()){strUpTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.record.templateHTML,fromColumn,toColumn);strUpTemplate=(strUpTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));strDownTemplate=strUpTemplate;}}
if(bolLeft){if(element.internalTemplates.header.trim()){strLeftHeaderTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.header,jsnRange.fromColumn,jsnOldRange.fromColumn);strLeftHeaderTemplate=handleHeaderTemplateTokens(element,strLeftHeaderTemplate,jsnRange.fromColumn,jsnOldRange.fromColumn);strLeftHeaderTemplate=(strLeftHeaderTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));}
if(element.internalTemplates.record.templateHTML.trim()){strLeftRecordTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.record.templateHTML,jsnRange.fromColumn,jsnOldRange.fromColumn);strLeftRecordTemplate=(strLeftRecordTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));}
if(element.internalTemplates.insertRecord.trim()&&!bolInsert){strLeftInsertTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.insertRecord,jsnRange.fromColumn,jsnOldRange.fromColumn);strLeftInsertTemplate=(strLeftInsertTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));}}
if(bolRight){if(element.internalTemplates.header.trim()){strRightHeaderTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.header,jsnOldRange.toColumn,jsnRange.toColumn);strRightHeaderTemplate=handleHeaderTemplateTokens(element,strRightHeaderTemplate,jsnOldRange.toColumn,jsnRange.toColumn);strRightHeaderTemplate=(strRightHeaderTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));}
if(element.internalTemplates.record.templateHTML.trim()){strRightRecordTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.record.templateHTML,jsnOldRange.toColumn,jsnRange.toColumn);strRightRecordTemplate=(strRightRecordTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));}
if(element.internalTemplates.insertRecord.trim()&&!bolInsert){strRightInsertTemplate=templateExtractVisibleCellRange(element,element.internalTemplates.insertRecord,jsnOldRange.toColumn,jsnRange.toColumn);strRightInsertTemplate=(strRightInsertTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));}}
strHTML='';if(bolUp){i=jsnRange.fromRecord;len=jsnOldRange.fromRecord;while(i<len){createRecordSelector(i);strHTML+=createRecord(strUpTemplate,i);i+=1;}}
if(bolDown){i=jsnOldRange.toRecord;len=jsnRange.toRecord;while(i<len){createRecordSelector(i);strHTML+=createRecord(strDownTemplate,i);i+=1;}}
if(bolInsert){strInsertTemplate='';if(!element.hasAttribute('no-record-selector')){strInsertTemplate+=('<gs-cell class="table-insert-selector"'+' data-row="insert" data-col="selector">*'+'</gs-cell>');}
strInsertTemplate+=(templateExtractVisibleCellRange(element,element.internalTemplates.insertRecord,jsnRange.fromColumn,jsnRange.toColumn));strInsertTemplate=(strInsertTemplate.replace(/\$\$CSSREPLACETOKEN\$\$/gi,''));strHTML+=createNonDataCells(strInsertTemplate);}
if(bolLeft){if(strLeftHeaderTemplate){strHTML+=createNonDataCells(strLeftHeaderTemplate);}
if(strLeftRecordTemplate){if(bolUp){i=jsnOldRange.fromRecord;len=jsnRange.toRecord;}else if(bolDown){i=jsnRange.fromRecord;len=jsnOldRange.toRecord;}else{i=jsnRange.fromRecord;len=jsnRange.toRecord;}
while(i<len){strHTML+=createRecord(strLeftRecordTemplate,i);i+=1;}}
if(strLeftInsertTemplate){strHTML+=createNonDataCells(strLeftInsertTemplate);}}
if(bolRight){if(strRightHeaderTemplate){strHTML+=createNonDataCells(strRightHeaderTemplate);}
if(strRightRecordTemplate){if(bolUp){i=jsnOldRange.fromRecord;len=jsnRange.toRecord;}else if(bolDown){i=jsnRange.fromRecord;len=jsnOldRange.toRecord;}else{i=jsnRange.fromRecord;len=jsnRange.toRecord;}
while(i<len){strHTML+=createRecord(strRightRecordTemplate,i);i+=1;}}
if(strRightInsertTemplate){strHTML+=createNonDataCells(strRightInsertTemplate);}}
strHTML=GS.templateShowSubTemplates(strHTML,element.internalTemplates.record);element.elems.dataViewport.insertAdjacentHTML('beforeend',strHTML);arrElements=xtag.query(element.elems.dataViewport,'.table-insert [column]');col_i=0;col_len=arrElements.length;while(col_i<col_len){strColumn=arrElements[col_i].getAttribute('column');strValue=element.internalData.insertRecord[strColumn];if(strValue){arrElements[col_i].value=strValue;}
col_i+=1;}
renderSelection(element);}
function renderLocation(element){var i;var len;var intMaximum;var intTraversed;var intExtremeSide;var intViewportWidth;var intViewportHeight;var jsnOldRange;var jsnRange;var focusElement;jsnOldRange=element.internalDisplay.currentRange;jsnRange=getCurrentCellRange(element);element.internalDisplay.currentRange=jsnRange;element.internalDisplay.prevRange=jsnOldRange;intViewportWidth=(element.elems.dataViewport.clientWidth);intViewportHeight=(element.elems.dataViewport.clientHeight);if(intViewportHeight<3||intViewportWidth<3){renderEmpty(element);}else if(element.internalDisplay.fullRenderRequired===true||jsnOldRange.fromRecord===undefined||jsnRange.fromRecord>jsnOldRange.toRecord||jsnRange.fromColumn>jsnOldRange.toColumn||jsnRange.toRecord<jsnOldRange.fromRecord||jsnRange.toColumn<jsnOldRange.fromColumn){renderLocationFull(element);}else{renderLocationPartial(element);}
element.internalDisplay.fullRenderRequired=false;element.elems.cellPositionStyle.innerHTML='';var intCellLeft=0;var intCellTop=0;var arrMinColumnWidths=element.internalDisplay.minColumnWidths;var arrColumnWidths=element.internalDisplay.columnWidths;var arrRecordHeights=element.internalDisplay.recordHeights;var columnBorderWidth=element.internalDisplay.columnBorderWidth;var recordBorderHeight=element.internalDisplay.recordBorderHeight;var strCSS='';var strCell='#'+element.getAttribute('id')+' gs-cell';intCellLeft=jsnRange.originLeft;i=jsnRange.fromColumn;len=jsnRange.toColumn;while(i<len){strCSS+=(strCell+'[data-col-number="'+i+'"] {'+'left: '+intCellLeft+'px;'+'width: '+(arrColumnWidths[i]+columnBorderWidth)+'px;'+'}');intCellLeft+=(arrColumnWidths[i]+columnBorderWidth);i+=1;}
intCellTop=jsnRange.originTop;i=jsnRange.fromRecord;len=jsnRange.toRecord;while(i<len){strCSS+=(strCell+'[data-row-number="'+i+'"] {'+'top: '+intCellTop+'px;'+'height: '+(arrRecordHeights[i]+recordBorderHeight)+'px;'+'}');intCellTop+=(arrRecordHeights[i]+recordBorderHeight);i+=1;}
if(element.internalDisplay.insertRecordVisible){strCSS+=(strCell+'[data-row="insert"],'+
strCell+'[data-row-number="insert"] {'+'top: '+intCellTop+'px;'+'height: '+(element.internalDisplay.insertRecordHeight+
element.internalDisplay.insertRecordBorderHeight)+'px;'+'}');}
strCSS+=(strCell+'[data-col="selector"] {'+'left: 0px;'+'width: '+(element.internalDisplay.recordSelectorWidth+
element.internalDisplay.recordSelectorBorderWidth)+'px;'+'}'+
strCell+'.table-all-selector,'+
strCell+'.table-header {'+'top: 0px;'+'height: '+(element.internalDisplay.headerHeight+
element.internalDisplay.headerBorderHeight)+'px;'+'}');element.elems.cellPositionStyle.innerHTML=strCSS;element.internalDisplay.columnHandles=[];element.internalDisplay.recordHandles=[];intMaximum=((intViewportWidth-
element.internalScrollOffsets.right)+
3);if(element.internalDisplay.recordSelectorVisible===true){element.internalDisplay.columnHandles.push(element.internalScrollOffsets.left);}
intTraversed=0;i=jsnRange.fromColumn;len=jsnRange.toColumn;while(i<len){if(element.internalDisplay.columnWidths[i]===0){intExtremeSide=0;}else{intExtremeSide=(element.internalDisplay.columnWidths[i]+
element.internalDisplay.columnBorderWidth);}
if(intTraversed<=0&&intExtremeSide>0){intExtremeSide+=jsnRange.originLeft;}
intTraversed+=intExtremeSide;if(intTraversed<intMaximum){if(intExtremeSide===0){element.internalDisplay.columnHandles.push(null);}else{element.internalDisplay.columnHandles.push(intTraversed);}}else{break;}
i+=1;}
intMaximum=(intViewportHeight-
element.internalScrollOffsets.bottom);if(element.internalDisplay.headerVisible===true){element.internalDisplay.recordHandles.push(element.internalScrollOffsets.top);}
intTraversed=0;i=jsnRange.fromRecord;len=jsnRange.toRecord;while(i<len){intExtremeSide=(element.internalDisplay.recordHeights[i]);if(intTraversed<=0){intExtremeSide+=(jsnRange.originTop);}
intTraversed+=intExtremeSide;if(intTraversed<intMaximum){element.internalDisplay.recordHandles.push(intTraversed);}else{break;}
intTraversed+=element.internalDisplay.recordBorderHeight;i+=1;}
if(element.internalDisplay.insertRecordVisible===true&&jsnRange){element.internalDisplay.recordHandles.push(element.internalDisplay.insertRecordHeight+
intTraversed);}
if(element.internalDisplay.focus.latest===false&&!isNaN(element.internalDisplay.focus.row)&&!isNaN(element.internalDisplay.focus.column)&&element.internalDisplay.focus.row>=jsnRange.fromRecord&&element.internalDisplay.focus.row<=jsnRange.toRecord&&element.internalDisplay.focus.column>=jsnRange.fromColumn&&element.internalDisplay.focus.column<=jsnRange.toColumn){focusElement=xtag.query(element.elems.dataViewport,('gs-cell'+'[data-col-number="'+
element.internalDisplay.focus.column+'"]'+'[data-row-number="'+
element.internalDisplay.focus.row+'"] '+
(element.internalDisplay.focus.nodeName||'').toLowerCase()))[0];if(focusElement){focusElement.focus();if(element.internalDisplay.focus.selectionRange){GS.setInputSelection(focusElement,element.internalDisplay.focus.selectionRange.start,element.internalDisplay.focus.selectionRange.end);}}}}
function renderScrollLocation(element){var intViewportWidth;var intViewportHeight;var virtualScrollHeight;var virtualScrollWidth;var virtualScrollTop;var virtualScrollLeft;var trueScrollHeight;var trueScrollWidth;var trueScrollTop;var trueScrollLeft;intViewportWidth=element.elems.dataViewport.clientWidth;intViewportHeight=element.elems.dataViewport.clientHeight;virtualScrollHeight=element.internalScroll.maxTop;virtualScrollWidth=element.internalScroll.maxLeft;virtualScrollTop=element.internalScroll.top;virtualScrollLeft=element.internalScroll.left;trueScrollWidth=element.elems.xScrollBar.scrollWidth;trueScrollHeight=element.elems.yScrollBar.scrollHeight;trueScrollWidth-=intViewportWidth;trueScrollHeight-=intViewportHeight;trueScrollTop=0;if(virtualScrollHeight>0){trueScrollTop=(virtualScrollTop/(virtualScrollHeight/trueScrollHeight));}
trueScrollLeft=0;if(virtualScrollWidth>0){trueScrollLeft=(virtualScrollLeft/(virtualScrollWidth/trueScrollWidth));}
element.internalEventCancelled.scrollbarY=true;element.internalEventCancelled.scrollbarX=true;if(Math.abs(element.elems.yScrollBar.scrollTop-trueScrollTop)>=1){element.elems.yScrollBar.scrollTop=trueScrollTop;}
if(Math.abs(element.elems.xScrollBar.scrollLeft-trueScrollLeft)>=1){element.elems.xScrollBar.scrollLeft=trueScrollLeft;}
renderLocation(element);}
function renderScrollDimensions(element){var i;var len;var arrColumnWidths;var arrRecordHeights;var columnBorderWidth;var recordBorderHeight;var intViewportWidth;var intViewportHeight;var intMaxColumnWidth;var intMaxRecordHeight;var intTotalDataWidth;var intTotalDataHeight;var intOverscrollWidth;var intOverscrollHeight;var intNoOverscrollHeight;var intNoOverscrollWidth;cellDimensionDetector(element);visibilityDetector(element);offsetDetector(element);columnBorderWidth=element.internalDisplay.columnBorderWidth;recordBorderHeight=element.internalDisplay.recordBorderHeight;arrColumnWidths=element.internalDisplay.columnWidths;arrRecordHeights=element.internalDisplay.recordHeights;intViewportWidth=element.elems.dataViewport.clientWidth;intViewportHeight=element.elems.dataViewport.clientHeight;intMaxColumnWidth=(intViewportWidth-(element.internalScrollOffsets.left+
element.internalScrollOffsets.right+
columnBorderWidth+
5));intMaxRecordHeight=(intViewportHeight-(element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom+
recordBorderHeight+
5));element.internalDisplay.maxColumnWidth=intMaxColumnWidth;element.internalDisplay.maxRecordHeight=intMaxRecordHeight;intTotalDataWidth=0;intOverscrollWidth=0;i=0;len=arrColumnWidths.length;while(i<len){if(intMaxColumnWidth>3&&arrColumnWidths[i]>intMaxColumnWidth){arrColumnWidths[i]=intMaxColumnWidth;}
intTotalDataWidth+=arrColumnWidths[i];intTotalDataWidth+=columnBorderWidth;if(i<(len-1)){intOverscrollWidth=intTotalDataWidth;}
i+=1;}
intTotalDataHeight=0;intOverscrollHeight=0;i=0;len=arrRecordHeights.length;while(i<len){if(intMaxRecordHeight>3&&arrRecordHeights[i]>intMaxRecordHeight){arrRecordHeights[i]=intMaxRecordHeight;}
intTotalDataHeight+=arrRecordHeights[i];intTotalDataHeight+=recordBorderHeight;if((element.internalDisplay.insertRecordVisible&&element.internalDisplay.insertRecordStick===null&&i===(len-1))||((!element.internalDisplay.insertRecordVisible||element.internalDisplay.insertRecordStick!==null)&&i<(len-1))){intOverscrollHeight=intTotalDataHeight;}
i+=1;}
if(element.hasAttribute('no-y-overscroll')){intNoOverscrollHeight=0;i=0;len=arrRecordHeights.length;while(i<len){if((intNoOverscrollHeight+
intViewportHeight)>(intTotalDataHeight+
element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom)){break;}
intNoOverscrollHeight+=arrRecordHeights[i];intNoOverscrollHeight+=recordBorderHeight;i+=1;}
if(element.internalDisplay.insertRecordVisible&&element.internalDisplay.insertRecordStick===null){intNoOverscrollHeight+=(element.internalDisplay.insertRecordHeight+
element.internalDisplay.insertRecordBorderHeight);}
element.internalScroll.maxTop=Math.max(0,intNoOverscrollHeight);}else{element.internalScroll.maxTop=Math.max(0,intOverscrollHeight);}
if(element.hasAttribute('no-x-overscroll')){intNoOverscrollWidth=0;i=0;len=arrColumnWidths.length;while(i<len){if((intNoOverscrollWidth+
intViewportWidth)>(intTotalDataWidth+
element.internalScrollOffsets.left+
element.internalScrollOffsets.right)){break;}
intNoOverscrollWidth+=arrColumnWidths[i];intNoOverscrollWidth+=columnBorderWidth;i+=1;}
element.internalScroll.maxLeft=Math.max(0,intNoOverscrollWidth);}else{element.internalScroll.maxLeft=Math.max(0,intOverscrollWidth);}
if(element.internalScroll.top>element.internalScroll.maxTop){element.internalScroll.top=element.internalScroll.maxTop;}
if(element.internalScroll.left>element.internalScroll.maxLeft){element.internalScroll.left=element.internalScroll.maxLeft;}
element.elems.yScrollBarCauser.style.top=(Math.min(((element.internalScroll.maxTop+
intViewportHeight)-1),100000)+"px");element.elems.xScrollBarCauser.style.left=(Math.min(((element.internalScroll.maxLeft+
intViewportWidth)-1),100000)+"px");renderScrollLocation(element);}
function renderHUD(element){var oldTopHUDHeight;var newTopHUDHeight;var oldBottomHUDHeight;var newBottomHUDHeight;oldTopHUDHeight=element.elems.topHudContainer.offsetHeight;if(element.internalTemplates.topHUD.trim()){element.elems.root.classList.add('show-top-hud');element.elems.topHudContainer.innerHTML=(element.internalTemplates.topHUD);newTopHUDHeight=element.elems.topHudContainer.offsetHeight;element.elems.root.style.paddingTop=newTopHUDHeight+'px';}else{element.elems.root.classList.remove('show-top-hud');element.elems.topHudContainer.innerHTML='';newTopHUDHeight=0;}
oldBottomHUDHeight=element.elems.bottomHudContainer.offsetHeight;if(element.internalTemplates.bottomHUD.trim()){element.elems.root.classList.add('show-bottom-hud');element.elems.bottomHudContainer.innerHTML=(element.internalTemplates.bottomHUD);newBottomHUDHeight=element.elems.bottomHudContainer.offsetHeight;element.elems.root.style.paddingBottom=newBottomHUDHeight+'px';}else{element.elems.root.classList.remove('show-bottom-hud');element.elems.bottomHudContainer.innerHTML='';newBottomHUDHeight=0;}
if(oldTopHUDHeight!==newTopHUDHeight||oldBottomHUDHeight!==newBottomHUDHeight){element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);}}
function resizeColumnsToHeader(element,arrColumnIndexes){var i;var len;var intIndex;i=0;len=arrColumnIndexes.length;while(i<len){intIndex=arrColumnIndexes[i];element.internalDisplay.columnWidths[intIndex]=(element.internalDisplay.minColumnWidths[intIndex]);i+=1;}
renderLocation(element);}
function resizeColumnsToContent(element,arrColumnIndexes){var i;var len;var elem_i;var elem_len;var intIndex;var arrElements;var controlElement;var intWidth;var jsnRange;var scopeElement;var controlText;var intTextWidth;var intColumnWidth;var intScopeElementWidth;jsnRange=element.internalDisplay.currentRange;i=0;len=arrColumnIndexes.length;while(i<len){intIndex=arrColumnIndexes[i];if(intIndex>=jsnRange.fromColumn&&intIndex<=jsnRange.toColumn){intWidth=element.internalDisplay.minColumnWidths[intIndex];intColumnWidth=element.internalDisplay.columnWidths[intIndex];arrElements=xtag.query(element.elems.dataViewport,'gs-cell.table-cell[data-col-number="'+intIndex+'"]');elem_i=0;elem_len=arrElements.length;while(elem_i<elem_len){controlElement=xtag.query(arrElements[elem_i],'input, textarea, select')[0];if(controlElement&&(controlElement.nodeName==='INPUT'||controlElement.nodeName==='TEXTAREA'||controlElement.nodeName==='SELECT')){scopeElement=controlElement.parentNode;controlText=controlElement.value;}else{scopeElement=(arrElements[elem_i].children[0]||arrElements[elem_i]);controlText=arrElements[elem_i].textContent;}
intTextWidth=GS.getTextWidth(scopeElement,controlText,true);intScopeElementWidth=Math.ceil(scopeElement.clientWidth-(parseFloat(GS.getStyle(scopeElement,'padding-left'))+
parseFloat(GS.getStyle(scopeElement,'padding-right'))));intTextWidth+=(intColumnWidth-intScopeElementWidth);intTextWidth+=10;if(intTextWidth>intWidth){intWidth=intTextWidth;}
elem_i+=1;}
element.internalDisplay.columnWidths[intIndex]=intWidth;}
i+=1;}
renderLocation(element);}
function moveLoaderToTop(element,loaderElement){}
function adjustLoaderWidth(element,loaderElement){var intWidth;intWidth=GS.getTextWidth(element,loaderElement.textContent);intWidth+=25;loaderElement.style.width=intWidth+'px';loaderElement.style.marginLeft='-'+intWidth+'px';}
function addLoader(element,strID,strContent){var loaderElement;loaderElement=document.createElement('div');loaderElement.classList.add('table-loader');loaderElement.innerHTML=strContent;element.elems.loaderContainer.appendChild(loaderElement);element.internalLoaders.loaderIDs.push(strID);element.internalLoaders.loaderElements.push(loaderElement);adjustLoaderWidth(element,loaderElement);moveLoaderToTop(element,loaderElement);}
function removeLoader(element,strID,strFinishedContent){var loaderIndex;var loaderElement;var fadeOut;var removeFunction;loaderIndex=element.internalLoaders.loaderIDs.indexOf(strID);loaderElement=element.internalLoaders.loaderElements[loaderIndex];element.internalLoaders.loaderIDs.splice(loaderIndex,1);element.internalLoaders.loaderElements.splice(loaderIndex,1);fadeOut=function(){loaderElement.classList.add('table-fade-out');removeFunction=function(){if(element.elems&&element.elems.loaderContainer){element.elems.loaderContainer.removeChild(loaderElement);}
removeFunction=null;};setTimeout(removeFunction,1000);fadeOut=null;};if(strFinishedContent){loaderElement.innerHTML=strFinishedContent;adjustLoaderWidth(element,loaderElement);moveLoaderToTop(element,loaderElement);setTimeout(fadeOut,1000);}else{fadeOut();}}
function dataSELECTcallback(element){var intDifference;var i;var len;var bolFirstLoad;bolFirstLoad=(element.internalData.bolFirstLoadFinished===false);intDifference=(element.internalDisplay.recordHeights.length-
element.internalData.records.length);if(intDifference>0){i=0;len=intDifference;while(i<len){element.internalDisplay.recordHeights.pop();i+=1;}}else if(intDifference<0){i=0;len=Math.abs(intDifference);while(i<len){element.internalDisplay.recordHeights.push(element.internalDisplay.defaultRecordHeight);i+=1;}}
if(element.internalData.bolFirstLoadFinished===false){element.internalData.bolFirstLoadFinished=true;}
element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);if(element.hasAttribute('focus-on-load')&&bolFirstLoad&&element.internalSelection.ranges.length===0){if(element.internalData.records.length>0){element.internalSelection.ranges=[{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"negator":false}];focusIntoCell(element,0,0);}else if(element.internalDisplay.recordSelectorVisible&&element.internalDisplay.headerVisible){element.internalSelection.ranges=[{"start":{"row":"header","column":"selector"},"end":{"row":"header","column":"selector"},"negator":false}];}
renderSelection(element);}
GS.triggerEvent(element,'after_select');}
function dataINSERTcallback(element){element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);element.internalScroll.top=(element.internalScroll.maxTop-(element.elems.dataViewport.clientHeight-(element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom+
element.internalDisplay.defaultRecordHeight)));renderScrollLocation(element);}
function dataUPDATEcallback(element){element.internalDisplay.fullRenderRequired=true;renderLocation(element);}
function dataDELETEcallback(element){element.internalSelection.ranges=[];element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);}
function getWhereClause(element){var strWhere;var strUserWhere;strWhere=GS.templateWithQuerystring(element.getAttribute('where')||'1=1');if(element.getAttribute('session-filter')){strWhere='('+element.getAttribute('session-filter')+')';strWhere+=(strWhere?' AND '+strWhere:'');}
if(element.getAttribute('value')&&(element.getAttribute('column')||element.getAttribute('qs'))){var strWhereColumn=element.getAttribute('child-column')||element.getAttribute('column')||element.getAttribute('qs');if(isNaN(element.value)){strWhere='CAST('+
strWhereColumn+' AS '+
GS.database.type.text+') = '+'CAST('+'$WhereQUOTE$'+(element.value)+'$WhereQUOTE$ AS '+
GS.database.type.text+')';strWhere+=(strWhere!==''?' AND ('+strWhere+')':'');}else{strWhere=strWhereColumn+'='+(element.value);strWhere+=(strWhere!==''?' AND ('+strWhere+')':'');}}
var arrOldColumnNames=element.internalData.columnNames;var arrOldColumnTypes=element.internalData.columnTypes;var arrOldColumnFilterStatuses=element.internalData.columnFilterStatuses;var arrOldColumnFilters=element.internalData.columnFilters;var arrOldColumnListFilters=element.internalData.columnListFilters;strUserWhere='';var i=0;var len=arrOldColumnFilters.length;var arrFilter;var strColumn;var filter_i;var filter_len;var strFilter;while(i<len){arrFilter=arrOldColumnFilters[i];strColumn=arrOldColumnNames[i];if(arrOldColumnFilterStatuses[i]==='on'){filter_i=0;filter_len=arrFilter.length;while(filter_i<filter_len){strFilter=arrFilter[filter_i].text;strUserWhere+=(strUserWhere?' AND ':'');strUserWhere+=strFilter;filter_i+=1;}}
i+=1;}
i=0;len=arrOldColumnListFilters.length;var jsnFilter;var strListWhere;while(i<len){jsnFilter=arrOldColumnListFilters[i];strColumn=arrOldColumnNames[i];strListWhere='';if(arrOldColumnFilterStatuses[i]==='on'&&jsnFilter.type&&jsnFilter.values){if(jsnFilter.type==='inclusion'){filter_i=0;filter_len=jsnFilter.values.length;while(filter_i<filter_len){strListWhere+=(strListWhere?' OR ':'');strListWhere+=(strColumn+' = CAST($werequote$'+
jsnFilter.values[filter_i]+'$werequote$ AS '+arrOldColumnTypes[i]+')');filter_i+=1;}
if(filter_len===0){strListWhere='1=2';}}else if(jsnFilter.type==='exclusion'){if(jsnFilter.values.length>0){filter_i=0;filter_len=jsnFilter.values.length;while(filter_i<filter_len){strListWhere+=(strListWhere?' AND ':'');strListWhere+=(strColumn+' != CAST($werequote$'+
jsnFilter.values[filter_i]+'$werequote$ AS '+arrOldColumnTypes[i]+')');filter_i+=1;}}}
if((strListWhere&&!(jsnFilter.type==='exclusion'&&jsnFilter.values.length===0))||jsnFilter.blanks===false){if(strListWhere){strListWhere='('+strListWhere+') ';}
if(jsnFilter.blanks===true){if(strListWhere){strListWhere+=' OR';}
strListWhere+=(' NULLIF('+'CAST('+
strColumn+' AS '+
GS.database.type.text+'), \'\') IS NULL');}else{if(strListWhere){strListWhere+=' AND';}
strListWhere+=(' NULLIF('+'CAST('+
strColumn+' AS '+
GS.database.type.text+'), \'\') IS NOT NULL');}
strUserWhere+=(strUserWhere?' AND ':'');strUserWhere+='('+strListWhere+')';}}
i+=1;}
if(strUserWhere&&strWhere){strWhere=strUserWhere+' AND ('+strWhere+')';}else if(strUserWhere){strWhere=strUserWhere;}
return strWhere;}
function databaseWSSELECT(element){var socket;var strSchema;var strObject;var strWhere;var strOrd;var strLimit;var strOffset;var strReturn;var strWhereColumn;var bolLoadNewRecordHeights;var intRecordHeight;var arrOldColumnNames;var arrOldColumnTypes;var arrOldColumnFilterStatuses;var arrOldColumnFilters;var arrOldColumnListFilters;var arrOldColumnOrders;var arrOldDisplayColumns;var i;var len;var strFilter;var strSort;var strColumn;var strUserOrd;var strUserWhere;var strListWhere;var filter_i;var filter_len;var arrFilter;var jsnFilter;var index;var arrRecords;var arrRecordHeights;socket=getSocket(element);strSchema=GS.templateWithQuerystring(element.getAttribute('schema')||'');strObject=GS.templateWithQuerystring(element.getAttribute('object')||'');strWhere=getWhereClause(element);strOrd=GS.templateWithQuerystring(element.getAttribute('ord')||'');strLimit=GS.templateWithQuerystring(element.getAttribute('limit')||'');strOffset=GS.templateWithQuerystring(element.getAttribute('offset')||'0');strReturn='*';bolLoadNewRecordHeights=(element.internalDisplay.recordHeights.length===0);intRecordHeight=(parseInt(element.getAttribute('default-record-height'),10)||intDefaultRecordHeight);element.internalData.records=[];arrOldColumnNames=element.internalData.columnNames;arrOldColumnTypes=element.internalData.columnTypes;arrOldColumnFilterStatuses=element.internalData.columnFilterStatuses;arrOldColumnFilters=element.internalData.columnFilters;arrOldColumnListFilters=element.internalData.columnListFilters;arrOldColumnOrders=element.internalData.columnOrders;arrOldDisplayColumns=element.internalDisplay.dataColumnName;strUserOrd='';i=0;len=arrOldDisplayColumns.length;while(i<len){strColumn=arrOldDisplayColumns[i];if(strColumn){index=arrOldColumnNames.indexOf(strColumn);strSort=arrOldColumnOrders[index];if(strSort==='asc'){strUserOrd+=(strUserOrd?', ':'');strUserOrd+=strColumn+' ASC';}else if(strSort==='desc'){strUserOrd+=(strUserOrd?', ':'');strUserOrd+=strColumn+' DESC';}}
i+=1;}
if(strUserOrd&&strOrd){strOrd=strUserOrd+', '+strOrd;}else if(strUserOrd){strOrd=strUserOrd;}
console.time('data load');arrRecords=element.internalData.records;arrRecordHeights=element.internalDisplay.recordHeights;addLoader(element,'data-select','Loading Data...');GS.requestSelectFromSocket(socket,strSchema,strObject,strReturn,strWhere,strOrd,strLimit,strOffset,function(data,error){var col_i;var col_len;var strCol;var strRecord;var strMessage;if(!error){if(data.strMessage==='TRANSACTION COMPLETED'){console.timeEnd('data load');console.log('record count:',element.internalData.records.length);removeLoader(element,'data-select','Data Loaded');dataSELECTcallback(element);}else{if(data.intCallback===0){element.internalData.columnNames=[];element.internalData.columnTypes=[];element.internalData.columnFilterStatuses=[];element.internalData.columnFilters=[];element.internalData.columnListFilters=[];element.internalData.columnOrders=[];col_i=0;col_len=data.arrDecodedColumnNames.length;while(col_i<col_len){strCol=data.arrDecodedColumnNames[col_i];index=arrOldColumnNames.indexOf(strCol);element.internalData.columnNames.push(strCol);element.internalData.columnTypes.push(data.arrDecodedColumnTypes[col_i]);if(index>-1){element.internalData.columnFilterStatuses.push(arrOldColumnFilterStatuses[index]);element.internalData.columnFilters.push(arrOldColumnFilters[index]);element.internalData.columnListFilters.push(arrOldColumnListFilters[index]);element.internalData.columnOrders.push(arrOldColumnOrders[index]);}else{element.internalData.columnFilterStatuses.push('on');element.internalData.columnFilters.push([]);element.internalData.columnListFilters.push({});element.internalData.columnOrders.push('neutral');}
col_i+=1;}}
if(data.intCallback===3&&element.internalData.bolFirstLoadFinished===false){element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);}
strMessage=data.strMessage;strRecord='';i=0;while(i<15){index=strMessage.indexOf('\n');strRecord=strMessage.substring(0,index);strMessage=strMessage.substring(index+1);if(strRecord!==''||strMessage!==''){arrRecords.push(strRecord);if(bolLoadNewRecordHeights){arrRecordHeights.push(intRecordHeight);}}else{break;}
i+=1;}}}else{dataSELECTcallback(element);removeLoader(element,'data-select','Data Failed To Load');GS.webSocketErrorDialog(data);}});}
function databaseWSINSERT(element,strMode,jsnInsert){var rec_i;var rec_len;var col_i;var col_len;var strColumn;var strPostfix;var insertStep;var beforeEvent;var arrPK;var arrSeq;var strPK;var strSeq;var strInsertColumns;var strInsertData;var strSchema;var strObject;var strReturn;var strNullString;var intRecordHeight;strSchema=GS.templateWithQuerystring(element.getAttribute('schema')||'');strObject=GS.templateWithQuerystring(element.getAttribute('object')||'');strReturn='';col_i=0;col_len=element.internalData.columnNames.length;while(col_i<col_len){strReturn+=(strReturn?'\t':'');strReturn+=element.internalData.columnNames[col_i];col_i+=1;}
strPK=GS.templateWithQuerystring(element.getAttribute('pk')||'');strSeq=GS.templateWithQuerystring(element.getAttribute('seq')||'');arrPK=strPK.split(/[\s]*,[\s]*/);arrSeq=strSeq.split(/[\s]*,[\s]*/);if(element.hasAttribute('null-string')){strNullString=element.getAttribute('null-string')||'';}else{strNullString=undefined;}
intRecordHeight=(parseInt(element.getAttribute('default-record-height'),10)||intDefaultRecordHeight);if(strMode==='single-record'){if(jsnInsert.data.addin&&jsnInsert.data.addin.link_column&&jsnInsert.data.addin.link_value&&jsnInsert.data.columns.indexOf(jsnInsert.data.addin.link_column)===-1){strColumn=jsnInsert.data.addin.link_column;jsnInsert.data.columns.push(jsnInsert.data.addin.link_column);jsnInsert.data.values[strColumn]=(jsnInsert.data.addin.link_value);}
strInsertColumns='';strInsertData='';col_i=0;col_len=jsnInsert.data.columns.length;while(col_i<col_len){strColumn=jsnInsert.data.columns[col_i];strInsertColumns+=(strInsertColumns?'\t':'');strInsertColumns+=strColumn;strInsertData+=(strInsertData?'\t':'');strInsertData+=GS.encodeForTabDelimited((jsnInsert.data.values[strColumn]||'NULL'),strNullString);col_i+=1;}
strInsertData+='\n';}else if(strMode==='multi-record'){if(jsnInsert.data.addin&&jsnInsert.data.addin.link_column&&jsnInsert.data.addin.link_value&&jsnInsert.data.columns.indexOf(jsnInsert.data.addin.link_column)===-1){strColumn=jsnInsert.data.addin.link_column;jsnInsert.data.columns.push(jsnInsert.data.addin.link_column);rec_i=0;rec_len=jsnInsert.data.columns.length;while(rec_i<rec_len){jsnInsert.data.values[rec_i]+='\t';jsnInsert.data.values[rec_i]+=GS.encodeForTabDelimited(jsnInsert.data.addin.link_value);rec_i+=1;}}
strInsertColumns='';col_i=0;col_len=jsnInsert.data.columns.length;while(col_i<col_len){strColumn=jsnInsert.data.columns[col_i];strInsertColumns+=(strInsertColumns?'\t':'');strInsertColumns+=strColumn;col_i+=1;}
strInsertData='';rec_i=0;rec_len=jsnInsert.data.values.length;while(rec_i<rec_len){strInsertData+=jsnInsert.data.values[rec_i];strInsertData+='\n';rec_i+=1;}}else{throw'GS-TABLE Error: Invalid insert type: "'+strMode+'".';}
col_i=0;col_len=arrSeq.length;while(col_i<col_len){if(jsnInsert.data.columns.indexOf(arrSeq[col_i])!==-1){arrSeq[col_i]='';}
col_i+=1;}
strPK='';col_i=0;col_len=arrPK.length;while(col_i<col_len){strPK+=(strPK?'\t':'');strPK+=GS.encodeForTabDelimited(arrPK[col_i],strNullString);col_i+=1;}
strSeq='';col_i=0;col_len=arrSeq.length;while(col_i<col_len){strSeq+=(col_i===0?'':'\t');if(jsnInsert.data.columns.indexOf(arrPK[col_i])===-1){strSeq+=arrSeq[col_i]||'';}
col_i+=1;}
strInsertData=strInsertColumns+'\n'+strInsertData;beforeEvent=GS.triggerEvent(element,'before_insert',{"schema":strSchema,"object":strObject,"insertMode":strMode,"insertData":jsnInsert.data});if(beforeEvent.defaultPrevented){return;}
insertStep=function(){var insertedRecords;insertedRecords='';addLoader(element,'data-insert','Inserting Data...');GS.requestInsertFromSocket(getSocket(element),strSchema,strObject,strReturn,strPK,strSeq,strInsertData,function(data,error){if(error){removeLoader(element,'data-insert','Insert Failed');GS.webSocketErrorDialog(data);}},function(data,error,ignore,commit,rollback){if(!error){if(data==='TRANSACTION COMPLETED'){commit();}else{insertedRecords+=data;}}else{GS.webSocketErrorDialog(data);rollback();}},function(strAnswer,data,error){var arrRecords;var i;var len;removeLoader(element,'data-insert',(error?'Insert Failed':'Insert Successful'));if(!error){if(strAnswer==='COMMIT'){arrRecords=insertedRecords.split('\n');i=0;len=arrRecords.length-1;while(i<len){element.internalData.records.push(arrRecords[i]);element.internalDisplay.recordHeights.push(intRecordHeight);i+=1;}
dataINSERTcallback(element);GS.triggerEvent(element,'after_insert',{"insertMode":strMode,"insertData":jsnInsert.data});}}else{GS.webSocketErrorDialog(data);}});};if((strMode!=='single-record'&&jsnInsert.data.values.length===0)||jsnInsert.data.columns.length===0){GS.msgbox('Nothing To Create','<center>'+'Please input data to create.'+'</center>',['Ok']);}else if(jsnInsert.insertConfirmed===true){insertStep();}else{strPostfix=((strMode==='single-record'||jsnInsert.data.values.length===1)?'this record':'these records');GS.msgbox('Are you sure...','<center>'+'Are you sure you want to create '+strPostfix+'?'+'</center>',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){insertStep();}});}}
function databaseWSUPDATE(element,strMode,jsnUpdate){var i;var len;var pk_i;var pk_len;var lock_i;var lock_len;var col_i;var col_len;var strPostfix;var beforeEvent;var updateStep;var jsnCurrentData;var strSchema;var strObject;var strReturn;var strHashColumns;var strRecord;var strUpdateData;var intUpdateColumnIndex;var arrPK;var arrLock;var startingIndex;var arrRecordIndexes;var strRow;var jsnRow;var cell_i;var cell;var char;var strRoles;var strColumns;var arrColumnNames;var strHashString;var strTemp;strSchema=GS.templateWithQuerystring(element.getAttribute('schema')||'');strObject=GS.templateWithQuerystring(element.getAttribute('object')||'');strReturn='';col_i=0;col_len=element.internalData.columnNames.length;while(col_i<col_len){strReturn+=(strReturn?'\t':'');strReturn+=element.internalData.columnNames[col_i];col_i+=1;}
arrColumnNames=element.internalData.columnNames;if(strMode==='single-cell'){jsnCurrentData={"columnName":jsnUpdate.data.columnName,"recordNumber":jsnUpdate.data.recordNumber,"oldValue":""};strHashColumns='';strUpdateData='';startingIndex='';intUpdateColumnIndex=(element.internalData.columnNames.indexOf(jsnUpdate.data.columnName));startingIndex=jsnUpdate.data.recordNumber;jsnCurrentData.oldValue=GS.decodeFromTabDelimited(element.internalData.records[startingIndex].split('\t')[intUpdateColumnIndex]);if(element.getAttribute('pk')){arrPK=(GS.templateWithQuerystring(element.getAttribute('pk')||'')).split(/[\s]*,[\s]*/);}else{arrPK=[];}
if(element.getAttribute('lock')){arrLock=(GS.templateWithQuerystring(element.getAttribute('lock')||'')).split(/[\s]*,[\s]*/);}else{arrLock=[];}
strHashColumns='';strHashString='';strRoles='';strColumns='';strUpdateData='';strRow=element.internalData.records[startingIndex];jsnRow={};i=0;len=strRow.length;cell_i=0;cell="";while(i<len){char=strRow[i];if(char==="\t"){jsnRow[arrColumnNames[cell_i]]=GS.decodeFromTabDelimited(cell,'\\N');cell="";cell_i+=1;}else{cell+=char;}
i+=1;}
jsnRow[arrColumnNames[cell_i]]=GS.decodeFromTabDelimited(cell,'\\N');i=0;len=arrPK.length;while(i<len){strRoles+=(strRoles?'\t':'');strRoles+='pk';strColumns+=(strColumns?'\t':'');strColumns+=arrPK[i];strUpdateData+=(strUpdateData?'\t':'');strUpdateData+=jsnRow[arrPK[i]];i+=1;}
i=0;len=arrLock.length;while(i<len){strHashColumns+=(strHashColumns?'\t':'');strHashColumns+=arrLock[i];strHashString+=(strHashString?'\t':'');strTemp=jsnRow[arrLock[i]];strHashString+=(strTemp==='NULL'?'':strTemp);i+=1;}
if(strHashString){strRoles+=(strRoles?'\t':'');strRoles+='hash';strColumns+=(strColumns?'\t':'');strColumns+='hash';strUpdateData+=(strUpdateData?'\t':'');strUpdateData+=GS.utfSafeMD5(strHashString).toString();}
strRoles+=(strRoles?'\t':'');strRoles+='set';strColumns+=(strColumns?'\t':'');strColumns+=jsnUpdate.data.columnName;strUpdateData+=(strUpdateData?'\t':'');strUpdateData+=GS.encodeForTabDelimited(jsnUpdate.data.newValue);strUpdateData+='\n';strUpdateData=(strRoles+'\n'+
strColumns+'\n'+
strUpdateData);arrRecordIndexes=[jsnUpdate.data.recordNumber];}else if(strMode==='cell-range'){jsnCurrentData={"columns":"","records":"","oldValues":"","newValues":""};strHashColumns='';strUpdateData='';strColumns='';strRoles='';if(element.getAttribute('pk')){arrPK=(GS.templateWithQuerystring(element.getAttribute('pk')||'')).split(/[\s]*,[\s]*/);}else{arrPK=[];}
if(element.getAttribute('lock')){arrLock=(GS.templateWithQuerystring(element.getAttribute('lock')||'')).split(/[\s]*,[\s]*/);}else{arrLock=[];}
i=0;len=arrLock.length;while(i<len){strHashColumns+=(strHashColumns?'\t':'');strHashColumns+=arrLock[i];i+=1;}
i=0;len=arrPK.length;while(i<len){strColumns+=(strColumns?'\t':'');strColumns+=arrPK[i];i+=1;}
i=0;len=jsnUpdate.data.columns.length;while(i<len){strColumns+=(strColumns?'\t':'');strColumns+=jsnUpdate.data.columns[i];i+=1;}
strColumns+='\t';strColumns+='hash';i=0;len=arrPK.length;while(i<len){strRoles+=(strRoles?'\tpk':'pk');i+=1;}
i=0;len=jsnUpdate.data.columns.length;while(i<len){strRoles+=(strRoles?'\tset':'set');i+=1;}
strRoles+='\t';strRoles+='hash';i=0;len=jsnUpdate.data.records.length;while(i<len){strRecord='';pk_i=0;pk_len=arrPK.length;while(pk_i<pk_len){strRecord+=(strRecord?'\t':'');strRecord+=getCell(element,arrPK[pk_i],jsnUpdate.data.records[i],false);pk_i+=1;}
strRecord+=(strRecord?'\t':'');strRecord+=jsnUpdate.data.values[i];strHashString='';lock_i=0;lock_len=arrPK.length;while(lock_i<lock_len){strHashString+=(strHashString?'\t':'');strTemp=getCell(element,arrLock[lock_i],jsnUpdate.data.records[i],false);strHashString+=(strTemp==='\\N'?'':strTemp);lock_i+=1;}
strRecord+=(strRecord?'\t':'');strRecord+=GS.utfSafeMD5(strHashString).toString();strUpdateData+=strRecord;strUpdateData+='\n';i+=1;}
strUpdateData=(strRoles+'\n'+
strColumns+'\n'+
strUpdateData);arrRecordIndexes=jsnUpdate.data.records;}else{throw'GS-TABLE Error: Invalid update type. Update type "'+
strMode+'" is not valid, please use "single-cell" '+'or "cell-range".';}
beforeEvent=GS.triggerEvent(element,'before_update',{"schema":strSchema,"object":strObject,"updateMode":strMode,"oldData":jsnCurrentData,"newData":jsnUpdate.data});if(beforeEvent.defaultPrevented){return;}
updateStep=function(){var updatedRecords;updatedRecords='';addLoader(element,'data-update','Updating Data...');GS.requestUpdateFromSocket(getSocket(element),strSchema,strObject,strReturn,strHashColumns,strUpdateData,function(data,error){if(error){removeLoader(element,'data-update','Change Failed');GS.webSocketErrorDialog(data);}},function(data,error,ignore,commit,rollback){if(!error){if(data==='TRANSACTION COMPLETED'){commit();}else{updatedRecords+=data;}}else{GS.webSocketErrorDialog(data);rollback();}},function(strAnswer,data,error){var arrRecords;removeLoader(element,'data-update',(error?'Change Failed':'Change Saved'));if(!error){if(strAnswer==='COMMIT'){arrRecords=updatedRecords.split('\n');i=0;len=arrRecords.length-1;while(i<len){element.internalData.records[arrRecordIndexes[i]]=(arrRecords[i]);i+=1;}
dataUPDATEcallback(element);GS.triggerEvent(element,'after_update',{"updateMode":strMode,"oldData":jsnCurrentData,"newData":jsnUpdate.data});}else{}}else{GS.webSocketErrorDialog(data);}});};if(jsnUpdate.updateConfirmed===true){updateStep();}else{strPostfix=((!jsnUpdate.data.records||jsnUpdate.data.records.length===1)?'this record':'these records');GS.msgbox('Are you sure...','<center>'+'Are you sure you want to update '+strPostfix+'?'+'</center>',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){updateStep();}});}}
function databaseWSDELETE(element,jsnDelete){var i;var len;var col_i;var col_len;var strSchema;var strObject;var strPostfix;var beforeEvent;var deleteStep;var strPK;var strLock;var arrPK;var arrLock;var intIndex;var arrColumns;var strColumnNames;var strColumnRoles;var strHashColumns;var strRecordToHash;var strTemp;var strDeleteData;var strDeleteRecords;var arrDeleteRecord;var strRecord;var strNullString;strSchema=GS.templateWithQuerystring(element.getAttribute("schema")||"");strObject=GS.templateWithQuerystring(element.getAttribute("object")||"");if(element.hasAttribute('null-string')){strNullString=element.getAttribute('null-string')||'';}else{strNullString=undefined;}
strPK=(element.getAttribute("pk")||"");strLock=(element.getAttribute("lock")||"");arrPK=strPK.split(/[\s]*,[\s]*/);arrLock=strLock.split(/[\s]*,[\s]*/);arrColumns=element.internalData.columnNames;strColumnRoles='';strColumnNames='';i=0;len=arrPK.length;while(i<len){strColumnNames+=(strColumnNames?"\t":"");strColumnNames+=arrPK[i];strColumnRoles+=(strColumnRoles?"\t":"");strColumnRoles+="pk";i+=1;}
strColumnNames+=(strColumnNames?"\t":"");strColumnNames+="hash";strColumnRoles+=(strColumnRoles?"\t":"");strColumnRoles+="hash";strHashColumns='';i=0;len=arrLock.length;while(i<len){strHashColumns+=(strHashColumns?"\t":"");strHashColumns+=arrLock[i];i+=1;}
strDeleteRecords='';i=0;len=jsnDelete.recordIndexes.length;while(i<len){strRecord='';arrDeleteRecord=element.internalData.records[jsnDelete.recordIndexes[i]].split("\t");col_i=0;col_len=arrPK.length;while(col_i<col_len){intIndex=arrColumns.indexOf(arrPK[col_i]);strRecord+=(strRecord?"\t":"");strRecord+=GS.encodeForTabDelimited(arrDeleteRecord[intIndex],strNullString);col_i+=1;}
strRecordToHash="";col_i=0;col_len=arrLock.length;while(col_i<col_len){intIndex=arrColumns.indexOf(arrLock[col_i]);strRecordToHash+=(strRecordToHash?"\t":"");strTemp=arrDeleteRecord[intIndex];strRecordToHash+=(strTemp==="NULL"?"":strTemp);col_i+=1;}
strDeleteRecords+=strRecord;strDeleteRecords+=(strRecord?'\t':'');strDeleteRecords+=GS.utfSafeMD5(strRecordToHash).toString();strDeleteRecords+='\n';i+=1;}
strDeleteData=(strColumnRoles+'\n'+
strColumnNames+'\n'+
strDeleteRecords);beforeEvent=GS.triggerEvent(element,'before_delete',{"schema":strSchema,"object":strObject,"recordIndexes":jsnDelete.recordIndexes,"deleteConfirmed":jsnDelete.deleteConfirmed,"strColumnRoles":strColumnRoles,"strColumnNames":strColumnNames,"strDeleteRecords":strDeleteRecords});if(beforeEvent.defaultPrevented){return;}
deleteStep=function(){addLoader(element,'data-delete','Deleting Data...');GS.requestDeleteFromSocket(getSocket(element),strSchema,strObject,strHashColumns,strDeleteData,function(data,error){if(error){removeLoader(element,'data-delete','Delete Failed');GS.webSocketErrorDialog(data);}},function(data,error,ignore,commit,rollback){if(!error){if(data==='TRANSACTION COMPLETED'){commit();}}else{GS.webSocketErrorDialog(data);rollback();}},function(strAnswer,data,error){var arrRecords;var arrRecordHeights;removeLoader(element,'data-delete',(error?'Delete Failed':'Delete Successful'));if(!error){if(strAnswer==='COMMIT'){arrRecords=[];arrRecordHeights=[];i=0;len=element.internalData.records.length;while(i<len){if(jsnDelete.recordIndexes.indexOf(i)===-1){arrRecords.push(element.internalData.records[i]);arrRecordHeights.push(element.internalDisplay.recordHeights[i]);}
i+=1;}
element.internalData.records=arrRecords;element.internalDisplay.recordHeights=arrRecordHeights;dataDELETEcallback(element);GS.triggerEvent(element,'after_delete',{"schema":strSchema,"object":strObject,"recordIndexes":jsnDelete.recordIndexes,"strColumnRoles":strColumnRoles,"strColumnNames":strColumnNames,"strDeleteRecords":strDeleteRecords});}}else{GS.webSocketErrorDialog(data);}});};if(jsnDelete.recordIndexes.length===0){GS.msgbox('No Records To Delete','<center>'+'Please choose a record to delete.'+'</center>',['Ok']);}else if(jsnDelete.deleteConfirmed===true){deleteStep();}else{strPostfix=(jsnDelete.recordIndexes.length===1?'this record':'these records');GS.msgbox('Are you sure...','<center>'+'Are you sure you want to delete '+strPostfix+'?'+'</center>',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){deleteStep();}});}}
function internalSELECT(element){var templateElement;var arrColumns;if(element.internalData.columnNames.length===0){templateElement=document.createElement('template');templateElement.innerHTML=element.internalTemplates.insertDialog;arrColumns=templateGetColumnList(templateElement);arrColumns.forEach(function(strColumn){if(element.internalData.columnNames.indexOf(strColumn)===-1){element.internalData.columnNames.push(strColumn);element.internalData.columnTypes.push('text');element.internalData.columnFilterStatuses.push('on');element.internalData.columnFilters.push([]);element.internalData.columnListFilters.push({});element.internalData.columnOrders.push('neutral');}});templateElement.innerHTML=element.internalTemplates.insertRecord;arrColumns=templateGetColumnList(templateElement);arrColumns.forEach(function(strColumn){if(element.internalData.columnNames.indexOf(strColumn)===-1){element.internalData.columnNames.push(strColumn);element.internalData.columnTypes.push('text');element.internalData.columnFilterStatuses.push('on');element.internalData.columnFilters.push([]);element.internalData.columnListFilters.push({});element.internalData.columnOrders.push('neutral');}});templateElement.innerHTML=element.internalTemplates.record;arrColumns=templateGetColumnList(templateElement);arrColumns.forEach(function(strColumn){if(element.internalData.columnNames.indexOf(strColumn)===-1){element.internalData.columnNames.push(strColumn);element.internalData.columnTypes.push('text');element.internalData.columnFilterStatuses.push('on');element.internalData.columnFilters.push([]);element.internalData.columnListFilters.push({});element.internalData.columnOrders.push('neutral');}});}
dataSELECTcallback(element);}
function internalINSERT(element,strMode,jsnInsert){var beforeEvent;var insertStep;var strPostfix;var strNullString;var intRecordHeight;var strRecord;var arrRecords;var arrRecord;var arrColumns;var strColumn;var strValue;var index;var i;var len;var col_i;var col_len;if(element.hasAttribute('null-string')){strNullString=element.getAttribute('null-string')||'';}else{strNullString=undefined;}
intRecordHeight=(parseInt(element.getAttribute('default-record-height'),10)||intDefaultRecordHeight);beforeEvent=GS.triggerEvent(element,'before_insert',{"insertMode":strMode,"insertData":jsnInsert.data});if(beforeEvent.defaultPrevented){return;}
insertStep=function(){addLoader(element,'data-insert','Inserting Data...');if(strMode==="single-record"){/*
                jsnInsert = {
                    "data": {
                        "addin": {
                            "link_column": "columnname4",
                            "link_value": "value"
                        },
                        "columns": [
                            "columnname1",
                            "columnname2",
                            "columnname3"
                            ...
                        ],
                        "values": {
                            "columnname1": "value",
                            "columnname2": "value",
                            "columnname3": "value"
                            ...
                        }
                    },
                    "insertConfirmed": boolean
                }
                */
strRecord="";arrColumns=element.internalData.columnNames;i=0;len=arrColumns.length;while(i<len){strColumn=arrColumns[i];if(i>0){strRecord+="\t";}
strValue=jsnInsert.data.values[strColumn];if(strValue!==undefined){strRecord+=GS.encodeForTabDelimited(strValue,strNullString);}else if(jsnInsert.data.addin.link_column===strColumn){strRecord+=GS.encodeForTabDelimited(jsnInsert.data.addin.link_value,strNullString);}else{strRecord+='\\N';}
i+=1;}
element.internalData.records.push(strRecord);element.internalDisplay.recordHeights.push(intRecordHeight);}else if(strMode==="multi-record"){/*
                jsnInsert = {
                    "data": {
                        "addin": {
                            "link_column": "columnname4",
                            "link_value": "value"
                        },
                        "columns": [
                            "columnname1",
                            "columnname2"
                            ...
                        ],
                        "values": [
                            "value1\tvalue1",
                            "value2\tvalue2",
                            "value3\tvalue3"
                            ...
                        ]
                    },
                    "insertConfirmed": boolean
                }
                */
arrRecords=[];arrColumns=element.internalData.columnNames;i=0;len=jsnInsert.data.values.length;while(i<len){strRecord=jsnInsert.data.values[i];arrRecord=strRecord.split('\t');strRecord="";col_i=0;col_len=arrColumns.length;while(col_i<col_len){strColumn=arrColumns[col_i];index=jsnInsert.data.columns.indexOf(strColumn);strValue=arrRecord[index];if(col_i>0){strRecord+="\t";}
if(strValue){strRecord+=arrRecord[index];}else if(jsnInsert.data.addin.link_column===strColumn){strRecord+=GS.encodeForTabDelimited(jsnInsert.data.addin.link_value,strNullString);}else{strRecord+='\\N';}
col_i+=1;}
arrRecords.push(strRecord);i+=1;}
i=0;len=arrRecords.length;while(i<len){element.internalData.records.push(arrRecords[i]);element.internalDisplay.recordHeights.push(intRecordHeight);i+=1;}}
removeLoader(element,'data-insert','New Record Saved');dataINSERTcallback(element);GS.triggerEvent(element,'after_insert',{"insertMode":strMode,"insertData":jsnInsert.data});};if((strMode!=='single-record'&&jsnInsert.data.values.length===0)||jsnInsert.data.columns.length===0){GS.msgbox('Nothing To Create','<center>'+'Please input data to create.'+'</center>',['Ok']);}else if(jsnInsert.insertConfirmed===true){insertStep();}else{strPostfix=((strMode==='single-record'||jsnInsert.data.values.length===1)?'this record':'these records');GS.msgbox('Are you sure...','<center>'+'Are you sure you want to create '+strPostfix+'?'+'</center>',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){insertStep();}});}}
function internalUPDATE(element,strMode,jsnUpdate){var i;var len;var row_i;var row_len;var strPostfix;var beforeEvent;var updateStep;var jsnCurrentData;var intUpdateColumnIndex;var arrUpdateColumnIndexes;var startingIndex;var arrUpdatePaste;var update_i;var cell_i;var cell;var char;var strOldRow;var strNewRow;var arrRecordIndexes;var arrRecordReplacements;if(strMode==='single-cell'){jsnCurrentData={"columnName":jsnUpdate.data.columnName,"recordNumber":jsnUpdate.data.recordNumber,"oldValue":""};intUpdateColumnIndex=(element.internalData.columnNames.indexOf(jsnUpdate.data.columnName));startingIndex=jsnUpdate.data.recordNumber;strOldRow=element.internalData.records[startingIndex];strNewRow='';i=0;len=strOldRow.length;cell_i=0;cell="";while(i<len){char=strOldRow[i];if(char==="\t"||i===(len-1)){if(i===(len-1)){cell+=char;}
if(cell_i===intUpdateColumnIndex){strNewRow+=GS.encodeForTabDelimited(jsnUpdate.data.newValue);jsnCurrentData.oldValue=cell;}else{strNewRow+=cell;}
cell="";cell_i+=1;}else{cell+=char;}
if(char==="\t"){strNewRow+='\t';}
i+=1;}
arrRecordIndexes=[startingIndex];arrRecordReplacements=[strNewRow];}else if(strMode==='cell-range'){jsnCurrentData={"columns":"","records":"","oldValues":"","newValues":""};arrUpdateColumnIndexes=[];i=0;len=jsnUpdate.data.columns.length;while(i<len){arrUpdateColumnIndexes.push(element.internalData.columnNames.indexOf(jsnUpdate.data.columns[i]));i+=1;}
i=0;len=jsnUpdate.data.records.length;arrRecordReplacements=[];while(i<len){strOldRow=element.internalData.records[jsnUpdate.data.records[i]];strNewRow='';arrUpdatePaste=jsnUpdate.data.values[i].split('\t');update_i=0;row_i=0;row_len=strOldRow.length;cell_i=0;cell="";while(row_i<row_len){char=strOldRow[row_i];if(char==="\t"||row_i===(row_len-1)){if(arrUpdateColumnIndexes.indexOf(cell_i)>-1){strNewRow+=arrUpdatePaste[update_i]||'\\N';update_i+=1;}else{strNewRow+=cell;}
cell="";cell_i+=1;}else{cell+=char;}
if(char==="\t"){strNewRow+='\t';}
row_i+=1;}
arrRecordReplacements.push(strNewRow);i+=1;}
arrRecordIndexes=jsnUpdate.data.records;}else{throw'GS-TABLE Error: Invalid update type. Update type "'+
strMode+'" is not valid, please use "single-cell" '+'or "cell-range".';}
beforeEvent=GS.triggerEvent(element,'before_update',{"updateMode":strMode,"oldData":jsnCurrentData,"newData":jsnUpdate.data});if(beforeEvent.defaultPrevented){return;}
updateStep=function(){addLoader(element,'data-update','Updating Data...');i=0;len=arrRecordIndexes.length;while(i<len){element.internalData.records[arrRecordIndexes[i]]=(arrRecordReplacements[i]);i+=1;}
dataUPDATEcallback(element);GS.triggerEvent(element,'after_update',{"updateMode":strMode,"oldData":jsnCurrentData,"newData":jsnUpdate.data});removeLoader(element,'data-update','Change Saved');};if(jsnUpdate.updateConfirmed===true){updateStep();}else{strPostfix=((!jsnUpdate.data.records||jsnUpdate.data.records.length===1)?'this record':'these records');GS.msgbox('Are you sure...','<center>'+'Are you sure you want to update '+strPostfix+'?'+'</center>',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){updateStep();}});}}
function internalDELETE(element,jsnDelete){var strPostfix;var beforeEvent;var deleteStep;beforeEvent=GS.triggerEvent(element,'before_delete',{"recordIndexes":jsnDelete.recordIndexes,"deleteConfirmed":jsnDelete.deleteConfirmed});if(beforeEvent.defaultPrevented){return;}
deleteStep=function(){var arrRecords;var arrRecordHeights;var i;var len;addLoader(element,'data-delete','Deleting Data...');arrRecords=[];arrRecordHeights=[];i=0;len=element.internalData.records.length;while(i<len){if(jsnDelete.recordIndexes.indexOf(i)===-1){arrRecords.push(element.internalData.records[i]);arrRecordHeights.push(element.internalDisplay.recordHeights[i]);}
i+=1;}
element.internalData.records=arrRecords;element.internalDisplay.recordHeights=arrRecordHeights;removeLoader(element,'data-delete','Delete Successful');dataDELETEcallback(element);GS.triggerEvent(element,'after_delete',{"recordIndexes":jsnDelete.recordIndexes});};if(jsnDelete.recordIndexes.length===0){GS.msgbox('No Records To Delete','<center>'+'Please choose a record to delete.'+'</center>',['Ok']);}else if(jsnDelete.deleteConfirmed===true){deleteStep();}else{strPostfix=(jsnDelete.recordIndexes.length===1?'this record':'these records');GS.msgbox('Are you sure...','<center>'+'Are you sure you want to delete '+strPostfix+'?'+'</center>',['No','Yes'],function(strAnswer){if(strAnswer==='Yes'){deleteStep();}});}}
function databaseWSSELECTcolumnUnique(element,uniqueFilterElement,valueListElement,strColumn){var socket=getSocket(element);var strSchema;var strObject;var strWhere;strSchema=GS.templateWithQuerystring(element.getAttribute('schema')||'');strObject=GS.templateWithQuerystring(element.getAttribute('object')||'');strWhere=element.getAttribute('where')||'1=1';var strSrc=(ml(function(){/*
                SELECT count(*) AS count
                     , COALESCE(
                            NULLIF(CAST("{{COLUMN}}" AS text), ''),
                            '(blanks)'
                       ) AS unique_value
                  FROM {{SCHEMA}}.{{OBJECT}}
                  WHERE {{WHERE}}
              GROUP BY NULLIF(CAST("{{COLUMN}}" AS text), '')
              ORDER BY NULLIF(CAST("{{COLUMN}}" AS text), '') ASC NULLS FIRST
            */}).replace(/\{\{WHERE\}\}/gi,strWhere).replace(/\{\{COLUMN\}\}/gi,strColumn).replace(/\{\{SCHEMA\}\}/gi,strSchema).replace(/\{\{OBJECT\}\}/gi,strObject));var bolUncheckedFound=false;var arrData;var jsnFilter;arrData=[''];jsnFilter=(element.internalData.columnListFilters[element.internalData.columnNames.indexOf(strColumn)]);GS.requestArbitrarySelectFromSocket(socket,'('+strSrc+') unique_list','','','','',function(data,error){var i;var tableElement;var index;var strValue;var strMessage=data.strMessage;var strRecord;var arrRecord=[];if(!error&&data.strMessage==='TRANSACTION COMPLETED'){if(bolUncheckedFound){arrData[0]='0\t\tSelect All';}else{arrData[0]='-1\t\tSelect All';}
uniqueFilterElement.removeAttribute('hidden');valueListElement.addEventListener('initialized',function(){tableElement=valueListElement.children[0];tableElement.internalData.records=arrData;tableElement.internalData.columnNames=['active','count','value'];tableElement.internalData.columnTypes=['text','text','text'];tableElement.internalData.columnFilterStatuses=['on','on','on'];tableElement.internalData.columnFilters=[[],[],[]];tableElement.internalData.columnListFilters=[{},{},{}];tableElement.internalData.columnOrders=['neutral','neutral','neutral'];tableElement.internalDisplay.columnWidths=[27,(valueListElement.clientWidth-80),49];tableElement.refresh();});valueListElement.innerHTML=ml(function(){/*
    <gs-table style="width: 100%; height: 100%;"
                no-record-selector
                no-x-overscroll
                no-y-overscroll
                copy-header="always">
        <template for="data-record">
            <gs-cell>
                <label>
                    <gs-checkbox column="active" mini></gs-checkbox>
                </label>
            </gs-cell>
            <gs-cell>
                {{? row.value === 'Select All' || row.value === '(blanks)' }}
                    <span class="gs-table-text-grey">
                        {{! row.value }}
                    </span>
                {{??}}
                    <label>{{! row.value }}</label>
                {{?}}
            </gs-cell>
            <gs-cell>
                <center class="gs-table-text-grey">
                    {{! row.count }}
                </center>
            </gs-cell>
        </template>
        <template for="copy">
            <gs-cell header="Include?">{{? row.active==='-1' }}X{{?}}</gs-cell>
            <gs-cell header="Value">{{! row.value }} </gs-cell>
            <gs-cell header="Occurences">{{! row.count }}</gs-cell>
        </template>
    </gs-table>
                    */});tableElement.addEventListener('before_update',function(event){var rec_i;var rec_len;var arrRecords;var replaceValue=function(strRecord,strValue){return(strValue+
strRecord.substring(strRecord.indexOf('\t')));};if(event.newData.columnName==='active'&&event.newData.recordNumber===0&&event.newData.newValue==='-1'){arrRecords=tableElement.internalData.records;rec_i=0;rec_len=arrRecords.length;while(rec_i<rec_len){arrRecords[rec_i]=(replaceValue(arrRecords[rec_i],'-1'));rec_i+=1;}}else if(event.newData.columnName==='active'&&event.newData.recordNumber===0&&event.newData.newValue==='0'){arrRecords=tableElement.internalData.records;rec_i=0;rec_len=arrRecords.length;while(rec_i<rec_len){arrRecords[rec_i]=(replaceValue(arrRecords[rec_i],'0'));rec_i+=1;}}else if(event.newData.columnName==='active'&&event.newData.recordNumber>0&&event.newData.newValue==='0'){tableElement.internalData.records[0]=(replaceValue(tableElement.internalData.records[0],'0'));}});}else if(!error){i=0;while(i<15){index=strMessage.indexOf('\n');strRecord=strMessage.substring(0,index);strMessage=strMessage.substring(index+1);if(strRecord!==''||strMessage!==''){arrRecord=strRecord.split('\t');strValue=arrRecord[1];if(!jsnFilter||!jsnFilter.type){arrData.push('-1\t'+strRecord);}else if(jsnFilter.type==='inclusion'&&jsnFilter.values.length===0){if(jsnFilter.blanks&&strValue==='(blanks)'){arrData.push('-1\t'+strRecord);}else if(jsnFilter.blanks===false&&strValue==='(blanks)'){arrData.push('0\t'+strRecord);bolUncheckedFound=true;}else{arrData.push('0\t'+strRecord);bolUncheckedFound=true;}}else if(jsnFilter.type==='exclusion'&&jsnFilter.values.length===0){if(jsnFilter.blanks&&strValue==='(blanks)'){arrData.push('-1\t'+strRecord);}else if(jsnFilter.blanks===false&&strValue==='(blanks)'){arrData.push('0\t'+strRecord);bolUncheckedFound=true;}else{arrData.push('-1\t'+strRecord);}}else if(jsnFilter&&jsnFilter.type==='inclusion'){if(jsnFilter.blanks&&strValue==='(blanks)'){arrData.push('-1\t'+strRecord);}else if(jsnFilter.blanks===false&&strValue==='(blanks)'){arrData.push('0\t'+strRecord);bolUncheckedFound=true;}else if(jsnFilter.values.indexOf(strValue)!==-1){arrData.push('-1\t'+strRecord);}else{arrData.push('0\t'+strRecord);bolUncheckedFound=true;}}else if(jsnFilter&&jsnFilter.type==='exclusion'){if(jsnFilter.blanks&&strValue==='(blanks)'){arrData.push('-1\t'+strRecord);}else if(jsnFilter.blanks===false&&strValue==='(blanks)'){arrData.push('0\t'+strRecord);bolUncheckedFound=true;}else if(jsnFilter.values.indexOf(strValue)!==-1){arrData.push('0\t'+strRecord);bolUncheckedFound=true;}else{arrData.push('-1\t'+strRecord);}}}else{break;}
i+=1;}}});}
function internalSELECTcolumnUnique(){}
function dataSELECTcolumnUnique(element,uniqueFilterElement,valueListElement,strColumn){if(element.hasAttribute("src")){databaseWSSELECTcolumnUnique(element,uniqueFilterElement,valueListElement,strColumn);}else{internalSELECTcolumnUnique(element,uniqueFilterElement,valueListElement,strColumn);}}
function dataSELECT(element){if(element.hasAttribute("src")){databaseWSSELECT(element);}else{internalSELECT(element);}}
function dataINSERT(element,strMode,jsnInsert){if(element.hasAttribute("src")){databaseWSINSERT(element,strMode,jsnInsert);}else{internalINSERT(element,strMode,jsnInsert);}}
function dataUPDATE(element,strMode,jsnUpdate){if(!element.hasAttribute('no-update')){element.internalDisplay.focus.selectionRange=null;if(element.internalDisplay.focus.latest&&(document.activeElement.nodeName==='INPUT'||document.activeElement.nodeName==='TEXTAREA')){element.internalDisplay.focus.selectionRange=(GS.getInputSelection(document.activeElement));}
if(element.hasAttribute("src")){databaseWSUPDATE(element,strMode,jsnUpdate);}else{internalUPDATE(element,strMode,jsnUpdate);}}}
function dataDELETE(element,jsnDeleteData){if(element.hasAttribute("src")){databaseWSDELETE(element,jsnDeleteData);}else{internalDELETE(element,jsnDeleteData);}}
function getSelectedRecordIndexes(element){var arrRows=element.internalSelection.rows.slice(0);if(arrRows[0]==='header'){arrRows.shift();}
if(arrRows[arrRows.length-1]==='insert'){arrRows.pop();}
return arrRows;}
function focusIntoCell(element,record,column,iterationNumber){var jsnViewportRange;var cellElement;var focusElement;var strTag;var strValue;if(iterationNumber===undefined){iterationNumber=0;}
jsnViewportRange=element.internalDisplay.currentRange;if((!jsnViewportRange.insertRecord&&(record<jsnViewportRange.fromRecord||record>jsnViewportRange.toRecord||column<jsnViewportRange.fromColumn||column>jsnViewportRange.toColumn))||(jsnViewportRange.insertRecord&&(column<jsnViewportRange.fromColumn||column>jsnViewportRange.toColumn))){console.warn('GS-TABLE Warning: "focusIntoCell" was called to'+' focus into a cell that is not rendered. Stopping'+' execution of "focusIntoCell".');return;}
if(record==='insert'&&jsnViewportRange.insertRecord){cellElement=xtag.query(element.elems.dataViewport,'gs-cell'+'.table-insert'+'[data-col-number="'+column+'"]')[0];}else{cellElement=xtag.query(element.elems.dataViewport,'gs-cell'+'.table-cell'+'[data-row-number="'+record+'"]'+'[data-col-number="'+column+'"]')[0];}
if(!cellElement){if(iterationNumber<1){console.warn('GS-TABLE Warning: "focusIntoCell" was called to'+' focus into a cell that is not rendered. Stopping'+' execution of "focusIntoCell".');element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);focusIntoCell(element,record,column,(iterationNumber+1));}else{console.warn('GS-TABLE Warning: infinite loop detected'+' in "focusIntoCell". Stopping execution of'+' "focusIntoCell".');}
return;}
focusElement=xtag.query(cellElement,'input, textarea, select, [tabindex]')[0];if(focusElement){focusElement.focus();strTag=focusElement.nodeName;strValue=(focusElement.value||'');if((strTag==='INPUT'||strTag==='TEXTAREA')&&strValue.length>0){GS.setInputSelection(focusElement,0,strValue.length);}}}
function scrollCellIntoView(element,cellRecord,cellColumn,strStickMode){var i;var len;var columnBorderWidth;var recordBorderHeight;var arrColumnWidths;var arrRecordHeights;var intCellWidth;var intCellHeight;var intCellTop;var intCellBottom;var intCellLeft;var intCellRight;var intViewportWidth;var intViewportHeight;var intViewportTop;var intViewportBottom;var intViewportLeft;var intViewportRight;var bolScrollMoved;var bolStickTop;var bolStickLeft;var bolStickBottom;var bolStickRight;columnBorderWidth=element.internalDisplay.columnBorderWidth;recordBorderHeight=element.internalDisplay.recordBorderHeight;arrColumnWidths=element.internalDisplay.columnWidths;arrRecordHeights=element.internalDisplay.recordHeights;if(strStickMode){bolStickTop=(strStickMode.indexOf('top')!==-1);bolStickLeft=(strStickMode.indexOf('left')!==-1);bolStickBottom=(strStickMode.indexOf('bottom')!==-1);bolStickRight=(strStickMode.indexOf('right')!==-1);if(bolStickTop&&bolStickBottom){console.warn('GS-TABLE Warning: Contradictory parameter sent'+' to scrollCellIntoView, you can\'t scroll a'+' cell to the top and the bottom of the viewport at'+' the same time. Stick to bottom will be cancelled.'+' Parameter Text: "'+strStickMode+'"');bolStickBottom=false;}
if(bolStickLeft&&bolStickRight){console.warn('GS-TABLE Warning: Contradictory parameter sent'+' to scrollCellIntoView, you can\'t scroll a'+' cell to the left and the right of the viewport at'+' the same time. Stick to right will be cancelled.'+' Parameter Text: "'+strStickMode+'"');bolStickRight=false;}}
if(cellRecord==='header'){intCellHeight=element.internalDisplay.headerHeight;}else if(cellRecord==='insert'){intCellHeight=element.internalDisplay.insertRecordHeight;}else{intCellHeight=arrRecordHeights[cellRecord];}
intCellTop=0;if(cellRecord==='header'){intCellTop=0;}else if(cellRecord==='insert'){i=0;len=arrRecordHeights.length;while(i<len){intCellTop+=arrRecordHeights[i];intCellTop+=recordBorderHeight;i+=1;}}else{i=0;len=cellRecord;while(i<len){intCellTop+=arrRecordHeights[i];intCellTop+=recordBorderHeight;i+=1;}}
if(cellColumn==='selector'){intCellWidth=element.internalDisplay.recordSelectorWidth;}else{intCellWidth=arrColumnWidths[cellColumn];}
intCellLeft=0;if(cellColumn!=='selector'){i=0;len=cellColumn;while(i<len){intCellLeft+=arrColumnWidths[i];intCellLeft+=columnBorderWidth;i+=1;}}
intCellBottom=(intCellTop+intCellHeight);intCellRight=(intCellLeft+intCellWidth);intViewportWidth=(element.elems.dataViewport.clientWidth-(element.internalScrollOffsets.left+
element.internalScrollOffsets.right));intViewportHeight=(element.elems.dataViewport.clientHeight-(element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom));intViewportTop=(element.internalScroll.top);intViewportLeft=(element.internalScroll.left);intViewportBottom=(intViewportTop+intViewportHeight);intViewportRight=(intViewportLeft+intViewportWidth);bolScrollMoved=false;if(intCellTop<intViewportTop||bolStickTop){element.internalScroll.top=intCellTop;bolScrollMoved=true;}else if(intCellBottom>intViewportBottom||bolStickBottom){element.internalScroll.top=(intCellBottom-intViewportHeight);bolScrollMoved=true;}
if(intCellLeft<intViewportLeft||bolStickLeft){element.internalScroll.left=intCellLeft;bolScrollMoved=true;}else if(intCellRight>intViewportRight||bolStickRight){element.internalScroll.left=(intCellRight-intViewportWidth);bolScrollMoved=true;}
if(element.internalScroll.left>element.internalScroll.maxLeft){element.internalScroll.left=element.internalScroll.maxLeft;}else if(element.internalScroll.left<0){element.internalScroll.left=0;}
if(element.internalScroll.top>element.internalScroll.maxTop){element.internalScroll.top=element.internalScroll.maxTop;}else if(element.internalScroll.top<0){element.internalScroll.top=0;}
if(bolScrollMoved){renderScrollLocation(element);}else{renderSelection(element);}}
function scrollSelectionIntoView(element,strStickMode){var jsnRange;var cellColumn;var cellRecord;jsnRange=element.internalSelection.ranges[element.internalSelection.ranges.length-1];if(!jsnRange){console.warn('GS-TABLE Warning: scrollSelectionIntoView was '+'called when there was no selection to scroll into view.');return;}
cellRecord=(jsnRange.end.row);cellColumn=(jsnRange.end.column);scrollCellIntoView(element,cellRecord,cellColumn,strStickMode);}
function focusIntoSelectedCell(element){var jsnRange;var bolReWriteSelection;jsnRange=element.internalSelection.ranges[element.internalSelection.ranges.length-1];if(element.internalSelection.ranges.length>1){console.warn('GS-TABLE Warning: "focusIntoSelectedCell" called'+' when multiple selections were present. Now clearing all'+' selections and creating new selection at last'+' selection\'s endpoint.');bolReWriteSelection=true;}else if(jsnRange&&(jsnRange.start.column!==jsnRange.end.column||jsnRange.start.row!==jsnRange.end.row)){console.warn('GS-TABLE Warning: "focusIntoSelectedCell" called'+' when the selection contained multiple cells. Now'+' clearing all selections and creating new selection at'+' last selection\'s endpoint.');bolReWriteSelection=true;}else if(!jsnRange){console.warn('GS-TABLE Warning: "focusIntoSelectedCell" called'+' when there was no selection to focus into. Stopping'+' execution of "focusIntoSelectedCell".');focusHiddenControl(element);return;}
if(bolReWriteSelection){element.internalSelection.ranges=[{"start":{"row":jsnRange.end.row,"column":jsnRange.end.column},"end":{"row":jsnRange.end.row,"column":jsnRange.end.column},"negator":false}];jsnRange=element.internalSelection.ranges[0];renderSelection(element);}
focusIntoCell(element,jsnRange.end.row,jsnRange.end.column);}
function deleteSelectedRecords(element){if(element.internalSelection.ranges.length===0){GS.msgbox('No Records To Delete','<center>'+'Please choose a record to delete.'+'</center>',['Ok']);}else if(!element.hasAttribute('no-delete')){dataDELETE(element,{"recordIndexes":getSelectedRecordIndexes(element),"deleteConfirmed":false});}}
function dragScrollEnd(element){if(element.internalTimerIDs.scrollIntervalID!==null){clearInterval(element.internalTimerIDs.scrollIntervalID);element.internalTimerIDs.scrollIntervalID=null;}
element.internalScroll.dragScrollingDirection=null;element.internalScroll.dragScrolling=false;}
function dragScrollStart(element,callback,strScrollDirection){var jsnDirection;var bolScrollTop;var bolScrollLeft;var bolScrollBottom;var bolScrollRight;element.internalScroll.dragScrolling=true;jsnDirection=directionStringBreakdown(strScrollDirection);bolScrollTop=jsnDirection.bolTop;bolScrollLeft=jsnDirection.bolLeft;bolScrollBottom=jsnDirection.bolBottom;bolScrollRight=jsnDirection.bolRight;strScrollDirection=jsnDirection.resolvedString;element.internalScroll.dragScrollingDirection=(strScrollDirection);element.internalTimerIDs.scrollIntervalID=setInterval(function(){var newScrollingDirection;var intLeftScrollAmount;var intLeftScroll;var intLeftMax;var intTopScrollAmount;var intTopScroll;var intTopMax;newScrollingDirection=(element.internalScroll.dragScrollingDirection);if(newScrollingDirection!==strScrollDirection){jsnDirection=directionStringBreakdown(newScrollingDirection);bolScrollTop=jsnDirection.bolTop;bolScrollLeft=jsnDirection.bolLeft;bolScrollBottom=jsnDirection.bolBottom;bolScrollRight=jsnDirection.bolRight;strScrollDirection=jsnDirection.resolvedString;element.internalScroll.dragScrollingDirection=(strScrollDirection);}
if(bolScrollLeft||bolScrollRight){intLeftScrollAmount=10;}
if(bolScrollTop||bolScrollBottom){intTopScrollAmount=10;}
if(bolScrollLeft||bolScrollRight){intLeftScroll=(element.internalScroll.left);intLeftMax=(element.internalScroll.maxLeft);}
if(bolScrollTop||bolScrollBottom){intTopScroll=(element.internalScroll.top);intTopMax=(element.internalScroll.maxTop);}
if((!bolScrollTop||intLeftScroll===0)&&(!bolScrollLeft||intLeftScroll===0)&&(!bolScrollBottom||intLeftScroll===intTopMax)&&(!bolScrollRight||intLeftScroll===intLeftMax)){dragScrollEnd(element);}else if(!bolScrollTop&&!bolScrollLeft&&!bolScrollBottom&&!bolScrollRight){dragScrollEnd(element);}else{if(bolScrollTop||bolScrollBottom){if(bolScrollTop){intTopScroll-=intTopScrollAmount;}else if(bolScrollBottom){intTopScroll+=intTopScrollAmount;}
if(intTopScroll>intTopMax){intTopScroll=intTopMax;}
if(intTopScroll<0){intTopScroll=0;}
element.internalScroll.top=intTopScroll;}
if(bolScrollLeft||bolScrollRight){if(bolScrollLeft){intLeftScroll-=intLeftScrollAmount;}else if(bolScrollRight){intLeftScroll+=intLeftScrollAmount;}
if(intLeftScroll>intLeftMax){intLeftScroll=intLeftMax;}
if(intLeftScroll<0){intLeftScroll=0;}
element.internalScroll.left=intLeftScroll;}
renderScrollLocation(element);if(callback){callback();}}},50);}
function insertPasteString(element,arrPaste,intMaxPasteColumn){var templateElement;var strSelection;var strOldRecord;var strNewRecord;var strCell;var strChar;var intStart;var intEnd;var intMinPasteColumn;var intPastedColumn;var intColumn;var arrColumnElements;var arrColumns;var i;var len;var rec_i;var rec_len;strSelection=element.internalSelection.resolvedSelection[element.internalSelection.resolvedSelection.length-1];if(element.internalDisplay.recordSelectorVisible){strSelection=strSelection.substring(1);}
intStart=strSelection.indexOf('F');intEnd=strSelection.lastIndexOf('F');if((intEnd-intStart)<intMaxPasteColumn){intMaxPasteColumn=(intEnd-intStart);}
intEnd=intStart+intMaxPasteColumn;if(element.internalSelection.columns[0]==='selector'){intMinPasteColumn=1;}else{intMinPasteColumn=0;}
i=0;len=arrPaste.length;while(i<len){strOldRecord=arrPaste[i];intColumn=0;intPastedColumn=0;strNewRecord='';strCell='';rec_i=0;rec_len=strOldRecord.length;while(rec_i<rec_len){strChar=strOldRecord[rec_i];if(strChar!=='\t'){strCell+=strChar;}
if(strChar==='\t'||rec_i===(rec_len-1)){if(intColumn>=intMinPasteColumn){if(intPastedColumn>0){strNewRecord+='\t';}
if(strSelection[intPastedColumn+intStart]==='F'){strNewRecord+=strCell;}else{strNewRecord+='\\N';}
intPastedColumn+=1;if(intPastedColumn>intMaxPasteColumn){break;}}
strCell='';intColumn+=1;}
if(intColumn>((intEnd-intStart)+intMinPasteColumn)){break;}
rec_i+=1;}
arrPaste[i]=strNewRecord;i+=1;}
templateElement=document.createElement('template');templateElement.innerHTML=templateExtractVisibleCellRange(element,element.internalTemplates.insertRecord,intStart,(intEnd+1));arrColumnElements=xtag.query(templateElement.content,'gs-cell [column]');arrColumns=[];i=0;len=arrColumnElements.length;while(i<len){arrColumns.push(arrColumnElements[i].getAttribute('column'));i+=1;}
dataINSERT(element,'multi-record',{"data":{"values":arrPaste,"columns":arrColumns,"addin":getInsertAddin(element)},"insertConfirmed":false});}
function updatePasteString(element,arrPaste,intMaxPasteColumn){var arrRecords;var arrColumns;var intStartColumn;var intEndColumn;var arrSelection;var strSelection;var arrUpdateIndexes=[];var arrTranslated=[];var paste_i;var update_i;var i;var len;var rec_i;var rec_len;var strOldRecord;var strNewRecord;var intColumn;var intMinPasteColumn;var strCell;var strChar;var intPasteColumn;var intColumnOffset;var templateElement;var arrCellElements;var arrColumnElements;var arrColumnNames;var arrSelectedStates=['B','D','F','H','J','L'];arrSelection=element.internalSelection.resolvedSelection;if(element.internalDisplay.headerVisible){arrSelection.shift();}
if(element.internalDisplay.insertRecordVisible){arrSelection.pop();}
arrRecords=element.internalSelection.rows;if(arrRecords[0]==='header'){arrRecords.shift();}
if(arrRecords[arrRecords.length-1]==='insert'){arrRecords.pop();}
arrColumns=element.internalSelection.columns;if(arrColumns[0]==='selector'){arrColumns.shift();}
intStartColumn=arrColumns[0];intEndColumn=arrColumns[arrColumns.length-1];if((intEndColumn-intStartColumn)<intMaxPasteColumn){intMaxPasteColumn=(intEndColumn-intStartColumn);}
intEndColumn=(intStartColumn+intMaxPasteColumn);intColumnOffset=0;if(element.internalDisplay.recordSelectorVisible){intColumnOffset=1;}
templateElement=document.createElement('template');templateElement.innerHTML=element.internalTemplates.insertRecord;arrCellElements=xtag.query(templateElement.content,'gs-cell');arrColumnNames=[];i=0;len=arrColumns.length;while(i<len){arrColumnElements=xtag.query(arrCellElements[arrColumns[i]],'[column]');if(arrColumnElements&&arrColumnElements.length>0){arrColumnNames.push(arrColumnElements[0].getAttribute('column'));if(arrColumnNames.length===(intMaxPasteColumn+1)){break;}}else{arrColumns.splice(i,1);i-=1;len-=1;}
i+=1;}
paste_i=0;update_i=0;len=arrPaste.length;if(len>arrRecords.length){len=arrRecords.length;}
if(element.internalSelection.rows[0]==='header'){paste_i+=1;}
if(element.internalSelection.columns[0]==='selector'){intMinPasteColumn=1;}else{intMinPasteColumn=0;}
while(update_i<len){strOldRecord=arrPaste[paste_i];strSelection=arrSelection[arrRecords[update_i]];intColumn=0;strNewRecord='';strCell='';intPasteColumn=0;rec_i=0;rec_len=strOldRecord.length;while(rec_i<rec_len){strChar=strOldRecord[rec_i];if(strChar!=='\t'){strCell+=strChar;}
if(strChar==='\t'||rec_i===(rec_len-1)){if(intColumn>=intMinPasteColumn){if(intPasteColumn>0){strNewRecord+='\t';}
if(arrSelectedStates.indexOf(strSelection[(arrColumns[intPasteColumn]+
intColumnOffset)])>-1){strNewRecord+=strCell;}else{strNewRecord+=getCell(element,arrColumnNames[intPasteColumn],arrRecords[update_i],false);}
intPasteColumn+=1;if(intPasteColumn>intMaxPasteColumn){break;}}
strCell='';intColumn+=1;}
if(intColumn>((intEndColumn-intStartColumn)+intMinPasteColumn)){break;}
rec_i+=1;}
arrUpdateIndexes.push(arrRecords[update_i]);arrTranslated.push(strNewRecord);paste_i+=1;update_i+=1;}
dataUPDATE(element,'cell-range',{"data":{"columns":arrColumnNames,"records":arrUpdateIndexes,"values":arrTranslated},"updateConfirmed":false});}
function usePasteString(element,strUnnormalizedPasteString){var elementMaker=document.createElement('template');var tableElement;var tbodyElement;var arrRecord;var arrUpdateRecord;var arrInsertRecord;var arrCell;var strRecord;var strCell;var intMaxUpdateRecord;var arrSelectedRows;var rec_i;var rec_len;var col_i;var col_len;addLoader(element,'paste-parse','Parsing Pasted Data...');if(strUnnormalizedPasteString.indexOf('<'+'table')===-1&&strUnnormalizedPasteString.indexOf('<'+'tr')===-1){strUnnormalizedPasteString=delimitedStringToHTML(element,strUnnormalizedPasteString,'\t','\n','"',GS.decodeFromTabDelimited);}
elementMaker.innerHTML=strUnnormalizedPasteString;tableElement=xtag.query(elementMaker.content,'table')[0];tbodyElement=xtag.queryChildren(tableElement,'tbody')[0];if(tbodyElement){arrRecord=xtag.queryChildren(tbodyElement,'tr');}else{arrRecord=xtag.queryChildren(tableElement,'tr');}
arrSelectedRows=element.internalSelection.rows;intMaxUpdateRecord=arrSelectedRows.length-1;if(arrSelectedRows[intMaxUpdateRecord]==='insert'){intMaxUpdateRecord-=1;}
if(arrSelectedRows[0]==='header'){intMaxUpdateRecord-=1;}
arrUpdateRecord=[];arrInsertRecord=[];rec_i=0;rec_len=arrRecord.length;col_len=arrRecord[0].children.length;while(rec_i<rec_len){strRecord='';arrCell=xtag.toArray(arrRecord[rec_i].children);col_i=0;while(col_i<col_len){strRecord+=(strRecord?'\t':'');if(arrCell[col_i]){strCell=getPlainText(arrCell[col_i],true);if(strCell&&strCell.trim()){strRecord+=GS.encodeForTabDelimited(strCell);}else{strRecord+='\\N';}}else{strRecord+='\\N';}
col_i+=1;}
if(rec_i<=intMaxUpdateRecord){arrUpdateRecord.push(strRecord);}else{arrInsertRecord.push(strRecord);}
rec_i+=1;}
if(arrInsertRecord.length>0&&element.internalDisplay.insertRecordVisible&&arrSelectedRows[arrSelectedRows.length-1]==='insert'){insertPasteString(element,arrInsertRecord,(col_len-1));}
if(arrUpdateRecord.length>0){updatePasteString(element,arrUpdateRecord,(col_len-1));}
removeLoader(element,'paste-parse','Paste Data Parsed');}
function usePasteEvent(element,event){var clipboardData;var pastePlain;var pasteHTML;if(element.internalSelection.columns.length===0&&element.internalSelection.rows.length===0){addLoader(element,'paste-fail','Can\'t paste, nothing selected...');removeLoader(element,'paste-fail','Can\'t paste, nothing selected...');}else{addLoader(element,'paste-extract','Extracting Pasted Data...');clipboardData=(event.clipboardData||window.clipboardData);if(window.clipboardData){pastePlain=clipboardData.getData('Text');}else{pasteHTML=clipboardData.getData('text/html');pastePlain=clipboardData.getData('Text');}
removeLoader(element,'paste-extract','Paste Data Extracted');usePasteString(element,(pasteHTML||pastePlain));}}
function openInsertDialog(element){var strTemplate;var templateElement;var beforeEvent;strTemplate=element.internalTemplates.insertDialog;templateElement=document.createElement("template");templateElement.innerHTML=ml(function(){/*
            <gs-page gs-dynamic>
                <gs-header>
                    <center><h3>Create</h3></center>
                </gs-header>
                <gs-body padded>
                    {{HTML}}
                </gs-body>
                <gs-footer>
                    <gs-grid gutter>
                        <gs-block>
                            <gs-button dialogclose>Cancel</gs-button>
                        </gs-block>
                        <gs-block>
                            <gs-button dialogclose
                                       listen-for-return
                                       bg-primary>Create</gs-button>
                        </gs-block>
                    </gs-grid>
                </gs-footer>
            </gs-page>
        */}).replace("{{HTML}}",strTemplate);beforeEvent=GS.triggerEvent(element,"before_insert_dialog_open");if(beforeEvent.defaultPrevented){return;}
GS.openDialog(templateElement,function(){var dialog=this;var arrElements;var element_i;var element_len;var strColumn;var strValue;arrElements=xtag.query(dialog,'[column]');element_i=0;element_len=arrElements.length;while(element_i<element_len){strColumn=arrElements[element_i].getAttribute('column');strValue=element.internalData.insertRecord[strColumn];if(strValue){arrElements[element_i].value=strValue;}
element_i+=1;}
GS.triggerEvent(element,"after_insert_dialog_open",{"relatedTarget":dialog});},function(ignore,strAnswer){var dialog=this;var arrElements;var element_i;var element_len;var strColumn;var strValue;arrElements=xtag.query(dialog,'[column]');element_i=0;element_len=arrElements.length;while(element_i<element_len){strColumn=arrElements[element_i].getAttribute('column');strValue=arrElements[element_i].value;if(strValue){element.internalData.insertRecord[strColumn]=strValue;if(element.internalData.insertRecordRetainedColumns.indexOf(strColumn)===-1){element.internalData.insertRecordRetainedColumns.push(strColumn);}}else if(!strValue&&element.internalData.insertRecordRetainedColumns.indexOf(strColumn)>-1){element.internalData.insertRecord[strColumn]=undefined;element.internalData.insertRecordRetainedColumns.splice(element.internalData.insertRecordRetainedColumns.indexOf(strColumn));}
element_i+=1;}
if(strAnswer!=='Cancel'||strAnswer==='Create'){dataINSERT(element,"single-record",{"data":{"values":(element.internalData.insertRecord),"columns":(element.internalData.insertRecordRetainedColumns),"addin":getInsertAddin(element)},"insertConfirmed":true});element.internalData.insertRecord={};element.internalData.insertRecordRetainedColumns=[];}else{element.internalDisplay.fullRenderRequired=true;renderLocation(element);}});}
function openColumnHideDialog(element,targetElement,callback){var templateElement;var afterOpenCallback;var beforeCloseCallback;templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','15em');templateElement.setAttribute('no-background','');templateElement.innerHTML=ml(function(){/*
            <gs-page gs-dynamic class="gs-table-contextmenu">
                <gs-header><h4>Unhide Columns</h4></gs-header>
                <gs-body class="gs-table-column-checklist-container" padded>
                </gs-body>
                <gs-footer>
                    <gs-grid gutter>
                        <gs-block>
                            <gs-button dialogclose>Cancel</gs-button>
                        </gs-block>
                        <gs-block>
                            <gs-button dialogclose bg-primary>Apply</gs-button>
                        </gs-block>
                    </gs-grid>
                </gs-footer>
            </gs-page>
        */});afterOpenCallback=function(){var dialog=this;var containerElement;var i;var len;var strHTML;var bolVisible;var arrColumnNames;var arrColumnWidths;arrColumnWidths=element.internalDisplay.columnWidths;arrColumnNames=element.internalDisplay.columnPlainTextNames;containerElement=xtag.query(dialog,'.gs-table-column-checklist-container')[0];strHTML='';i=0;len=arrColumnWidths.length;while(i<len){bolVisible=(arrColumnWidths[i]>0);strHTML+=('<gs-checkbox '+'        data-col-number="'+i+'"'+'        value="'+bolVisible.toString()+'">&nbsp;'+
encodeHTML(arrColumnNames[i])+'</gs-checkbox>');i+=1;}
containerElement.innerHTML=strHTML;dialog.classList.add('gs-table-contextmenu');};beforeCloseCallback=function(ignore,strAnswer){var dialog=this;var arrCheckbox;var arrColumnWidths;var arrDefaultColumnWidths;var i;var len;var colIndex;if(strAnswer!=='Cancel'){arrColumnWidths=(element.internalDisplay.columnWidths);arrDefaultColumnWidths=(element.internalDisplay.defaultColumnWidths);arrCheckbox=xtag.query(dialog,'gs-checkbox');i=0;len=arrCheckbox.length;while(i<len){colIndex=parseInt(arrCheckbox[i].getAttribute('data-col-number'),10);if(arrColumnWidths[colIndex]>0&&arrCheckbox[i].value==='false'){arrColumnWidths[colIndex]=0;}else if(arrColumnWidths[colIndex]===0&&arrCheckbox[i].value==='true'){arrColumnWidths[colIndex]=(arrDefaultColumnWidths[colIndex]);}
i+=1;}
element.internalDisplay.fullRenderRequired=true;renderLocation(element);}
if(callback){callback(strAnswer);}};if(targetElement){GS.openDialogToElement(targetElement,templateElement,'right',afterOpenCallback,beforeCloseCallback);}else{GS.openDialog(templateElement,afterOpenCallback,beforeCloseCallback);}}
function openDataSettingsDialog(element,buttonElement){var templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','20em');templateElement.setAttribute('no-background','');templateElement.setAttribute('data-overlay-close','true');templateElement.innerHTML=ml(function(){/*
<gs-page class="gs-table-contextmenu">
    <gs-body class="gs-table-contextmenu" padded>
        <div class="context-menu-header">Show Rows:</div>
<table>
    <tbody>
        <tr>
            <td>From:</td>
            <td><gs-number class="pref-limit-from" mini></gs-number></td>
        </tr>
        <tr>
            <td>To:</td>
            <td><gs-number class="pref-limit-to" mini></gs-number></td>
        </tr>
    </tbody>
</table>
        <hr />
        <gs-grid gutter>
            <gs-block>
                <gs-button dialogclose>Cancel</gs-button>
            </gs-block>
            <gs-block>
                <gs-button dialogclose bg-primary>Apply</gs-button>
            </gs-block>
        </gs-grid>
    </gs-body>
</gs-page>
            */}).replace(/\{\{RETURN\}\}/gi,'\n').replace(/\{\{TAB\}\}/gi,'\t');var limitFromControl;var limitToControl;GS.openDialogToElement(buttonElement,templateElement,'down',function(){var dialog=this;var intLimit;var intOffset;dialog.classList.add('gs-table-contextmenu');limitFromControl=xtag.query(dialog,'.pref-limit-from')[0];limitToControl=xtag.query(dialog,'.pref-limit-to')[0];intLimit=parseInt(element.getAttribute('limit'),10);intOffset=parseInt((element.getAttribute('offset')||'0'),10);limitFromControl.value=(intOffset+1);limitToControl.value=((intLimit+intOffset)||element.internalData.records.length);},function(ignore,strAnswer){var intLimitFrom;var intLimitTo;var intLimit;var strOldLimit;var strOldOffset;if(strAnswer==='Apply'){intLimitFrom=parseInt((limitFromControl.value||'0'),10)-1;intLimitTo=parseInt((limitToControl.value||'0'),10);intLimit=(intLimitTo-intLimitFrom);strOldLimit=element.getAttribute('limit');strOldOffset=element.getAttribute('offset');if(!isNaN(intLimit)){element.setAttribute('limit',intLimit);}else{element.removeAttribute('limit');}
if(!isNaN(intLimitFrom)){element.setAttribute('offset',intLimitFrom);}else{element.removeAttribute('offset');}
if(element.getAttribute('limit')!==strOldLimit&&element.getAttribute('offset')!==strOldOffset){dataSELECT(element);}}});}
function openClipboardSettingsDialog(element,buttonElement){var templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','20em');templateElement.setAttribute('no-background','');templateElement.setAttribute('data-overlay-close','true');templateElement.innerHTML=ml(function(){/*
<gs-page class="gs-table-contextmenu">
    <gs-body class="gs-table-contextmenu" padded>
        <div class="context-menu-header">Paste Format:</div>
        <table>
            <tbody>
<tr>
    <td>Headers?</td>
    <td>
        <gs-select class="pref-copy-headers" mini>
            <option value="always">Always</option>
            <option value="never">Never</option>
            <option value="selected">Only when selected</option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Row Numbers?</td>
    <td>
        <gs-select class="pref-copy-selectors" mini>
            <option value="always">Always</option>
            <option value="never">Never</option>
            <option value="selected">Only when selected</option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Quote Character:</td>
    <td>
        <gs-select class="pref-quote-char" mini>
            <option value="\">Backslash (\)</option>
            <option value="/">Forward Slash (/)</option>
            <option value="|">Pipe (|)</option>
            <option value="&quot;">Double Quote (&quot;)</option>
            <option value="'">Single Quote (')</option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Escape Character:</td>
    <td>
        <gs-select class="pref-escape-char" mini>
            <option value="\">Backslash (\)</option>
            <option value="/">Forward Slash (/)</option>
            <option value="|">Pipe (|)</option>
            <option value="&quot;">Double Quote (&quot;)</option>
            <option value="'">Single Quote (')</option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Quote?</td>
    <td>
        <gs-select class="pref-copy-quote" mini>
            <option value="always">Always</option>
            <option value="never">Never</option>
            <option value="strings">Only on strings</option>
            <option value="delimiter-in-content">
                Cell contains separator
            </option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Record Separator:</td>
    <td>
        <gs-select class="pref-delimiter-record" mini>
            <option value="{{RETURN}}">Newline</option>
            <option value="|">Vertical Bar (|)</option>
            <option value=",">Comma (,)</option>
            <option value="{{TAB}}">Tab</option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Cell Separator:</td>
    <td>
        <gs-select class="pref-delimiter-cell" mini>
            <option value="{{RETURN}}">Newline</option>
            <option value="|">Vertical Bar (|)</option>
            <option value=",">Comma (,)</option>
            <option value="{{TAB}}">Tab</option>
        </gs-select>
    </td>
</tr>
<tr>
    <td>Empty values:</td>
    <td>
        <gs-select class="pref-null-value" mini>
            <option value="">(nothing)</option>
            <option value="NULL">"NULL"</option>
            <option value="null">"null"</option>
            <option value="EMPTY">"EMPTY"</option>
            <option value="empty">"empty"</option>
            <option value="Nothing">"Nothing"</option>
        </gs-select>
    </td>
</tr>
            </tbody>
        </table>
        <hr />
        <gs-grid gutter>
            <gs-block>
                <gs-button dialogclose>Cancel</gs-button>
            </gs-block>
            <gs-block>
                <gs-button dialogclose bg-primary>Apply</gs-button>
            </gs-block>
        </gs-grid>
    </gs-body>
</gs-page>
            */}).replace(/\{\{RETURN\}\}/gi,'\n').replace(/\{\{TAB\}\}/gi,'\t');var copyHeadersControl;var copySelectorsControl;var copyQuoteCharControl;var copyEscapeCharControl;var copyQuoteWhenControl;var copyCellDelimiterControl;var copyRecordDelimiterControl;var copyNullControl;GS.openDialogToElement(buttonElement,templateElement,'down',function(){var dialog=this;var jsnCopy;dialog.classList.add('gs-table-contextmenu');jsnCopy=getCopyParameters(element);copyHeadersControl=xtag.query(dialog,'.pref-copy-headers')[0];copySelectorsControl=xtag.query(dialog,'.pref-copy-selectors')[0];copyQuoteCharControl=xtag.query(dialog,'.pref-quote-char')[0];copyEscapeCharControl=xtag.query(dialog,'.pref-escape-char')[0];copyQuoteWhenControl=xtag.query(dialog,'.pref-copy-quote')[0];copyCellDelimiterControl=xtag.query(dialog,'.pref-delimiter-cell')[0];copyRecordDelimiterControl=xtag.query(dialog,'.pref-delimiter-record')[0];copyNullControl=xtag.query(dialog,'.pref-null-value')[0];copyHeadersControl.value=jsnCopy.headerMode;copySelectorsControl.value=jsnCopy.selectorMode;copyQuoteCharControl.value=jsnCopy.quoteChar;copyEscapeCharControl.value=jsnCopy.escapeChar;copyQuoteWhenControl.value=jsnCopy.quoteMode;copyCellDelimiterControl.value=jsnCopy.cellDelimiter;copyRecordDelimiterControl.value=jsnCopy.recordDelimiter;copyNullControl.value=jsnCopy.nullString;},function(ignore,strAnswer){var strCopyHeaders;var strCopySelectors;var strQuoteChar;var strEscapeChar;var strQuoteMode;var strCellDelimiter;var strRecordDelimiter;var strNullValue;if(strAnswer==='Apply'){strCopyHeaders=copyHeadersControl.value;strCopySelectors=copySelectorsControl.value;strQuoteChar=copyQuoteCharControl.value;strEscapeChar=copyEscapeCharControl.value;strQuoteMode=copyQuoteWhenControl.value;strCellDelimiter=copyCellDelimiterControl.value;strRecordDelimiter=copyRecordDelimiterControl.value;strNullValue=copyNullControl.value;element.setAttribute('copy-header',strCopyHeaders);element.setAttribute('copy-selectors',strCopySelectors);element.setAttribute('copy-quote-char',strQuoteChar);element.setAttribute('copy-escape-char',strEscapeChar);element.setAttribute('copy-quote-when',strQuoteMode);element.setAttribute('copy-delimiter-cell',strCellDelimiter);element.setAttribute('copy-delimiter-record',strRecordDelimiter);element.setAttribute('copy-null-cell',strNullValue);}});}
function openSettingsDialog(element,buttonElement){var templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','15em');templateElement.setAttribute('no-background','');templateElement.setAttribute('data-overlay-close','true');templateElement.innerHTML=ml(function(){/*
<gs-page class="gs-table-contextmenu">
    <gs-body class="gs-table-contextmenu" padded>
        <gs-button dialogclose iconleft remove-bottom
            icon="database"
            class="button-column-width">Data Settings</gs-button>
        <gs-button dialogclose iconleft remove-top
            icon="clipboard"
            class="button-column-width">Clipboard Settings</gs-button>
    </gs-body>
</gs-page>
            */});GS.openDialogToElement(buttonElement,templateElement,'down',function(){var dialog=this;dialog.classList.add('gs-table-contextmenu');},function(ignore,strAnswer){if(strAnswer==='Data Settings'){openDataSettingsDialog(element,buttonElement);}else if(strAnswer==='Clipboard Settings'){openClipboardSettingsDialog(element,buttonElement);}});}
function unbindFocus(element){element.removeEventListener(evt.mousedown,element.internalEvents.focusMouseDown);element.elems.dataViewport.removeEventListener('focus',element.internalEvents.focusInViewport,true);window.removeEventListener('focus',element.internalEvents.focusTracker);element.removeEventListener('focus',element.internalEvents.focusTracker,true);window.removeEventListener('blur',element.internalEvents.focusTracker);window.removeEventListener('focusout',element.internalEvents.focusTracker);}
function bindFocus(element){element.internalEvents.focusMouseDown=function(event){var blurEventFunction;var target=event.target;var parentCell;parentCell=GS.findParentTag(target,'gs-cell');if(parentCell&&parentCell.nodeName==='GS-CELL'&&target.nodeName==='LABEL'&&parentCell.children.length===1&&parentCell.children[0].nodeName==='LABEL'){event.preventDefault();event.stopPropagation();}
if(!GS.isElementFocusable(target)&&!evt.touchDevice){focusHiddenControl(element);blurEventFunction=function(){focusHiddenControl(element);element.elems.hiddenFocusControl.removeEventListener('blur',blurEventFunction);};element.elems.hiddenFocusControl.addEventListener('blur',blurEventFunction);}};element.addEventListener(evt.mousedown,element.internalEvents.focusMouseDown);element.internalEvents.focusInViewport=function(){var active=document.activeElement;var parentCell=GS.findParentTag(active,'gs-cell');if(parentCell&&parentCell.nodeName==='GS-CELL'){if(!parentCell.hasAttribute('selected')){focusHiddenControl(element);}}};element.elems.dataViewport.addEventListener('focus',element.internalEvents.focusInViewport,true);element.internalEvents.focusTracker=function(){var active=document.activeElement;var parentTable=GS.findParentElement(active,element);var parentCell;var parentColumn;element.internalDisplay.focus.latest=false;if(parentTable&&parentTable.nodeName==='GS-TABLE'){element.classList.add('focus-in');element.classList.remove('focus-out');parentCell=GS.findParentTag(active,'gs-cell');parentColumn=GS.findParentElement(active,'[column]');if(!parentColumn||parentColumn.nodeName==='HTML'){parentColumn=active;}
if(parentCell){element.internalDisplay.focus.column=(parseInt((parentCell.getAttribute('data-col-number')||parentCell.getAttribute('data-col')||''),10));element.internalDisplay.focus.row=(parseInt((parentCell.getAttribute('data-row-number')||parentCell.getAttribute('data-row')||''),10));element.internalDisplay.focus.columnAttribute=(parentColumn.getAttribute('column'));element.internalDisplay.focus.nodeName=(active.nodeName);element.internalDisplay.focus.latest=true;}}else{element.classList.add('focus-out');element.classList.remove('focus-in');}};window.addEventListener('focus',element.internalEvents.focusTracker);element.addEventListener('focus',element.internalEvents.focusTracker,true);window.addEventListener('blur',element.internalEvents.focusTracker);window.addEventListener('focusout',element.internalEvents.focusTracker);}
function unbindScroll(element){if(evt.touchDevice){element.elems.dataViewport.removeEventListener(evt.mousedown,element.internalEvents.scrollDragStartFunction);}else{element.removeEventListener('wheel',element.internalEvents.scrollWheelFunction);}
window.removeEventListener('resize',element.internalEvents.scrollResizeFunction);element.elems.yScrollBar.removeEventListener('scroll',element.internalEvents.scrollBarYFunction);element.elems.xScrollBar.removeEventListener('scroll',element.internalEvents.scrollBarXFunction);}
function bindScroll(element){if(evt.touchDevice){var intStartMouseLeft;var intStartMouseTop;var intStartScrollLeft;var intStartScrollTop;var intCurrentMouseLeft;var intCurrentMouseTop;var intCurrentScrollLeft;var intCurrentScrollTop;var dragStarted;element.internalEvents.scrollDragStartFunction=function(event){var jsnMousePos=GS.mousePosition(event);dragStarted=false;intStartMouseLeft=jsnMousePos.left;intStartMouseTop=jsnMousePos.top;intStartScrollLeft=element.internalScroll.left;intStartScrollTop=element.internalScroll.top;event.preventDefault();event.stopPropagation();document.body.addEventListener(evt.mousemove,element.internalEvents.scrollDragMoveFunction);document.body.addEventListener(evt.mouseup,element.internalEvents.scrollDragEndFunction);};var leftPlay=10;var topPlay=10;element.internalEvents.scrollDragMoveFunction=function(event){var jsnMousePos;if(event.which===0&&!evt.touchDevice){event.preventDefault();event.stopPropagation();element.internalEvents.scrollDragEndFunction();}else{jsnMousePos=GS.mousePosition(event);intCurrentMouseLeft=jsnMousePos.left;intCurrentMouseTop=jsnMousePos.top;intCurrentScrollLeft=element.internalScroll.left;intCurrentScrollTop=element.internalScroll.top;if(dragStarted===false&&(Math.abs(intCurrentMouseLeft-intStartMouseLeft)>leftPlay||Math.abs(intCurrentMouseTop-intStartMouseTop)>topPlay)){dragStarted=true;}
if(dragStarted){event.preventDefault();event.stopPropagation();element.internalScroll.prevTop=element.internalScroll.top;element.internalScroll.prevLeft=element.internalScroll.left;element.internalScroll.left-=(intCurrentMouseLeft-intStartMouseLeft)+
(intCurrentScrollLeft-intStartScrollLeft);element.internalScroll.top-=(intCurrentMouseTop-intStartMouseTop)+
(intCurrentScrollTop-intStartScrollTop);element.internalScroll.top=Math.round(element.internalScroll.top);element.internalScroll.left=Math.round(element.internalScroll.left);element.internalScroll.top=Math.min(element.internalScroll.maxTop,element.internalScroll.top);element.internalScroll.left=Math.min(element.internalScroll.maxLeft,element.internalScroll.left);element.internalScroll.top=Math.max(0,element.internalScroll.top);element.internalScroll.left=Math.max(0,element.internalScroll.left);renderScrollLocation(element);}}};element.internalEvents.scrollDragEndFunction=function(){document.body.removeEventListener(evt.mousemove,element.internalEvents.scrollDragMoveFunction);document.body.removeEventListener(evt.mouseup,element.internalEvents.scrollDragEndFunction);};element.elems.dataViewport.addEventListener(evt.mousedown,element.internalEvents.scrollDragStartFunction);}else{element.internalEvents.scrollWheelFunction=function(event){var originalTop;var originalLeft;if((element.internalScroll.top===0&&event.deltaY<0)||(element.internalScroll.top===element.internalScroll.maxTop&&event.deltaY>0)||(element.internalScroll.left===0&&event.deltaX<0)||(element.internalScroll.left===element.internalScroll.maxLeft&&event.deltaX>0)){return;}
event.preventDefault();originalTop=element.internalScroll.top;originalLeft=element.internalScroll.left;element.internalScroll.top+=event.deltaY;element.internalScroll.left+=event.deltaX;element.internalScroll.prevTop=element.internalScroll.top;element.internalScroll.prevLeft=element.internalScroll.left;element.internalScroll.top=Math.round(element.internalScroll.top);element.internalScroll.left=Math.round(element.internalScroll.left);element.internalScroll.top=Math.min(element.internalScroll.maxTop,element.internalScroll.top);element.internalScroll.left=Math.min(element.internalScroll.maxLeft,element.internalScroll.left);element.internalScroll.top=Math.max(0,element.internalScroll.top);element.internalScroll.left=Math.max(0,element.internalScroll.left);if((element.internalScroll.top!==originalTop)||(element.internalScroll.left!==originalLeft)){renderScrollLocation(element);}};element.addEventListener('wheel',element.internalEvents.scrollWheelFunction);}
element.internalEvents.scrollResizeFunction=function(){renderScrollDimensions(element);};window.addEventListener('resize',element.internalEvents.scrollResizeFunction);element.internalEvents.scrollBarYFunction=function(){var intViewportHeight;var virtualScrollHeight;var trueScrollHeight;var trueScrollTop;if(!element.internalEventCancelled.scrollbarY){intViewportHeight=element.elems.dataViewport.clientHeight;virtualScrollHeight=element.internalScroll.maxTop;trueScrollHeight=element.elems.yScrollBar.scrollHeight;trueScrollHeight-=intViewportHeight;trueScrollTop=element.elems.yScrollBar.scrollTop;element.internalScroll.top=(trueScrollTop*(virtualScrollHeight/trueScrollHeight));element.internalScroll.top=(element.internalScroll.top||0);element.internalScroll.top=Math.round(element.internalScroll.top);element.internalScroll.top=Math.min(element.internalScroll.maxTop,element.internalScroll.top);element.internalScroll.top=Math.max(0,element.internalScroll.top);renderScrollLocation(element);}
element.internalEventCancelled.scrollbarY=false;};element.elems.yScrollBar.addEventListener('scroll',element.internalEvents.scrollBarYFunction);element.internalEvents.scrollBarXFunction=function(){var intViewportWidth;var virtualScrollWidth;var trueScrollWidth;var trueScrollLeft;if(!element.internalEventCancelled.scrollbarX){intViewportWidth=element.elems.dataViewport.clientWidth;virtualScrollWidth=element.internalScroll.maxLeft;trueScrollWidth=element.elems.xScrollBar.scrollWidth;trueScrollWidth-=intViewportWidth;trueScrollLeft=element.elems.xScrollBar.scrollLeft;element.internalScroll.left=(trueScrollLeft*(virtualScrollWidth/trueScrollWidth));element.internalScroll.left=(element.internalScroll.left||0);element.internalScroll.left=Math.round(element.internalScroll.left);element.internalScroll.left=Math.min(element.internalScroll.maxLeft,element.internalScroll.left);element.internalScroll.left=Math.max(0,element.internalScroll.left);renderScrollLocation(element);}
element.internalEventCancelled.scrollbarX=false;};element.elems.xScrollBar.addEventListener('scroll',element.internalEvents.scrollBarXFunction);}
function unbindSelection(element){if(evt.touchDevice){}else{element.elems.dataContainer.removeEventListener(evt.mousedown,element.internalEvents.selectDragStart);}}
function bindSelection(element){if(evt.touchDevice){}else{var selectionRangesCopy;var intCurrentSelectionIndex;element.internalEvents.selectDragStart=function(event){var cell;var classList;var intRow;var intColumn;var newRange;var jsnLocation;cell=GS.findParentElement(event.target,'gs-cell');if(cell.nodeName==='GS-CELL'&&element.internalResize.currentlyResizing===false&&element.internalReorder.currentlyReordering===false&&(event.which===1||!cell.hasAttribute('selected'))){element.internalSelection.currentlySelecting=true;newRange={"start":{"row":0,"column":0},"end":{"row":0,"column":0},"negator":false};selectionRangesCopy=JSON.parse(JSON.stringify(element.internalSelection.ranges));jsnLocation=getCellFromMouseEvent(element,event);newRange.start.row=jsnLocation.row;newRange.start.column=jsnLocation.column;newRange.end.row=newRange.start.row;newRange.end.column=newRange.start.column;if(!event.shiftKey&&!event.metaKey&&!event.ctrlKey){element.internalSelection.ranges=[newRange];intCurrentSelectionIndex=0;}else{if(event.shiftKey){intCurrentSelectionIndex=(element.internalSelection.ranges.length-1);if(element.internalSelection.ranges[intCurrentSelectionIndex].negator===false){element.internalSelection.ranges[intCurrentSelectionIndex].end.row=newRange.start.row;element.internalSelection.ranges[intCurrentSelectionIndex].end.column=newRange.start.column;}else{element.internalSelection.ranges.push(newRange);intCurrentSelectionIndex=(element.internalSelection.ranges.length-1);}}else if(event.metaKey||event.ctrlKey){if(cell.hasAttribute('selected')){newRange.negator=true;}
element.internalSelection.ranges.push(newRange);intCurrentSelectionIndex=(element.internalSelection.ranges.length-1);}}
renderSelection(element);if(event.which===1){document.body.addEventListener(evt.mousemove,element.internalEvents.selectDragMove);document.body.addEventListener(evt.mouseup,element.internalEvents.selectDragEnd);}else{element.internalEvents.selectDragEnd();}}};element.internalEvents.selectDragMove=function(event){var cell;var classList;var intRow;var intColumn;var intOldEndRow;var intOldEndColumn;var currentRange;getCellFromMouseEvent(element,event);if(event.which===0&&!evt.touchDevice){element.internalEvents.selectDragEnd();}else{var jsnLocation=getCellFromMouseEvent(element,event);currentRange=(element.internalSelection.ranges[intCurrentSelectionIndex]);intOldEndRow=currentRange.end.row;intOldEndColumn=currentRange.end.column;currentRange.end.row=jsnLocation.row;currentRange.end.column=jsnLocation.column;if(currentRange.start.row!==currentRange.end.row||currentRange.start.column!==currentRange.end.column){event.preventDefault();event.stopPropagation();}
if(document.activeElement!==element.elems.hiddenFocusControl){if(((currentRange.start.row!==currentRange.end.row||currentRange.start.column!==currentRange.end.column)&&(currentRange.start.row===intOldEndRow&&currentRange.start.column===intOldEndColumn))||GS.findParentTag(document.activeElement,'gs-table')!==element||element.internalSelection.ranges.length>1){focusHiddenControl(element);}}
if(currentRange.end.row!==intOldEndRow||currentRange.end.column!==intOldEndColumn){renderSelection(element);}}};element.internalEvents.selectDragEnd=function(/*event*/){var beforeEvent;beforeEvent=GS.triggerEvent(element,'before_selection');if(beforeEvent.defaultPrevented){element.internalSelection.ranges=selectionRangesCopy;}
renderSelection(element);if(beforeEvent.defaultPrevented){GS.triggerEvent(element,'after_selection');}
document.body.removeEventListener(evt.mousemove,element.internalEvents.selectDragMove);document.body.removeEventListener(evt.mouseup,element.internalEvents.selectDragEnd);element.internalSelection.currentlySelecting=false;};element.elems.dataContainer.addEventListener(evt.mousedown,element.internalEvents.selectDragStart);}}
function unbindCellResize(element){if(!evt.touchDevice){element.elems.dataViewport.removeEventListener(evt.mousemove,element.internalEvents.cellResizeStarter);element.elems.handleColumn.removeEventListener(evt.mousedown,element.internalEvents.cellResizeDragStart);element.elems.handleRecord.removeEventListener(evt.mousedown,element.internalEvents.cellResizeDragStart);element.elems.handleColumn.removeEventListener('dblclick',element.internalEvents.cellResizeToDefault);element.elems.handleRecord.removeEventListener('dblclick',element.internalEvents.cellResizeToDefault);}}
function bindCellResize(element){var showHandles;var setLineToMouse;if(!evt.touchDevice){showHandles=function(event){if(element.internalResize.showThrottleID!==null){clearTimeout(element.internalResize.showThrottleID);element.internalResize.showThrottleID=null;}
element.internalResize.showThrottleID=setTimeout(function(){var intPreviousPoint;var jsnElementPos;var jsnMousePos;var intMouseX;var intMouseY;var intPoint;var i;var len;jsnElementPos=GS.getElementOffset(element.elems.dataViewport);jsnMousePos=GS.mousePosition(event);intMouseX=(jsnMousePos.left-jsnElementPos.left);intMouseY=(jsnMousePos.top-jsnElementPos.top);element.internalResize.resizeColumn=false;if(element.internalDisplay.recordSelectorVisible&&intMouseY<=(element.internalDisplay.headerHeight)){i=0;len=element.internalDisplay.columnHandles.length;while(i<len){intPoint=(element.internalDisplay.columnHandles[i]);if(intPoint!==null){if(Math.abs(intMouseX-intPoint)<=5){element.internalResize.resizeColumnHandleIndex=i;element.internalResize.resizeColumn=(true);if(intPreviousPoint!==undefined){element.internalResize.cellOriginX=(intPreviousPoint);}else{element.internalResize.cellOriginX=0;}
element.internalResize.cellOriginX+=1;break;}
if(intPoint>intMouseX){break;}
intPreviousPoint=intPoint;}
i+=1;}}
element.internalResize.resizeRecord=false;if(element.internalDisplay.headerVisible&&intMouseX<=(element.internalDisplay.recordSelectorWidth)){i=0;len=element.internalDisplay.recordHandles.length;while(i<len){intPoint=(element.internalDisplay.recordHandles[i]);if(Math.abs(intMouseY-intPoint)<=5){element.internalResize.resizeRecordHandleIndex=i;element.internalResize.resizeRecord=true;if(i===(len-1)&&element.internalDisplay.insertRecordVisible){element.internalResize.cellOriginY=(0);}else if(i>0){element.internalResize.cellOriginY=(element.internalDisplay.recordHandles[i-1]);}else{element.internalResize.cellOriginY=0;}
element.internalResize.cellOriginY+=1;break;}
if(intPoint>intMouseY){break;}
i+=1;}}
if(element.internalResize.resizeColumn&&element.elems.handleColumn.parentNode!==element.elems.dataViewport){element.elems.dataViewport.appendChild(element.elems.handleColumn);}
if(element.internalResize.resizeRecord&&element.elems.handleRecord.parentNode!==element.elems.dataViewport){element.elems.dataViewport.appendChild(element.elems.handleRecord);}
if(element.internalResize.resizeColumn){element.elems.handleColumn.style.left=(element.internalDisplay.columnHandles[element.internalResize.resizeColumnHandleIndex])+'px';}
if(element.internalResize.resizeRecord){element.elems.handleRecord.style.top=(element.internalDisplay.recordHandles[element.internalResize.resizeRecordHandleIndex])+'px';}
if(element.internalResize.resizeColumn&&element.internalResize.resizeRecord){element.elems.dataViewport.classList.add('table-cursor-all-resize');}else if(element.internalResize.resizeColumn){element.elems.dataViewport.classList.add('table-cursor-col-resize');}else if(element.internalResize.resizeRecord){element.elems.dataViewport.classList.add('table-cursor-row-resize');}
element.internalResize.showThrottleID=null;},20);};element.internalEvents.cellResizeStarter=function(event){if((((window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Firefox")>-1)&&event.which===1)||((window.navigator.userAgent.indexOf("Edge")===-1||window.navigator.userAgent.indexOf("Firefox")>-1)&&event.which===0))&&element.internalResize.currentlyResizing!==true&&element.internalResize.currentlyReordering!==true){if(element.elems.handleColumn.parentNode===element.elems.dataViewport){element.elems.dataViewport.removeChild(element.elems.handleColumn);}
if(element.elems.handleRecord.parentNode===element.elems.dataViewport){element.elems.dataViewport.removeChild(element.elems.handleRecord);}
element.elems.dataViewport.classList.remove('table-cursor-all-resize');element.elems.dataViewport.classList.remove('table-cursor-col-resize');element.elems.dataViewport.classList.remove('table-cursor-row-resize');showHandles(event);}else{if(element.internalResize.showThrottleID!==null){clearTimeout(element.internalResize.showThrottleID);element.internalResize.showThrottleID=null;}}};element.elems.dataViewport.addEventListener(evt.mousemove,element.internalEvents.cellResizeStarter);element.internalEvents.cellResizeDragStart=function(){var recordSelectorVisible;var headerVisible;var insertRecordVisible;var intColumnHandle;var intRecordHandle;element.internalResize.currentlyResizing=true;element.internalResize.resizeStarted=false;element.internalResize.resizeColumnIndex=null;element.internalResize.resizeRecordIndex=null;element.internalResize.resizingRecordSelectors=false;element.internalResize.resizingHeader=false;element.internalResize.resizingInsert=false;recordSelectorVisible=(element.internalDisplay.recordSelectorVisible);headerVisible=(element.internalDisplay.headerVisible);insertRecordVisible=(element.internalDisplay.insertRecordVisible);if(element.internalResize.resizeColumn){intColumnHandle=(element.internalResize.resizeColumnHandleIndex);if(intColumnHandle===0&&recordSelectorVisible===true){element.internalResize.resizingRecordSelectors=true;}else{element.internalResize.resizeColumnIndex=(intColumnHandle+
element.internalDisplay.currentRange.fromColumn)-(recordSelectorVisible?1:0);}}
if(element.internalResize.resizeRecord){intRecordHandle=(element.internalResize.resizeRecordHandleIndex);if(intRecordHandle===0&&headerVisible===true){element.internalResize.resizingHeader=true;}}
element.internalResize.scrollOriginTop=(element.internalScroll.displayTop);element.internalResize.scrollOriginLeft=(element.internalScroll.displayLeft);document.body.addEventListener(evt.mousemove,element.internalEvents.cellResizeDragMove);document.body.addEventListener(evt.mouseup,element.internalEvents.cellResizeDragEnd);};setLineToMouse=function(event){var jsnMousePos;var jsnElementPos;var intMouseX;var intMouseY;var viewportWidth;var viewportHeight;var cellOriginX;var cellOriginY;var intMaxColWidth;var intMaxRowHeight;var intMinColWidth;var intOriginScrollTop;var intOriginScrollLeft;var intCurrentScrollTop;var intCurrentScrollLeft;var intNewWidth;var intNewHeight;var intNewX;var intNewY;var intTopBoundery;intOriginScrollTop=(element.internalResize.scrollOriginTop);intOriginScrollLeft=(element.internalResize.scrollOriginLeft);intCurrentScrollTop=(element.internalScroll.displayTop);intCurrentScrollLeft=(element.internalScroll.displayLeft);jsnMousePos=GS.mousePosition(event);jsnElementPos=GS.getElementOffset(element.elems.dataViewport);if(element.internalResize.resizeColumn){element.elems.handleColumn.classList.add('active');intMouseX=(jsnMousePos.left-jsnElementPos.left);intMaxColWidth=(element.internalDisplay.maxColumnWidth);intMinColWidth=(element.internalDisplay.minColumnWidths[element.internalResize.resizeColumnIndex]);cellOriginX=element.internalResize.cellOriginX;viewportWidth=element.elems.dataViewport.clientWidth;intNewWidth=((intMouseX+
intCurrentScrollLeft)-
(cellOriginX+
intOriginScrollLeft));if(intNewWidth<0){intNewWidth=0;}
if(intNewWidth>(viewportWidth-10)){intNewWidth=(viewportWidth-10);}
if(intNewWidth>intMaxColWidth){intNewWidth=intMaxColWidth;}
if(intNewWidth<10){intNewWidth=10;}
if(intNewWidth<intMinColWidth){intNewWidth=intMinColWidth;}
intNewX=((cellOriginX+
intOriginScrollLeft+
intNewWidth)-
(intCurrentScrollLeft));element.elems.handleColumn.style.left=(intNewX)+'px';element.internalResize.lastX=intNewX;element.internalResize.lastWidth=intNewWidth;}
if(element.internalResize.resizeRecord){element.elems.handleRecord.classList.add('active');intMouseY=(jsnMousePos.top-jsnElementPos.top);intMaxRowHeight=(element.internalDisplay.maxRecordHeight);cellOriginY=element.internalResize.cellOriginY;viewportHeight=element.elems.dataViewport.clientHeight;if(element.internalResize.resizingInsert){intNewHeight=(viewportHeight-
intMouseY);}else{intNewHeight=((intMouseY+
intCurrentScrollTop)-
(cellOriginY+
intOriginScrollTop));}
if(intNewHeight<0){intNewHeight=0;}
intTopBoundery=(viewportHeight-(element.internalScrollOffsets.top+10));if(intNewHeight>intTopBoundery){intNewHeight=intTopBoundery;}
if(!element.internalResize.resizingInsert&&intNewHeight>intMaxRowHeight){intNewHeight=intMaxRowHeight;}
if(intNewHeight<10){intNewHeight=10;}
if(element.internalResize.resizingInsert){intNewY=(viewportHeight-
intNewHeight);}else{intNewY=((cellOriginY+
intOriginScrollTop+
intNewHeight)-
(intCurrentScrollTop));}
element.elems.handleRecord.style.top=(intNewY)+'px';element.internalResize.lastY=intNewY;element.internalResize.lastHeight=intNewHeight;}};element.internalEvents.cellResizeDragMove=function(event){var jsnMousePos;var jsnElementPos;var bolScrollTop;var bolScrollLeft;var bolScrollRight;var bolScrollBottom;var colIndex;var rowIndex;var jsnRange;var strScrollDirection;if(event.which===0&&!evt.touchDevice){event.preventDefault();event.stopPropagation();element.internalEvents.cellResizeDragEnd();}else{element.internalResize.resizeStarted=true;jsnMousePos=GS.mousePosition(event);jsnElementPos=GS.getElementOffset(element.elems.dataViewport);colIndex=element.internalResize.resizeColumnIndex;rowIndex=element.internalResize.resizeRecordIndex;jsnRange=(element.internalDisplay.currentRange);bolScrollTop=(jsnMousePos.top<(jsnElementPos.top+
element.internalScrollOffsets.top));bolScrollLeft=(jsnMousePos.left<(jsnElementPos.left+
element.internalScrollOffsets.left));bolScrollRight=(jsnMousePos.left>((jsnElementPos.left+
element.elems.dataViewport.clientWidth)-
element.internalScrollOffsets.right));bolScrollBottom=(jsnMousePos.top>((jsnElementPos.top+
element.elems.dataViewport.clientHeight)-
element.internalScrollOffsets.bottom));if(!element.internalResize.resizeRecord){bolScrollTop=false;bolScrollBottom=false;}
if(!element.internalResize.resizeColumn){bolScrollLeft=false;bolScrollRight=false;}
if(element.internalResize.resizingRecordSelectors){bolScrollLeft=false;bolScrollRight=false;}
if(element.internalResize.resizingHeader||element.internalResize.resizingInsert){bolScrollTop=false;bolScrollBottom=false;}
if(bolScrollTop&&rowIndex===jsnRange.toRecord){bolScrollTop=false;}
if(bolScrollLeft&&colIndex===jsnRange.toColumn){bolScrollLeft=false;}
if(bolScrollBottom&&rowIndex===jsnRange.fromRecord){bolScrollBottom=false;}
if(bolScrollRight&&colIndex===jsnRange.fromColumn){bolScrollRight=false;}
if((bolScrollTop||bolScrollLeft||bolScrollRight||bolScrollBottom)&&!element.internalScroll.dragScrolling){dragScrollStart(element,function(){var bolOldScrollTop;var bolOldScrollLeft;var bolOldScrollBottom;var bolOldScrollRight;strScrollDirection=(element.internalScroll.dragScrollingDirection);bolScrollTop=(strScrollDirection.indexOf('top')!==-1);bolScrollLeft=(strScrollDirection.indexOf('left')!==-1);bolScrollBottom=(strScrollDirection.indexOf('bottom')!==-1);bolScrollRight=(strScrollDirection.indexOf('right')!==-1);bolOldScrollTop=bolScrollTop;bolOldScrollLeft=bolScrollLeft;bolOldScrollBottom=bolScrollBottom;bolOldScrollRight=bolScrollRight;setLineToMouse(event);jsnRange=(element.internalDisplay.currentRange);if(bolScrollTop&&rowIndex===jsnRange.toRecord){bolScrollTop=false;}
if(bolScrollLeft&&colIndex===jsnRange.toColumn){bolScrollLeft=false;}
if(bolScrollBottom&&rowIndex===jsnRange.fromRecord){bolScrollBottom=false;}
if(bolScrollRight&&colIndex===jsnRange.fromColumn){bolScrollRight=false;}
if(bolScrollTop!==bolOldScrollTop||bolScrollLeft!==bolOldScrollLeft||bolScrollBottom!==bolOldScrollBottom||bolScrollRight!==bolOldScrollRight){if(bolScrollTop||bolScrollLeft||bolScrollRight||bolScrollBottom){element.internalScroll.dragScrollingDirection=((bolScrollTop?'top':'')+
(bolScrollLeft?'left':'')+
(bolScrollRight?'right':'')+
(bolScrollBottom?'bottom':''));}else{dragScrollEnd(element);}}},((bolScrollTop?'top':'')+
(bolScrollLeft?'left':'')+
(bolScrollRight?'right':'')+
(bolScrollBottom?'bottom':'')));}else if(element.internalScroll.dragScrolling&&(bolScrollTop||bolScrollLeft||bolScrollRight||bolScrollBottom)){strScrollDirection=(element.internalScroll.dragScrollingDirection);if(bolScrollTop&&strScrollDirection.indexOf('top')===-1){strScrollDirection+='top';}
if(bolScrollLeft&&strScrollDirection.indexOf('left')===-1){strScrollDirection+='left';}
if(bolScrollRight&&strScrollDirection.indexOf('right')===-1){strScrollDirection+='right';}
if(bolScrollBottom&&strScrollDirection.indexOf('bottom')===-1){strScrollDirection+='bottom';}
if(strScrollDirection!==element.internalScroll.dragScrollingDirection){element.internalScroll.dragScrollingDirection=(strScrollDirection);}}else if(!bolScrollTop&&!bolScrollLeft&&!bolScrollRight&&!bolScrollBottom&&element.internalScroll.dragScrolling){dragScrollEnd(element);}
setLineToMouse(event);}};element.internalEvents.cellResizeDragEnd=function(){var intNew;var intIndex;var i;var len;var arrRecordHeights;var arrSelectedColumns;var arrColumnWidths;var arrColumns;if(element.internalScroll.dragScrolling){dragScrollEnd(element);}
element.elems.handleColumn.classList.remove('active');element.elems.handleRecord.classList.remove('active');if(element.internalResize.resizeColumn&&element.internalResize.resizeStarted){intNew=(element.internalResize.lastWidth);if(element.internalResize.resizingRecordSelectors){element.internalDisplay.recordSelectorWidth=intNew;}else{intIndex=(element.internalResize.resizeColumnIndex);arrSelectedColumns=element.internalSelection.columns;arrSelectedColumns=(arrSelectedColumns.slice(arrSelectedColumns[0]==='selector'?1:0));arrColumnWidths=(element.internalDisplay.columnWidths);if(arrSelectedColumns.indexOf(intIndex)>-1){arrColumns=(getConnectedSelectedColumns(element,intIndex));i=0;len=arrColumns.length;while(i<len){arrColumnWidths[arrColumns[i]]=intNew;i+=1;}}else{arrColumnWidths[intIndex]=intNew;}}}
if(element.internalResize.resizeRecord&&element.internalResize.resizeStarted){intNew=(element.internalResize.lastHeight);if(element.internalResize.resizingHeader){element.internalDisplay.headerHeight=intNew;}else{arrRecordHeights=(element.internalDisplay.recordHeights);i=0;len=arrRecordHeights.length;while(i<len){arrRecordHeights[i]=intNew;i+=1;}
if(element.internalDisplay.insertRecordVisible){element.internalDisplay.insertRecordHeight=intNew;}}}
if(element.internalResize.resizeStarted){renderScrollDimensions(element);}
element.internalResize.currentlyResizing=false;document.body.removeEventListener(evt.mousemove,element.internalEvents.cellResizeDragMove);document.body.removeEventListener(evt.mouseup,element.internalEvents.cellResizeDragEnd);};element.elems.handleColumn.addEventListener(evt.mousedown,element.internalEvents.cellResizeDragStart);element.elems.handleRecord.addEventListener(evt.mousedown,element.internalEvents.cellResizeDragStart);element.internalEvents.cellResizeToDefault=function(){var intIndex;var intNew;var i;var len;var arrRecordHeights;var arrSelectedColumns;var arrColumnWidths;var arrColumns;if(element.internalResize.resizeColumn){if(element.internalResize.resizingRecordSelectors){element.internalDisplay.recordSelectorWidth=(element.internalDisplay.defaultRecordSelectorWidth);}else{arrSelectedColumns=element.internalSelection.columns;arrSelectedColumns=(arrSelectedColumns.slice(arrSelectedColumns[0]==='selector'?1:0));resizeColumnsToContent(element,arrSelectedColumns);}}
if(element.internalResize.resizeRecord){if(element.internalResize.resizingHeader){element.internalDisplay.headerHeight=(element.internalDisplay.defaultHeaderHeight);}else{intNew=(element.internalDisplay.defaultRecordHeight);arrRecordHeights=(element.internalDisplay.recordHeights);i=0;len=arrRecordHeights.length;while(i<len){arrRecordHeights[i]=intNew;i+=1;}
if(element.internalDisplay.insertRecordVisible){element.internalDisplay.insertRecordHeight=(element.internalDisplay.defaultInsertRecordHeight);}}}
if(element.internalResize.resizeColumn){element.elems.dataViewport.removeChild(element.elems.handleColumn);}
if(element.internalResize.resizeRecord){element.elems.dataViewport.removeChild(element.elems.handleRecord);}
renderScrollDimensions(element);};element.elems.handleColumn.addEventListener('dblclick',element.internalEvents.cellResizeToDefault);element.elems.handleRecord.addEventListener('dblclick',element.internalEvents.cellResizeToDefault);}}
function unbindColumnReorder(element){if(!evt.touchDevice){element.elems.dataViewport.removeEventListener('mousedown',element.internalEvents.columnReorderDragStart);}}
function bindColumnReorder(element){var setLineToMouse;if(!evt.touchDevice){setLineToMouse=function(event){var jsnMousePos;var jsnElementPos;var arrColumnHandles;var intMouse;var intPrevHandle;var intCurrentHandle;var intPrevIndex;var intCurrentIndex;var intHandleIndex;var intInsertionIndex;var i;var len;jsnMousePos=GS.mousePosition(event);jsnElementPos=GS.getElementOffset(element.elems.dataViewport);arrColumnHandles=(element.internalDisplay.columnHandles);intMouse=(jsnMousePos.left-jsnElementPos.left);if(element.internalScroll.dragScrolling&&element.internalScroll.dragScrollingDirection==='left'){i=0;len=arrColumnHandles.length;while(i<len){if(arrColumnHandles[i]!==null){intHandleIndex=i;break;}
i+=1;}}else if(element.internalScroll.dragScrolling&&element.internalScroll.dragScrollingDirection==='left'){i=(arrColumnHandles.length-1);while(i>=0){if(arrColumnHandles[i]!==null){intHandleIndex=i;break;}
i-=1;}}else{intPrevHandle=null;intCurrentHandle=null;intPrevIndex=null;intCurrentIndex=null;intHandleIndex=null;i=0;len=arrColumnHandles.length;while(i<len){if(arrColumnHandles[i]!==null){intCurrentHandle=arrColumnHandles[i];intCurrentIndex=i;}
if(intPrevHandle!==null&&intCurrentHandle!==null){if(intMouse>=intPrevHandle&&intMouse<=intCurrentHandle){if((intCurrentHandle-intMouse)<(intMouse-intPrevHandle)){intHandleIndex=intCurrentIndex;}else{intHandleIndex=intPrevIndex;}}else if(i===(len-1)){if(intMouse>=intCurrentHandle){intHandleIndex=intCurrentIndex;}else{intHandleIndex=intPrevIndex;}}}else if(intCurrentHandle!==null&&intMouse<=intCurrentHandle){intHandleIndex=intCurrentIndex;}
if(intHandleIndex!==null){break;}
if(intCurrentHandle!==null){intPrevHandle=intCurrentHandle;intPrevIndex=intCurrentIndex;}
i+=1;}}
intInsertionIndex=(intHandleIndex+
element.internalDisplay.currentRange.fromColumn);if(element.elems.handleReorder.parentNode!==element.elems.dataViewport){element.elems.dataViewport.appendChild(element.elems.handleReorder);}
element.elems.handleReorder.style.left=((arrColumnHandles[intHandleIndex])+'px');element.internalReorder.dropLocation=intInsertionIndex;};element.internalEvents.columnReorderDragStart=function(event){var target;var parentCell;var intColNumber;var arrCurrentColumns;target=event.target;if(parentCell&&parentCell.nodeName!=='GS-CELL'){parentCell=GS.findParentElement(target,'gs-cell');}else{parentCell=target;}
if(parentCell&&parentCell.nodeName==='GS-CELL'&&parentCell.classList.contains('table-header')&&parentCell.hasAttribute('selected')){element.internalReorder.currentlyReordering=true;element.internalReorder.reorderStarted=false;intColNumber=parseInt(parentCell.getAttribute('data-col-number'),10);arrCurrentColumns=(getConnectedSelectedColumns(element,intColNumber));element.internalReorder.currentColumns=arrCurrentColumns;element.internalReorder.originColumn=intColNumber;element.internalReorder.dropLocation=null;element.internalSelection.ranges=[{"start":{"row":"header","column":arrCurrentColumns[0]},"end":{"row":"header","column":arrCurrentColumns[arrCurrentColumns.length-1]},"negator":false}];renderSelection(element);setLineToMouse(event);document.body.addEventListener(evt.mousemove,element.internalEvents.columnReorderDragMove);document.body.addEventListener(evt.mouseup,element.internalEvents.columnReorderDragEnd);}};element.internalEvents.columnReorderDragMove=function(event){var jsnMousePos;var jsnElementPos;var bolScrollLeft;var bolScrollRight;if(event.which===0&&!evt.touchDevice){event.preventDefault();event.stopPropagation();element.internalEvents.columnReorderDragEnd();}else{element.internalReorder.reorderStarted=true;jsnMousePos=GS.mousePosition(event);jsnElementPos=GS.getElementOffset(element.elems.dataViewport);bolScrollLeft=(jsnMousePos.left<(jsnElementPos.left+
element.internalScrollOffsets.left));bolScrollRight=(jsnMousePos.left>((jsnElementPos.left+
element.elems.dataViewport.clientWidth)-
element.internalScrollOffsets.right));if((bolScrollLeft||bolScrollRight)&&!element.internalScroll.dragScrolling){dragScrollStart(element,function(){setLineToMouse(event);},(bolScrollLeft?'left':'right'));}else if(!bolScrollLeft&&!bolScrollRight&&element.internalScroll.dragScrolling){dragScrollEnd(element);}
setLineToMouse(event);}};element.internalEvents.columnReorderDragEnd=function(){var arrOrderCols;var intDropIndex;var headerTemplate;var recordTemplate;var insertTemplate;var arrOldHeaderTemplate;var arrOldRecordTemplate;var arrOldInsertTemplate;var arrOldPlainText;var arrOldDataCol;var arrOldColWidths;var arrOldDefaultColWidths;var arrOldCopyHeaders;var arrOldCopyCol;var strNewHeaderTemplate;var strNewRecordTemplate;var strNewInsertTemplate;var arrNewPlainText;var arrNewDataCol;var arrNewColWidths;var arrNewDefaultColWidths;var arrNewCopyHeaders;var arrNewCopyCol;var i;var len;var intSeqIndex;var unmovedColumns;var pullIndex;var index;var strSort;var strColumn;var strOldSortOrder;var strNewSortOrder;if(element.elems.handleReorder.parentNode===element.elems.dataViewport){element.elems.dataViewport.removeChild(element.elems.handleReorder);}
if(element.internalScroll.dragScrolling){dragScrollEnd(element);}
intDropIndex=(element.internalReorder.dropLocation);arrOrderCols=(element.internalReorder.currentColumns);if(!element.internalReorder.reorderStarted){element.internalSelection.ranges=[{"start":{"row":"header","column":element.internalReorder.originColumn},"end":{"row":"header","column":element.internalReorder.originColumn},"negator":false}];renderSelection(element);}
if(element.internalReorder.reorderStarted&&intDropIndex!==null&&intDropIndex!==undefined&&!isNaN(intDropIndex)&&arrOrderCols.length>0&&intDropIndex<=(element.internalDisplay.columnWidths.length)&&arrOrderCols.indexOf(intDropIndex)===-1&&arrOrderCols.indexOf(intDropIndex-1)===-1){if(element.internalTemplates.header){headerTemplate=document.createElement('template');headerTemplate.innerHTML=(element.internalTemplates.header);arrOldHeaderTemplate=(xtag.query(headerTemplate.content,'gs-cell'));}
if(element.internalTemplates.originalRecord){recordTemplate=document.createElement('template');recordTemplate.innerHTML=(element.internalTemplates.originalRecord);arrOldRecordTemplate=(xtag.query(recordTemplate.content,'gs-cell'));}
if(element.internalTemplates.insertRecord){insertTemplate=document.createElement('template');insertTemplate.innerHTML=(element.internalTemplates.insertRecord);arrOldInsertTemplate=(xtag.query(insertTemplate.content,'gs-cell'));}
arrOldPlainText=(element.internalDisplay.columnPlainTextNames);arrOldDataCol=(element.internalDisplay.dataColumnName);arrOldColWidths=(element.internalDisplay.columnWidths);arrOldDefaultColWidths=(element.internalDisplay.defaultColumnWidths);if(element.internalClip.headerList&&element.internalClip.headerList.length>0){arrOldCopyHeaders=(element.internalClip.headerList);}
if(element.internalClip.columnList&&element.internalClip.columnList.length>0){arrOldCopyCol=(element.internalClip.columnList);}
strNewHeaderTemplate='';strNewRecordTemplate='';strNewInsertTemplate='';arrNewPlainText=[];arrNewDataCol=[];arrNewColWidths=[];arrNewDefaultColWidths=[];arrNewCopyHeaders=[];arrNewCopyCol=[];intSeqIndex=0;unmovedColumns=arrOrderCols.slice(0);i=0;len=arrOldColWidths.length;while(i<len){if(intSeqIndex===intDropIndex&&unmovedColumns.length>0){pullIndex=unmovedColumns.shift();}else if(intSeqIndex===arrOrderCols[0]){intSeqIndex+=(arrOrderCols.length);pullIndex=intSeqIndex;intSeqIndex+=1;}else{pullIndex=intSeqIndex;intSeqIndex+=1;}
if(arrOldHeaderTemplate){strNewHeaderTemplate+=(arrOldHeaderTemplate[pullIndex].outerHTML);}
if(arrOldRecordTemplate){strNewRecordTemplate+=(arrOldRecordTemplate[pullIndex].outerHTML);}
if(arrOldInsertTemplate){strNewInsertTemplate+=(arrOldInsertTemplate[pullIndex].outerHTML);}
arrNewPlainText.push(arrOldPlainText[pullIndex]);arrNewDataCol.push(arrOldDataCol[pullIndex]);arrNewColWidths.push(arrOldColWidths[pullIndex]);arrNewDefaultColWidths.push(arrOldDefaultColWidths[pullIndex]);arrNewCopyHeaders.push(arrOldCopyHeaders[pullIndex]);arrNewCopyCol.push(arrOldCopyCol[pullIndex]);i+=1;}
if(arrOldHeaderTemplate){headerTemplate.innerHTML=strNewHeaderTemplate;templateCellAddColumnNumber(headerTemplate);strNewHeaderTemplate=headerTemplate.innerHTML;element.internalTemplates.header=(strNewHeaderTemplate);}
if(arrOldRecordTemplate){recordTemplate.innerHTML=strNewRecordTemplate;templateCellAddColumnNumber(recordTemplate);strNewRecordTemplate=recordTemplate.innerHTML;element.internalTemplates.originalRecord=(strNewRecordTemplate);element.internalTemplates.record=(GS.templateHideSubTemplates(strNewRecordTemplate,false));}
if(arrOldInsertTemplate){insertTemplate.innerHTML=strNewInsertTemplate;templateCellAddColumnNumber(insertTemplate);strNewInsertTemplate=insertTemplate.innerHTML;element.internalTemplates.insertRecord=(strNewInsertTemplate);}
element.internalDisplay.columnPlainTextNames=(arrNewPlainText);element.internalDisplay.dataColumnName=(arrNewDataCol);element.internalDisplay.columnWidths=(arrNewColWidths);element.internalDisplay.defaultColumnWidths=(arrNewDefaultColWidths);if(arrOldCopyHeaders){element.internalClip.headerList=(arrNewCopyHeaders);}
if(arrOldCopyCol){element.internalClip.columnList=(arrNewCopyCol);}
element.internalSelection.ranges=[];strOldSortOrder='';strNewSortOrder='';i=0;len=arrOldDataCol.length;while(i<len){if(arrOldDataCol[i]){strColumn=arrOldDataCol[i];index=(element.internalData.columnNames.indexOf(strColumn));strSort=element.internalData.columnOrders[index];if(index>-1&&strSort!=='neutral'){strOldSortOrder+=strColumn;}}
if(arrNewDataCol[i]){strColumn=arrNewDataCol[i];index=(element.internalData.columnNames.indexOf(strColumn));strSort=element.internalData.columnOrders[index];if(index>-1&&strSort!=='neutral'){strNewSortOrder+=strColumn;}}
i+=1;}
if(strOldSortOrder!==strNewSortOrder){dataSELECT(element);}else{element.internalDisplay.fullRenderRequired=true;renderScrollDimensions(element);}}
element.internalReorder.currentlyReordering=false;document.body.removeEventListener(evt.mousemove,element.internalEvents.columnReorderDragMove);document.body.removeEventListener(evt.mouseup,element.internalEvents.columnReorderDragEnd);};element.elems.dataViewport.addEventListener('mousedown',element.internalEvents.columnReorderDragStart);}}
function unbindUpdate(element){element.removeEventListener('change',element.internalEvents.cellUpdate);}
function bindUpdate(element){element.internalEvents.cellUpdate=function(event){var target;var columnElement;var cellElement;var newValue;var strColumn;var intRecord;target=event.target;columnElement=GS.findParentElement(target,'[column]');cellElement=GS.findParentElement(columnElement,'gs-cell');if(GS.findParentElement(columnElement,'gs-table')===element&&cellElement.classList.contains('table-cell')){if(columnElement){if(columnElement.value!==null&&columnElement.value!==undefined){newValue=columnElement.value;}else if(target.value!==null&&target.value!==undefined){newValue=target.value;}else if(columnElement.checked!==null&&columnElement.checked!==undefined){newValue=columnElement.checked;}else if(target.checked!==null&&target.checked!==undefined){newValue=target.checked;}else{throw'GS-TABLE Error: Found an element with a '+'"column" attribute, but could not find a '+'value. Please make sure that when a '+'"change" event is fired either the event '+'target or the "column" element has a '+'"value" or "checked" accessor.';}
strColumn=columnElement.getAttribute('column');intRecord=parseInt(cellElement.getAttribute('data-row-number'),10);dataUPDATE(element,'single-cell',{"data":{"columnName":strColumn,"recordNumber":intRecord,"newValue":newValue},"updateConfirmed":true});}}};element.addEventListener('change',element.internalEvents.cellUpdate);}
function unbindInsert(element){element.elems.dataViewport.removeEventListener('keydown',element.internalEvents.insertRecordReturn);element.elems.dataViewport.removeEventListener('change',element.internalEvents.insertRecordValueRetain);element.elems.dataViewport.removeEventListener('keyup',element.internalEvents.insertRecordValueRetain);}
function bindInsert(element){element.internalEvents.insertRecordReturn=function(event){var parentCell=GS.findParentTag(event.target,'gs-cell');var keyCode=(event.keyCode||event.which);if(parentCell.classList.contains('table-insert')&&keyCode===13){dataINSERT(element,'single-record',{"data":{"values":(element.internalData.insertRecord),"columns":(element.internalData.insertRecordRetainedColumns),"addin":getInsertAddin(element)},"insertConfirmed":true});element.internalData.insertRecord={};element.internalData.insertRecordRetainedColumns=[];element.internalDisplay.fullRenderRequired=true;renderLocation(element);}};element.elems.dataViewport.addEventListener('keydown',element.internalEvents.insertRecordReturn);element.internalEvents.insertRecordValueRetain=function(event){var target=event.target;var parentCell=GS.findParentTag(target,'gs-cell');var parentColumn=GS.findParentElement(target,'[column]');var strColumn=parentColumn.getAttribute('column');var strValue=target.value;if(parentCell.classList.contains('table-insert')&&strColumn){if(strValue){element.internalData.insertRecord[strColumn]=strValue;if(element.internalData.insertRecordRetainedColumns.indexOf(strColumn)===-1){element.internalData.insertRecordRetainedColumns.push(strColumn);}}else if(!strValue&&element.internalData.insertRecordRetainedColumns.indexOf(strColumn)>-1){element.internalData.insertRecord[strColumn]=undefined;element.internalData.insertRecordRetainedColumns.splice(element.internalData.insertRecordRetainedColumns.indexOf(strColumn));}}};element.elems.dataViewport.addEventListener('change',element.internalEvents.insertRecordValueRetain);element.elems.dataViewport.addEventListener('keyup',element.internalEvents.insertRecordValueRetain);}
function unbindHUD(element){}
function bindHUD(element){}
function unbindKey(element){element.removeEventListener('keydown',element.internalEvents.keyDown);}
function bindKey(element){element.internalEvents.keyDown=function(event){var keyCode=(event.keyCode||event.which);var bolCMDorCTRL=(event.ctrlKey||event.metaKey);var bolShift=(event.shiftKey);var active=document.activeElement;var activeValue=document.activeElement.value;var jsnRange;var intOldRecord;var intOldColumn;var intNewRecord;var intNewColumn;var intMaxColumn;var intMaxRecord;var intMinColumn;var intMinRecord;var jsnCursorPos;var intCursorPos;var bolFullSelection;var bolCursorAtFirst;var bolCursorAtTop;var bolCursorAtLast;var bolCursorAtBottom;var bolMaintainSelection;var bolMoveSelectedToTop;var intSpaceToTraverse;var intHeight;var i;var len;var beforeEvent;var selectionCopy;if(active===element.elems.hiddenFocusControl){if(keyCode===8||keyCode===46){deleteSelectedRecords(element);}else if(keyCode===13){focusIntoSelectedCell(element);}else if(bolCMDorCTRL&&keyCode===65){len=element.internalData.records.length;element.internalSelection.ranges=[{"start":{"row":(element.internalDisplay.headerVisible?'header':0),"column":(element.internalDisplay.recordSelectorVisible?'selector':0)},"end":{"row":(len>0?(len-1):'header'),"column":(element.internalDisplay.columnWidths.length-1)},"negator":false}];renderSelection(element);}}
if((keyCode===38||keyCode===39||keyCode===40||keyCode===37||keyCode===33||keyCode===34||keyCode===36||keyCode===35||keyCode===9)&&!event.defaultPrevented){if((active.nodeName==='INPUT'||active.nodeName==='TEXTAREA')&&active!==element.elems.hiddenFocusControl){jsnCursorPos=GS.getInputSelection(active);}else{jsnCursorPos={'start':0,'end':activeValue.length};}
bolFullSelection=(jsnCursorPos.start===0&&jsnCursorPos.end===activeValue.length);if(jsnCursorPos&&!bolFullSelection&&jsnCursorPos.start===jsnCursorPos.end){intCursorPos=jsnCursorPos.start;bolCursorAtFirst=(intCursorPos===0);bolCursorAtTop=((intCursorPos<(activeValue.indexOf('\n')===-1?activeValue.length+1:activeValue.indexOf('\n')+1))||(intCursorPos===0));bolCursorAtLast=(intCursorPos===activeValue.length);bolCursorAtBottom=(intCursorPos>activeValue.lastIndexOf('\n'));}
jsnRange=element.internalSelection.ranges[element.internalSelection.ranges.length-1];if(jsnRange){intOldRecord=jsnRange.end.row;intOldColumn=jsnRange.end.column;if(intOldRecord==='header'){intOldRecord=-1;}else if(intOldRecord==='insert'){intOldRecord=element.internalData.records.length;}
if(intOldColumn==='selector'){intOldColumn=-1;}}else{intOldRecord=0;intOldColumn=0;}
intMaxColumn=(element.internalDisplay.columnWidths.length-1);intMaxRecord=(element.internalDisplay.insertRecordVisible?element.internalData.records.length:element.internalData.records.length-1);intMinColumn=(element.internalDisplay.recordSelectorVisible?-1:0);intMinRecord=(element.internalDisplay.headerVisible?-1:0);if(keyCode===36){event.preventDefault();event.stopPropagation();intNewRecord=intOldRecord;intNewColumn=intMinColumn;}else if(keyCode===35){event.preventDefault();event.stopPropagation();intNewRecord=intOldRecord;intNewColumn=intMaxColumn;}else if(keyCode===38){if(bolFullSelection||bolCursorAtTop){event.preventDefault();event.stopPropagation();if(bolCMDorCTRL){intNewRecord=intMinRecord;intNewColumn=intOldColumn;}else if(intOldRecord>intMinRecord){intNewRecord=(intOldRecord-1);intNewColumn=intOldColumn;}}}else if(keyCode===39){if(bolFullSelection||bolCursorAtLast){event.preventDefault();event.stopPropagation();if(bolCMDorCTRL){intNewRecord=intOldRecord;intNewColumn=intMaxColumn;}else if(intOldColumn===intMaxColumn&&intOldRecord<intMaxRecord){intNewRecord=(intOldRecord+1);intNewColumn=intMinColumn;}else if(intOldColumn<intMaxColumn){intNewRecord=intOldRecord;intNewColumn=(intOldColumn+1);}}}else if(keyCode===40){if(bolFullSelection||bolCursorAtBottom){event.preventDefault();event.stopPropagation();if(bolCMDorCTRL){intNewRecord=intMaxRecord;intNewColumn=intOldColumn;}else if(intOldRecord<intMaxRecord){intNewRecord=(intOldRecord+1);intNewColumn=intOldColumn;}}}else if(keyCode===37){if(bolFullSelection||bolCursorAtFirst){event.preventDefault();event.stopPropagation();if(bolCMDorCTRL){intNewRecord=intOldRecord;intNewColumn=intMinColumn;}else if(intOldColumn===intMinColumn&&intOldRecord>intMinRecord){intNewRecord=(intOldRecord-1);intNewColumn=intMaxColumn;}else if(intOldColumn>intMinColumn){intNewRecord=intOldRecord;intNewColumn=(intOldColumn-1);}}}else if(keyCode===33){event.preventDefault();event.stopPropagation();intSpaceToTraverse=(element.elems.dataViewport.clientHeight-(element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom));i=(element.internalDisplay.currentRange.fromRecord);while(i>=-1){intHeight=(element.internalDisplay.recordHeights[i]);intSpaceToTraverse-=intHeight;if(i===intMinRecord){intNewRecord=i;break;}
if(intSpaceToTraverse<0){intNewRecord=i;break;}
i-=1;}
if(intNewRecord!==undefined){if(bolShift){intNewColumn=intOldColumn;}else{intNewColumn=intMinColumn;}}
bolMoveSelectedToTop=true;}else if(keyCode===34){event.preventDefault();event.stopPropagation();intSpaceToTraverse=(element.elems.dataViewport.clientHeight-(element.internalScrollOffsets.top+
element.internalScrollOffsets.bottom));i=(element.internalDisplay.currentRange.fromRecord);len=(intMaxRecord+1);while(i<len){if(i===-1){intHeight=(element.internalDisplay.headerHeight);}else{intHeight=(element.internalDisplay.recordHeights[i]);}
intSpaceToTraverse-=intHeight;if(i===intMaxRecord){intNewRecord=i;break;}
if(intSpaceToTraverse<0){intNewRecord=i-1;break;}
i+=1;}
if(intNewRecord!==undefined){if(bolShift){intNewColumn=intOldColumn;}else{intNewColumn=intMinColumn;}}
bolMoveSelectedToTop=true;}else if(keyCode===9){if(bolShift){if(intOldRecord!==intMinColumn||intOldColumn!==intMinRecord){event.preventDefault();event.stopPropagation();if(intOldColumn===intMinColumn){intNewRecord=(intOldRecord-1);intNewColumn=intMaxColumn;}else{intNewRecord=intOldRecord;intNewColumn=intOldColumn-1;}}}else{if(intOldRecord!==intMaxColumn||intOldColumn!==intMaxRecord){event.preventDefault();event.stopPropagation();if(intOldColumn===intMaxColumn){intNewRecord=(intOldRecord+1);intNewColumn=intMinColumn;}else{intNewRecord=intOldRecord;intNewColumn=intOldColumn+1;}}}}
if(intNewRecord!==undefined&&intNewColumn!==undefined){focusHiddenControl(element);bolMaintainSelection=(bolShift&&jsnRange&&keyCode!==9);selectionCopy=getSelectionCopy(element);var intHeaderIndex;var intSelectorIndex;var intInsertIndex;var newRecord;var newColumn;intHeaderIndex=-1;intSelectorIndex=-1;intInsertIndex=(element.internalData.records.length);if(intNewRecord===intHeaderIndex){newRecord='header';}else if(intNewRecord===intInsertIndex){newRecord='insert';}else{newRecord=intNewRecord;}
if(intNewColumn===intSelectorIndex){newColumn='selector';}else{newColumn=intNewColumn;}
if(bolMaintainSelection){jsnRange.end.row=newRecord;jsnRange.end.column=newColumn;}else{jsnRange={"start":{"row":newRecord,"column":newColumn},"end":{"row":newRecord,"column":newColumn},"negator":false};element.internalSelection.ranges=[jsnRange];}
beforeEvent=GS.triggerEvent(element,'before_selection');if(beforeEvent.defaultPrevented){element.internalSelection.ranges=(selectionCopy.ranges);return;}
focusHiddenControl(element);if(bolMoveSelectedToTop){scrollSelectionIntoView(element,'top');}else{scrollSelectionIntoView(element);}
if(!bolMaintainSelection&&intNewRecord>-1&&intNewColumn>-1){focusIntoSelectedCell(element);}
if(beforeEvent.defaultPrevented){GS.triggerEvent(element,'after_selection');}}}};element.addEventListener('keydown',element.internalEvents.keyDown);}
function unbindCopy(element){element.removeEventListener('copy',element.internalEvents.copySelection);}
function bindCopy(element){element.internalEvents.copySelection=function(event){var jsnCopyString;var focusedElement;focusedElement=document.activeElement;if(focusedElement.classList.contains('hidden-focus-control')||focusedElement.selectionStart===focusedElement.selectionEnd){console.time('copy');addLoader(element,'copy-loader','Copying Data...');focusedElement=element.elems.hiddenFocusControl;focusedElement.focus();GS.setInputSelection(focusedElement,0,focusedElement.value.length);jsnCopyString=getCopyStrings(element);if(handleClipboardData(event,jsnCopyString.text,'text')){event.preventDefault(event);}
if(handleClipboardData(event,jsnCopyString.html,'html')){event.preventDefault(event);}
removeLoader(element,'copy-loader','Data Copied');console.timeEnd('copy');}};element.addEventListener('copy',element.internalEvents.copySelection);}
function unbindPaste(element){element.removeEventListener('paste',element.internalEvents.pasteSelection);}
function bindPaste(element){element.internalEvents.pasteSelection=function(event){if(document.activeElement===element.elems.hiddenFocusControl){event.preventDefault();usePasteEvent(element,event);}};element.addEventListener('paste',element.internalEvents.pasteSelection);}
function unbindCut(element){element.removeEventListener('cut',element.internalEvents.cutSelection);}
function bindCut(element){element.internalEvents.cutSelection=function(){if(document.activeElement===element.elems.hiddenFocusControl){event.preventDefault();addLoader(element,'cut-warn','Cut is not supported');removeLoader(element,'cut-warn','Cut is not supported');}};element.addEventListener('cut',element.internalEvents.cutSelection);}
function unbindContextMenu(element){element.elems.dataViewport.removeEventListener('contextmenu',element.internalEvents.columnContextMenu);}
function bindContextMenu(element){element.internalEvents.columnContextMenu=function(event){var target=event.target;var parentCell=GS.findParentTag(target,'gs-cell');var templateElement;var strCellType;var bolRange;var arrDataColumns;var arrSelectedColumns;var bolFilterUnique;var bolFilterSelection;var bolColumnWidths;var bolHideAndShow;var bolSort;var intRecord;var intColumn;var strDataValue;var strControlValue;var strColumn;var columnElement;var focusElement;var jsnSelection;var strSelection;var i;var len;var strHTML;parentCell=target;if(target.nodeName!=='GS-CELL'){parentCell=GS.findParentTag(target,'gs-cell');}
if(parentCell&&parentCell.nodeName==='GS-CELL'&&(parentCell.classList.contains('table-cell')||parentCell.classList.contains('table-header')||parentCell.classList.contains('table-insert'))){if(parentCell.classList.contains('table-cell')){strCellType='data';}else if(parentCell.classList.contains('table-header')){strCellType='header';}else if(parentCell.classList.contains('table-insert')){strCellType='insert';}
arrSelectedColumns=(element.internalSelection.columns);if(arrSelectedColumns[0]==='selector'){arrSelectedColumns.shift();}
bolRange=(arrSelectedColumns.length>1||element.internalSelection.rows.length>1);arrDataColumns=getSelectedDataColumns(element);if(strCellType==='data'&&!bolRange&&arrDataColumns.length===1){intRecord=parseInt(parentCell.getAttribute('data-row-number'),10);intColumn=parseInt(parentCell.getAttribute('data-col-number'),10);strColumn=(element.internalDisplay.dataColumnName[intColumn]);strDataValue=getCell(element,strColumn,intRecord,true,'gsTAbleINTERNALNULLSTRING');columnElement=xtag.query(parentCell,'[column]')[0];if(columnElement&&strDataValue!=='gsTAbleINTERNALNULLSTRING'){if((columnElement.nodeName==='INPUT'&&columnElement.getAttribute('type')==='text')||columnElement.nodeName==='TEXTAREA'){focusElement=columnElement;}else{focusElement=xtag.query(columnElement,'input[type="text"], textarea')[0];}
if(focusElement&&focusElement.value===strDataValue){strControlValue=focusElement.value;jsnSelection=GS.getInputSelection(focusElement);strSelection=strControlValue.substring(jsnSelection.start,jsnSelection.end);}}}
bolFilterUnique=true;bolFilterSelection=true;bolColumnWidths=true;bolHideAndShow=true;bolSort=true;if(true){bolFilterUnique=false;}
if(strCellType!=='data'||bolRange||arrSelectedColumns.length!==1||arrDataColumns.length!==1){bolFilterSelection=false;}
if(false){bolColumnWidths=false;}
if(false){bolHideAndShow=false;}
if(arrDataColumns.length===0){bolSort=false;}
strHTML='';if(bolSort){strHTML+=(strHTML?'<hr />':'');strHTML+=('<div class="context-menu-header">Sorting:</div>'+'<div class="context-menu-indent">'+'    <gs-button dialogclose remove-bottom'+'                iconleft icon="sort-alpha-asc"'+'                class="button-sort-asc">'+'        Sort A to Z'+'    </gs-button>'+'    <gs-button dialogclose remove-all'+'                iconleft icon="sort-alpha-desc"'+'                class="button-sort-desc">'+'        Sort Z to A'+'    </gs-button>'+'    <gs-button dialogclose remove-top'+'                iconleft icon="trash-o"'+'                class="button-sort-clear">'+'        Clear Sort'+'    </gs-button>'+'</div>');}
if(bolHideAndShow){strHTML+=(strHTML?'<hr />':'');strHTML+=('<div class="context-menu-header">'+'Hide/Unhide Columns:'+'</div>'+'<div class="context-menu-indent">'+'    <gs-button dialogclose remove-bottom'+'                iconleft icon="eye-slash"'+'                class="button-column-hide">'+'        Hide Column(s)'+'    </gs-button>'+'    <gs-button dialogclose remove-top'+'                iconleft icon="eye"'+'                class="button-column-unhide">'+'        Unhide Columns'+'    </gs-button>'+'</div>');}
if(bolColumnWidths){strHTML+=(strHTML?'<hr />':'');strHTML+=('<div class="context-menu-header">Column Width:</div>'+'<div class="context-menu-indent">'+'    <gs-button dialogclose remove-bottom'+'                iconleft icon="text-width"'+'                class="button-column-width">'+'        Fit To Header'+'    </gs-button>'+'    <gs-button dialogclose remove-top'+'                iconleft icon="text-width"'+'                class="button-column-width">'+'        Fit To Content'+'    </gs-button>'+'</div>');}
if(bolFilterSelection){strHTML+=(strHTML?'<hr />':'');strHTML+=('<div class="context-menu-header">Filtering:</div>'+'<div class="context-menu-indent">'+'    <gs-button dialogclose remove-bottom'+'                iconleft icon="filter"'+'                class="button-filter-include">'+'        Filter By Selection'+'    </gs-button>'+'    <gs-button dialogclose remove-all'+'                iconleft icon="filter"'+'                class="button-filter-exclude">'+'        Filter Excluding Selection'+'    </gs-button>'+'    <gs-button dialogclose remove-all'+'                iconleft icon="search"'+'                class="button-filter-text">'+'        Text Filters'+'    </gs-button>'+'    <gs-button dialogclose remove-all'+'                iconleft icon="toggle-off"'+'                class="button-filter-toggle">'+'        Toggle Filters'+'    </gs-button>'+'    <gs-button dialogclose remove-top'+'                iconleft icon="trash-o"'+'                class="button-filter-clear">'+'        Clear Filters'+'    </gs-button>'+'</div>');}
if(bolFilterUnique){strHTML+=(strHTML?'<hr />':'');strHTML+='<div class="gs-table-unique-value-list"></div>';}
templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','15em');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('no-focus-lock','true');templateElement.setAttribute('no-background','');templateElement.innerHTML=('<gs-page gs-dynamic class="gs-table-contextmenu">'+'    <gs-body padded>'+'        '+strHTML+'    </gs-body>'+'</gs-page>');event.preventDefault();var jsnMousePos=GS.mousePosition(event);var jsnElementPos=GS.getElementOffset(element.elems.root);element.elems.pixel.style.left=(((jsnMousePos.left-
jsnElementPos.left)+
(GS.emToPx(document.body,15)/2))+'px');element.elems.pixel.style.top=((jsnMousePos.top-
jsnElementPos.top)+'px');element.elems.pixel.style.bottom='';element.elems.pixel.style.right='';GS.openDialogToElement(element.elems.pixel,templateElement,'down',function(){var dialog=this;var filterToggleButton;var strStatus;dialog.classList.add('gs-table-contextmenu');if(bolFilterSelection){filterToggleButton=xtag.query(dialog,'.button-filter-toggle')[0];strStatus=(element.internalData.columnFilterStatuses[arrDataColumns[0]]);if(strStatus==='on'){filterToggleButton.textContent=('Toggle Filters Off');filterToggleButton.setAttribute('icon','toggle-on');}else{filterToggleButton.textContent=('Toggle Filters On');filterToggleButton.setAttribute('icon','toggle-off');}}},function(event,strAnswer){var dialog=this;var targetElement;var buttonElement;var strWhere;var strValue;var strNewSort;var col_i;var col_len;if(event&&event.target){targetElement=event.target;}
if(targetElement){if(targetElement.nodeName==='GS-BUTTON'){buttonElement=targetElement;}else{buttonElement=GS.findParentTag(targetElement,'gs-button');}}
strAnswer=strAnswer.trim();if(strAnswer==='Sort A to Z'||strAnswer==='Sort Z to A'||strAnswer==='Clear Sort'){if(strAnswer==='Sort A to Z'){strNewSort='asc';}else if(strAnswer==='Sort Z to A'){strNewSort='desc';}else if(strAnswer==='Clear Sort'){strNewSort='neutral';}
col_i=0;col_len=arrDataColumns.length;while(col_i<col_len){element.internalData.columnOrders[arrDataColumns[col_i]]=strNewSort;col_i+=1;}
dataSELECT(element);}else if(strAnswer==='Fit To Header'){resizeColumnsToHeader(element,arrSelectedColumns);}else if(strAnswer==='Fit To Content'){resizeColumnsToContent(element,arrSelectedColumns);}else if(strAnswer==='Hide Column(s)'){i=0;len=arrSelectedColumns.length;while(i<len){if(arrSelectedColumns[i]>=0){element.internalDisplay.columnWidths[arrSelectedColumns[i]]=0;}
i+=1;}
element.internalDisplay.fullRenderRequired=true;renderLocation(element);}else if(strAnswer==='Unhide Columns'){openColumnHideDialog(element,buttonElement,function(strAnswer){if(strAnswer!=='Cancel'){GS.closeDialog(dialog,'Force');}});event.preventDefault();}else if(strAnswer==='Filter By Selection'){strValue=(strSelection||strDataValue);if(strValue==='gsTAbleINTERNALNULLSTRING'){strWhere=(strColumn+' IS NULL');}else{strWhere=('CAST('+
strColumn+' AS '+
GS.database.type.text+') = $$'+strValue+'$$');}
element.internalData.columnFilters[arrDataColumns[0]].push({"text":strWhere,"name":'equals "'+strValue+'"'});dataSELECT(element);}else if(strAnswer==='Filter Excluding Selection'){strValue=(strSelection||strDataValue);if(strValue==='gsTAbleINTERNALNULLSTRING'){strWhere=(strColumn+' IS NOT NULL');}else{strWhere=('CAST('+
strColumn+' AS '+
GS.database.type.text+') != $$'+strValue+'$$');}
element.internalData.columnFilters[arrDataColumns[0]].push({"text":strWhere,"name":"doesn't equal "+"\""+strValue+"\""});dataSELECT(element);}else if(strAnswer==='Text Filters'){strValue=(strSelection||strDataValue);element.internalEvents.textFilterContextMenu(buttonElement,arrDataColumns[0],strColumn,strValue,function(strAnswer){if(strAnswer!=='Cancel'){GS.closeDialog(dialog,'Force');}});event.preventDefault();}else if(strAnswer==='Toggle Filters On'){element.internalData.columnFilterStatuses[arrDataColumns[0]]=('on');dataSELECT(element);}else if(strAnswer==='Toggle Filters Off'){element.internalData.columnFilterStatuses[arrDataColumns[0]]=('off');dataSELECT(element);}else if(strAnswer==='Clear Filters'){element.internalData.columnFilters[arrDataColumns[0]]=[];element.internalData.columnListFilters[arrDataColumns[0]]={};dataSELECT(element);}});}};element.internalEvents.textFilterContextMenu=function(buttonElement,columnIndex,strColumn,strValue,callback){var templateElement;templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','17em');templateElement.setAttribute('no-background','');templateElement.setAttribute('data-overlay-close','true');templateElement.innerHTML=ml(function(){/*
                <gs-page gs-dynamic class="gs-table-contextmenu">
                    <gs-body padded>
                        <center>
                            <i>Check each filter you want to apply.</i><br />
                            <i>
                                Matching values must pass every<br />
                                filter you choose.
                            </i>
                        </center>
                        <table>
                            <tbody>
                                <tr class="fltr-row fltr-eq">
                                    <td>
                                        <gs-checkbox remove-all mini>
                                            &nbsp;Equals</gs-checkbox>
                                    </td>
                                    <td><gs-text mini></gs-text></td>
                                </tr>
                                <tr class="fltr-row fltrn-eq">
                                    <td>
                                        <gs-checkbox remove-all mini>
                                            &nbsp;Doesn't Equal</gs-checkbox>
                                    </td>
                                    <td><gs-text mini></gs-text></td>
                                </tr>
                                <tr class="fltr-row fltr-contain">
                                    <td>
                                        <gs-checkbox remove-all mini>
                                            &nbsp;Contains</gs-checkbox>
                                    </td>
                                    <td><gs-text mini></gs-text></td>
                                </tr>
                                <tr class="fltr-row fltrn-contain">
                                    <td>
                                        <gs-checkbox remove-all mini>
                                            &nbsp;Doesn't Contain</gs-checkbox>
                                    </td>
                                    <td><gs-text mini></gs-text></td>
                                </tr>
                                <tr class="fltr-row fltr-starts">
                                    <td>
                                        <gs-checkbox remove-all mini>
                                            &nbsp;Starts With</gs-checkbox>
                                    </td>
                                    <td><gs-text mini></gs-text></td>
                                </tr>
                                <tr class="fltr-row fltr-ends">
                                    <td>
                                        <gs-checkbox remove-all mini>
                                            &nbsp;Ends With</gs-checkbox>
                                    </td>
                                    <td><gs-text mini></gs-text></td>
                                </tr>
                            </tbody>
                        </table>

                        <!--
                        <gs-checkbox remove-bottom>
                            &nbsp;Equals
                        </gs-checkbox>
                        <gs-checkbox remove-all>
                            &nbsp;Doesn't Equal
                        </gs-checkbox>
                        <gs-checkbox remove-all>
                            &nbsp;Contains
                        </gs-checkbox>
                        <gs-checkbox remove-all>
                            &nbsp;Doesn't Contain
                        </gs-checkbox>
                        <gs-checkbox remove-all>
                            &nbsp;Starts With
                        </gs-checkbox>
                        <gs-checkbox remove-top>
                            &nbsp;Ends With
                        </gs-checkbox>
                        -->
                    </gs-body>
                    <gs-footer>
                        <gs-grid gutter>
                            <gs-block>
                                <gs-button dialogclose>
                                    Cancel
                                </gs-button>
                            </gs-block>
                            <gs-block>
                                <gs-button dialogclose bg-primary>
                                    Apply
                                </gs-button>
                            </gs-block>
                        </gs-grid>
                    </gs-footer>
                </gs-page>
            */});GS.openDialogToElement(buttonElement,templateElement,'right',function(){var dialog=this;var arrElements;var i;var len;arrElements=xtag.query(dialog,'.fltr-row gs-text');i=0;len=arrElements.length;while(i<len){arrElements[i].value=strValue;i+=1;}},function(ignore,strAnswer){var dialog=this;var arrRows;var rowClass;var checkElement;var valueElement;var strWhere;var strName;var strWhereValue;var i;var len;strAnswer=strAnswer.trim();if(strAnswer==='Apply'){arrRows=xtag.query(dialog,'.fltr-row');i=0;len=arrRows.length;while(i<len){checkElement=(arrRows[i].children[0].children[0]);valueElement=(arrRows[i].children[1].children[0]);strWhereValue=valueElement.value;rowClass=arrRows[i].classList;strWhere='';if(checkElement.value==='true'){if(rowClass.contains('fltr-eq')){strWhere='CAST('+
strColumn+' AS '+
GS.database.type.text+') '+'= $$'+strWhereValue+'$$';strName='equals "'+strWhereValue+'"';}else if(rowClass.contains('fltrn-eq')){strWhere='CAST('+
strColumn+' AS '+
GS.database.type.text+') '+'!= $$'+strWhereValue+'$$';strName='doesn\'t equal '+'"'+strWhereValue+'"';}else if(rowClass.contains('fltr-contain')){strWhere='CAST('+
strColumn+' AS '+
GS.database.type.text+') '+'LIKE $$%'+strWhereValue+'%$$';strName='contains '+'"'+strWhereValue+'"';}else if(rowClass.contains('fltrn-contain')){strWhere='CAST('+
strColumn+' AS '+
GS.database.type.text+') '+'NOT LIKE '+'$$%'+strWhereValue+'%$$';strName='doesn\'t '+'"'+strWhereValue+'"';}else if(rowClass.contains('fltr-starts')){strWhere='CAST('+
strColumn+' AS '+
GS.database.type.text+') '+'LIKE $$'+strWhereValue+'%$$';strName='starts with '+'"'+strWhereValue+'"';}else if(rowClass.contains('fltr-ends')){strWhere='CAST('+
strColumn+' AS '+
GS.database.type.text+') '+'LIKE $$%'+strWhereValue+'$$';strName='ends '+'"'+strWhereValue+'"';}}
if(strWhere){element.internalData.columnFilters[columnIndex].push({"text":strWhere,"name":strName});}
i+=1;}
dataSELECT(element);}
if(callback){callback(strAnswer);}});};element.internalEvents.advancedFilterContextMenu=function(){};element.elems.dataViewport.addEventListener('contextmenu',element.internalEvents.columnContextMenu);}
function unbindColumnDropdown(element){element.removeEventListener('click',element.internalEvents.columnDropDown);}
function bindColumnDropdown(element){element.internalEvents.columnDropDown=function(event){var target=event.target;var parentCell;var templateElement;var columnNumber;var strColumn;var columnIndex;var strHTML;var jsnMousePos;var jsnElementPos;var intMouseX;var intMouseY;if(target.classList.contains('header-button')){jsnMousePos=GS.mousePosition(event);jsnElementPos=GS.getElementOffset(element.elems.root);intMouseX=(jsnMousePos.left-jsnElementPos.left);intMouseY=(jsnMousePos.top-jsnElementPos.top);element.elems.pixel.style.left=(intMouseX+'px');element.elems.pixel.style.top=(intMouseY+'px');parentCell=GS.findParentTag(target,'gs-cell');columnNumber=(parseInt(parentCell.getAttribute('data-col-number'),10));strColumn=(element.internalDisplay.dataColumnName[columnNumber]);columnIndex=(element.internalData.columnNames.indexOf(strColumn));strHTML='';strHTML+=('<gs-button dialogclose remove-bottom'+'            iconleft icon="sort-alpha-asc"'+'            class="button-sort-asc">'+'    Sort A to Z'+'</gs-button>');strHTML+=('<gs-button dialogclose remove-all'+'            iconleft icon="sort-alpha-desc"'+'            class="button-sort-desc">'+'    Sort Z to A'+'</gs-button>');strHTML+=('<gs-button dialogclose remove-top'+'            iconleft icon="trash-o"'+'            class="button-sort-clear">'+'    Clear Sort'+'</gs-button>');strHTML+=('<div class="gs-table-unique-filter-container" hidden>'+'    <hr />'+'    <small><i>Filter By Selection:</i></small>'+'    <div class="gs-table-unique-value-list"></div>'+'    <div class="gs-table-unique-value-list-toolbar">'+
('<gs-button dialogclose remove-right '+'inline>Cancel</gs-button>'+'<gs-button dialogclose remove-left '+'inline bg-primary>Ok</gs-button>')+'    </div>'+'</div>');strHTML+='<hr />';strHTML+=('<gs-button dialogclose'+'            iconleft icon="trash-o"'+'            class="button-sort-clear">'+'    Clear Filters'+'</gs-button>');templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','17em');templateElement.setAttribute('data-overlay-close','true');templateElement.setAttribute('no-background','');templateElement.innerHTML=('<gs-page gs-dynamic class="gs-table-contextmenu">'+'    <gs-body padded>'+'        '+strHTML+'    </gs-body>'+'</gs-page>');GS.openDialogToElement(element.elems.pixel,templateElement,'down',function(){var dialog=this;var uniqueFilterElement=xtag.query(dialog,'.gs-table-unique-filter-container')[0];var valueListElement=xtag.query(dialog,'.gs-table-unique-value-list')[0];if(uniqueFilterElement&&valueListElement){dataSELECTcolumnUnique(element,uniqueFilterElement,valueListElement,strColumn);}},function(ignore,strAnswer){var dialog=this;var tableElement;var valueListElement=xtag.query(dialog,'.gs-table-unique-value-list')[0];var arrRecords;var arrIncluded;var arrExcluded;var strValue;var bolBlanks;var i;var len;strAnswer=strAnswer.trim();tableElement=valueListElement.children[0];if(tableElement&&tableElement.nodeName==='GS-TABLE'){if(strAnswer==='Ok'){arrRecords=tableElement.internalData.records;arrIncluded=[];arrExcluded=[];i=1;len=arrRecords.length;while(i<len){strValue=(arrRecords[i].substring(arrRecords[i].lastIndexOf('\t')+1));if(strValue==='(blanks)'){bolBlanks=(arrRecords[i][0]==='-');}else{if(arrRecords[i][0]==='0'){arrExcluded.push(strValue);}else{arrIncluded.push(strValue);}}
i+=1;}
if(!element.internalData.columnListFilters[columnIndex]){element.internalData.columnListFilters[columnIndex]={};}
if(arrIncluded.length<arrExcluded.length){element.internalData.columnListFilters[columnIndex].type='inclusion';element.internalData.columnListFilters[columnIndex].values=(arrIncluded);}else if(arrExcluded.length>0){element.internalData.columnListFilters[columnIndex].type='exclusion';element.internalData.columnListFilters[columnIndex].values=(arrExcluded);}else{element.internalData.columnListFilters[columnIndex].type='exclusion';element.internalData.columnListFilters[columnIndex].values=([]);}
element.internalData.columnListFilters[columnIndex].blanks=(bolBlanks||false);arrRecords=[];arrExcluded=[];arrIncluded=[];dataSELECT(element);}
tableElement.destroy();}
if(strAnswer==='Sort A to Z'){element.internalData.columnOrders[columnIndex]='asc';dataSELECT(element);}else if(strAnswer==='Sort Z to A'){element.internalData.columnOrders[columnIndex]='desc';dataSELECT(element);}else if(strAnswer==='Clear Sort'){element.internalData.columnOrders[columnIndex]='neutral';dataSELECT(element);}else if(strAnswer==='Clear Filters'){element.internalData.columnFilters[columnIndex]=[];element.internalData.columnListFilters[columnIndex]={};dataSELECT(element);}});}};element.addEventListener('click',element.internalEvents.columnDropDown);}
function unbindDeveloper(element){element.removeEventListener(evt.mousedown,element.internalEvents.developerMouseDown);}
function bindDeveloper(element){element.internalEvents.developerMouseDown=function(event){var bolCMDorCTRL=(event.ctrlKey||event.metaKey);var bolShift=(event.shiftKey);var strHTML;var arrAttr;var jsnAttr;var i;var len;if(bolCMDorCTRL&&bolShift){event.preventDefault();event.stopPropagation();strHTML='';arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];strHTML+=('<b>Attribute "'+encodeHTML(jsnAttr.name)+'":</b>'+'<pre>'+encodeHTML(jsnAttr.value)+'</pre>');i+=1;}
GS.msgbox('Developer Info',strHTML,['Ok']);}};element.addEventListener(evt.mousedown,element.internalEvents.developerMouseDown);}
function unbindVisibilityPolling(element){clearInterval(element.internalTimerIDs.visibilityIntervalID);}
function bindVisibilityPolling(element){element.internalTimerIDs.visibilityIntervalID=setInterval(function(){var jsnCache;var intWidth;var intHeight;var intFontSize;jsnCache=element.internalPollingCache;intWidth=element.clientWidth;intHeight=element.clientHeight;intFontSize=GS.emToPx(element,1);if(jsnCache.elementWidth!==intWidth||jsnCache.elementHeight!==intHeight||jsnCache.fontSize!==intFontSize){renderScrollDimensions(element);GS.triggerEvent(window,'resize');}
jsnCache.elementWidth=intWidth;jsnCache.elementHeight=intHeight;jsnCache.fontSize=intFontSize;},75);}
function unbindElement(element){unbindFocus(element);unbindScroll(element);unbindSelection(element);unbindCellResize(element);unbindColumnReorder(element);unbindUpdate(element);unbindInsert(element);unbindKey(element);unbindHUD(element);unbindCopy(element);unbindPaste(element);unbindContextMenu(element);unbindColumnDropdown(element);unbindCut(element);unbindDeveloper(element);unbindVisibilityPolling(element);}
function bindElement(element){bindFocus(element);bindScroll(element);bindSelection(element);bindCellResize(element);bindColumnReorder(element);bindUpdate(element);bindInsert(element);bindKey(element);bindHUD(element);bindCopy(element);bindPaste(element);bindContextMenu(element);bindColumnDropdown(element);bindCut(element);bindDeveloper(element);bindVisibilityPolling(element);}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;resolveElementAttributes(element);prepareElement(element);siphonElement(element);renderHUD(element);bindElement(element);createWebWorker(element);GS.triggerEvent(element,'initialized');}}}
xtag.register('gs-table',{lifecycle:{'created':function(){},'inserted':function(){elementInserted(this);},'removed':function(){this.destroy();},'attributeChanged':function(strAttrName){var element=this;if(strAttrName==='suspend-created'||strAttrName==='suspend-inserted'){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(strAttrName==='value'&&element.root){element.refresh();}}}},accessors:{'selection':{'get':function(){}},'data':{'get':function(){}},'value':{'get':function(){return this.getAttribute('value');},'set':function(newValue){this.setAttribute('value',newValue);}}},methods:{'destroy':function(){var element=this;if(element.elems.dataViewport){unbindElement(element);if(element.internalWorker.worker){element.internalWorker.worker.terminate();}
element.internalData={};element.internalScrollOffsets={};element.internalEvents={};element.internalEventCancelled={};element.internalScroll={};element.internalTimerIDs={};element.internalTemplates={};element.internalDisplay={};element.internalSelection={};element.internalClip={};element.internalWorker={};element.internalLoaders={};element.internalResize={};element.internalReorder={};element.elems={};element.innerHTML='';}},'refresh':function(){dataSELECT(this);},'selectData':function(){dataSELECT(this);},'insertData':function(jsnInsert){dataINSERT(this,jsnInsert);},'updateData':function(jsnUpdate){dataUPDATE(this,jsnUpdate);},'deleteData':function(jsnDeleteData){dataDELETE(this,jsnDeleteData);},'render':function(){renderScrollDimensions(this);},'toggleFullContainer':function(container,target){if(this.classList.contains('absolute')){this.classList.remove('absolute');document.getElementById(container).classList.remove('relative');target.setAttribute('icon','expand');}else{this.classList.add('absolute');document.getElementById(container).classList.add('relative');target.setAttribute('icon','compress');}
renderScrollDimensions(this);},'openFullContainer':function(container,target){if(!this.classList.contains('absolute')){this.classList.add('absolute');document.getElementById(container).classList.add('relative');target.setAttribute('icon','compress');}
renderScrollDimensions(this);},'closeFullContainer':function(container,target){if(this.classList.contains('absolute')){this.classList.remove('absolute');document.getElementById(container).classList.remove('relative');target.setAttribute('icon','expand');}
renderScrollDimensions(this);},'deleteSelected':function(){deleteSelectedRecords(this);},'clearFilter':function(){var filter_i;var filter_len;filter_i=0;filter_len=this.internalData.columnFilters.length;while(filter_i<filter_len){this.internalData.columnFilters[filter_i]=[];this.internalData.columnListFilters[filter_i]={};filter_i+=1;}
dataSELECT(this);},'toggleFullscreen':function(target){if(this.classList.contains('table-fullscreen')){this.classList.remove('table-fullscreen');if(target.getAttribute('icon')==='close'){target.setAttribute('icon','arrows-alt');}}else{this.classList.add('table-fullscreen');if(target.getAttribute('icon')==='arrows-alt'){target.setAttribute('icon','close');}}
renderScrollDimensions(this);},'openFullscreen':function(target){if(!this.classList.contains('table-fullscreen')){this.classList.add('table-fullscreen');if(target.getAttribute('icon')==='arrows-alt'){target.setAttribute('icon','close');}}
renderScrollDimensions(this);},'closeFullscreen':function(target){if(this.classList.contains('table-fullscreen')){this.classList.remove('table-fullscreen');if(target.getAttribute('icon')==='close'){target.setAttribute('icon','arrows-alt');}}
renderScrollDimensions(this);},'openPrefs':function(target){openSettingsDialog(this,target);},'sort':function(action){var strNewSort;if(action==='asc'){strNewSort='asc';}else if(action==='desc'){strNewSort='desc';}else if(action==='clear'){strNewSort='neutral';}else{strNewSort='neutral';}
var arrColumnOrders=(this.internalData.columnOrders);var arrDataColumns=getSelectedDataColumns(this);var i=0;var len=arrDataColumns.length;while(i<len){arrColumnOrders[arrDataColumns[i]]=strNewSort;i+=1;}
dataSELECT(this);},'openInsertDialog':function(){openInsertDialog(element);},'goToLine':function(action){var intCurrentRecord=(this.internalSelection.originRecord||0);var intMaxRecord=(this.internalData.records.length-1);var intMinColumn=(this.internalDisplay.recordSelectorVisible?-1:0);if(action==='insert'){scrollCellIntoView(this,'insert','0','top');}else{if(action==='first'){intCurrentRecord=0;}else if(action==='previous'){intCurrentRecord-=1;}else if(action==='next'){intCurrentRecord+=1;}else if(action==='plusten'){intCurrentRecord+=10;}else if(action==='minusten'){intCurrentRecord-=10;}else if(action==='last'){intCurrentRecord=intMaxRecord;}else if(typeof action==='number'){intCurrentRecord=action-1;}else{intCurrentRecord=parseInt(action,10)-1;}
if(intCurrentRecord>intMaxRecord){intCurrentRecord=intMaxRecord;}
if(intCurrentRecord<0){intCurrentRecord=0;}
if(intMaxRecord===-1){intCurrentRecord=undefined;}
if(intCurrentRecord!==undefined){this.internalSelection.ranges=[{"start":{"row":intCurrentRecord,"column":intMinColumn},"end":{"row":intCurrentRecord,"column":intMinColumn},"negator":false}];}else{this.internalSelection.ranges=[];}
renderSelection(this);scrollSelectionIntoView(this,'top');}},'clearSelection':function(){var element=this;element.internalSelection.ranges=[];renderSelection(element);},'addSelectionRange':function(fromRow,fromColumn,toRow,toColumn,bolNegate){var element=this;if(bolNegate===undefined||typeof bolNegate!=='boolean'){bolNegate=false;}
element.internalSelection.ranges.push({"start":{"row":fromRow,"column":fromColumn},"end":{"row":toRow,"column":toColumn},"negator":false});renderSelection(element);},'getCopyStrings':function(){return getCopyStrings(this);},'paste':function(strPasteString){usePasteString(this,strPasteString);},'resizeAllColumns':function(){var arrIndexes=[];for(var i=0,len=this.internalDisplay.columnPlainTextNames.length;i<len;i++){arrIndexes.push(i);}
resizeColumnsToContent(this,arrIndexes);},'addFilter':function(filterColumn,filterType,filterValue){var element=this;var columnIndex;var strWhere;var strName;if(!(/^(contains|starts|ends)$/gi).test(filterType)&&!(/^(equals|greaterthan|lessthan)$/gi).test(filterType)&&!(/^(notcontains|notstarts|notends)$/gi).test(filterType)&&!(/^(notequals|notgreaterthan)$/gi).test(filterType)&&!(/^(notlessthan)$/gi).test(filterType)){throw'GS-TABLE Error: invalid filter type given to '+'ELEMENT.addFilter(filterColumn, filterType, '+'filterValue). Given filter type was '+'"'+filterType+'", must be "contains", '+'"starts", "ends", "equals", "greaterthan", '+'"lessthan", "notcontains", "notstarts", '+'"notends", "notequals", "notgreaterthan" '+'or "notlessthan".';}
filterType=filterType.toLowerCase();if(filterValue===undefined){throw'GS-TABLE Error: no filter value given to '+'ELEMENT.addFilter(filterColumn, filterType, '+'filterValue)';}
filterValue=filterValue.toString();if(filterType==='equals'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'= $$'+filterValue+'$$';strName='equals'+' "'+filterValue+'"';}else if(filterType==='notequals'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'!= $$'+filterValue+'$$';strName='doesn\'t equal'+' "'+filterValue+'"';}else if(filterType==='contains'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'LIKE $$%'+filterValue+'%$$';strName='contains'+' "'+filterValue+'"';}else if(filterType==='notcontains'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'NOT LIKE '+'$$%'+filterValue+'%$$';strName='doesn\'t contain'+' "'+filterValue+'"';}else if(filterType==='starts'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'LIKE $$'+filterValue+'%$$';strName='starts with'+' "'+filterValue+'"';}else if(filterType==='notstarts'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'NOT LIKE $$'+filterValue+'%$$';strName=''+' "'+filterValue+'"';}else if(filterType==='ends'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'LIKE $$%'+filterValue+'$$';strName='ends with'+' "'+filterValue+'"';}else if(filterType==='notends'){strWhere='CAST('+
filterColumn+' AS '+
GS.database.type.text+') '+'NOT LIKE $$%'+filterValue+'$$';strName='doesn\'t end with'+' "'+filterValue+'"';}else if(filterType==='greaterthan'){strWhere=(filterColumn+' > '+filterValue);strName='greater than'+' "'+filterValue+'"';}else if(filterType==='notgreaterthan'){strWhere=(filterColumn+' <= '+filterValue);strName='not greater than'+' "'+filterValue+'"';}else if(filterType==='lessthan'){strWhere=(filterColumn+' < '+filterValue);strName='less than'+' "'+filterValue+'"';}else if(filterType==='notlessthan'){strWhere=(filterColumn+' >= '+filterValue);strName='not less than'+' "'+filterValue+'"';}
columnIndex=(element.internalData.columnNames.indexOf(filterColumn));if(strWhere){element.internalData.columnFilters[columnIndex].push({"text":strWhere,"name":strName});}else{console.warn('GS-TABLE Warning: Unable to create where'+'clause.\n'+'Here are the parameters that failed:\n'+'\tfilterColumn:   "'+filterColumn+'"\n'+'\tfilterType:     "'+filterType+'"\n'+'\tfilterValue:    "'+filterValue+'"');}}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-text>','<gs-text>','gs-text column="${1:name}"></gs-text>');registerDesignSnippet('<gs-text> With Label','<gs-text>','label for="${1:text-insert-last_name}">${2:Last Name}:</label>\n'+'<gs-text id="${1:text-insert-last_name}" column="${3:last_name}"></gs-text>');designRegisterElement('gs-text','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-text.html');window.designElementProperty_GSTEXT=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'placeholder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'    <option value="">Visible</option>'+'    <option value="hidden">Invisible</option>'+'    <option value="hide-on-desktop">Invisible at desktop size</option>'+'    <option value="hide-on-tablet">Invisible at tablet size</option>'+'    <option value="hide-on-phone">Invisible at phone size</option>'+'    <option value="show-on-desktop">Visible at desktop size</option>'+'    <option value="show-on-tablet">Visible at tablet size</option>'+'    <option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function changeFunction(event){event.preventDefault();event.stopPropagation();event.stopImmediatePropagation();event.target.parentNode.syncGetters();GS.triggerEvent(event.target.parentNode,'change');return false;}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function createPushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.value=strQSValue;}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);element.handleContents();element.syncView();if(element.getAttribute('qs')){createPushReplacePopHandler(element);window.addEventListener('pushstate',function(){createPushReplacePopHandler(element);});window.addEventListener('replacestate',function(){createPushReplacePopHandler(element);});window.addEventListener('popstate',function(){createPushReplacePopHandler(element);});}
if(element.innerHTML.trim()===''){element.handleContents();element.syncView();}}}}
xtag.register('gs-text',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==='suspend-created'&&newValue===null){elementCreated(element);elementInserted(element);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){var currentValue;if(strAttrName==='disabled'||strAttrName==='readonly'){element.handleContents();element.syncView();}else if(strAttrName==='value'&&element.initalized){currentValue=element.control.value;if(newValue!==currentValue){element.syncView();}}}}},events:{'keydown':function(event){var element=this;if(!element.hasAttribute('readonly')&&!element.hasAttribute('disabled')){element.syncGetters();}},'keyup':function(){var element=this;if(!element.hasAttribute('readonly')&&!element.hasAttribute('disabled')){element.syncGetters();}}},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(strNewValue){this.setAttribute('value',strNewValue);}}},methods:{focus:function(){var element=this;if(element.control){element.control.focus();}},handleContents:function(){var element=this;var arrPassThroughAttributes=['placeholder','name','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','spellcheck','readonly','disabled'];var i;var len;if(element.hasAttribute('tabindex')){element.savedTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
element.innerHTML='<input class="control" gs-dynamic type="'+(element.getAttribute('type')||'text')+'" />';element.control=element.children[0];element.control.removeEventListener('change',changeFunction);element.control.addEventListener('change',changeFunction);element.control.removeEventListener('focus',focusFunction);element.control.addEventListener('focus',focusFunction);element.control.removeEventListener('blur',blurFunction);element.control.addEventListener('blur',blurFunction);element.control.removeEventListener(evt.mouseout,mouseoutFunction);element.control.addEventListener(evt.mouseout,mouseoutFunction);element.control.removeEventListener(evt.mouseout,mouseoverFunction);element.control.addEventListener(evt.mouseover,mouseoverFunction);i=0;len=arrPassThroughAttributes.length;while(i<len){if(element.hasAttribute(arrPassThroughAttributes[i])){if(arrPassThroughAttributes[i]==='disabled'){element.control.setAttribute('readonly',element.getAttribute(arrPassThroughAttributes[i])||'');}else{element.control.setAttribute(arrPassThroughAttributes[i],element.getAttribute(arrPassThroughAttributes[i])||'');}}
i+=1;}
if(element.savedTabIndex!==undefined&&element.savedTabIndex!==null){element.control.setAttribute('tabindex',element.savedTabIndex);}},syncView:function(){var element=this;element.control.value=element.getAttribute('value')||'';element.initalized=true;},syncGetters:function(){this.setAttribute('value',this.control.value);}}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-time>','<gs-time>','gs-time column="${1:name}"></gs-time>');registerDesignSnippet('<gs-time> With Label','<gs-time>','label for="${1:time-insert-start_time}">${2:Start Time}:</label>\n'+'<gs-time id="${1:time-insert-start_time}" column="${3:start_time}"></gs-time>');designRegisterElement('gs-time','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-time.html');window.designElementProperty_GSTIME=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'placeholder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Time Picker',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-picker'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-picker',(this.value==='true'),false);});addProp('Non-Empty',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('non-empty'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'non-empty',(this.value==='true'),true);});addProp('Now Button',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-now-button'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-now-button',(this.value==='true'),false);});addProp('Display Format',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('format')||'')+'" mini>'+'<option value="">Regular (1:30 PM)</option>'+'<option value="military">Military (13:30)</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'format',this.value);});addProp('Output Format',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('output-format')||'')+'" mini>'+'<option value="">Regular (1:30 PM)</option>'+'<option value="military">Military (13:30)</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'output-format',this.value);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';var currentErrorControl;window.addEventListener('focus',function(event){if(currentErrorControl&&event.target!==currentErrorControl.control){currentErrorControl.control.focus();if(currentErrorControl.control){GS.setInputSelection(currentErrorControl.control,0,currentErrorControl.control.value.length);}}
if(currentErrorControl&&currentErrorControl.control&&currentErrorControl.control.value){currentErrorControl='';}});function changeFunction(event){event.preventDefault();event.stopPropagation();event.target.parentNode.setAttribute('value',event.target.value);handleChange(event.target.parentNode);}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function refreshControl(element){var i,len,arrPassThroughAttributes,strHTML;element.innerHTML='';element.control='';element.button='';if(!element.hasAttribute('disabled')){strHTML='<input class="control" gs-dynamic type="text" />';if(!element.hasAttribute('no-picker')){strHTML+='<gs-button class="time-picker-button" gs-dynamic inline icononly icon="clock-o" no-focus></gs-button>';}
element.innerHTML=strHTML;element.control=element.children[0];element.button=element.children[1];arrPassThroughAttributes=['placeholder','name','maxlength','autocorrect','autocapitalize','autocomplete','autofocus','spellcheck','readonly'];i=0;len=arrPassThroughAttributes.length;while(i<len){if(element.hasAttribute(arrPassThroughAttributes[i])){element.control.setAttribute(arrPassThroughAttributes[i],element.getAttribute(arrPassThroughAttributes[i])||'');}
i+=1;}
if(element.hasAttribute('tabindex')){element.oldTabIndex=element.getAttribute('tabindex');element.removeAttribute('tabindex');}
if(element.oldTabIndex){element.control.tabIndex=element.oldTabIndex;}
element.control.removeEventListener('change',changeFunction);element.control.addEventListener('change',changeFunction);element.control.removeEventListener('focus',focusFunction);element.control.addEventListener('focus',focusFunction);element.control.removeEventListener('blur',blurFunction);element.control.addEventListener('blur',blurFunction);element.control.removeEventListener(evt.mouseout,mouseoutFunction);element.control.addEventListener(evt.mouseout,mouseoutFunction);element.control.removeEventListener(evt.mouseover,mouseoverFunction);element.control.addEventListener(evt.mouseover,mouseoverFunction);}
setValueDisplay(element,element.getAttribute('value'));}
function handleChange(element){element.close();if(handleNonEmpty(element)&&element.lastChangeValue!==element.getAttribute('value')){GS.triggerEvent(element,'change');element.lastChangeValue=element.getAttribute('value');}}
function handleNonEmpty(element){var bolAllClear=true;if(element.hasAttribute('non-empty')&&!element.getAttribute('value')){bolAllClear=false;currentErrorControl=element;alert('Error: Invalid Time. Please input a time.');element.open();}
return bolAllClear;}
function translateValue(strFormat,newValue){var translatedValue;var valueDate;var strHour;var strMinute;var strPeriod;var arrParts;var intHours;newValue=newValue||'';if(typeof newValue==='string'){strPeriod=(newValue.match(/pm|am|a|p/gi)||[''])[0].toLowerCase();newValue=newValue.replace(/[^0-9:]/gi,'');if(strPeriod){strPeriod=(strPeriod[0]==='a'?'AM':'PM');}
if(newValue){if((/:/).test(newValue)){arrParts=newValue.split(':');strHour=arrParts[0];strMinute=GS.leftPad(arrParts[1],'0',2);if(parseInt(strHour,10)>12){strHour=parseInt(strHour,10)-12;strPeriod='PM';}}else{newValue=newValue.substring(0,4);if(newValue.length>=3){strMinute=newValue.substring(newValue.length-2);strHour=newValue.substring(0,newValue.length-2);if(parseInt(strHour,10)>12){strHour=parseInt(strHour,10)-12;strPeriod='PM';}}else{newValue=parseInt(newValue,10);if((strFormat==='military')&&newValue>24||(strFormat!=='military')&&newValue>12){strHour='12';strMinute=String(newValue);}else{strHour=String(newValue);strMinute='00';}}}}
if(strHour&&strMinute){if(!strPeriod){if(parseInt(strHour,10)<6||parseInt(strHour,10)===12){strPeriod='PM';}else{strPeriod='AM';}}
valueDate=new Date('1/1/1111 '+strHour+':'+strMinute+' '+strPeriod);}}else{valueDate=new Date(newValue);}
if(valueDate){if(strFormat==='military'){translatedValue=GS.leftPad(valueDate.getHours(),'0',2)+':'+
GS.leftPad(valueDate.getMinutes(),'0',2);}else{intHours=valueDate.getHours();if(intHours>=12){intHours=intHours-12;}
if(intHours===0){intHours=12;}
translatedValue=intHours+':'+
GS.leftPad(valueDate.getMinutes(),'0',2)+' '+
(valueDate.getHours()>=12?'PM':'AM');}}else{translatedValue='';}
return translatedValue;}
function setValueDisplay(element,newValue){var translatedOutputValue=translateValue((element.getAttribute('output-format')==='military'?'military':'regular'),newValue);var translatedDisplayValue=translateValue((element.getAttribute('format')==='military'?'military':'regular'),newValue);element.setAttribute('value',translatedOutputValue);if(!element.hasAttribute('disabled')){element.control.value=translatedDisplayValue;}else{element.textContent=translatedDisplayValue||element.getAttribute('placeholder')||'';}
if(element.innerState==='open'){refreshPickerValue(element);}}
function refreshPickerValue(element){var arrElements;var strTranslatedValue;var dteTranslatedValue;var i;var len;var intHours;if(element.innerState==='open'){strTranslatedValue=translateValue((element.getAttribute('format')==='military'?'military':'regular'),element.getAttribute('value'));dteTranslatedValue=new Date('1/1/1111 '+strTranslatedValue);element.pickerModalControlElement.setAttribute('value',strTranslatedValue);arrElements=xtag.query(element.pickerContainerElement,'.selected');i=0;len=arrElements.length;while(i<len){arrElements[i].classList.remove('selected');i+=1;}
intHours=dteTranslatedValue.getHours();if(intHours>=12){intHours=intHours-12;}
if(intHours===0){intHours=12;}
xtag.query(element.pickerContainerElement,'.clock-hour[data-value="'+intHours+'"]')[0].classList.add('selected');xtag.query(element.pickerContainerElement,'.clock-minute[data-value="'+(Math.floor(dteTranslatedValue.getMinutes()/5)*5)+'"]')[0].classList.add('selected');xtag.query(element.pickerContainerElement,'.clock-period-switch.'+(dteTranslatedValue.getHours()>=12?'pm':'am'))[0].classList.add('selected');}}
function handleQS(element){var strQSValue;if(!element.qsEventFunction){element.qsEventFunction=function(){pushReplacePopHandler(element);};}
window.removeEventListener('pushstate',element.qsEventFunction);window.removeEventListener('replacestate',element.qsEventFunction);window.removeEventListener('popstate',element.qsEventFunction);if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',element.qsEventFunction);window.addEventListener('replacestate',element.qsEventFunction);window.addEventListener('popstate',element.qsEventFunction);}}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){var now;var strQSValue;if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.innerState='closed';element.internal={};saveDefaultAttributes(element);if(element.getAttribute('value')==='now'){now=new Date();if(now.getHours()>12){now=GS.leftPad(now.getHours()-12,'0',2)+':'+GS.leftPad(now.getMinutes(),'0',2)+' PM';}else{now=GS.leftPad(now.getHours(),'0',2)+':'+GS.leftPad(now.getMinutes(),'0',2)+' AM';}
element.setAttribute('value',now);}
element.inserted=true;refreshControl(element);if(element.getAttribute('qs')){handleQS(element);}
element.lastChangeValue=element.getAttribute('value');if(element.hasAttribute('non-empty')&&!element.getAttribute('value')){console.warn('gs-time Warning: No value provided on "non-empty" gs-time control. Defaulting to "12:00 PM". Please provide a default value.');element.setAttribute('value','12:00 PM');}}}}
xtag.register('gs-time',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var element=this;if(strAttrName==='suspend-created'&&newValue===null){elementCreated(element);elementInserted(element);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(element);}else if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(strAttrName==='placeholder'||strAttrName==='disabled'||strAttrName==='format'||strAttrName==='no-picker'||strAttrName==='tabindex'){refreshControl(element);}else if(strAttrName==='qs'){handleQS(element);}else if(strAttrName==='value'&&element.inserted){setValueDisplay(element,newValue);}}}},events:{'click':function(event){var element=this;if(event.target===element.button){element.toggle();}},'keydown:':function(event){var element=this;var intKeyCode=(event.keyCode||event.which);var newControlValue;if(!element.hasAttribute('no-keys')&&!element.hasAttribute('readonly')){if(element.getAttribute('value')&&(intKeyCode===38||intKeyCode===39||intKeyCode===40||intKeyCode===37)){newControlValue=new Date('1/1/1111 '+element.getAttribute('value'));event.preventDefault();event.stopPropagation();if(intKeyCode===38||intKeyCode===39){newControlValue=newControlValue.setMinutes(newControlValue.getMinutes()+1);}else if(intKeyCode===40||intKeyCode===37){newControlValue=newControlValue.setMinutes(newControlValue.getMinutes()-1);}}
if(intKeyCode===67&&!event.ctrlKey&&!event.metaKey&&!element.hasAttribute('non-empty')){newControlValue='';event.preventDefault();event.stopPropagation();}else if(intKeyCode===78&&!event.ctrlKey&&!event.metaKey&&!element.hasAttribute('no-now-button')){newControlValue=new Date();event.preventDefault();event.stopPropagation();}
if(newControlValue!==undefined){setValueDisplay(element,newControlValue);GS.setInputSelection(element.control,0,element.control.value.length);}
if(intKeyCode===13){handleNonEmpty(element);}}},'focusout':function(event){var element=this;if(element.innerState==='open'){element.close();}else{handleChange(element);}}},accessors:{value:{get:function(){if(!this.getAttribute('value')||this.getAttribute('value').trim()===''){return'NULL';}else{return this.getAttribute('value');}},set:function(newValue){this.setAttribute('value',newValue);}},dateValue:{get:function(){return new Date('1/1/1111 '+this.getAttribute('value'));},set:function(newValue){setValueDisplay(this,newValue);}},state:{get:function(){return this.innerState;},set:function(newValue){var element=this;if(newValue==='open'){element.open();}else{element.close();}}}},methods:{focus:function(){this.control.focus();},open:function(){var element=this;var pickerContainerElement;var overlayElement;var pickerElement;var handleLook;var strHTML;if(element.innerState==='closed'){element.innerState='open';element.lastClosedValue=element.getAttribute('value');if(!evt.touchDevice){element.control.focus();GS.setInputSelection(element.control,0,element.control.value.length);}else{}
pickerContainerElement=document.createElement('div');pickerContainerElement.classList.add('gs-time-time-picker-container');overlayElement=document.createElement('div');overlayElement.classList.add('gs-time-time-picker-overlay');pickerElement=document.createElement('div');pickerElement.classList.add('gs-time-time-picker');element.pickerContainerElement=pickerContainerElement;pickerContainerElement.appendChild(overlayElement);pickerContainerElement.appendChild(pickerElement);document.body.appendChild(pickerContainerElement);strHTML=ml(function(){/*

                        <div class="time-modal-control-container" flex-horizontal>

                            <gs-text class="time-modal-control" flex></gs-text>

                            <gs-button class="modal-done">Done</gs-button>

                        </div>

                        <div class="time-inner-container">

                            <div class="time-top-toolbar">

                                <div flex-horizontal align-bottom>

                                    <gs-button class="decrement-time" icononly icon="arrow-left"></gs-button>

                                    <div flex></div>

                                    <gs-button class="increment-time" icononly icon="arrow-right"></gs-button>

                                </div>

                            </div>

                            <div class="gs-time-clock-container" prevent-text-selection>

                                <div class="gs-time-bezel">

                                    <div class="clock-face-layer layer-1">

                                        <div class="clock-line" style="top: 0%;"><div class="clock-button clock-hour" data-value="12"><span class="content">12</span></div></div><div class="clock-line" style="top: 5.9%;"><div class="clock-split" style="width: 45.25%;

left: 4.5%;"><div class="clock-button clock-hour" data-value="11"><span class="content">11</span></div></div><div class="clock-split" style="width: 45.25%;

left: 46.75%;"><div class="clock-button clock-hour" data-value="1">&nbsp;<span class="content">1</span></div></div></div><div class="clock-line" style="top: 22.5%;"><div class="clock-split" style="width: 22%;

left: 0%;"><div class="clock-button clock-hour" data-value="10"><span class="content">10</span></div></div><div class="clock-split" style="width: 22%;

left: 78%;"><div class="clock-button clock-hour" data-value="2">&nbsp;<span class="content">2</span></div></div></div><div class="clock-line" style="top: 45.3%;"><div class="clock-split" style="width: 14%;

left: 0%;"><div class="clock-button clock-hour" data-value="9"><span class="content">9</span>&nbsp;</div></div><div class="clock-split" style="width: 14%;

left: 86%;"><div class="clock-button clock-hour" data-value="3">&nbsp;<span class="content">3</span></div></div></div><div class="clock-line" style="top: 67.8%;"><div class="clock-split" style="width: 22%;

left: 0%;"><div class="clock-button clock-hour" data-value="8"><span class="content">8</span>&nbsp;</div></div><div class="clock-split" style="width: 22%;

left: 78%"><div class="clock-button clock-hour" data-value="4">&nbsp;<span class="content">4</span></div></div></div><div class="clock-line" style="top: 83.5%;"><div class="clock-split" style="width: 45.25%;

left: 4.5%;"><div class="clock-button clock-hour" data-value="7"><span class="content">7</span>&nbsp;</div></div><div class="clock-split" style="width: 45.25%;

left: 46.75%;"><div class="clock-button clock-hour" data-value="5">&nbsp;<span class="content">5</span></div></div></div><div class="clock-line" style="top: 90%;"><div class="clock-button clock-hour" data-value="6"><span class="content">6</span></div></div>

                                    </div>

                                    <div class="clock-face-layer layer-2">

                                        <div class="clock-line" style="top: 0%;"><div class="clock-button clock-minute" data-value="0"><span class="content">00</span></div></div>

                                        <div class="clock-line" style="top: 5.9%;"><div class="clock-split" style="width: 45.25%;

left: 4.5%;"><div class="clock-button clock-minute" data-value="55"><span class="content">55</span></div></div><div class="clock-split" style="width: 45.25%;

left: 49.75%;"><div class="clock-button clock-minute" data-value="5"><span class="content">05</span></div></div></div>

                                        <div class="clock-line" style="top: 22.5%;"><div class="clock-split" style="width: 22%;

left: 0%;"><div class="clock-button clock-minute" data-value="50"><span class="content">50</span></div></div><div class="clock-split" style="width: 22%;

left: 78%;"><div class="clock-button clock-minute" data-value="10"><span class="content">10</span></div></div></div>

                                        <div class="clock-line" style="top: 45.3%;"><div class="clock-split" style="width: 16%;

left: 0%;"><div class="clock-button clock-minute" data-value="45"><span class="content">45</span></div></div><div class="clock-split" style="width: 16%;

left: 84%;"><div class="clock-button clock-minute" data-value="15"><span class="content">15</span></div></div></div>

                                        <div class="clock-line" style="top: 67.8%;"><div class="clock-split" style="width: 22%;

left: 0%;"><div class="clock-button clock-minute" data-value="40"><span class="content">40</span></div></div><div class="clock-split" style="width: 22%;

left: 78%;"><div class="clock-button clock-minute" data-value="20"><span class="content">20</span></div></div></div>

                                        <div class="clock-line" style="top: 83.5%;"><div class="clock-split" style="width: 45.25%;

left: 4.5%;"><div class="clock-button clock-minute" data-value="35"><span class="content">35</span></div></div><div class="clock-split" style="width: 45.25%;

left: 49.75%;"><div class="clock-button clock-minute" data-value="25"><span class="content">25</span></div></div></div>

                                        <div class="clock-line" style="top: 90%;"><div class="clock-button clock-minute" data-value="30"><span class="content">30</span></div></div>

                                        <div class="clock-center"><div class="clock-period-switch am"><span class="content">AM</span></div><div class="clock-period-switch pm"><span class="content">PM</span></div></div>

                                    </div>

                                </div>

                            </div>

                        </div>

                    */});strHTML+='<div class="time-bottom-toolbar">'+'<div flex-horizontal align-top>';if(!element.hasAttribute('no-now-button')){strHTML+='<gs-button class="now-time">Now</gs-button>';}
strHTML+='<gs-button class="done" flex>Done</gs-button>';if(!element.hasAttribute('non-empty')){strHTML+='<gs-button class="clear-time">Clear</gs-button>';}
strHTML+='</div>'+'</div>';pickerElement.innerHTML=strHTML;element.pickerModalControlElement=xtag.query(pickerContainerElement,'.time-modal-control')[0];refreshPickerValue(element);element.pickerModalControlElement.addEventListener('change',function(event){setValueDisplay(element,this.value);});element.pickerModalControlElement.addEventListener('keydown',function(event){if((event.keyCode||event.which)===13){element.close();}});pickerElement.addEventListener('mousedown',function(event){if(!evt.touchDevice){event.preventDefault();event.stopPropagation();}});pickerElement.addEventListener('click',function(event){var target=event.target,arrElements,i,len,newValue;if(target.classList.contains('content')){target=target.parentNode;}
if(target.classList.contains('clock-button')||target.classList.contains('clock-period-switch')){if(target.classList.contains('clock-hour')){arrElements=xtag.query(pickerElement,'.clock-hour');}
if(target.classList.contains('clock-minute')){arrElements=xtag.query(pickerElement,'.clock-minute');}
if(target.classList.contains('clock-period-switch')){arrElements=xtag.query(pickerElement,'.clock-period-switch');}
for(i=0,len=arrElements.length;i<len;i+=1){arrElements[i].classList.remove('selected');}
target.classList.add('selected');arrElements=xtag.query(pickerElement,'.selected');if(arrElements.length===3){newValue=arrElements[0].textContent+':'+
arrElements[1].textContent+' '+
arrElements[2].textContent;}}
if(target.classList.contains('increment-time')&&element.getAttribute('value')){newValue=new Date('1/1/1111 '+element.getAttribute('value'));newValue=newValue.setMinutes(newValue.getMinutes()+1);}else if(target.classList.contains('decrement-time')&&element.getAttribute('value')){newValue=new Date('1/1/1111 '+element.getAttribute('value'));newValue=newValue.setMinutes(newValue.getMinutes()-1);}else if(target.classList.contains('now-time')){newValue=new Date();}else if(target.classList.contains('clear-time')){newValue='';}else if(target.classList.contains('modal-done')||target.classList.contains('done')){element.close();}
if(newValue!==undefined){setValueDisplay(element,newValue);if(!evt.touchDevice){GS.setInputSelection(element.control,0,element.control.value.length);}}});handleLook=function(){var positionData,intPopupHeight,intPopupWidth;if(pickerContainerElement.parentNode!==document.body){window.removeEventListener('resize',handleLook);window.removeEventListener('orientationchange',handleLook);return;}
pickerElement.style.top='';pickerElement.style.left='';pickerElement.style.marginTop='';pickerContainerElement.classList.remove('modal');positionData=GS.getElementPositionData(element);intPopupHeight=pickerElement.offsetHeight;intPopupWidth=pickerElement.offsetWidth;if((positionData.intRoomAbove<intPopupHeight&&positionData.intRoomBelow<intPopupHeight)||window.innerWidth<400||window.innerHeight<550){pickerElement.style.marginTop='1em';pickerContainerElement.classList.add('modal');}else{if(positionData.intRoomBelow>intPopupHeight){pickerElement.style.top=(positionData.objElementOffset.top+positionData.intElementHeight)+'px';}else{pickerElement.style.top=(positionData.objElementOffset.top-intPopupHeight)+'px';}
pickerElement.style.left=((positionData.objElementOffset.left+positionData.intElementWidth)-intPopupWidth)+'px';}};handleLook();window.addEventListener('resize',handleLook);window.addEventListener('orientationchange',handleLook);}},close:function(){var element=this;if(element.innerState==='open'){element.innerState='closed';if(element.pickerContainerElement){document.body.removeChild(element.pickerContainerElement);element.pickerContainerElement='';}
if(element.getAttribute('value')!==element.lastClosedValue){handleChange(element);}else if(!element.getAttribute('value')){handleNonEmpty(element);}}},toggle:function(){if(this.innerState==='open'){this.close();}else{this.open();}}}});});/*jslint white:true browser:true this:true*/
/*global window,GS,document,xtag,designRegisterElement,registerDesignSnippet,addProp,encodeHTML,setOrRemoveTextAttribute,setOrRemoveBooleanAttribute,addFlexProps*/
window.addEventListener('design-register-element',function(){'use strict';registerDesignSnippet('<gs-timestamp>','<gs-timestamp>','gs-timestamp date-format="${0:isodate}" time-format=${1}></gs-timestamp>');designRegisterElement('gs-timestamp','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-timestamp.html');window.designElementProperty_GSTIMESTAMP=function(selectedElement){addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('Date Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('date-placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'date-placeholder',this.value);});addProp('Time Placeholder',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('time-placeholder')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'time-placeholder',this.value);});addProp('Mini',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('mini'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'mini',(this.value==='true'),true);});addProp('Date Picker',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-date-picker'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-date-picker',(this.value==='true'),false);});addProp('Date Format',true,'<gs-combo class="target" value="'+encodeHTML(selectedElement.getAttribute('date-format')||'')+'" mini>'+
ml(function(){/*<template>
                                            <table>
                                                <tbody>
                                                    <tr value="">
                                                        <td hidden>Default</td>
                                                        <td><center>Default<br /> (01/01/2015)</center></td>
                                                    </tr>
                                                    <tr value="shortdate">
                                                        <td hidden>shortdate</td>
                                                        <td><center>shortdate<br /> (1/1/15)</center></td>
                                                    </tr>
                                                    <tr value="mediumdate">
                                                        <td hidden>mediumdate</td>
                                                        <td><center>mediumdate<br /> (Jan 1, 2015)</center></td>
                                                    </tr>
                                                    <tr value="longdate">
                                                        <td hidden>longdate</td>
                                                        <td><center>longdate<br /> (January 1, 2015)</center></td>
                                                    </tr>
                                                    <tr value="fulldate">
                                                        <td hidden>fulldate</td>
                                                        <td><center>fulldate<br /> (Thursday, January 1, 2015)</center></td>
                                                    </tr>
                                                    <tr value="isodate">
                                                        <td hidden>isodate</td>
                                                        <td><center>isodate<br /> (2015-01-01)</center></td>
                                                    </tr>
                                                    <tr value="isodatetime">
                                                        <td hidden>isodatetime</td>
                                                        <td><center>isodatetime<br /> (2015-01-01T00:00:00)</center></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </template>
                                    </gs-combo>
                                */}),function(){return setOrRemoveTextAttribute(selectedElement,'date-format',this.value);});addProp('Time Picker',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('no-time-picker'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'no-time-picker',(this.value==='true'),false);});addProp('Time Display Format',true,'<gs-select class="target" value="'+encodeHTML(selectedElement.getAttribute('time-format')||'')+'" mini>'+'<option value="">Regular (1:30 PM)</option>'+'<option value="military">Military (13:30)</option>'+'</gs-select>',function(){return setOrRemoveTextAttribute(selectedElement,'time-format',this.value);});addProp('Time Non-Empty',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('time-non-empty'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'time-non-empty',(this.value==='true'),true);});addProp('Time Now Button',true,'<gs-checkbox class="target" value="'+(!selectedElement.hasAttribute('time-no-now-button'))+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'time-no-now-button',(this.value==='true'),false);});addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Date Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('date-tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'date-tabindex',this.value);});addProp('Time Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('time-tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'time-tabindex',this.value);});addProp('Autocorrect',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocorrect')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocorrect',(this.value==='false'?'off':''));});addProp('Autocapitalize',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocapitalize')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocapitalize',(this.value==='false'?'off':''));});addProp('Autocomplete',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('autocomplete')!=='off')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'autocomplete',(this.value==='false'?'off':''));});addProp('Spellcheck',true,'<gs-checkbox class="target" value="'+(selectedElement.getAttribute('spellcheck')!=='false')+'" mini></gs-checkbox>',function(){return setOrRemoveTextAttribute(selectedElement,'spellcheck',(this.value==='false'?'false':''));});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});addProp('Readonly',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('readonly')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'readonly',this.value==='true',true);});addFlexProps(selectedElement);addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol&&strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(strQSCol&&GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function syncView(element){var strDateValue=element.dateControl.value+' '+(element.timeControl.value==='NULL'?'00:00':element.timeControl.value);var dateValue=new Date(strDateValue);var newValue=dateValue.getFullYear()+'-'+(dateValue.getMonth()+1)+'-'+dateValue.getDate()+' '+dateValue.getHours()+':'+dateValue.getMinutes();element.setAttribute('value',newValue);}
function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};i=0;len=element.attributes.length;arrAttr=element.attributes;while(i<len){jsnAttr=element.attributes[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function focusFunction(event){GS.triggerEvent(event.target.parentNode,'focus');event.target.parentNode.classList.add('focus');}
function blurFunction(event){GS.triggerEvent(event.target.parentNode,'blur');event.target.parentNode.classList.remove('focus');}
function mouseoutFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseout);event.target.parentNode.classList.remove('hover');}
function mouseoverFunction(event){GS.triggerEvent(event.target.parentNode,evt.mouseover);event.target.parentNode.classList.add('hover');}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){if(element.value&&new Date(element.value).getTime()){element.setAttribute('value',element.value);delete element.value;}}}
function elementInserted(element){var dateValue='';var timeValue='';if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(element.hasAttribute('value')){var arrValue=element.getAttribute('value').split(' ');dateValue=new Date(arrValue[0]+' 00:00:00');timeValue=arrValue[1];}
element.dateControl=document.createElement('gs-date');element.timeControl=document.createElement('gs-time');var arrPassthrough=['mini','autocorrect','autocapitalize','autocomplete','spellcheck','disabled','readonly'];var arrDatePassthrough=['date-placeholder','no-date-picker','date-format','date-tabindex'];var arrTimePassthrough=['time-placeholder','no-time-picker','time-format','time-non-empty','time-no-now-button','time-tabindex'];var i;var len;for(i=0,len=arrPassthrough.length;i<len;i+=1){if(element.hasAttribute(arrPassthrough[i])){element.dateControl.setAttribute(arrPassthrough[i],'');element.timeControl.setAttribute(arrPassthrough[i],'');}}
for(i=0,len=arrDatePassthrough.length;i<len;i+=1){if(element.hasAttribute(arrDatePassthrough[i])){element.dateControl.setAttribute(arrDatePassthrough[i].replace(/date\-/g,''),element.getAttribute(arrDatePassthrough[i])||'');}}
for(i=0,len=arrTimePassthrough.length;i<len;i+=1){if(element.hasAttribute(arrTimePassthrough[i])){element.timeControl.setAttribute(arrTimePassthrough[i].replace(/time\-/g,''),element.getAttribute(arrTimePassthrough[i])||'');}}
element.dateControl.value=dateValue;element.timeControl.value=timeValue;element.dateControl.setAttribute('flex','');element.timeControl.setAttribute('flex','');element.dateControl.setAttribute('gs-dynamic','');element.timeControl.setAttribute('gs-dynamic','');element.dateControl.addEventListener('focus',focusFunction);element.timeControl.addEventListener('focus',focusFunction);element.dateControl.addEventListener('blur',blurFunction);element.timeControl.addEventListener('blur',blurFunction);element.dateControl.addEventListener(evt.mouseout,mouseoutFunction);element.timeControl.addEventListener(evt.mouseout,mouseoutFunction);element.dateControl.addEventListener(evt.mouseover,mouseoverFunction);element.timeControl.addEventListener(evt.mouseover,mouseoverFunction);element.dateControl.addEventListener('change',function(event){syncView(element);event.stopPropagation();GS.triggerEvent(element,'change');});element.timeControl.addEventListener('change',function(event){syncView(element);event.stopPropagation();GS.triggerEvent(element,'change');});element.appendChild(element.dateControl);element.appendChild(element.timeControl);pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}}}
xtag.register('gs-timestamp',{lifecycle:{created:function(){elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){var dateValue='';var timeValue='';if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){if(strAttrName==='value'){if(newValue!==null){var arrValue=newValue.split(' ');dateValue=new Date(arrValue[0]);timeValue=arrValue[1];this.dateControl.value=dateValue;this.timeControl.value=timeValue;}else{this.dateControl.value=null;this.timeControl.value=null;}}}}},events:{},accessors:{value:{get:function(){return this.getAttribute('value');},set:function(newValue){this.setAttribute('value',newValue);}}},methods:{}});});window.addEventListener('design-register-element',function(){registerDesignSnippet('<gs-toggle>','<gs-toggle>','gs-toggle column="${1}">${2}</gs-toggle>');designRegisterElement('gs-toggle','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-buttons-toggle.html');window.designElementProperty_GSTOGGLE=function(selectedElement){addProp('Icon',true,'<div flex-horizontal>'+'     <gs-text id="prop-icon-input" class="target" value="'+(selectedElement.getAttribute('icon')||'')+'" mini flex></gs-text>'+'     <gs-button id="prop-icon-picker-button" mini icononly icon="list"></gs-button>'+'     <style>#prop-icon-picker-button:after {font-size: 1em;}</style>'+'</div>',function(){return setOrRemoveTextAttribute(selectedElement,'icon',this.value,false);});document.getElementById('prop-icon-picker-button').addEventListener('click',function(){var i,len,html,arrIcons=GS.iconList(),strName,templateElement;for(i=0,len=arrIcons.length,html='';i<len;i+=1){strName=arrIcons[i].name;html+='<gs-block>'+'<gs-button iconleft icon="'+strName+'" dialogclose>'+strName+'</gs-button>'+'</gs-block>';}
templateElement=document.createElement('template');templateElement.setAttribute('data-max-width','1100px');templateElement.innerHTML=ml(function(){/*
                <gs-page>
                    <gs-header><center><h3>Choose An Icon</h3></center></gs-header>
                    <gs-body padded>
                        <gs-grid widths="1,1,1,1" reflow-at="767px">{{HTML}}</gs-grid>
                    </gs-body>
                    <gs-footer><gs-button dialogclose>Cancel</gs-button></gs-footer>
                </gs-page>
            */}).replace('{{HTML}}',html);GS.openDialog(templateElement,'',function(event,strAnswer){var propInput=document.getElementById('prop-icon-input');if(strAnswer!=='Cancel'){propInput.value=strAnswer;GS.triggerEvent(propInput,'change');}});});if(selectedElement.getAttribute('icon')||selectedElement.hasAttribute('iconleft')||selectedElement.hasAttribute('iconright')||selectedElement.hasAttribute('icontop')||selectedElement.hasAttribute('iconbottom')||selectedElement.hasAttribute('icononly')||selectedElement.hasAttribute('iconrotateright')||selectedElement.hasAttribute('iconrotatedown')||selectedElement.hasAttribute('iconrotateleft')){if(selectedElement.hasAttribute('iconleft')){strIconPos='iconleft';}else if(selectedElement.hasAttribute('iconright')){strIconPos='iconright';}else if(selectedElement.hasAttribute('icontop')){strIconPos='icontop';}else if(selectedElement.hasAttribute('iconbottom')){strIconPos='iconbottom';}else if(selectedElement.hasAttribute('icononly')){strIconPos='icononly';}else{strIconPos='';}
addProp('Icon Position',true,'<gs-select class="target" value="'+strIconPos+'" mini>'+'   <option value="">Default</option>'+'   <option value="iconleft">Left</option>'+'   <option value="iconright">Right</option>'+'   <option value="icontop">Top</option>'+'   <option value="iconbottom">Bottom</option>'+'   <option value="icononly">Icononly</option>'+'</gs-select>',function(){selectedElement.removeAttribute('iconleft');selectedElement.removeAttribute('iconright');selectedElement.removeAttribute('icontop');selectedElement.removeAttribute('iconbottom');selectedElement.removeAttribute('icononly');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});if(selectedElement.hasAttribute('iconrotateright')){strIconRotation='iconrotateright';}else if(selectedElement.hasAttribute('iconrotatedown')){strIconRotation='iconrotatedown';}else if(selectedElement.hasAttribute('iconrotateleft')){strIconRotation='iconrotateleft';}else{strIconRotation='';}
addProp('Icon&nbsp;Rotation',true,'<gs-select class="target" value="'+strIconRotation+'" mini>'+'   <option value="">None</option>'+'   <option value="iconrotateright">90 degrees</option>'+'   <option value="iconrotatedown">180 degrees</option>'+'   <option value="iconrotateleft">270 degrees</option>'+'</gs-select>',function(){selectedElement.removeAttribute('iconrotateright');selectedElement.removeAttribute('iconrotatedown');selectedElement.removeAttribute('iconrotateleft');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});}
addProp('Title',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('title')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'title',this.value);});addProp('Tabindex',true,'<gs-number class="target" value="'+encodeHTML(selectedElement.getAttribute('tabindex')||'')+'" mini></gs-number>',function(){return setOrRemoveTextAttribute(selectedElement,'tabindex',this.value);});var strVisibilityAttribute='';if(selectedElement.hasAttribute('hidden')){strVisibilityAttribute='hidden';}
if(selectedElement.hasAttribute('hide-on-desktop')){strVisibilityAttribute='hide-on-desktop';}
if(selectedElement.hasAttribute('hide-on-tablet')){strVisibilityAttribute='hide-on-tablet';}
if(selectedElement.hasAttribute('hide-on-phone')){strVisibilityAttribute='hide-on-phone';}
if(selectedElement.hasAttribute('show-on-desktop')){strVisibilityAttribute='show-on-desktop';}
if(selectedElement.hasAttribute('show-on-tablet')){strVisibilityAttribute='show-on-tablet';}
if(selectedElement.hasAttribute('show-on-phone')){strVisibilityAttribute='show-on-phone';}
addProp('Visibility',true,'<gs-select class="target" value="'+strVisibilityAttribute+'" mini>'+'<option value="">Visible</option>'+'<option value="hidden">Invisible</option>'+'<option value="hide-on-desktop">Invisible at desktop size</option>'+'<option value="hide-on-tablet">Invisible at tablet size</option>'+'<option value="hide-on-phone">Invisible at phone size</option>'+'<option value="show-on-desktop">Visible at desktop size</option>'+'<option value="show-on-tablet">Visible at tablet size</option>'+'<option value="show-on-phone">Visible at phone size</option>'+'</gs-select>',function(){selectedElement.removeAttribute('hidden');selectedElement.removeAttribute('hide-on-desktop');selectedElement.removeAttribute('hide-on-tablet');selectedElement.removeAttribute('hide-on-phone');selectedElement.removeAttribute('show-on-desktop');selectedElement.removeAttribute('show-on-tablet');selectedElement.removeAttribute('show-on-phone');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Disabled',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('disabled')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'disabled',this.value==='true',true);});strFontAttribute='';if(selectedElement.hasAttribute('txt-primary')){strFontAttribute='txt-primary';}
if(selectedElement.hasAttribute('txt-success')){strFontAttribute='txt-success';}
if(selectedElement.hasAttribute('txt-info')){strFontAttribute='txt-info';}
if(selectedElement.hasAttribute('txt-warning')){strFontAttribute='txt-warning';}
if(selectedElement.hasAttribute('txt-danger')){strFontAttribute='txt-danger';}
addProp('Font Color',true,'<gs-select class="target" value="'+strFontAttribute+'" mini>'+'<option value="">Default</option>'+'<option value="txt-primary">Primary</option>'+'<option value="txt-success">Success</option>'+'<option value="txt-info">Info</option>'+'<option value="txt-warning">Warning</option>'+'<option value="txt-danger">Danger</option>'+'</gs-select>',function(){selectedElement.removeAttribute('txt-primary');selectedElement.removeAttribute('txt-success');selectedElement.removeAttribute('txt-info');selectedElement.removeAttribute('txt-warning');selectedElement.removeAttribute('txt-danger');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});strBackgroundAttribute='';if(selectedElement.hasAttribute('bg-primary')){strBackgroundAttribute='bg-primary';}
if(selectedElement.hasAttribute('bg-success')){strBackgroundAttribute='bg-success';}
if(selectedElement.hasAttribute('bg-info')){strBackgroundAttribute='bg-info';}
if(selectedElement.hasAttribute('bg-warning')){strBackgroundAttribute='bg-warning';}
if(selectedElement.hasAttribute('bg-danger')){strBackgroundAttribute='bg-danger';}
addProp('Background Color',true,'<gs-select class="target" value="'+strBackgroundAttribute+'" mini>'+'<option value="">Default</option>'+'<option value="bg-primary">Primary</option>'+'<option value="bg-success">Success</option>'+'<option value="bg-info">Info</option>'+'<option value="bg-warning">Warning</option>'+'<option value="bg-danger">Danger</option>'+'</gs-select>',function(){selectedElement.removeAttribute('bg-primary');selectedElement.removeAttribute('bg-success');selectedElement.removeAttribute('bg-info');selectedElement.removeAttribute('bg-warning');selectedElement.removeAttribute('bg-danger');if(this.value){selectedElement.setAttribute(this.value,'');}
return selectedElement;});addProp('Column',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('column')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'column',this.value);});addProp('Value',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('value')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'value',this.value);});addProp('Column In Querystring',true,'<gs-text class="target" value="'+encodeHTML(selectedElement.getAttribute('qs')||'')+'" mini></gs-text>',function(){return setOrRemoveTextAttribute(selectedElement,'qs',this.value,false);});addProp('suspend-created',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-created')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-created',this.value==='true',true);});addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});addProp('Corners',true,'<div class="target">'+'<gs-checkbox value="'+(!(selectedElement.hasAttribute('remove-all')||selectedElement.hasAttribute('remove-top')||selectedElement.hasAttribute('remove-left')||selectedElement.hasAttribute('remove-top-left'))).toString()+'" remove-right remove-bottom id="round-top-left-corner________" inline></gs-checkbox>'+'<gs-checkbox value="'+(!(selectedElement.hasAttribute('remove-all')||selectedElement.hasAttribute('remove-top')||selectedElement.hasAttribute('remove-right')||selectedElement.hasAttribute('remove-top-right'))).toString()+'" remove-left remove-bottom id="round-top-right-corner________" inline></gs-checkbox><br />'+'<gs-checkbox value="'+(!(selectedElement.hasAttribute('remove-all')||selectedElement.hasAttribute('remove-bottom')||selectedElement.hasAttribute('remove-left')||selectedElement.hasAttribute('remove-bottom-left'))).toString()+'" remove-right remove-top id="round-bottom-left-corner________" inline></gs-checkbox>'+'<gs-checkbox value="'+(!(selectedElement.hasAttribute('remove-all')||selectedElement.hasAttribute('remove-bottom')||selectedElement.hasAttribute('remove-right')||selectedElement.hasAttribute('remove-bottom-right'))).toString()+'" remove-left remove-top id="round-bottom-right-corner________" inline></gs-checkbox>'+'</div>',function(){var topLeft=document.getElementById('round-top-left-corner________').value==='true',topRight=document.getElementById('round-top-right-corner________').value==='true',bottomLeft=document.getElementById('round-bottom-left-corner________').value==='true',bottomRight=document.getElementById('round-bottom-right-corner________').value==='true',arrStrAttr=[],i,len;selectedElement.removeAttribute('remove-all');selectedElement.removeAttribute('remove-top');selectedElement.removeAttribute('remove-bottom');selectedElement.removeAttribute('remove-left');selectedElement.removeAttribute('remove-right');selectedElement.removeAttribute('remove-top-left');selectedElement.removeAttribute('remove-top-right');selectedElement.removeAttribute('remove-bottom-left');selectedElement.removeAttribute('remove-bottom-right');if(!topLeft&&!topRight&&!bottomLeft&&!bottomRight){arrStrAttr.push('remove-all');}else if(!topLeft&&!topRight){arrStrAttr.push('remove-top');}else if(!bottomLeft&&!bottomRight){arrStrAttr.push('remove-bottom');}else if(!topLeft&&!bottomLeft){arrStrAttr.push('remove-left');}else if(!topRight&&!bottomRight){arrStrAttr.push('remove-right');}
if(!topLeft&&!bottomLeft&&arrStrAttr[0]!=='remove-all'){arrStrAttr.push('remove-left');}else if(!topLeft&&topRight){arrStrAttr.push('remove-top-left');}else if(!bottomLeft&&bottomRight){arrStrAttr.push('remove-bottom-left');}
if(!topRight&&!bottomRight&&arrStrAttr[0]!=='remove-all'){arrStrAttr.push('remove-right');}else if(topLeft&&!topRight){arrStrAttr.push('remove-top-right');}else if(bottomLeft&&!bottomRight){arrStrAttr.push('remove-bottom-right');}
for(i=0,len=arrStrAttr.length;i<len;i+=1){selectedElement.setAttribute(arrStrAttr[i],'');}
return selectedElement;});addFlexProps(selectedElement);};});document.addEventListener('DOMContentLoaded',function(){'use strict';function saveDefaultAttributes(element){var i;var len;var arrAttr;var jsnAttr;element.internal.defaultAttributes={};arrAttr=element.attributes;i=0;len=arrAttr.length;while(i<len){jsnAttr=arrAttr[i];element.internal.defaultAttributes[jsnAttr.nodeName]=(jsnAttr.nodeValue||'');i+=1;}}
function pushReplacePopHandler(element){var i;var len;var strQS=GS.getQueryString();var strQSCol=element.getAttribute('qs');var strQSValue;var strQSAttr;var arrQSParts;var arrAttrParts;var strOperator;if(strQSCol.indexOf('=')!==-1){arrAttrParts=strQSCol.split(',');i=0;len=arrAttrParts.length;while(i<len){strQSCol=arrAttrParts[i];if(strQSCol.indexOf('!=')!==-1){strOperator='!=';arrQSParts=strQSCol.split('!=');}else{strOperator='=';arrQSParts=strQSCol.split('=');}
strQSCol=arrQSParts[0];strQSAttr=arrQSParts[1]||arrQSParts[0];if(strOperator==='!='){if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){element.setAttribute(strQSAttr,'');}else{element.removeAttribute(strQSAttr);}}else{if(GS.qryGetKeys(strQS).indexOf(strQSCol)===-1){if(element.internal.defaultAttributes[strQSAttr]!==undefined){element.setAttribute(strQSAttr,(element.internal.defaultAttributes[strQSAttr]||''));}else{element.removeAttribute(strQSAttr);}}else{element.setAttribute(strQSAttr,(GS.qryGetVal(strQS,strQSCol)||element.internal.defaultAttributes[strQSAttr]||''));}}
i+=1;}}else if(GS.qryGetKeys(strQS).indexOf(strQSCol)>-1){strQSValue=GS.qryGetVal(strQS,strQSCol);if(element.internal.bolQSFirstRun!==true){if(strQSValue!==''||!element.getAttribute('value')){element.setAttribute('value',strQSValue);}}else{element.value=strQSValue;}}
element.internal.bolQSFirstRun=true;}
function elementCreated(element){if(!element.hasAttribute('suspend-created')){}}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;element.internal={};saveDefaultAttributes(element);if(!evt.touchDevice){element.addEventListener(evt.mousedown,function(event){element.classList.add('down');});element.addEventListener(evt.mouseout,function(event){element.classList.remove('down');element.classList.remove('hover');});element.addEventListener(evt.mouseover,function(event){element.classList.remove('down');element.classList.add('hover');});element.addEventListener('keydown',function(event){if(!element.hasAttribute('disabled')&&!element.classList.contains('down')&&(event.keyCode===13||event.keyCode===32)){element.classList.add('down');}});element.addEventListener('keyup',function(event){if(!element.hasAttribute('disabled')&&element.classList.contains('down')&&(event.keyCode===13||event.keyCode===32)){GS.triggerEvent(element,'click');}});}
if(!element.hasAttribute('tabindex')){element.tabIndex=0;}
if(typeof element.getAttribute('value')==='string'){if(element.getAttribute('value')==='true'||element.getAttribute('value')==='-1'){element.setAttribute('selected','');}}
if(element.getAttribute('qs')){pushReplacePopHandler(element);window.addEventListener('pushstate',function(){pushReplacePopHandler(element);});window.addEventListener('replacestate',function(){pushReplacePopHandler(element);});window.addEventListener('popstate',function(){pushReplacePopHandler(element);});}}}}
xtag.register('gs-toggle',{lifecycle:{created:function(){if(this.value){this.setAttribute('value',this.value);delete this.value;}
elementCreated(this);},inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if(strAttrName==='suspend-created'&&newValue===null){elementCreated(this);elementInserted(this);}else if(strAttrName==='suspend-inserted'&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{'click':function(event){if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){this.classList.remove('down');if(this.hasAttribute('selected')){this.removeAttribute('selected');if(this.getAttribute('value')==='true'){this.setAttribute('value','false');}else if(this.getAttribute('value')==='-1'){this.setAttribute('value','0');}}else{this.setAttribute('selected','');if(this.getAttribute('value')==='false'){this.setAttribute('value','true');}else if(this.getAttribute('value')==='0'){this.setAttribute('value','-1');}}
xtag.fireEvent(this,'change',{bubbles:true,cancelable:true});}}},accessors:{'value':{'get':function(){return this.hasAttribute('selected');},'set':function(newValue){if(newValue===true||newValue==='true'){this.setAttribute('selected','');}else{this.removeAttribute('selected');}}},'textValue':{'get':function(){return this.hasAttribute('selected')?'YES':'NO';},'set':function(newValue){if(newValue===true||newValue==='true'||newValue==='YES'){this.setAttribute('selected','');}else{this.removeAttribute('selected');}}}},methods:{}});});window.addEventListener('design-register-element',function(){'use strict';designRegisterElement('gs-tutorial','/env/app/developer_g/greyspots-'+GS.version()+'/documentation/doc-elem-tutorial.html');window.designElementProperty_GSTUTORIAL=function(selectedElement){addProp('suspend-inserted',true,'<gs-checkbox class="target" value="'+(selectedElement.hasAttribute('suspend-inserted')||'')+'" mini></gs-checkbox>',function(){return setOrRemoveBooleanAttribute(selectedElement,'suspend-inserted',this.value==='true',true);});};});document.addEventListener('DOMContentLoaded',function(){'use strict';function closeCurrentPopup(element){var popupElement=element.currentPopup;if(popupElement.strBeforeClose){new Function(popupElement.strBeforeClose).apply(element);}
if(popupElement.relatedOverlay){document.body.removeChild(popupElement.relatedOverlay);}
document.body.removeChild(popupElement);}
function openPopup(element,templateElement,intTemplateNumber,intNumberOfTemplates){var strTargetSelector=(templateElement.getAttribute('target')||''),strDirectionRequest=(templateElement.getAttribute('direction')||'down'),intMaxWidthAttribute=parseInt((templateElement.getAttribute('max-width')||'9999999'),10),strBeforeOpen=templateElement.getAttribute('before-open'),strBeforeClose=templateElement.getAttribute('before-close'),strHTML,arrElements,elementTarget,arrTests,popupElement,overlayElement,arrowElement,positionHandlingFunction,buttonElement,i,len;templateElement=templateElement.cloneNode(true);if(strBeforeOpen){new Function(strBeforeOpen).apply(element);}
strHTML=(templateElement.innerHTML||'');if(intTemplateNumber===1&&intNumberOfTemplates===1){strHTML+=ml(function(){/*
                            <div class="popup-control-bar">
                                <gs-button class="button-close" inline icononly icon="times"></gs-button>
                            </div>
                        */});}else if(intTemplateNumber===1&&intNumberOfTemplates>1){strHTML+=ml(function(){/*
                            <div class="popup-control-bar">
                                <gs-button class="button-right" inline icononly icon="arrow-right" remove-left></gs-button>
                                <gs-button class="button-close" inline icononly icon="times" remove-right></gs-button>
                            </div>
                        */});}else if(intTemplateNumber>1&&intNumberOfTemplates>intTemplateNumber){strHTML+=ml(function(){/*
                            <div class="popup-control-bar">
                                <gs-button class="button-right" inline icononly icon="arrow-right" remove-left></gs-button>
                                <gs-button class="button-close" inline icononly icon="times" remove-all></gs-button>
                                <gs-button class="button-left" inline icononly icon="arrow-left" remove-right></gs-button>
                            </div>
                        */});}else{strHTML+=ml(function(){/*
                            <div class="popup-control-bar">
                                <gs-button class="button-close" inline icononly icon="times" remove-left></gs-button>
                                <gs-button class="button-left" inline icononly icon="arrow-left" remove-right></gs-button>
                            </div>
                        */});}
if(strTargetSelector){try{arrElements=xtag.toArray(document.querySelectorAll(strTargetSelector));}catch(e){}
arrElements=arrElements||[];if(arrElements.length>1){console.warn('gs-tutorial Warning: More than one element matched with selector \''+strTargetSelector+'\'.');}
if(arrElements.length===0){console.warn('gs-tutorial Warning: No elements matched with selector \''+strTargetSelector+'\'.');}else{elementTarget=arrElements[0];}}
strDirectionRequest.toLowerCase();if(!strDirectionRequest.match(/^up$|^down$|^left$|^right$/)){console.warn('gs-tutorial Warning: '+'Direction \''+strDirectionRequest+'\' not recognized. '+'Please use \'up\', \'down\', \'left\', \'right\'. Defaulting to \'down\'.');strDirectionRequest='down';}
if(strDirectionRequest==='up'){arrTests=['up','down','left','right'];}else if(strDirectionRequest==='down'){arrTests=['down','up','left','right'];}else if(strDirectionRequest==='left'){arrTests=['left','right','down','up'];}else if(strDirectionRequest==='right'){arrTests=['right','left','down','up'];}
popupElement=document.createElement('gs-tutorial-popup');overlayElement=document.createElement('gs-tutorial-overlay');arrowElement=document.createElement('div');arrowElement.classList.add('connection-arrow');document.body.appendChild(overlayElement);document.body.appendChild(popupElement);popupElement.relatedOverlay=overlayElement;popupElement.strBeforeClose=strBeforeClose;popupElement.innerHTML=strHTML;popupElement.appendChild(arrowElement);buttonElement=xtag.query(popupElement,'.popup-control-bar > .button-left')[0];if(buttonElement){buttonElement.addEventListener('click',function(){element.backward();});}
buttonElement=xtag.query(popupElement,'.popup-control-bar > .button-close')[0];if(buttonElement){buttonElement.addEventListener('click',function(){element.end();});}
buttonElement=xtag.query(popupElement,'.popup-control-bar > .button-right')[0];if(buttonElement){buttonElement.addEventListener('click',function(){element.forward();});}
overlayElement.addEventListener('click',function(){element.forward();});positionHandlingFunction=function(){var intTemp,intMaxWidth,intMaxHeight,intResolvedWidth,intResolvedHeight,jsnPositionData,strResolvedDirection,intPopupMidPoint,intElementMidPoint,intMargin=10,intArrow=5,intPopupTop,intPopupLeft,intArrowLeft,intArrowTop;if(popupElement.parentNode!==document.body){window.removeEventListener('resize',positionHandlingFunction);window.removeEventListener('orientationchange',positionHandlingFunction);return;}
popupElement.oldScrollTop=popupElement.scrollTop;popupElement.oldScrollLeft=popupElement.scrollLeft;popupElement.classList.remove('up');popupElement.classList.remove('down');popupElement.classList.remove('left');popupElement.classList.remove('right');popupElement.setAttribute('style','');arrowElement.setAttribute('style','');if((popupElement.offsetHeight+popupElement.offsetWidth)<300){intTemp=300;}else{intTemp=((popupElement.offsetHeight+popupElement.offsetWidth)/2);}
intMaxWidth=(intTemp<window.innerWidth?intTemp:window.innerWidth-(intMargin*2));if(intMaxWidth>intMaxWidthAttribute){intMaxWidth=intMaxWidthAttribute;}
if(evt.touchDevice){intMaxHeight=Math.floor(window.innerHeight/2)-(intMargin*2);}else{intMaxHeight=Math.floor(window.innerHeight/3)-(intMargin*2);}
popupElement.style.maxWidth=intMaxWidth+'px';popupElement.style.maxHeight=intMaxHeight+'px';intResolvedWidth=popupElement.offsetWidth;intResolvedHeight=popupElement.offsetHeight;if(elementTarget){jsnPositionData=GS.getElementPositionData(elementTarget);for(i=0,len=arrTests.length;i<len;i+=1){if((arrTests[i]==='up'&&(intResolvedHeight+intMargin+intArrow)<=jsnPositionData.intRoomAbove)||(arrTests[i]==='down'&&(intResolvedHeight+intMargin+intArrow)<=jsnPositionData.intRoomBelow)||(arrTests[i]==='left'&&(intResolvedWidth+intMargin+intArrow)<=jsnPositionData.intRoomLeft)||(arrTests[i]==='right'&&(intResolvedWidth+intMargin+intArrow)<=jsnPositionData.intRoomRight)){strResolvedDirection=arrTests[i];break;}}
strResolvedDirection=strResolvedDirection||'middle';}else{strResolvedDirection='middle';}
if(strResolvedDirection==='up'||strResolvedDirection==='down'){intElementMidPoint=(jsnPositionData.intElementLeft+(jsnPositionData.intElementWidth/2));intPopupMidPoint=(intResolvedWidth/2);if(intElementMidPoint-intPopupMidPoint<intMargin){intPopupLeft=intMargin;}else if(intElementMidPoint+intPopupMidPoint>window.innerWidth-intMargin){intPopupLeft=((window.innerWidth-intResolvedWidth)-intMargin);}else{intPopupLeft=(intElementMidPoint-intPopupMidPoint);}
intArrowLeft=(intElementMidPoint-intPopupLeft);if(intElementMidPoint<=(intMargin+Math.round(intArrow/2)+5)){popupElement.classList.add('extreme-left');}
if(intElementMidPoint>=(((window.innerWidth-intMargin)-Math.round(intArrow/2))-5)){popupElement.classList.add('extreme-right');}}else if(strResolvedDirection==='left'||strResolvedDirection==='right'){intElementMidPoint=(jsnPositionData.intElementTop+(jsnPositionData.intElementHeight/2));intPopupMidPoint=(intResolvedHeight/2);if(intElementMidPoint-intPopupMidPoint<intMargin){intPopupTop=intMargin;}else if(intElementMidPoint+intPopupMidPoint>window.innerHeight-intMargin){intPopupTop=((window.innerHeight-intResolvedHeight)-intMargin);}else{intPopupTop=(intElementMidPoint-intPopupMidPoint);}
intArrowTop=(intElementMidPoint-intPopupTop);if(intElementMidPoint<=(intMargin+Math.round(intArrow/2)+5)){popupElement.classList.add('extreme-up');}
if(intElementMidPoint>=(((window.innerHeight-intMargin)-Math.round(intArrow/2))-5)){popupElement.classList.add('extreme-down');}}else{intPopupTop=(window.innerHeight/2)-(intResolvedHeight/2);intPopupLeft=(window.innerWidth/2)-(intResolvedWidth/2);}
if(strResolvedDirection==='up'){intPopupTop=(jsnPositionData.intElementTop-intResolvedHeight)-intArrow;}else if(strResolvedDirection==='down'){intPopupTop=(jsnPositionData.intElementTop+jsnPositionData.intElementHeight)+intArrow;}else if(strResolvedDirection==='left'){intPopupLeft=(jsnPositionData.intElementLeft-intResolvedWidth)-intArrow;}else if(strResolvedDirection==='right'){intPopupLeft=(jsnPositionData.intElementLeft+jsnPositionData.intElementWidth)+intArrow;}
if(intPopupTop+intResolvedWidth>window.innerHeight){intPopupTop-=(intPopupTop+intResolvedWidth)-window.innerHeight;}
if(intPopupLeft+intResolvedWidth>window.innerWidth){intPopupLeft-=(intPopupLeft+intResolvedWidth)-window.innerWidth;}
popupElement.style.top=intPopupTop+'px';popupElement.style.left=intPopupLeft+'px';if(strResolvedDirection!=='middle'){popupElement.classList.add(strResolvedDirection);if(intArrowLeft){arrowElement.style.left=intArrowLeft+'px';}
if(intArrowTop){arrowElement.style.top=intArrowTop+'px';}}};positionHandlingFunction();window.addEventListener('resize',positionHandlingFunction);window.addEventListener('orientationchange',positionHandlingFunction);element.currentPopup=popupElement;}
function elementInserted(element){if(!element.hasAttribute('suspend-created')&&!element.hasAttribute('suspend-inserted')){if(!element.inserted){element.inserted=true;}}}
xtag.register('gs-tutorial',{lifecycle:{inserted:function(){elementInserted(this);},attributeChanged:function(strAttrName,oldValue,newValue){if((strAttrName==='suspend-created'||strAttrName==='suspend-created')&&newValue===null){elementInserted(this);}else if(!this.hasAttribute('suspend-created')&&!this.hasAttribute('suspend-inserted')){}}},events:{},accessors:{},methods:{'start':function(){var strBeforeStart=this.getAttribute('before-start'),arrElement=xtag.queryChildren(this,'template');if(arrElement.length===0){console.warn('gs-tutorial Warning: No popup templates provided.'+' Please consult the documention if you need info on how to use the gs-tutorial element.');}else if(this.children.length!==arrElement.length){console.warn('gs-tutorial Warning: Invalid element'+((this.children.length-arrElement.length)===1?'':'s')+'.'+' The gs-tutorial element only accepts template elements for it\'s children.');}
this.currentIndex=0;if(arrElement[this.currentIndex]){if(strBeforeStart){new Function(strBeforeStart).apply(this);}
openPopup(this,arrElement[this.currentIndex],(this.currentIndex+1),arrElement.length);}},'end':function(){var strBeforeEnd=this.getAttribute('before-end');if(strBeforeEnd){new Function(strBeforeEnd).apply(this);}
if(this.currentPopup){closeCurrentPopup(this);}},'forward':function(){var arrElement=xtag.queryChildren(this,'template');this.currentIndex+=1;if(arrElement[this.currentIndex]){if(this.currentPopup){closeCurrentPopup(this);}
openPopup(this,arrElement[this.currentIndex],(this.currentIndex+1),arrElement.length);}else{this.end();}},'backward':function(){var arrElement=xtag.queryChildren(this,'template');if(this.currentPopup){closeCurrentPopup(this);}
this.currentIndex-=1;if(arrElement[this.currentIndex]){if(this.currentPopup){closeCurrentPopup(this);}
openPopup(this,arrElement[this.currentIndex],(this.currentIndex+1),arrElement.length);}},'reposition':function(){}}});});